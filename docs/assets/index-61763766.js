var Aa=Object.defineProperty;var ua=($,it,g)=>it in $?Aa($,it,{enumerable:!0,configurable:!0,writable:!0,value:g}):$[it]=g;var _t=($,it,g)=>(ua($,typeof it!="symbol"?it+"":it,g),g);(function(){const it=document.createElement("link").relList;if(it&&it.supports&&it.supports("modulepreload"))return;for(const W of document.querySelectorAll('link[rel="modulepreload"]'))F(W);new MutationObserver(W=>{for(const Z of W)if(Z.type==="childList")for(const q of Z.addedNodes)q.tagName==="LINK"&&q.rel==="modulepreload"&&F(q)}).observe(document,{childList:!0,subtree:!0});function g(W){const Z={};return W.integrity&&(Z.integrity=W.integrity),W.referrerPolicy&&(Z.referrerPolicy=W.referrerPolicy),W.crossOrigin==="use-credentials"?Z.credentials="include":W.crossOrigin==="anonymous"?Z.credentials="omit":Z.credentials="same-origin",Z}function F(W){if(W.ep)return;W.ep=!0;const Z=g(W);fetch(W.href,Z)}})();/*!
 * excalibur - 0.27.0 - 2022-7-8
 * https://github.com/excaliburjs/Excalibur
 * Copyright (c) 2022 Excalibur.js <https://github.com/excaliburjs/Excalibur/graphs/contributors>
 * Licensed BSD-2-Clause
 * @preserve
 */var pa={4662:($,it,g)=>{g(3430);var F=g(8791);$.exports=F("Array","sort")},8343:($,it,g)=>{g(4769);var F=g(9276);$.exports=F.Object.keys},7111:($,it,g)=>{var F=g(6733),W=g(9821),Z=TypeError;$.exports=function(q){if(F(q))return q;throw Z(W(q)+" is not a function")}},1176:($,it,g)=>{var F=g(5052),W=String,Z=TypeError;$.exports=function(q){if(F(q))return q;throw Z(W(q)+" is not an object")}},9540:($,it,g)=>{var F=g(905),W=g(3231),Z=g(9646),q=function(E){return function(T,D,S){var K=F(T),w=Z(K),y=W(S,w),P;if(E&&D!=D){for(;w>y;)if(P=K[y++],P!=P)return!0}else for(;w>y;y++)if((E||y in K)&&K[y]===D)return E||y||0;return!E&&-1}};$.exports={includes:q(!0),indexOf:q(!1)}},6038:($,it,g)=>{var F=g(4229);$.exports=function(W,Z){var q=[][W];return!!q&&F(function(){q.call(null,Z||function(){return 1},1)})}},9794:($,it,g)=>{var F=g(3231),W=g(9646),Z=g(2324),q=Array,E=Math.max;$.exports=function(T,D,S){for(var K=W(T),w=F(D,K),y=F(S===void 0?K:S,K),P=q(E(y-w,0)),V=0;w<y;w++,V++)Z(P,V,T[w]);return P.length=V,P}},3867:($,it,g)=>{var F=g(9794),W=Math.floor,Z=function(T,D){var S=T.length,K=W(S/2);return S<8?q(T,D):E(T,Z(F(T,0,K),D),Z(F(T,K),D),D)},q=function(T,D){for(var S=T.length,K=1,w,y;K<S;){for(y=K,w=T[K];y&&D(T[y-1],w)>0;)T[y]=T[--y];y!==K++&&(T[y]=w)}return T},E=function(T,D,S,K){for(var w=D.length,y=S.length,P=0,V=0;P<w||V<y;)T[P+V]=P<w&&V<y?K(D[P],S[V])<=0?D[P++]:S[V++]:P<w?D[P++]:S[V++];return T};$.exports=Z},7079:($,it,g)=>{var F=g(5968),W=F({}.toString),Z=F("".slice);$.exports=function(q){return Z(W(q),8,-1)}},1589:($,it,g)=>{var F=g(1601),W=g(6733),Z=g(7079),q=g(95),E=q("toStringTag"),T=Object,D=Z(function(){return arguments}())=="Arguments",S=function(K,w){try{return K[w]}catch{}};$.exports=F?Z:function(K){var w,y,P;return K===void 0?"Undefined":K===null?"Null":typeof(y=S(w=T(K),E))=="string"?y:D?Z(w):(P=Z(w))=="Object"&&W(w.callee)?"Arguments":P}},7081:($,it,g)=>{var F=g(8270),W=g(4826),Z=g(7933),q=g(1787);$.exports=function(E,T,D){for(var S=W(T),K=q.f,w=Z.f,y=0;y<S.length;y++){var P=S[y];!F(E,P)&&!(D&&F(D,P))&&K(E,P,w(T,P))}}},5762:($,it,g)=>{var F=g(7400),W=g(1787),Z=g(5358);$.exports=F?function(q,E,T){return W.f(q,E,Z(1,T))}:function(q,E,T){return q[E]=T,q}},5358:$=>{$.exports=function(it,g){return{enumerable:!(it&1),configurable:!(it&2),writable:!(it&4),value:g}}},2324:($,it,g)=>{var F=g(9310),W=g(1787),Z=g(5358);$.exports=function(q,E,T){var D=F(E);D in q?W.f(q,D,Z(0,T)):q[D]=T}},4768:($,it,g)=>{var F=g(6733),W=g(1787),Z=g(6039),q=g(8400);$.exports=function(E,T,D,S){S||(S={});var K=S.enumerable,w=S.name!==void 0?S.name:T;if(F(D)&&Z(D,w,S),S.global)K?E[T]=D:q(T,D);else{try{S.unsafe?E[T]&&(K=!0):delete E[T]}catch{}K?E[T]=D:W.f(E,T,{value:D,enumerable:!1,configurable:!S.nonConfigurable,writable:!S.nonWritable})}return E}},8400:($,it,g)=>{var F=g(9859),W=Object.defineProperty;$.exports=function(Z,q){try{W(F,Z,{value:q,configurable:!0,writable:!0})}catch{F[Z]=q}return q}},9563:($,it,g)=>{var F=g(9821),W=TypeError;$.exports=function(Z,q){if(!delete Z[q])throw W("Cannot delete property "+F(q)+" of "+F(Z))}},7400:($,it,g)=>{var F=g(4229);$.exports=!F(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},2635:($,it,g)=>{var F=g(9859),W=g(5052),Z=F.document,q=W(Z)&&W(Z.createElement);$.exports=function(E){return q?Z.createElement(E):{}}},2671:($,it,g)=>{var F=g(598),W=F.match(/firefox\/(\d+)/i);$.exports=!!W&&+W[1]},8506:($,it,g)=>{var F=g(598);$.exports=/MSIE|Trident/.test(F)},598:($,it,g)=>{var F=g(1333);$.exports=F("navigator","userAgent")||""},6358:($,it,g)=>{var F=g(9859),W=g(598),Z=F.process,q=F.Deno,E=Z&&Z.versions||q&&q.version,T=E&&E.v8,D,S;T&&(D=T.split("."),S=D[0]>0&&D[0]<4?1:+(D[0]+D[1])),!S&&W&&(D=W.match(/Edge\/(\d+)/),(!D||D[1]>=74)&&(D=W.match(/Chrome\/(\d+)/),D&&(S=+D[1]))),$.exports=S},9811:($,it,g)=>{var F=g(598),W=F.match(/AppleWebKit\/(\d+)\./);$.exports=!!W&&+W[1]},8791:($,it,g)=>{var F=g(9859),W=g(5968);$.exports=function(Z,q){return W(F[Z].prototype[q])}},3837:$=>{$.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3103:($,it,g)=>{var F=g(9859),W=g(7933).f,Z=g(5762),q=g(4768),E=g(8400),T=g(7081),D=g(6541);$.exports=function(S,K){var w=S.target,y=S.global,P=S.stat,V,R,O,z,X,p;if(y?R=F:P?R=F[w]||E(w,{}):R=(F[w]||{}).prototype,R)for(O in K){if(X=K[O],S.dontCallGetSet?(p=W(R,O),z=p&&p.value):z=R[O],V=D(y?O:w+(P?".":"#")+O,S.forced),!V&&z!==void 0){if(typeof X==typeof z)continue;T(X,z)}(S.sham||z&&z.sham)&&Z(X,"sham",!0),q(R,O,X,S)}}},4229:$=>{$.exports=function(it){try{return!!it()}catch{return!0}}},7188:($,it,g)=>{var F=g(4229);$.exports=!F(function(){var W=function(){}.bind();return typeof W!="function"||W.hasOwnProperty("prototype")})},266:($,it,g)=>{var F=g(7188),W=Function.prototype.call;$.exports=F?W.bind(W):function(){return W.apply(W,arguments)}},1805:($,it,g)=>{var F=g(7400),W=g(8270),Z=Function.prototype,q=F&&Object.getOwnPropertyDescriptor,E=W(Z,"name"),T=E&&function(){}.name==="something",D=E&&(!F||F&&q(Z,"name").configurable);$.exports={EXISTS:E,PROPER:T,CONFIGURABLE:D}},5968:($,it,g)=>{var F=g(7188),W=Function.prototype,Z=W.bind,q=W.call,E=F&&Z.bind(q,q);$.exports=F?function(T){return T&&E(T)}:function(T){return T&&function(){return q.apply(T,arguments)}}},1333:($,it,g)=>{var F=g(9859),W=g(6733),Z=function(q){return W(q)?q:void 0};$.exports=function(q,E){return arguments.length<2?Z(F[q]):F[q]&&F[q][E]}},5300:($,it,g)=>{var F=g(7111);$.exports=function(W,Z){var q=W[Z];return q==null?void 0:F(q)}},9859:($,it,g)=>{var F=function(W){return W&&W.Math==Math&&W};$.exports=F(typeof globalThis=="object"&&globalThis)||F(typeof window=="object"&&window)||F(typeof self=="object"&&self)||F(typeof g.g=="object"&&g.g)||function(){return this}()||Function("return this")()},8270:($,it,g)=>{var F=g(5968),W=g(2991),Z=F({}.hasOwnProperty);$.exports=Object.hasOwn||function(E,T){return Z(W(E),T)}},5977:$=>{$.exports={}},4394:($,it,g)=>{var F=g(7400),W=g(4229),Z=g(2635);$.exports=!F&&!W(function(){return Object.defineProperty(Z("div"),"a",{get:function(){return 7}}).a!=7})},9337:($,it,g)=>{var F=g(5968),W=g(4229),Z=g(7079),q=Object,E=F("".split);$.exports=W(function(){return!q("z").propertyIsEnumerable(0)})?function(T){return Z(T)=="String"?E(T,""):q(T)}:q},8511:($,it,g)=>{var F=g(5968),W=g(6733),Z=g(5353),q=F(Function.toString);W(Z.inspectSource)||(Z.inspectSource=function(E){return q(E)}),$.exports=Z.inspectSource},6407:($,it,g)=>{var F=g(8694),W=g(9859),Z=g(5968),q=g(5052),E=g(5762),T=g(8270),D=g(5353),S=g(4399),K=g(5977),w="Object already initialized",y=W.TypeError,P=W.WeakMap,V,R,O,z=function(Y){return O(Y)?R(Y):V(Y,{})},X=function(Y){return function(I){var k;if(!q(I)||(k=R(I)).type!==Y)throw y("Incompatible receiver, "+Y+" required");return k}};if(F||D.state){var p=D.state||(D.state=new P),m=Z(p.get),C=Z(p.has),v=Z(p.set);V=function(Y,I){if(C(p,Y))throw new y(w);return I.facade=Y,v(p,Y,I),I},R=function(Y){return m(p,Y)||{}},O=function(Y){return C(p,Y)}}else{var H=S("state");K[H]=!0,V=function(Y,I){if(T(Y,H))throw new y(w);return I.facade=Y,E(Y,H,I),I},R=function(Y){return T(Y,H)?Y[H]:{}},O=function(Y){return T(Y,H)}}$.exports={set:V,get:R,has:O,enforce:z,getterFor:X}},6733:$=>{$.exports=function(it){return typeof it=="function"}},6541:($,it,g)=>{var F=g(4229),W=g(6733),Z=/#|\.prototype\./,q=function(K,w){var y=T[E(K)];return y==S?!0:y==D?!1:W(w)?F(w):!!w},E=q.normalize=function(K){return String(K).replace(Z,".").toLowerCase()},T=q.data={},D=q.NATIVE="N",S=q.POLYFILL="P";$.exports=q},5052:($,it,g)=>{var F=g(6733);$.exports=function(W){return typeof W=="object"?W!==null:F(W)}},4231:$=>{$.exports=!1},9395:($,it,g)=>{var F=g(1333),W=g(6733),Z=g(1321),q=g(6969),E=Object;$.exports=q?function(T){return typeof T=="symbol"}:function(T){var D=F("Symbol");return W(D)&&Z(D.prototype,E(T))}},9646:($,it,g)=>{var F=g(4237);$.exports=function(W){return F(W.length)}},6039:($,it,g)=>{var F=g(4229),W=g(6733),Z=g(8270),q=g(7400),E=g(1805).CONFIGURABLE,T=g(8511),D=g(6407),S=D.enforce,K=D.get,w=Object.defineProperty,y=q&&!F(function(){return w(function(){},"length",{value:8}).length!==8}),P=String(String).split("String"),V=$.exports=function(R,O,z){String(O).slice(0,7)==="Symbol("&&(O="["+String(O).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),z&&z.getter&&(O="get "+O),z&&z.setter&&(O="set "+O),(!Z(R,"name")||E&&R.name!==O)&&(q?w(R,"name",{value:O,configurable:!0}):R.name=O),y&&z&&Z(z,"arity")&&R.length!==z.arity&&w(R,"length",{value:z.arity});try{z&&Z(z,"constructor")&&z.constructor?q&&w(R,"prototype",{writable:!1}):R.prototype&&(R.prototype=void 0)}catch{}var X=S(R);return Z(X,"source")||(X.source=P.join(typeof O=="string"?O:"")),R};Function.prototype.toString=V(function(){return W(this)&&K(this).source||T(this)},"toString")},917:$=>{var it=Math.ceil,g=Math.floor;$.exports=Math.trunc||function(W){var Z=+W;return(Z>0?g:it)(Z)}},3839:($,it,g)=>{var F=g(6358),W=g(4229);$.exports=!!Object.getOwnPropertySymbols&&!W(function(){var Z=Symbol();return!String(Z)||!(Object(Z)instanceof Symbol)||!Symbol.sham&&F&&F<41})},8694:($,it,g)=>{var F=g(9859),W=g(6733),Z=g(8511),q=F.WeakMap;$.exports=W(q)&&/native code/.test(Z(q))},1787:($,it,g)=>{var F=g(7400),W=g(4394),Z=g(7137),q=g(1176),E=g(9310),T=TypeError,D=Object.defineProperty,S=Object.getOwnPropertyDescriptor,K="enumerable",w="configurable",y="writable";it.f=F?Z?function(V,R,O){if(q(V),R=E(R),q(O),typeof V=="function"&&R==="prototype"&&"value"in O&&y in O&&!O[y]){var z=S(V,R);z&&z[y]&&(V[R]=O.value,O={configurable:w in O?O[w]:z[w],enumerable:K in O?O[K]:z[K],writable:!1})}return D(V,R,O)}:D:function(V,R,O){if(q(V),R=E(R),q(O),W)try{return D(V,R,O)}catch{}if("get"in O||"set"in O)throw T("Accessors not supported");return"value"in O&&(V[R]=O.value),V}},7933:($,it,g)=>{var F=g(7400),W=g(266),Z=g(9195),q=g(5358),E=g(905),T=g(9310),D=g(8270),S=g(4394),K=Object.getOwnPropertyDescriptor;it.f=F?K:function(y,P){if(y=E(y),P=T(P),S)try{return K(y,P)}catch{}if(D(y,P))return q(!W(Z.f,y,P),y[P])}},8151:($,it,g)=>{var F=g(140),W=g(3837),Z=W.concat("length","prototype");it.f=Object.getOwnPropertyNames||function(E){return F(E,Z)}},894:($,it)=>{it.f=Object.getOwnPropertySymbols},1321:($,it,g)=>{var F=g(5968);$.exports=F({}.isPrototypeOf)},140:($,it,g)=>{var F=g(5968),W=g(8270),Z=g(905),q=g(9540).indexOf,E=g(5977),T=F([].push);$.exports=function(D,S){var K=Z(D),w=0,y=[],P;for(P in K)!W(E,P)&&W(K,P)&&T(y,P);for(;S.length>w;)W(K,P=S[w++])&&(~q(y,P)||T(y,P));return y}},5632:($,it,g)=>{var F=g(140),W=g(3837);$.exports=Object.keys||function(q){return F(q,W)}},9195:($,it)=>{var g={}.propertyIsEnumerable,F=Object.getOwnPropertyDescriptor,W=F&&!g.call({1:2},1);it.f=W?function(q){var E=F(this,q);return!!E&&E.enumerable}:g},2914:($,it,g)=>{var F=g(266),W=g(6733),Z=g(5052),q=TypeError;$.exports=function(E,T){var D,S;if(T==="string"&&W(D=E.toString)&&!Z(S=F(D,E))||W(D=E.valueOf)&&!Z(S=F(D,E))||T!=="string"&&W(D=E.toString)&&!Z(S=F(D,E)))return S;throw q("Can't convert object to primitive value")}},4826:($,it,g)=>{var F=g(1333),W=g(5968),Z=g(8151),q=g(894),E=g(1176),T=W([].concat);$.exports=F("Reflect","ownKeys")||function(S){var K=Z.f(E(S)),w=q.f;return w?T(K,w(S)):K}},9276:($,it,g)=>{var F=g(9859);$.exports=F},8885:$=>{var it=TypeError;$.exports=function(g){if(g==null)throw it("Can't call method on "+g);return g}},4399:($,it,g)=>{var F=g(3036),W=g(1441),Z=F("keys");$.exports=function(q){return Z[q]||(Z[q]=W(q))}},5353:($,it,g)=>{var F=g(9859),W=g(8400),Z="__core-js_shared__",q=F[Z]||W(Z,{});$.exports=q},3036:($,it,g)=>{var F=g(4231),W=g(5353);($.exports=function(Z,q){return W[Z]||(W[Z]=q!==void 0?q:{})})("versions",[]).push({version:"3.23.3",mode:F?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.3/LICENSE",source:"https://github.com/zloirock/core-js"})},3231:($,it,g)=>{var F=g(3329),W=Math.max,Z=Math.min;$.exports=function(q,E){var T=F(q);return T<0?W(T+E,0):Z(T,E)}},905:($,it,g)=>{var F=g(9337),W=g(8885);$.exports=function(Z){return F(W(Z))}},3329:($,it,g)=>{var F=g(917);$.exports=function(W){var Z=+W;return Z!==Z||Z===0?0:F(Z)}},4237:($,it,g)=>{var F=g(3329),W=Math.min;$.exports=function(Z){return Z>0?W(F(Z),9007199254740991):0}},2991:($,it,g)=>{var F=g(8885),W=Object;$.exports=function(Z){return W(F(Z))}},2066:($,it,g)=>{var F=g(266),W=g(5052),Z=g(9395),q=g(5300),E=g(2914),T=g(95),D=TypeError,S=T("toPrimitive");$.exports=function(K,w){if(!W(K)||Z(K))return K;var y=q(K,S),P;if(y){if(w===void 0&&(w="default"),P=F(y,K,w),!W(P)||Z(P))return P;throw D("Can't convert object to primitive value")}return w===void 0&&(w="number"),E(K,w)}},9310:($,it,g)=>{var F=g(2066),W=g(9395);$.exports=function(Z){var q=F(Z,"string");return W(q)?q:q+""}},1601:($,it,g)=>{var F=g(95),W=F("toStringTag"),Z={};Z[W]="z",$.exports=String(Z)==="[object z]"},3326:($,it,g)=>{var F=g(1589),W=String;$.exports=function(Z){if(F(Z)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return W(Z)}},9821:$=>{var it=String;$.exports=function(g){try{return it(g)}catch{return"Object"}}},1441:($,it,g)=>{var F=g(5968),W=0,Z=Math.random(),q=F(1 .toString);$.exports=function(E){return"Symbol("+(E===void 0?"":E)+")_"+q(++W+Z,36)}},6969:($,it,g)=>{var F=g(3839);$.exports=F&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},7137:($,it,g)=>{var F=g(7400),W=g(4229);$.exports=F&&W(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},95:($,it,g)=>{var F=g(9859),W=g(3036),Z=g(8270),q=g(1441),E=g(3839),T=g(6969),D=W("wks"),S=F.Symbol,K=S&&S.for,w=T?S:S&&S.withoutSetter||q;$.exports=function(y){if(!Z(D,y)||!(E||typeof D[y]=="string")){var P="Symbol."+y;E&&Z(S,y)?D[y]=S[y]:T&&K?D[y]=K(P):D[y]=w(P)}return D[y]}},3430:($,it,g)=>{var F=g(3103),W=g(5968),Z=g(7111),q=g(2991),E=g(9646),T=g(9563),D=g(3326),S=g(4229),K=g(3867),w=g(6038),y=g(2671),P=g(8506),V=g(6358),R=g(9811),O=[],z=W(O.sort),X=W(O.push),p=S(function(){O.sort(void 0)}),m=S(function(){O.sort(null)}),C=w("sort"),v=!S(function(){if(V)return V<70;if(!(y&&y>3)){if(P)return!0;if(R)return R<603;var I="",k,b,N,_;for(k=65;k<76;k++){switch(b=String.fromCharCode(k),k){case 66:case 69:case 70:case 72:N=3;break;case 68:case 71:N=4;break;default:N=2}for(_=0;_<47;_++)O.push({k:b+_,v:N})}for(O.sort(function(ct,gt){return gt.v-ct.v}),_=0;_<O.length;_++)b=O[_].k.charAt(0),I.charAt(I.length-1)!==b&&(I+=b);return I!=="DGBEFHACIJK"}}),H=p||!m||!C||!v,Y=function(I){return function(k,b){return b===void 0?-1:k===void 0?1:I!==void 0?+I(k,b)||0:D(k)>D(b)?1:-1}};F({target:"Array",proto:!0,forced:H},{sort:function(k){k!==void 0&&Z(k);var b=q(this);if(v)return k===void 0?z(b):z(b,k);var N=[],_=E(b),ct,gt;for(gt=0;gt<_;gt++)gt in b&&X(N,b[gt]);for(K(N,Y(k)),ct=N.length,gt=0;gt<ct;)b[gt]=N[gt++];for(;gt<_;)T(b,gt++);return b}})},4769:($,it,g)=>{var F=g(3103),W=g(2991),Z=g(5632),q=g(4229),E=q(function(){Z(1)});F({target:"Object",stat:!0,forced:E},{keys:function(D){return Z(W(D))}})},1388:($,it,g)=>{g.d(it,{Z:()=>T});var F=g(272),W=g.n(F),Z=g(2609),q=g.n(Z),E=q()(W());E.push([$.id,`/* Buttons styles start */\r
\r
button#excalibur-play {\r
  display: inline-block;\r
  position: relative;\r
  z-index: 999;\r
  border-radius: 6px;\r
  border: none;\r
  /*border: 3px solid;\r
    border-color: white;\r
    box-shadow: 0 0 10px #ccc;*/\r
  padding: 1rem 1.5rem 1rem 4rem;\r
  margin: 0;\r
  text-decoration: none;\r
  background: #00b233;\r
  color: #ffffff;\r
  font-family: sans-serif;\r
  font-size: 2rem;\r
  white-space: nowrap;\r
  line-height: 1;\r
  cursor: pointer;\r
  text-align: center;\r
  transition: background 250ms ease-in-out, transform 150ms ease;\r
  -webkit-appearance: none;\r
  -moz-appearance: none;\r
\r
  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r
  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r
  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r
  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r
  animation: excalibur-button-fadein 200ms;\r
}\r
\r
/*\r
button#excalibur-play {\r
  display: none;\r
}*/\r
\r
button#excalibur-play:after {\r
  position: absolute;\r
  content: '';\r
  border: 8px solid;\r
  border-color: transparent transparent transparent white;\r
  left: 35px;\r
  top: 24px;\r
  width: 0;\r
  height: 0;\r
}\r
\r
button#excalibur-play:before {\r
  position: absolute;\r
  content: '';\r
  border: 3px solid;\r
  left: 19px;\r
  top: 14px;\r
  border-radius: 20px;\r
  width: 30px;\r
  height: 30px;\r
}\r
\r
button#excalibur-play:hover,\r
button#excalibur-play:focus {\r
  background: #00982c;\r
}\r
\r
button#excalibur-play:focus {\r
  outline: 1px solid #fff;\r
  outline-offset: -4px;\r
}\r
\r
button#excalibur-play:active {\r
  transform: scale(0.99);\r
}\r
\r
@keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Firefox < 16 */\r
@-moz-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Safari, Chrome and Opera > 12.1 */\r
@-webkit-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Internet Explorer */\r
@-ms-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Opera < 12.1 */\r
@-o-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
`,"",{version:3,sources:["webpack://./Loader.css"],names:[],mappings:"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF",sourcesContent:[`/* Buttons styles start */\r
\r
button#excalibur-play {\r
  display: inline-block;\r
  position: relative;\r
  z-index: 999;\r
  border-radius: 6px;\r
  border: none;\r
  /*border: 3px solid;\r
    border-color: white;\r
    box-shadow: 0 0 10px #ccc;*/\r
  padding: 1rem 1.5rem 1rem 4rem;\r
  margin: 0;\r
  text-decoration: none;\r
  background: #00b233;\r
  color: #ffffff;\r
  font-family: sans-serif;\r
  font-size: 2rem;\r
  white-space: nowrap;\r
  line-height: 1;\r
  cursor: pointer;\r
  text-align: center;\r
  transition: background 250ms ease-in-out, transform 150ms ease;\r
  -webkit-appearance: none;\r
  -moz-appearance: none;\r
\r
  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r
  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r
  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r
  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r
  animation: excalibur-button-fadein 200ms;\r
}\r
\r
/*\r
button#excalibur-play {\r
  display: none;\r
}*/\r
\r
button#excalibur-play:after {\r
  position: absolute;\r
  content: '';\r
  border: 8px solid;\r
  border-color: transparent transparent transparent white;\r
  left: 35px;\r
  top: 24px;\r
  width: 0;\r
  height: 0;\r
}\r
\r
button#excalibur-play:before {\r
  position: absolute;\r
  content: '';\r
  border: 3px solid;\r
  left: 19px;\r
  top: 14px;\r
  border-radius: 20px;\r
  width: 30px;\r
  height: 30px;\r
}\r
\r
button#excalibur-play:hover,\r
button#excalibur-play:focus {\r
  background: #00982c;\r
}\r
\r
button#excalibur-play:focus {\r
  outline: 1px solid #fff;\r
  outline-offset: -4px;\r
}\r
\r
button#excalibur-play:active {\r
  transform: scale(0.99);\r
}\r
\r
@keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Firefox < 16 */\r
@-moz-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Safari, Chrome and Opera > 12.1 */\r
@-webkit-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Internet Explorer */\r
@-ms-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
\r
/* Opera < 12.1 */\r
@-o-keyframes excalibur-button-fadein {\r
  from {\r
    opacity: 0;\r
  }\r
  to {\r
    opacity: 1;\r
  }\r
}\r
`],sourceRoot:""}]);const T=E},7379:($,it,g)=>{g.d(it,{Z:()=>T});var F=g(272),W=g.n(F),Z=g(2609),q=g.n(Z),E=q()(W());E.push([$.id,`\r
#ex-toast-container {\r
  position: absolute;\r
  height: 0;\r
  min-width: 50%;\r
  left: 50%;\r
  top: 0;\r
}\r
\r
.ex-toast-message {\r
  left: -50%;\r
  position: relative;\r
  display: flex;\r
  justify-content: space-between;\r
\r
\r
  padding: 10px;\r
  margin-top: 5px;\r
  font-size: 18px;\r
  font-family: sans-serif;\r
  border-radius: 6px;\r
  border: 3px solid #b7b779;\r
  background-color: rgb(253, 253, 192);\r
}\r
\r
\r
.ex-toast-message button {\r
  align-self: flex-start;\r
}`,"",{version:3,sources:["webpack://./Util/Toaster.css"],names:[],mappings:";AACA;EACE,kBAAkB;EAClB,SAAS;EACT,cAAc;EACd,SAAS;EACT,MAAM;AACR;;AAEA;EACE,UAAU;EACV,kBAAkB;EAClB,aAAa;EACb,8BAA8B;;;EAG9B,aAAa;EACb,eAAe;EACf,eAAe;EACf,uBAAuB;EACvB,kBAAkB;EAClB,yBAAyB;EACzB,oCAAoC;AACtC;;;AAGA;EACE,sBAAsB;AACxB",sourcesContent:[`\r
#ex-toast-container {\r
  position: absolute;\r
  height: 0;\r
  min-width: 50%;\r
  left: 50%;\r
  top: 0;\r
}\r
\r
.ex-toast-message {\r
  left: -50%;\r
  position: relative;\r
  display: flex;\r
  justify-content: space-between;\r
\r
\r
  padding: 10px;\r
  margin-top: 5px;\r
  font-size: 18px;\r
  font-family: sans-serif;\r
  border-radius: 6px;\r
  border: 3px solid #b7b779;\r
  background-color: rgb(253, 253, 192);\r
}\r
\r
\r
.ex-toast-message button {\r
  align-self: flex-start;\r
}`],sourceRoot:""}]);const T=E},2609:$=>{$.exports=function(it){var g=[];return g.toString=function(){return this.map(function(W){var Z="",q=typeof W[5]<"u";return W[4]&&(Z+="@supports (".concat(W[4],") {")),W[2]&&(Z+="@media ".concat(W[2]," {")),q&&(Z+="@layer".concat(W[5].length>0?" ".concat(W[5]):""," {")),Z+=it(W),q&&(Z+="}"),W[2]&&(Z+="}"),W[4]&&(Z+="}"),Z}).join("")},g.i=function(W,Z,q,E,T){typeof W=="string"&&(W=[[null,W,void 0]]);var D={};if(q)for(var S=0;S<this.length;S++){var K=this[S][0];K!=null&&(D[K]=!0)}for(var w=0;w<W.length;w++){var y=[].concat(W[w]);q&&D[y[0]]||(typeof T<"u"&&(typeof y[5]>"u"||(y[1]="@layer".concat(y[5].length>0?" ".concat(y[5]):""," {").concat(y[1],"}")),y[5]=T),Z&&(y[2]&&(y[1]="@media ".concat(y[2]," {").concat(y[1],"}")),y[2]=Z),E&&(y[4]?(y[1]="@supports (".concat(y[4],") {").concat(y[1],"}"),y[4]=E):y[4]="".concat(E)),g.push(y))}},g}},272:$=>{$.exports=function(it){var g=it[1],F=it[3];if(!F)return g;if(typeof btoa=="function"){var W=btoa(unescape(encodeURIComponent(JSON.stringify(F)))),Z="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(W),q="/*# ".concat(Z," */"),E=F.sources.map(function(T){return"/*# sourceURL=".concat(F.sourceRoot||"").concat(T," */")});return[g].concat(E).concat([q]).join(`
`)}return[g].join(`
`)}}},Xo={};function pe($){var it=Xo[$];if(it!==void 0)return it.exports;var g=Xo[$]={id:$,exports:{}};return pa[$](g,g.exports,pe),g.exports}pe.n=$=>{var it=$&&$.__esModule?()=>$.default:()=>$;return pe.d(it,{a:it}),it};pe.d=($,it)=>{for(var g in it)pe.o(it,g)&&!pe.o($,g)&&Object.defineProperty($,g,{enumerable:!0,get:it[g]})};pe.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();pe.o=($,it)=>Object.prototype.hasOwnProperty.call($,it);pe.r=$=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty($,Symbol.toStringTag,{value:"Module"}),Object.defineProperty($,"__esModule",{value:!0})};var U={};(()=>{pe.d(U,{fWn:()=>ms,Ia8:()=>nr,rqv:()=>r,hLI:()=>vs,yyv:()=>oo,tX5:()=>hs,vtX:()=>mi,r7K:()=>Ri,lCh:()=>Zr,cE4:()=>nt,fwF:()=>Vi,sce:()=>Ks,_c7:()=>be,KUs:()=>so,Ajp:()=>Ki,RDh:()=>Fn,_H9:()=>Ni,mxs:()=>Ar,OmD:()=>Ht,kBf:()=>N,C4F:()=>Ti,NQt:()=>Cr,JjN:()=>wi,V1s:()=>Kr,Xz7:()=>_n,Cdc:()=>Xs,FKn:()=>ve,wTW:()=>We,SUY:()=>On,ab2:()=>Us,GfZ:()=>Pe,YMS:()=>Mi,oyv:()=>_e,aUb:()=>ts,SdD:()=>gi,JUv:()=>ni,jEj:()=>f,TFq:()=>Ke,HDU:()=>ii,R_y:()=>ei,ydN:()=>Zi,t50:()=>Ps,s$$:()=>zi,v2G:()=>Gt,Ilk:()=>I,s9i:()=>br,dxL:()=>ss,LLX:()=>ns,wA2:()=>Se,R_p:()=>Ae,IQ$:()=>no,I5F:()=>H,X8$:()=>vi,FR6:()=>fe,U8o:()=>pi,kbG:()=>je,iS_:()=>Qs,cGG:()=>lo,RPN:()=>Dn,skb:()=>ro,SLU:()=>Wn,RdJ:()=>Ne,cNu:()=>qs,gU7:()=>tr,LSk:()=>Ur,Nmp:()=>kn,d1Y:()=>re,xrL:()=>fs,sRW:()=>ir,cmV:()=>Uo,qWz:()=>In,N0Q:()=>dr,q8b:()=>ne,ynB:()=>Ee,jT9:()=>Wr,wAz:()=>Cs,D4V:()=>as,N6H:()=>Ts,W1A:()=>Xn,JHW:()=>we,v2K:()=>to,pBf:()=>Bi,GMl:()=>M,zW2:()=>$,B0K:()=>us,Nv7:()=>As,C_p:()=>Ns,iqw:()=>Me,MUA:()=>qn,xqU:()=>Ds,pTp:()=>Hr,vUK:()=>q,j9l:()=>En,Zxw:()=>ri,Hdx:()=>Sn,Z$d:()=>Bn,iqV:()=>xr,o$7:()=>$s,olM:()=>_,Zm$:()=>tt,$QH:()=>bt,i78:()=>Bt,h6u:()=>ye,hts:()=>Ze,j88:()=>ee,VME:()=>Ue,nt:()=>Ve,Ukr:()=>nn,zsu:()=>Be,oA6:()=>Qe,TVh:()=>bs,TwZ:()=>Cn,GTT:()=>sr,xxj:()=>mr,XdK:()=>ji,Jmb:()=>xe,cXo:()=>un,Dm5:()=>Xi,IIB:()=>F,zI0:()=>gs,LYD:()=>Gn,cEG:()=>is,SEl:()=>s,t9V:()=>l,SKZ:()=>rt,__J:()=>Mo,RI$:()=>Yr,x12:()=>Bs,ccz:()=>Le,aNw:()=>ps,xwn:()=>qr,dNK:()=>Mn,ini:()=>C,YdH:()=>v,y3G:()=>L,l57:()=>A,xn0:()=>vn,t2V:()=>ur,uxB:()=>ie,cpd:()=>io,fiy:()=>ar,$XZ:()=>lr,uqK:()=>Qi,STE:()=>Nr,y$z:()=>Ie,mAD:()=>vr,sOq:()=>ke,hUw:()=>Qn,_0G:()=>c,Sqs:()=>an,hpZ:()=>Nn,Vol:()=>ui,wIZ:()=>Ft,cBi:()=>zn,RFv:()=>es,kfC:()=>Js,mgq:()=>Br,YVA:()=>Nt,Kgp:()=>Zn,HH$:()=>ti,M_d:()=>Wt,rgh:()=>kt,Ra6:()=>Fe,KhR:()=>lt,BS5:()=>Yt,xhz:()=>$e,xOq:()=>Mt,a9j:()=>yt,bHk:()=>Kt,CgK:()=>At,cuY:()=>qt,kvE:()=>Ai,SBu:()=>Wi,AE_:()=>gr,ctO:()=>eo,OLH:()=>Rn,kky:()=>D,nSF:()=>ce,zHn:()=>_i,zwx:()=>_r,AeJ:()=>js,hLz:()=>Xe,D9g:()=>$r,wA:()=>rr,jhr:()=>or,GVs:()=>Yi,_zO:()=>Si,w6$:()=>yn,mhV:()=>Or,MOD:()=>ze,kwd:()=>xn,Lmr:()=>hr,xsS:()=>Zs,lLr:()=>Gs,Z$r:()=>Y,IXb:()=>pr,SGH:()=>ao,SMj:()=>Hi,L34:()=>Lo,exe:()=>qe,bnF:()=>se,MFA:()=>b,$uU:()=>Re,jyi:()=>qi,E03:()=>Fs,V6q:()=>cs,rg2:()=>Ir,DVW:()=>zs,nVo:()=>Xr,F6N:()=>Hn,xP7:()=>oi,Odq:()=>Ln,Zif:()=>De,ZGJ:()=>wn,MJk:()=>co,xvT:()=>Ws,PHM:()=>ws,dpR:()=>Xt,n9L:()=>jr,KwO:()=>Tn,B7y:()=>Gi,x7r:()=>Ao,wx7:()=>$i,Uvn:()=>Pt,OFT:()=>Fi,xzN:()=>Jr,M5Z:()=>S,ZrN:()=>W,OWs:()=>p,dF9:()=>Os,oZy:()=>si,rD2:()=>Pi,VHo:()=>Ui,ohE:()=>Ji,R$E:()=>mn,q3I:()=>fr,Pab:()=>P,uZ5:()=>y,McK:()=>E,F9c:()=>K,k0b:()=>bn,hnT:()=>j,RSJ:()=>jt,Mku:()=>wt,h90:()=>Je,rms:()=>me,ErP:()=>G,aVg:()=>Dt,lPc:()=>ht,Z8E:()=>Li,_N2:()=>Ys,yFn:()=>Po,lNv:()=>Vr,cu9:()=>Pn,MZQ:()=>Di,FUM:()=>er,BxR:()=>Ut,vdf:()=>z,iaL:()=>X,w6H:()=>O,Q4c:()=>Gr,Xxe:()=>w,Uxb:()=>V,Yr5:()=>R,Bhw:()=>m,yOA:()=>it});var $={};pe.r($),pe.d($,{ActivateEvent:()=>hs,CollisionEndEvent:()=>gi,CollisionPostSolveEvent:()=>ii,CollisionPreSolveEvent:()=>ei,CollisionStartEvent:()=>Ps,ContactEndEvent:()=>fe,ContactStartEvent:()=>pi,DeactivateEvent:()=>Qs,EnterTriggerEvent:()=>Ts,EnterViewPortEvent:()=>Xn,EventTypes:()=>M,ExitTriggerEvent:()=>qn,ExitViewPortEvent:()=>Ds,GameEvent:()=>tt,GameStartEvent:()=>bt,GameStopEvent:()=>Bt,GamepadAxisEvent:()=>ye,GamepadButtonEvent:()=>Ze,GamepadConnectEvent:()=>ee,GamepadDisconnectEvent:()=>Ue,HiddenEvent:()=>ji,InitializeEvent:()=>Xi,KillEvent:()=>rt,PostCollisionEvent:()=>ti,PostDebugDrawEvent:()=>Wt,PostDrawEvent:()=>kt,PostFrameEvent:()=>Fe,PostKillEvent:()=>lt,PostUpdateEvent:()=>Yt,PreCollisionEvent:()=>$e,PreDebugDrawEvent:()=>Mt,PreDrawEvent:()=>yt,PreFrameEvent:()=>Kt,PreKillEvent:()=>At,PreUpdateEvent:()=>qt,VisibleEvent:()=>Ui});var it={};pe.r(it),pe.d(it,{getAttributeComponentSize:()=>Yn,getAttributePointerType:()=>Kn,getGlTypeSizeBytes:()=>pn});var g={};pe.r(g),pe.d(g,{circle:()=>fi,line:()=>$n,point:()=>Eo,roundRect:()=>fn,vector:()=>Bo});var F={};pe.r(F),pe.d(F,{Axes:()=>os,Buttons:()=>sn,Gamepad:()=>en,Gamepads:()=>xs,KeyEvent:()=>tn,Keyboard:()=>ho,Keys:()=>rs,NativePointerButton:()=>Oi,PointerButton:()=>bi,PointerComponent:()=>es,PointerEvent:()=>rn,PointerEventReceiver:()=>on,PointerScope:()=>ys,PointerSystem:()=>Js,PointerType:()=>Ci,WheelDeltaMode:()=>Is,WheelEvent:()=>Vn});var W={};pe.r(W),pe.d(W,{ConsoleAppender:()=>H,DrawUtil:()=>g,EasingFunctions:()=>ne,LogLevel:()=>C,Logger:()=>v,Observable:()=>Ie,ScreenAppender:()=>Y,addItemToArray:()=>gt,contains:()=>Et,delay:()=>mt,fail:()=>at,getPosition:()=>ct,removeItemFromArray:()=>ot}),pe(4662),pe(8343);function Z(){if(typeof window>"u"&&(window={audioContext:function(){}}),typeof window<"u"&&!window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setInterval(a,1e3/60)}),typeof window<"u"&&!window.cancelAnimationFrame&&(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(){}),typeof window<"u"&&!window.AudioContext){if(window.webkitAudioContext){const t=window.webkitAudioContext.prototype.decodeAudioData;window.webkitAudioContext.prototype.decodeAudioData=function(e){return new Promise((i,n)=>{t.call(this,e,i,n)})}}window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext}typeof window<"u"&&!window.devicePixelRatio&&(window.devicePixelRatio=window.devicePixelRatio||1)}class q{static useCanvasGraphicsContext(){q.enable("use-canvas-context")}static freeze(){q._FROZEN=!0}static _reset(){q._FROZEN=!1,q._FLAGS={}}static enable(t){if(this._FROZEN)throw Error("Feature flags can only be enabled before Engine constructor time");q._FLAGS[t]=!0}static disable(t){if(this._FROZEN)throw Error("Feature flags can only be disabled before Engine constructor time");q._FLAGS[t]=!1}static isEnabled(t){return!!q._FLAGS[t]}static show(){return Object.keys(q._FLAGS)}}q._FROZEN=!1,q._FLAGS={};function E(a,t){return{type:a,value:t}}const T=4294967295;class D{constructor(t){this.seed=t,this._lowerMask=2147483647,this._upperMask=2147483648,this._w=32,this._n=624,this._m=397,this._a=2567483615,this._u=11,this._s=7,this._b=2636928640,this._t=15,this._c=4022730752,this._l=18,this._f=1812433253,this._mt=new Array(this._n),this._mt[0]=(t||Date.now())>>>0;for(let e=1;e<this._n;e++){const i=this._mt[e-1]^this._mt[e-1]>>>this._w-2;this._mt[e]=(this._f*((i&4294901760)>>>16)<<16)+this._f*(i&65535)+e>>>0}this._index=this._n}_twist(){const t=[0,this._a];let e=0,i=0;for(;i<this._n-this._m;i++)e=this._mt[i]&this._upperMask|this._mt[i+1]&this._lowerMask,this._mt[i]=this._mt[i+this._m]^e>>>1^t[e&1]&T;for(;i<this._n-1;i++)e=this._mt[i]&this._upperMask|this._mt[i+1]&this._lowerMask,this._mt[i]=this._mt[i+(this._m-this._n)]^e>>>1^t[e&1]&T;e=this._mt[this._n-1]&this._upperMask|this._mt[0]&this._lowerMask,this._mt[this._n-1]=this._mt[this._m-1]^e>>>1^t[e&1]&T,this._index=0}nextInt(){this._index>=this._n&&this._twist();let t=this._mt[this._index++];return t^=t>>>this._u,t^=t<<this._s&this._b,t^=t<<this._t&this._c,t^=t>>>this._l,t>>>0}next(){return this.nextInt()*(1/4294967296)}floating(t,e){return(e-t)*this.next()+t}integer(t,e){return Math.floor((e-t+1)*this.next()+t)}bool(t=.5){return this.next()<=t}pickOne(t){return t[this.integer(0,t.length-1)]}pickSet(t,e,i=!1){return i?this._pickSetWithDuplicates(t,e):this._pickSetWithoutDuplicates(t,e)}_pickSetWithoutDuplicates(t,e){if(e>t.length||e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 < n <= length");if(e===t.length)return t;const i=new Array(e);let n=0;const o=t.slice(0);for(;n<e;){const h=this.integer(0,o.length-1);i[n++]=o[h],o.splice(h,1)}return i}_pickSetWithDuplicates(t,e){if(e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT");const i=new Array(e);for(let n=0;n<e;n++)i[n]=this.pickOne(t);return i}shuffle(t){const e=t.slice(0);let i=null;for(let n=0;n<e.length-2;n++){const o=this.integer(n,e.length-1);i=e[n],e[n]=e[o],e[o]=i}return e}range(t,e,i){const n=new Array(t);for(let o=0;o<t;o++)n[o]=this.integer(e,i);return n}d4(){return this.integer(1,4)}d6(){return this.integer(1,6)}d8(){return this.integer(1,8)}d10(){return this.integer(1,10)}d12(){return this.integer(1,12)}d20(){return this.integer(1,20)}}const S=Math.PI*2;function K(a){return a>=0?a-Math.floor(a):a-Math.ceil(a)}function w(a){return a===0?0:a<0?-1:1}function y(a,t,e){return Math.min(Math.max(t,a),e)}function P(a){let t=a;if(a>S)for(;t>S;)t-=S;if(a<0)for(;t<0;)t+=S;return t}function V(a){return 180/Math.PI*a}function R(a){return a/180*Math.PI}const O=(a,t)=>Array.from(new Array(t-a+1),(e,i)=>i+a);function z(a,t,e=new D){return e?e.floating(a,t):a+Math.random()*(t-a)}function X(a,t,e=new D){return e?e.integer(a,t):Math.round(z(a,t))}class p{constructor(t,e){this._x=0,this._y=0,this._x=t,this._y=e}static get Zero(){return new p(0,0)}static get One(){return new p(1,1)}static get Half(){return new p(.5,.5)}static get Up(){return new p(0,-1)}static get Down(){return new p(0,1)}static get Left(){return new p(-1,0)}static get Right(){return new p(1,0)}static fromAngle(t){return new p(Math.cos(t),Math.sin(t))}static isValid(t){return!(t==null||isNaN(t.x)||isNaN(t.y)||t.x===1/0||t.y===1/0||t.x===-1/0||t.y===-1/0)}static distance(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}static min(t,e){return new p(Math.min(t.x,e.x),Math.min(t.y,e.y))}static max(t,e){return new p(Math.max(t.x,e.x),Math.max(t.y,e.y))}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}setTo(t,e){this.x=t,this.y=e}equals(t,e=.001){return Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e}distance(t){if(!t)return Math.sqrt(this.x*this.x+this.y*this.y);const e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)}squareDistance(t){t||(t=p.Zero);const e=this.x-t.x,i=this.y-t.y;return e*e+i*i}clampMagnitude(t){const e=this.size,i=y(e,0,t);return this.size=i,this}get size(){return this.distance()}set size(t){const e=this.normalize().scale(t);this.setTo(e.x,e.y)}normalize(){const t=this.distance();return t>0?new p(this.x/t,this.y/t):new p(0,1)}average(t){return this.add(t).scale(.5)}scale(t,e){const i=e||new p(0,0);return t instanceof p?(i.x=this.x*t.x,i.y=this.y*t.y):(i.x=this.x*t,i.y=this.y*t),i}add(t,e){return e?(e.x=this.x+t.x,e.y=this.y+t.y,e):new p(this.x+t.x,this.y+t.y)}sub(t){return new p(this.x-t.x,this.y-t.y)}addEqual(t){return this.setTo(this.x+t.x,this.y+t.y),this}subEqual(t){return this.setTo(this.x-t.x,this.y-t.y),this}scaleEqual(t){return this.setTo(this.x*t,this.y*t),this}dot(t){return this.x*t.x+this.y*t.y}cross(t){if(t instanceof p)return this.x*t.y-this.y*t.x;if(typeof t=="number")return new p(t*this.y,-t*this.x)}static cross(t,e){return new p(-t*e.y,t*e.x)}perpendicular(){return new p(this.y,-this.x)}normal(){return this.perpendicular().normalize()}negate(){return this.scale(-1)}toAngle(){return Math.atan2(this.y,this.x)}rotate(t,e){e||(e=new p(0,0));const i=Math.sin(t),n=Math.cos(t),o=n*(this.x-e.x)-i*(this.y-e.y)+e.x,h=i*(this.x-e.x)+n*(this.y-e.y)+e.y;return new p(o,h)}clone(t){const e=t??new p(0,0);return e.x=this.x,e.y=this.y,e}toString(t){return t?`(${this.x.toFixed(t)}, ${this.y.toFixed(t)})`:`(${this.x}, ${this.y})`}}function m(a,t){return new p(a,t)}var C;(function(a){a[a.Debug=0]="Debug",a[a.Info=1]="Info",a[a.Warn=2]="Warn",a[a.Error=3]="Error",a[a.Fatal=4]="Fatal"})(C||(C={}));class v{constructor(){if(this._appenders=[],this.defaultLevel=C.Info,v._INSTANCE)throw new Error("Logger is a singleton");return v._INSTANCE=this,v._INSTANCE.addAppender(new H),v._INSTANCE}static getInstance(){return v._INSTANCE==null&&(v._INSTANCE=new v),v._INSTANCE}addAppender(t){this._appenders.push(t)}clearAppenders(){this._appenders.length=0}_log(t,e){t==null&&(t=this.defaultLevel);const i=this._appenders.length;for(let n=0;n<i;n++)t>=this.defaultLevel&&this._appenders[n].log(t,e)}debug(...t){this._log(C.Debug,t)}info(...t){this._log(C.Info,t)}warn(...t){this._log(C.Warn,t)}error(...t){this._log(C.Error,t)}fatal(...t){this._log(C.Fatal,t)}}v._INSTANCE=null;class H{log(t,e){if(!console&&!console.log&&console.warn&&console.error)return;const i=[];i.unshift.apply(i,e),i.unshift("["+C[t]+"] : "),t<C.Warn?console.log.apply?console.log.apply(console,i):console.log(i.join(" ")):t<C.Error?console.warn.apply?console.warn.apply(console,i):console.warn(i.join(" ")):console.error.apply?console.error.apply(console,i):console.error(i.join(" "))}}class Y{constructor(t,e){this._messages=[],this._canvas=document.createElement("canvas"),this._canvas.width=t||window.innerWidth,this._canvas.height=e||window.innerHeight,this._canvas.style.position="absolute",this._ctx=this._canvas.getContext("2d"),document.body.appendChild(this._canvas)}log(t,e){const i=e.join(",");this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._messages.unshift("["+C[t]+"] : "+i);let n=10,o=1;for(let h=0;h<this._messages.length;h++)this._ctx.fillStyle="rgba(255,255,255,"+o.toFixed(2)+")",this._ctx.fillText(this._messages[h],200,n),n+=10,o=o>0?o-.05:0}}class I{constructor(t,e,i,n){this.r=t,this.g=e,this.b=i,this.a=n??1}static fromRGB(t,e,i,n){return new I(t,e,i,n)}static fromRGBString(t){const e=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/i;let i=null;if(i=t.match(e)){const n=parseInt(i[1],10),o=parseInt(i[2],10),h=parseInt(i[3],10);let d=1;return i[4]&&(d=parseFloat(i[4])),new I(n,o,h,d)}else throw new Error("Invalid rgb/a string: "+t)}static fromHex(t){const e=/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i;let i=null;if(i=t.match(e)){const n=parseInt(i[1],16),o=parseInt(i[2],16),h=parseInt(i[3],16);let d=1;return i[4]&&(d=parseInt(i[4],16)/255),new I(n,o,h,d)}else throw new Error("Invalid hex string: "+t)}static fromHSL(t,e,i,n=1){return new k(t,e,i,n).toRGBA()}lighten(t=.1){const e=k.fromRGBA(this.r,this.g,this.b,this.a);return e.l+=(1-e.l)*t,e.toRGBA()}darken(t=.1){const e=k.fromRGBA(this.r,this.g,this.b,this.a);return e.l-=e.l*t,e.toRGBA()}saturate(t=.1){const e=k.fromRGBA(this.r,this.g,this.b,this.a);return e.s+=e.s*t,e.toRGBA()}desaturate(t=.1){const e=k.fromRGBA(this.r,this.g,this.b,this.a);return e.s-=e.s*t,e.toRGBA()}multiply(t){const e=t.r/255*this.r/255*255,i=t.g/255*this.g/255*255,n=t.b/255*this.b/255*255,o=t.a*this.a;return new I(e,i,n,o)}screen(t){const e=t.invert(),i=t.invert();return e.multiply(i).invert()}invert(){return new I(255-this.r,255-this.g,255-this.b,1-this.a)}average(t){const e=(t.r+this.r)/2,i=(t.g+this.g)/2,n=(t.b+this.b)/2,o=(t.a+this.a)/2;return new I(e,i,n,o)}equal(t){return this.toString()===t.toString()}toString(t="rgb"){switch(t){case"rgb":return this.toRGBA();case"hsl":return this.toHSLA();case"hex":return this.toHex();default:throw new Error("Invalid Color format")}}_componentToHex(t){const e=t.toString(16);return e.length===1?"0"+e:e}toHex(){return"#"+this._componentToHex(this.r)+this._componentToHex(this.g)+this._componentToHex(this.b)}toRGBA(){const t=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return this.a!==void 0||this.a!==null?"rgba("+t+", "+String(this.a)+")":"rgb("+t+")"}toHSLA(){return k.fromRGBA(this.r,this.g,this.b,this.a).toString()}fillStyle(){return this.toString()}clone(){return new I(this.r,this.g,this.b,this.a)}static get Black(){return I.fromHex("#000000")}static get White(){return I.fromHex("#FFFFFF")}static get Gray(){return I.fromHex("#808080")}static get LightGray(){return I.fromHex("#D3D3D3")}static get DarkGray(){return I.fromHex("#A9A9A9")}static get Yellow(){return I.fromHex("#FFFF00")}static get Orange(){return I.fromHex("#FFA500")}static get Red(){return I.fromHex("#FF0000")}static get Vermilion(){return I.fromHex("#FF5B31")}static get Rose(){return I.fromHex("#FF007F")}static get Magenta(){return I.fromHex("#FF00FF")}static get Violet(){return I.fromHex("#7F00FF")}static get Blue(){return I.fromHex("#0000FF")}static get Azure(){return I.fromHex("#007FFF")}static get Cyan(){return I.fromHex("#00FFFF")}static get Viridian(){return I.fromHex("#59978F")}static get Green(){return I.fromHex("#00FF00")}static get Chartreuse(){return I.fromHex("#7FFF00")}static get Transparent(){return I.fromHex("#FFFFFF00")}static get ExcaliburBlue(){return I.fromHex("#176BAA")}}class k{constructor(t,e,i,n){this.h=t,this.s=e,this.l=i,this.a=n}static hue2rgb(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*(2/3-i)*6:t}static fromRGBA(t,e,i,n){t/=255,e/=255,i/=255;const o=Math.max(t,e,i),h=Math.min(t,e,i);let d,u;const x=(o+h)/2;if(o===h)d=u=0;else{const Q=o-h;switch(u=x>.5?Q/(2-o-h):Q/(o+h),o){case t:d=(e-i)/Q+(e<i?6:0);break;case e:d=(i-t)/Q+2;break;case i:d=(t-e)/Q+4;break}d/=6}return new k(d,u,x,n)}toRGBA(){let t,e,i;if(this.s===0)t=e=i=this.l;else{const n=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,o=2*this.l-n;t=k.hue2rgb(o,n,this.h+1/3),e=k.hue2rgb(o,n,this.h),i=k.hue2rgb(o,n,this.h-1/3)}return new I(t*255,e*255,i*255,this.a)}toString(){const t=this.h.toFixed(0),e=this.s.toFixed(0),i=this.l.toFixed(0),n=this.a.toFixed(0);return`hsla(${t}, ${e}, ${i}, ${n})`}}var b;(function(a){a.None="None",a.Top="Top",a.Bottom="Bottom",a.Left="Left",a.Right="Right"})(b||(b={})),function(a){function t(i){return i===a.Top?a.Bottom:i===a.Bottom?a.Top:i===a.Left?a.Right:i===a.Right?a.Left:a.None}a.getOpposite=t;function e(i){const n=[p.Left,p.Right,p.Up,p.Down],o=[a.Left,a.Right,a.Top,a.Bottom];let h=-Number.MAX_VALUE,d=-1;for(let u=0;u<n.length;u++)n[u].dot(i)>h&&(h=n[u].dot(i),d=u);return o[d]}a.fromDirection=e}(b||(b={}));class N{constructor(t=0,e=0,i=0,n=0){typeof t=="object"?(this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom):typeof t=="number"&&(this.left=t,this.top=e,this.right=i,this.bottom=n)}clone(){return new N(this.left,this.top,this.right,this.bottom)}static getSideFromIntersection(t){return t&&t?Math.abs(t.x)>Math.abs(t.y)?t.x<0?b.Right:b.Left:t.y<0?b.Bottom:b.Top:b.None}static fromPoints(t){let e=1/0,i=1/0,n=-1/0,o=-1/0;for(let h=0;h<t.length;h++)t[h].x<e&&(e=t[h].x),t[h].x>n&&(n=t[h].x),t[h].y<i&&(i=t[h].y),t[h].y>o&&(o=t[h].y);return new N(e,i,n,o)}static fromDimension(t,e,i=p.Half,n=p.Zero){return new N(-t*i.x+n.x,-e*i.y+n.y,t-t*i.x+n.x,e-e*i.y+n.y)}get width(){return this.right-this.left}get height(){return this.bottom-this.top}hasZeroDimensions(){return this.width===0||this.height===0}get center(){return new p((this.left+this.right)/2,(this.top+this.bottom)/2)}translate(t){return new N(this.left+t.x,this.top+t.y,this.right+t.x,this.bottom+t.y)}rotate(t,e=p.Zero){const i=this.getPoints().map(n=>n.rotate(t,e));return N.fromPoints(i)}scale(t,e=p.Zero){const i=this.translate(e);return new N(i.left*t.x,i.top*t.y,i.right*t.x,i.bottom*t.y)}transform(t){const e=t.data[0]*this.left,i=t.data[1]*this.left,n=t.data[0]*this.right,o=t.data[1]*this.right,h=t.data[2]*this.top,d=t.data[3]*this.top,u=t.data[2]*this.bottom,x=t.data[3]*this.bottom,Q=t.getPosition(),J=Math.min(e,n)+Math.min(h,u)+Q.x,et=Math.min(i,o)+Math.min(d,x)+Q.y,dt=Math.max(e,n)+Math.max(h,u)+Q.x,ft=Math.max(i,o)+Math.max(d,x)+Q.y;return new N({left:J,top:et,right:dt,bottom:ft})}getPerimeter(){const t=this.width,e=this.height;return 2*(t+e)}getPoints(){const t=[];return t.push(new p(this.left,this.top)),t.push(new p(this.right,this.top)),t.push(new p(this.right,this.bottom)),t.push(new p(this.left,this.bottom)),t}rayCast(t,e=1/0){let i=-1/0,n=1/0;const o=t.dir.x===0?Number.MAX_VALUE:1/t.dir.x,h=t.dir.y===0?Number.MAX_VALUE:1/t.dir.y,d=(this.left-t.pos.x)*o,u=(this.right-t.pos.x)*o;i=Math.min(d,u),n=Math.max(d,u);const x=(this.top-t.pos.y)*h,Q=(this.bottom-t.pos.y)*h;return i=Math.max(i,Math.min(x,Q)),n=Math.min(n,Math.max(x,Q)),n>=Math.max(0,i)&&i<e}rayCastTime(t,e=1/0){let i=-1/0,n=1/0;const o=t.dir.x===0?Number.MAX_VALUE:1/t.dir.x,h=t.dir.y===0?Number.MAX_VALUE:1/t.dir.y,d=(this.left-t.pos.x)*o,u=(this.right-t.pos.x)*o;i=Math.min(d,u),n=Math.max(d,u);const x=(this.top-t.pos.y)*h,Q=(this.bottom-t.pos.y)*h;return i=Math.max(i,Math.min(x,Q)),n=Math.min(n,Math.max(x,Q)),n>=Math.max(0,i)&&i<e?i:-1}contains(t){return t instanceof p?this.left<=t.x&&this.top<=t.y&&this.bottom>=t.y&&this.right>=t.x:t instanceof N?this.left<=t.left&&this.top<=t.top&&t.bottom<=this.bottom&&t.right<=this.right:!1}combine(t){return new N(Math.min(this.left,t.left),Math.min(this.top,t.top),Math.max(this.right,t.right),Math.max(this.bottom,t.bottom))}get dimensions(){return new p(this.width,this.height)}overlaps(t,e){const i=e||0;if(t.hasZeroDimensions())return this.contains(t);if(this.hasZeroDimensions())return t.contains(this);const n=this.combine(t);return n.width+i<t.width+this.width&&n.height+i<t.height+this.height}intersect(t){const e=this.combine(t);if(e.width<t.width+this.width&&e.height<t.height+this.height&&!e.dimensions.equals(t.dimensions)&&!e.dimensions.equals(this.dimensions)){let i=0;this.right>=t.left&&this.right<=t.right?i=t.left-this.right:i=t.right-this.left;let n=0;return this.top<=t.bottom&&this.top>=t.top?n=t.bottom-this.top:n=t.top-this.bottom,Math.abs(i)<Math.abs(n)?new p(i,0):new p(0,n)}else if(e.dimensions.equals(t.dimensions)||e.dimensions.equals(this.dimensions)){let i=0;this.width-t.width>=0?this.right-t.right<=t.left-this.left?i=t.left-this.right:i=t.right-this.left:t.right-this.right<=this.left-t.left?i=this.left-t.right:i=this.right-t.left;let n=0;return this.height-t.height>=0?this.bottom-t.bottom<=t.top-this.top?n=t.top-this.bottom:n=t.bottom-this.top:t.bottom-this.bottom<=this.top-t.top?n=this.top-t.bottom:n=this.bottom-t.top,Math.abs(i)<Math.abs(n)?new p(i,0):new p(0,n)}else return null}intersectWithSide(t){const e=this.intersect(t);return N.getSideFromIntersection(e)}draw(t,e=I.Yellow){t.debug.drawRect(this.left,this.top,this.width,this.height,{color:e})}}class _{constructor(){this._isCompleted=!1,this.promise=new Promise((t,e)=>{this._resolver=t,this._rejecter=e})}get isCompleted(){return this._isCompleted}resolve(t){this._isCompleted||(this._isCompleted=!0,this._resolver(t))}reject(t){this._isCompleted||(this._isCompleted=!0,this._rejecter(t))}}function ct(a){let t=0,e=0;const i=o=>{t+=o.offsetLeft,o.offsetParent&&i(o.offsetParent)},n=o=>{e+=o.offsetTop,o.offsetParent&&n(o.offsetParent)};return i(a),n(a),new p(t,e)}function gt(a,t){return t.indexOf(a)===-1?(t.push(a),!0):!1}function ot(a,t){let e=-1;return(e=t.indexOf(a))>-1?(t.splice(e,1),!0):!1}function Et(a,t){for(let e=0;e<a.length;e++)if(a[e]===t)return!0;return!1}function at(a){throw new Error(a)}function mt(a,t){var e;const i=new _;return((e=t==null?void 0:t.schedule.bind(t))!==null&&e!==void 0?e:setTimeout)(()=>{i.resolve()},a),i.promise}var A;(function(a){a[a.X=12]="X",a[a.Y=13]="Y"})(A||(A={}));class L{constructor(){this.data=new Float32Array(16),this._scaleX=1,this._scaleSignX=1,this._scaleY=1,this._scaleSignY=1}static ortho(t,e,i,n,o,h){const d=new L;return d.data[0]=2/(e-t),d.data[1]=0,d.data[2]=0,d.data[3]=0,d.data[4]=0,d.data[5]=2/(n-i),d.data[6]=0,d.data[7]=0,d.data[8]=0,d.data[9]=0,d.data[10]=-2/(h-o),d.data[11]=0,d.data[12]=-(e+t)/(e-t),d.data[13]=-(n+i)/(n-i),d.data[14]=-(h+o)/(h-o),d.data[15]=1,d}clone(t){const e=t||new L;return e.data[0]=this.data[0],e.data[1]=this.data[1],e.data[2]=this.data[2],e.data[3]=this.data[3],e.data[4]=this.data[4],e.data[5]=this.data[5],e.data[6]=this.data[6],e.data[7]=this.data[7],e.data[8]=this.data[8],e.data[9]=this.data[9],e.data[10]=this.data[10],e.data[11]=this.data[11],e.data[12]=this.data[12],e.data[13]=this.data[13],e.data[14]=this.data[14],e.data[15]=this.data[15],e}toDOMMatrix(){return new DOMMatrix([...this.data])}static fromFloat32Array(t){const e=new L;return e.data=t,e}static identity(){const t=new L;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}reset(){const t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}static translation(t,e){const i=L.identity();return i.data[12]=t,i.data[13]=e,i}static scale(t,e){const i=L.identity();return i.data[0]=t,i.data[5]=e,i.data[10]=1,i.data[15]=1,i}static rotation(t){const e=L.identity();return e.data[0]=Math.cos(t),e.data[4]=-Math.sin(t),e.data[1]=Math.sin(t),e.data[5]=Math.cos(t),e}multiply(t,e){if(t instanceof p){const i=e||new p(0,0),n=t,o=n.x*this.data[0]+n.y*this.data[4]+this.data[12],h=n.x*this.data[1]+n.y*this.data[5]+this.data[13];return i.x=o,i.y=h,i}else{const i=e||new L,n=t,o=this.data[0],h=this.data[1],d=this.data[2],u=this.data[3],x=this.data[4],Q=this.data[5],J=this.data[6],et=this.data[7],dt=this.data[8],ft=this.data[9],xt=this.data[10],It=this.data[11],ut=this.data[12],pt=this.data[13],Tt=this.data[14],Qt=this.data[15],zt=n.data[0],Lt=n.data[1],vt=n.data[2],te=n.data[3],oe=n.data[4],ae=n.data[5],$t=n.data[6],Ge=n.data[7],yi=n.data[8],xi=n.data[9],ln=n.data[10],hn=n.data[11],cn=n.data[12],dn=n.data[13],Vt=n.data[14],uo=n.data[15];i.data[0]=o*zt+x*Lt+dt*vt+ut*te,i.data[1]=h*zt+Q*Lt+ft*vt+pt*te,i.data[2]=d*zt+J*Lt+xt*vt+Tt*te,i.data[3]=u*zt+et*Lt+It*vt+Qt*te,i.data[4]=o*oe+x*ae+dt*$t+ut*Ge,i.data[5]=h*oe+Q*ae+ft*$t+pt*Ge,i.data[6]=d*oe+J*ae+xt*$t+Tt*Ge,i.data[7]=u*oe+et*ae+It*$t+Qt*Ge,i.data[8]=o*yi+x*xi+dt*ln+ut*hn,i.data[9]=h*yi+Q*xi+ft*ln+pt*hn,i.data[10]=d*yi+J*xi+xt*ln+Tt*hn,i.data[11]=u*yi+et*xi+It*ln+Qt*hn,i.data[12]=o*cn+x*dn+dt*Vt+ut*uo,i.data[13]=h*cn+Q*dn+ft*Vt+pt*uo,i.data[14]=d*cn+J*dn+xt*Vt+Tt*uo,i.data[15]=u*cn+et*dn+It*Vt+Qt*uo;const jo=this.getScale();return i._scaleSignX=w(jo.x)*w(i._scaleSignX),i._scaleSignY=w(jo.y)*w(i._scaleSignY),i}}translate(t,e){const i=this.data[0],n=this.data[1],o=this.data[2],h=this.data[3],d=this.data[4],u=this.data[5],x=this.data[6],Q=this.data[7],J=this.data[8],et=this.data[9],dt=this.data[10],ft=this.data[11],xt=this.data[12],It=this.data[13],ut=this.data[14],pt=this.data[15],Tt=0,Qt=1;return this.data[12]=i*t+d*e+J*Tt+xt*Qt,this.data[13]=n*t+u*e+et*Tt+It*Qt,this.data[14]=o*t+x*e+dt*Tt+ut*Qt,this.data[15]=h*t+Q*e+ft*Tt+pt*Qt,this}setPosition(t,e){this.data[12]=t,this.data[13]=e}getPosition(){return m(this.data[12],this.data[13])}rotate(t){const e=this.data[0],i=this.data[1],n=this.data[2],o=this.data[3],h=this.data[4],d=this.data[5],u=this.data[6],x=this.data[7],Q=Math.sin(t),J=Math.cos(t);return this.data[0]=J*e+Q*h,this.data[1]=J*i+Q*d,this.data[2]=J*n+Q*u,this.data[3]=J*o+Q*x,this.data[4]=J*h-Q*e,this.data[5]=J*d-Q*i,this.data[6]=J*u-Q*n,this.data[7]=J*x-Q*o,this}scale(t,e){const i=this.data[0],n=this.data[1],o=this.data[2],h=this.data[3],d=this.data[4],u=this.data[5],x=this.data[6],Q=this.data[7];return this.data[0]=i*t,this.data[1]=n*t,this.data[2]=o*t,this.data[3]=h*t,this.data[4]=d*e,this.data[5]=u*e,this.data[6]=x*e,this.data[7]=Q*e,this}setRotation(t){const e=this.getScale(),i=Math.sin(t),n=Math.cos(t);this.data[0]=n*e.x,this.data[1]=i*e.y,this.data[4]=-i*e.x,this.data[5]=n*e.y}getRotation(){const t=Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX());return P(t)}getScaleX(){const t=m(this.data[0],this.data[4]).size;return this._scaleSignX*t}getScaleY(){const t=m(this.data[1],this.data[5]).size;return this._scaleSignY*t}getScale(){return m(this.getScaleX(),this.getScaleY())}setScaleX(t){if(this._scaleX===t)return;this._scaleSignX=w(t);const e=m(this.data[0]*this._scaleSignX,this.data[4]*this._scaleSignX).normalize();this.data[0]=e.x*t,this.data[4]=e.y*t,this._scaleX=t}setScaleY(t){if(this._scaleY===t)return;this._scaleSignY=w(t);const e=m(this.data[1]*this._scaleSignY,this.data[5]*this._scaleSignY).normalize();this.data[1]=e.x*t,this.data[5]=e.y*t,this._scaleY=t}setScale(t){this.setScaleX(t.x),this.setScaleY(t.y)}getBasisDeterminant(){return this.data[0]*this.data[5]-this.data[1]*this.data[4]}getAffineInverse(t){const i=1/this.getBasisDeterminant(),n=this.data[0],o=this.data[4],h=this.data[1],d=this.data[5],u=t||L.identity();u.data[0]=d*i,u.data[1]=-h*i,u.data[4]=-o*i,u.data[5]=n*i;const x=this.data[12],Q=this.data[13];return u.data[12]=-(x*u.data[0]+Q*u.data[4]),u.data[13]=-(x*u.data[1]+Q*u.data[5]),u}isIdentity(){return this.data[0]===1&&this.data[1]===0&&this.data[2]===0&&this.data[3]===0&&this.data[4]===0&&this.data[5]===1&&this.data[6]===0&&this.data[7]===0&&this.data[8]===0&&this.data[9]===0&&this.data[10]===1&&this.data[11]===0&&this.data[12]===0&&this.data[13]===0&&this.data[14]===0&&this.data[15]===1}toString(){return`
[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]
[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]
[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]
[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]
`}}class nt{constructor(){this.data=new Float64Array(6),this._scale=new Float64Array([1,1]),this._scaleSignX=1,this._scaleSignY=1}toDOMMatrix(){return new DOMMatrix([...this.data])}static identity(){const t=new nt;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=1,t.data[4]=0,t.data[5]=0,t}static translation(t,e){const i=nt.identity();return i.data[4]=t,i.data[5]=e,i}static scale(t,e){const i=nt.identity();return i.data[0]=t,i.data[3]=e,i._scale[0]=t,i._scale[1]=e,i}static rotation(t){const e=nt.identity();return e.data[0]=Math.cos(t),e.data[1]=Math.sin(t),e.data[2]=-Math.sin(t),e.data[3]=Math.cos(t),e}setPosition(t,e){this.data[4]=t,this.data[5]=e}getPosition(){return m(this.data[4],this.data[5])}rotate(t){const e=this.data[0],i=this.data[1],n=this.data[2],o=this.data[3],h=Math.sin(t),d=Math.cos(t);return this.data[0]=d*e+h*n,this.data[1]=d*i+h*o,this.data[2]=d*n-h*e,this.data[3]=d*o-h*i,this}translate(t,e){const i=this.data[0],n=this.data[1],o=this.data[2],h=this.data[3],d=this.data[4],u=this.data[5];return this.data[4]=i*t+o*e+d,this.data[5]=n*t+h*e+u,this}scale(t,e){const i=this.data[0],n=this.data[1],o=this.data[2],h=this.data[3];return this.data[0]=i*t,this.data[1]=n*t,this.data[2]=o*e,this.data[3]=h*e,this._scale[0]=t,this._scale[1]=e,this}determinant(){return this.data[0]*this.data[3]-this.data[1]*this.data[2]}inverse(t){const i=1/this.determinant(),n=this.data[0],o=this.data[2],h=this.data[1],d=this.data[3],u=t||nt.identity();u.data[0]=d*i,u.data[1]=-h*i,u.data[2]=-o*i,u.data[3]=n*i;const x=this.data[4],Q=this.data[5];return u.data[4]=-(x*u.data[0]+Q*u.data[2]),u.data[5]=-(x*u.data[1]+Q*u.data[3]),u}multiply(t,e){if(t instanceof p){const i=e||new p(0,0),n=t,o=n.x*this.data[0]+n.y*this.data[2]+this.data[4],h=n.x*this.data[1]+n.y*this.data[3]+this.data[5];return i.x=o,i.y=h,i}else{const i=e||new nt,n=t,o=this.data[0],h=this.data[1],d=this.data[2],u=this.data[3],x=this.data[4],Q=this.data[5],J=n.data[0],et=n.data[1],dt=n.data[2],ft=n.data[3],xt=n.data[4],It=n.data[5];i.data[0]=o*J+d*et,i.data[1]=h*J+u*et,i.data[2]=o*dt+d*ft,i.data[3]=h*dt+u*ft,i.data[4]=o*xt+d*It+x,i.data[5]=h*xt+u*It+Q;const ut=this.getScale();return i._scaleSignX=w(ut.x)*w(i._scaleSignX),i._scaleSignY=w(ut.y)*w(i._scaleSignY),i}}to4x4(){const t=new L;return t.data[0]=this.data[0],t.data[1]=this.data[1],t.data[2]=0,t.data[3]=0,t.data[4]=this.data[2],t.data[5]=this.data[3],t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=this.data[4],t.data[13]=this.data[5],t.data[14]=0,t.data[15]=1,t}setRotation(t){const e=this.getScale(),i=Math.sin(t),n=Math.cos(t);this.data[0]=n*e.x,this.data[1]=i*e.y,this.data[2]=-i*e.x,this.data[3]=n*e.y}getRotation(){const t=Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX());return P(t)}getScaleX(){const t=m(this.data[0],this.data[2]).distance();return this._scaleSignX*t}getScaleY(){const t=m(this.data[1],this.data[3]).distance();return this._scaleSignY*t}getScale(){return m(this.getScaleX(),this.getScaleY())}setScaleX(t){if(t===this._scale[0])return;this._scaleSignX=w(t);const e=m(this.data[0]*this._scaleSignX,this.data[2]*this._scaleSignX).normalize();this.data[0]=e.x*t,this.data[2]=e.y*t,this._scale[0]=t}setScaleY(t){if(t===this._scale[1])return;this._scaleSignY=w(t);const e=m(this.data[1]*this._scaleSignY,this.data[3]*this._scaleSignY).normalize();this.data[1]=e.x*t,this.data[3]=e.y*t,this._scale[1]=t}setScale(t){this.setScaleX(t.x),this.setScaleY(t.y)}isIdentity(){return this.data[0]===1&&this.data[1]===0&&this.data[2]===0&&this.data[3]===1&&this.data[4]===0&&this.data[5]===0}reset(){const t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=1,t.data[4]=0,t.data[5]=0,t}clone(t){const e=t||new nt;return e.data[0]=this.data[0],e.data[1]=this.data[1],e.data[2]=this.data[2],e.data[3]=this.data[3],e.data[4]=this.data[4],e.data[5]=this.data[5],e}toString(){return`
[${this.data[0]} ${this.data[2]} ${this.data[4]}]
[${this.data[1]} ${this.data[3]} ${this.data[5]}]
[0 0 1]
`}}class B{constructor(){this._transforms=[],this._currentTransform=nt.identity()}save(){this._transforms.push(this._currentTransform),this._currentTransform=this._currentTransform.clone()}restore(){this._currentTransform=this._transforms.pop()}translate(t,e){return this._currentTransform.translate(t,e)}rotate(t){return this._currentTransform.rotate(t)}scale(t,e){return this._currentTransform.scale(t,e)}set current(t){this._currentTransform=t}get current(){return this._currentTransform}}class st{constructor(){this._states=[],this._currentState=this._getDefaultState()}_getDefaultState(){return{opacity:1,z:0,tint:I.White}}_cloneState(){return{opacity:this._currentState.opacity,z:this._currentState.z,tint:this._currentState.tint.clone()}}save(){this._states.push(this._currentState),this._currentState=this._cloneState()}restore(){this._currentState=this._states.pop()}get current(){return this._currentState}set current(t){this._currentState=t}}var M;(function(a){a.Kill="kill",a.PreKill="prekill",a.PostKill="postkill",a.PreDraw="predraw",a.PostDraw="postdraw",a.PreDebugDraw="predebugdraw",a.PostDebugDraw="postdebugdraw",a.PreUpdate="preupdate",a.PostUpdate="postupdate",a.PreFrame="preframe",a.PostFrame="postframe",a.PreCollision="precollision",a.CollisionStart="collisionstart",a.CollisionEnd="collisionend",a.PostCollision="postcollision",a.Initialize="initialize",a.Activate="activate",a.Deactivate="deactivate",a.ExitViewport="exitviewport",a.EnterViewport="enterviewport",a.ExitTrigger="exit",a.EnterTrigger="enter",a.Connect="connect",a.Disconnect="disconnect",a.Button="button",a.Axis="axis",a.Visible="visible",a.Hidden="hidden",a.Start="start",a.Stop="stop",a.PointerUp="pointerup",a.PointerDown="pointerdown",a.PointerMove="pointermove",a.PointerEnter="pointerenter",a.PointerLeave="pointerleave",a.PointerCancel="pointercancel",a.PointerWheel="pointerwheel",a.Up="up",a.Down="down",a.Move="move",a.Enter="enter",a.Leave="leave",a.Cancel="cancel",a.Wheel="wheel",a.Press="press",a.Release="release",a.Hold="hold",a.PointerDragStart="pointerdragstart",a.PointerDragEnd="pointerdragend",a.PointerDragEnter="pointerdragenter",a.PointerDragLeave="pointerdragleave",a.PointerDragMove="pointerdragmove"})(M||(M={}));class tt{constructor(){this._bubbles=!0}get bubbles(){return this._bubbles}set bubbles(t){this._bubbles=t}stopPropagation(){this.bubbles=!1}}class rt extends tt{constructor(t){super(),this.target=t}}class At extends tt{constructor(t){super(),this.target=t}}class lt extends tt{constructor(t){super(),this.target=t}}class bt extends tt{constructor(t){super(),this.target=t}}class Bt extends tt{constructor(t){super(),this.target=t}}class yt extends tt{constructor(t,e,i){super(),this.ctx=t,this.delta=e,this.target=i}}class kt extends tt{constructor(t,e,i){super(),this.ctx=t,this.delta=e,this.target=i}}class Mt extends tt{constructor(t,e){super(),this.ctx=t,this.target=e}}class Wt extends tt{constructor(t,e){super(),this.ctx=t,this.target=e}}class qt extends tt{constructor(t,e,i){super(),this.engine=t,this.delta=e,this.target=i}}class Yt extends tt{constructor(t,e,i){super(),this.engine=t,this.delta=e,this.target=i}}class Kt extends tt{constructor(t,e){super(),this.engine=t,this.prevStats=e,this.target=t}}class Fe extends tt{constructor(t,e){super(),this.engine=t,this.stats=e,this.target=t}}class ee extends tt{constructor(t,e){super(),this.index=t,this.gamepad=e,this.target=e}}class Ue extends tt{constructor(t,e){super(),this.index=t,this.gamepad=e,this.target=e}}class Ze extends tt{constructor(t,e,i){super(),this.button=t,this.value=e,this.target=i}}class ye extends tt{constructor(t,e,i){super(),this.axis=t,this.value=e,this.target=i}}class Ui extends tt{constructor(t){super(),this.target=t}}class ji extends tt{constructor(t){super(),this.target=t}}class $e extends tt{constructor(t,e,i,n){super(),this.other=e,this.side=i,this.intersection=n,this.target=t}}class ti extends tt{constructor(t,e,i,n){super(),this.other=e,this.side=i,this.intersection=n,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class pi{constructor(t,e,i){this.target=t,this.other=e,this.contact=i}}class fe{constructor(t,e){this.target=t,this.other=e}}class ei{constructor(t,e,i,n,o){this.target=t,this.other=e,this.side=i,this.intersection=n,this.contact=o}}class ii{constructor(t,e,i,n,o){this.target=t,this.other=e,this.side=i,this.intersection=n,this.contact=o}}class Ps extends tt{constructor(t,e,i){super(),this.other=e,this.contact=i,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class gi extends tt{constructor(t,e){super(),this.other=e,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class Xi extends tt{constructor(t,e){super(),this.engine=t,this.target=e}}class hs extends tt{constructor(t,e){super(),this.context=t,this.target=e}}class Qs extends tt{constructor(t,e){super(),this.context=t,this.target=e}}class Ds extends tt{constructor(t){super(),this.target=t}}class Xn extends tt{constructor(t){super(),this.target=t}}class Ts extends tt{constructor(t,e){super(),this.target=t,this.actor=e}}class qn extends tt{constructor(t,e){super(),this.target=t,this.actor=e}}class Bi{constructor(){this._handlers={},this._wiredEventDispatchers=[],this._deferedHandlerRemovals=[]}clear(){this._handlers={},this._wiredEventDispatchers=[]}_processDeferredHandlerRemovals(){for(const t of this._deferedHandlerRemovals)this._removeHandler(t.name,t.handler);this._deferedHandlerRemovals.length=0}emit(t,e){if(this._processDeferredHandlerRemovals(),!t)return;t=t.toLowerCase(),e||(e=new tt);let i,n;if(this._handlers[t])for(i=0,n=this._handlers[t].length,i;i<n;i++)this._handlers[t][i](e);for(i=0,n=this._wiredEventDispatchers.length,i;i<n;i++)this._wiredEventDispatchers[i].emit(t,e)}on(t,e){this._processDeferredHandlerRemovals(),t=t.toLowerCase(),this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(e)}off(t,e){this._deferedHandlerRemovals.push({name:t,handler:e})}_removeHandler(t,e){t=t.toLowerCase();const i=this._handlers[t];if(i)if(!e)this._handlers[t].length=0;else{const n=i.indexOf(e);n>-1&&this._handlers[t].splice(n,1)}}once(t,e){this._processDeferredHandlerRemovals();const i=n=>{const o=n||new tt;this.off(t,i),e(o)};this.on(t,i)}wire(t){t._wiredEventDispatchers.push(this)}unwire(t){const e=t._wiredEventDispatchers.indexOf(this);e>-1&&t._wiredEventDispatchers.splice(e,1)}}class Si{constructor(t,e,i=!0){this.path=t,this.responseType=e,this.bustCache=i,this.data=null,this.logger=v.getInstance(),this.events=new Bi}isLoaded(){return this.data!==null}_cacheBust(t){return/\?\w*=\w*/.test(t)?t+="&__="+Date.now():t+="?__="+Date.now(),t}load(){return new Promise((t,e)=>{if(this.data!==null){this.logger.debug("Already have data for resource",this.path),this.events.emit("complete",this.data),t(this.data);return}const i=new XMLHttpRequest;i.open("GET",this.bustCache?this._cacheBust(this.path):this.path,!0),i.responseType=this.responseType,i.addEventListener("loadstart",n=>this.events.emit("loadstart",n)),i.addEventListener("progress",n=>this.events.emit("progress",n)),i.addEventListener("error",n=>this.events.emit("error",n)),i.addEventListener("load",n=>this.events.emit("load",n)),i.addEventListener("load",()=>{if(i.status!==0&&i.status!==200){this.logger.error("Failed to load resource ",this.path," server responded with error code",i.status),this.events.emit("error",i.response),e(new Error(i.statusText));return}this.data=i.response,this.events.emit("complete",this.data),this.logger.debug("Completed loading resource",this.path),t(this.data)}),i.send()})}}function ki(a,t){return a&&(a.__isProxy===void 0?new Proxy(a,{set:(e,i,n)=>(e[i]!==n&&(e[i]=n,typeof i=="string"&&i[0]!=="_"&&t(e)),!0),get:(e,i)=>i!=="__isProxy"?e[i]:!0}):a)}function Pr(a,t){return a&&(a.__isProxy===void 0?new Proxy(a,{set:(e,i,n)=>(e[i]=n,typeof i=="string"&&i[0]!=="_"&&t(e),!0),get:(e,i)=>i!=="__isProxy"?e[i]:!0}):a)}class Be{constructor(t){var e,i,n,o,h,d;this.id=Be._ID++,this.transform=nt.identity(),this.tint=null,this._transformStale=!0,this.showDebug=!1,this._flipHorizontal=!1,this._flipVertical=!1,this._rotation=0,this.opacity=1,this._scale=p.One,this._origin=null,this._width=0,this._height=0,t&&(this.origin=(e=t.origin)!==null&&e!==void 0?e:this.origin,this.flipHorizontal=(i=t.flipHorizontal)!==null&&i!==void 0?i:this.flipHorizontal,this.flipVertical=(n=t.flipVertical)!==null&&n!==void 0?n:this.flipVertical,this.rotation=(o=t.rotation)!==null&&o!==void 0?o:this.rotation,this.opacity=(h=t.opacity)!==null&&h!==void 0?h:this.opacity,this.scale=(d=t.scale)!==null&&d!==void 0?d:this.scale)}isStale(){return this._transformStale}get flipHorizontal(){return this._flipHorizontal}set flipHorizontal(t){this._flipHorizontal=t,this._transformStale=!0}get flipVertical(){return this._flipVertical}set flipVertical(t){this._flipVertical=t,this._transformStale=!0}get rotation(){return this._rotation}set rotation(t){this._rotation=t,this._transformStale=!0}get scale(){return this._scale}set scale(t){this._scale=ki(t,()=>{this._transformStale=!0}),this._transformStale=!0}get origin(){return this._origin}set origin(t){this._origin=ki(t,()=>{this._transformStale=!0}),this._transformStale=!0}cloneGraphicOptions(){return{origin:this.origin?this.origin.clone():null,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,rotation:this.rotation,opacity:this.opacity,scale:this.scale?this.scale.clone():null}}get width(){return Math.abs(this._width*this.scale.x)}get height(){return Math.abs(this._height*this.scale.y)}set width(t){this._width=t,this._transformStale=!0}set height(t){this._height=t,this._transformStale=!0}get localBounds(){return N.fromDimension(this.width,this.height,p.Zero)}draw(t,e,i){this._preDraw(t,e,i),this._drawImage(t,0,0),this._postDraw(t)}_preDraw(t,e,i){t.save(),t.translate(e,i),this._transformStale&&(this.transform.reset(),this.transform.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this._rotate(this.transform),this._flip(this.transform),this._transformStale=!1),t.multiply(this.transform),t.opacity=t.opacity*this.opacity,this.tint&&(t.tint=this.tint)}_rotate(t){var e;const i=this.scale.x>0?1:-1,n=this.scale.y>0?1:-1,o=(e=this.origin)!==null&&e!==void 0?e:m(this.width/2,this.height/2);t.translate(o.x,o.y),t.rotate(this.rotation),t.scale(i,n),t.translate(-o.x,-o.y)}_flip(t){this.flipHorizontal&&(t.translate(this.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,this.height/this.scale.y),t.scale(1,-1))}_postDraw(t){this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}Be._ID=0;class qi extends Be{constructor(t){var e,i;super(t),this._logger=v.getInstance(),this._dirty=!0,this._logNotLoadedWarning=!1,this.image=t.image;const{width:n,height:o}=t;this.sourceView=(e=t.sourceView)!==null&&e!==void 0?e:{x:0,y:0,width:n??0,height:o??0},this.destSize=(i=t.destSize)!==null&&i!==void 0?i:{width:n??0,height:o??0},this._updateSpriteDimensions(),this.image.ready.then(()=>{this._updateSpriteDimensions()})}static from(t){return new qi({image:t})}get width(){return Math.abs(this.destSize.width*this.scale.x)}get height(){return Math.abs(this.destSize.height*this.scale.y)}set width(t){t/=Math.abs(this.scale.x),this.destSize.width=t,super.width=Math.ceil(this.destSize.width)}set height(t){t/=Math.abs(this.scale.y),this.destSize.height=t,super.height=Math.ceil(this.destSize.height)}_updateSpriteDimensions(){var t,e,i,n,o,h;const{width:d,height:u}=this.image;this.sourceView.width=((t=this.sourceView)===null||t===void 0?void 0:t.width)||d,this.sourceView.height=((e=this.sourceView)===null||e===void 0?void 0:e.height)||u,this.destSize.width=((i=this.destSize)===null||i===void 0?void 0:i.width)||((n=this.sourceView)===null||n===void 0?void 0:n.width)||d,this.destSize.height=((o=this.destSize)===null||o===void 0?void 0:o.height)||((h=this.sourceView)===null||h===void 0?void 0:h.height)||u,this.width=Math.ceil(this.destSize.width)*this.scale.x,this.height=Math.ceil(this.destSize.height)*this.scale.y}_preDraw(t,e,i){this.image.isLoaded()&&this._dirty&&(this._dirty=!1,this._updateSpriteDimensions()),super._preDraw(t,e,i)}_drawImage(t,e,i){this.image.isLoaded()?t.drawImage(this.image.image,this.sourceView.x,this.sourceView.y,this.sourceView.width,this.sourceView.height,e,i,this.destSize.width,this.destSize.height):(this._logNotLoadedWarning||this._logger.warn(`ImageSource ${this.image.path} is not yet loaded and won't be drawn. Please call .load() or include in a Loader.

Read https://excaliburjs.com/docs/imagesource for more information.`),this._logNotLoadedWarning=!0)}clone(){return new qi({image:this.image,sourceView:{...this.sourceView},destSize:{...this.destSize},...this.cloneGraphicOptions()})}}var xe;(function(a){a.Pixel="Pixel",a.Blended="Blended"})(xe||(xe={}));class Xt{static register(t){Xt._GL=t,Xt._MAX_TEXTURE_SIZE=t.getParameter(t.MAX_TEXTURE_SIZE)}static get(t){return Xt._TEXTURE_MAP.get(t)}static has(t){return Xt._TEXTURE_MAP.has(t)}static load(t,e,i=!1){const n=Xt._GL;if(!n)return null;let o=null;if(Xt.has(t)&&(o=Xt.get(t)),o)return i&&(n.bindTexture(n.TEXTURE_2D,o),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),o;o=n.createTexture(),Xt.checkImageSizeSupportedAndLog(t),n.bindTexture(n.TEXTURE_2D,o),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);const h=e??Xt.filtering;return n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,h===xe.Pixel?n.NEAREST:n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,h===xe.Pixel?n.NEAREST:n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),Xt._TEXTURE_MAP.set(t,o),o}static delete(t){const e=Xt._GL;if(!e)return null;let i=null;Xt.has(t)&&(i=Xt.get(t),e.deleteTexture(i))}static checkImageSizeSupportedAndLog(t){var e;const i=(e=t.dataset.originalSrc)!==null&&e!==void 0?e:"internal canvas bitmap";return t.width>Xt._MAX_TEXTURE_SIZE||t.height>Xt._MAX_TEXTURE_SIZE?(Xt._LOGGER.error(`The image [${i}] provided to Excalibur is too large for the device's maximum texture size of (${Xt._MAX_TEXTURE_SIZE}x${Xt._MAX_TEXTURE_SIZE}) please resize to an image for excalibur to render properly.

Images will likely render as black rectangles.

Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!1):((t.width>4096||t.height>4096)&&Xt._LOGGER.warn(`The image [${i}] provided to excalibur is too large may not work on all mobile devices, it is recommended you resize images to a maximum (4096x4096).

Images will likely render as black rectangles on some mobile platforms.

Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!0)}}Xt._LOGGER=v.getInstance(),Xt.filtering=xe.Blended,Xt._TEXTURE_MAP=new Map,Xt._MAX_TEXTURE_SIZE=0;class un{constructor(t,e=!1,i){this.path=t,this._logger=v.getInstance(),this.data=new Image,this._readyFuture=new _,this.ready=this._readyFuture.promise,this._resource=new Si(t,"blob",e),this._filtering=i,(t.endsWith(".svg")||t.endsWith(".gif"))&&this._logger.warn(`Image type is not fully supported, you may have mixed results ${t}. Fully supported: jpg, bmp, and png`)}get width(){return this.image.naturalWidth}get height(){return this.image.naturalHeight}isLoaded(){return this._src||(this._src=this.data.src),!!this._src}get image(){return this.data}async load(){if(this.isLoaded())return this.data;try{let t;if(this.path.includes("data:image/"))t=this.path;else{const n=await this._resource.load();t=URL.createObjectURL(n)}const e=new Image,i=new _;e.onload=()=>i.resolve(),e.src=t,e.setAttribute("data-original-src",this.path),await i.promise,this.data=e}catch(t){throw`Error loading ImageSource from path '${this.path}' with error [${t.message}]`}return Xt.load(this.data,this._filtering),this._readyFuture.resolve(this.data),this.data}toSprite(){return qi.from(this)}unload(){this.data=new Image}}class cs{constructor(t){this._logger=v.getInstance(),this.sprites=[];const{sprites:e,rows:i,columns:n}=t;this.sprites=e,this.rows=i??1,this.columns=n??this.sprites.length}getSprite(t,e){if(t>=this.columns||t<0)return this._logger.warn(`No sprite exists in the SpriteSheet at (${t}, ${e}), x: ${t} should be between 0 and ${this.columns-1}`),null;if(e>=this.rows||e<0)return this._logger.warn(`No sprite exists in the SpriteSheet at (${t}, ${e}), y: ${e} should be between 0 and ${this.rows-1}`),null;const i=t+e*this.columns;return this.sprites[i]}static fromImageSourceWithSourceViews(t){const e=t.sourceViews.map(i=>new qi({image:t.image,sourceView:i}));return new cs({sprites:e})}static fromImageSource(t){var e;const i=[];t.spacing=(e=t.spacing)!==null&&e!==void 0?e:{};const{image:n,grid:{rows:o,columns:h,spriteWidth:d,spriteHeight:u},spacing:{originOffset:x,margin:Q}}=t,J={x:0,y:0,...x},et={x:0,y:0,...Q};for(let dt=0;dt<h;dt++)for(let ft=0;ft<o;ft++)i[dt+ft*h]=new qi({image:n,sourceView:{x:dt*d+et.x*dt+J.x,y:ft*u+et.y*ft+J.y,width:d,height:u},destSize:{height:u,width:d}});return new cs({sprites:i,rows:o,columns:h})}}class Fs extends Be{constructor(t){super(t),this._text="",this.alphabet="",this.shadow=null,this.caseInsensitive=!1,this.spacing=0,this._logger=v.getInstance(),this._alreadyWarnedAlphabet=!1,this._alreadyWarnedSpriteSheet=!1;const{alphabet:e,spriteSheet:i,caseInsensitive:n,spacing:o,shadow:h}=t;this.alphabet=e,this.spriteSheet=i,this.caseInsensitive=n??this.caseInsensitive,this.spacing=o??this.spacing,this.shadow=h??this.shadow}_getCharacterSprites(t){const e=[],i=this.caseInsensitive?t.toLocaleLowerCase():t,n=this.caseInsensitive?this.alphabet.toLocaleLowerCase():this.alphabet;for(let o=0;o<i.length;o++){const h=i[o];let d=n.indexOf(h);d===-1&&(d=0,this._alreadyWarnedAlphabet||(this._logger.warn(`SpriteFont - Cannot find letter '${h}' in configured alphabet '${n}'.`),this._logger.warn("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."),this._alreadyWarnedAlphabet=!0));const u=this.spriteSheet.sprites[d];u?e.push(u):this._alreadyWarnedSpriteSheet||(this._logger.warn(`SpriteFont - Cannot find sprite for '${h}' at index '${d}' in configured SpriteSheet`),this._logger.warn("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."),this._alreadyWarnedSpriteSheet=!0)}return e}measureText(t){const e=t.split(`
`),i=e.reduce((d,u)=>d.length>u.length?d:u),n=this._getCharacterSprites(i);let o=0,h=0;for(const d of n)o+=d.width+this.spacing,h=Math.max(h,d.height);return N.fromDimension(o,h*e.length,p.Zero)}_drawImage(t,e,i){let n=0,o=0,h=0;const d=this._text.split(`
`);for(const u of d){for(const x of this._getCharacterSprites(u))x.draw(t,e+n,i+o),n+=x.width+this.spacing,h=Math.max(h,x.height);n=0,o+=h}}render(t,e,i,n,o){this._text=e;const h=this.measureText(e);this.width=h.width,this.height=h.height,this.shadow&&(t.save(),t.translate(this.shadow.offset.x,this.shadow.offset.y),this.draw(t,n,o),t.restore()),this.draw(t,n,o)}clone(){return new Fs({alphabet:this.alphabet,spriteSheet:this.spriteSheet,spacing:this.spacing})}}const go="data:image/png;base64,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";class Wn{constructor(){this.fontSheet=go,this.size=16,this.load()}load(){return this._imageSource=new un(this.fontSheet),this._imageSource.load().then(()=>{this._spriteSheet=cs.fromImageSource({image:this._imageSource,grid:{rows:3,columns:16,spriteWidth:16,spriteHeight:16}}),this._spriteFont=new Fs({alphabet:`0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!'&."?-()+ `,caseInsensitive:!0,spriteSheet:this._spriteSheet,spacing:-6})})}write(t,e,i){this._imageSource.isLoaded()&&this._spriteFont.render(t,e,null,i.x,i.y)}}class Qr{constructor(t,e){this._gl=t,this._texture=e}use(){const t=this._gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this._texture)}disable(){const t=this._gl;t.bindTexture(t.TEXTURE_2D,null)}}class hi{constructor(t){this.width=t.width,this.height=t.height,this._gl=t.gl,this._setupFramebuffer()}setResolution(t,e){const i=this._gl;this.width=t,this.height=e,i.bindTexture(i.TEXTURE_2D,this._frameTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.width,this.height,0,i.RGBA,i.UNSIGNED_BYTE,null)}get frameBuffer(){return this._frameBuffer}get frameTexture(){return this._frameTexture}_setupFramebuffer(){const t=this._gl;this._frameTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._frameTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const e=t.COLOR_ATTACHMENT0;this._frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,e,t.TEXTURE_2D,this._frameTexture,0),this.disable()}toRenderSource(){return new Qr(this._gl,this._frameTexture)}use(){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.viewport(0,0,this.width,this.height)}disable(){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null)}}class Me{static clear(){Me._GL=null}static register(t){Me._GL=t}static get gl(){if(!Me._GL)throw Error("Attempted gl access before init");return Me._GL}}const fo=`#version 300 es\r
in vec2 a_position;\r
in vec4 a_color;\r
\r
out lowp vec4 v_color;\r
\r
uniform mat4 u_matrix;\r
\r
void main() {\r
   // Set the vertex position using the ortho transform matrix\r
   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
\r
   // Passthrough the color\r
   v_color = a_color;\r
}`,_o=`#version 300 es\r
precision mediump float;\r
\r
// Color\r
in lowp vec4 v_color;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  fragColor = v_color;\r
}`;function pn(a,t){switch(t){case a.FLOAT:return 4;case a.SHORT:return 2;case a.UNSIGNED_SHORT:return 2;case a.BYTE:return 1;case a.UNSIGNED_BYTE:return 1;default:return 1}}function Yn(a,t){switch(t){case a.LOW_FLOAT:case a.HIGH_FLOAT:case a.FLOAT:return 1;case a.FLOAT_VEC2:return 2;case a.FLOAT_VEC3:return 3;case a.FLOAT_VEC4:return 4;case a.BYTE:return 1;case a.UNSIGNED_BYTE:return 1;case a.UNSIGNED_SHORT:case a.SHORT:return 1;default:return 1}}function Kn(a,t){switch(t){case a.LOW_FLOAT:case a.HIGH_FLOAT:case a.FLOAT:case a.FLOAT_VEC2:case a.FLOAT_VEC3:case a.FLOAT_VEC4:return a.FLOAT;case a.BYTE:return a.BYTE;case a.UNSIGNED_BYTE:return a.UNSIGNED_BYTE;case a.SHORT:return a.SHORT;case a.UNSIGNED_SHORT:return a.UNSIGNED_SHORT;default:return a.FLOAT}}class qe{constructor(t){this._gl=Me.gl,this.uniforms={},this.attributes={},this._compiled=!1;const{vertexSource:e,fragmentSource:i}=t;this.vertexSource=e,this.fragmentSource=i}get compiled(){return this._compiled}use(){this._gl.useProgram(this.program),qe._ACTIVE_SHADER_INSTANCE=this}isCurrentlyBound(){return qe._ACTIVE_SHADER_INSTANCE===this}compile(){const t=this._gl,e=this._compileShader(t,this.vertexSource,t.VERTEX_SHADER),i=this._compileShader(t,this.fragmentSource,t.FRAGMENT_SHADER);this.program=this._createProgram(t,e,i);const n=this.getAttributes();for(const h of n)this.attributes[h.name]=h;const o=this.getUniforms();for(const h of o)this.uniforms[h.name]=h;return this._compiled=!0,this.program}getUniforms(){const t=this._gl,e=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),i=[];for(let n=0;n<e;n++){const o=t.getActiveUniform(this.program,n),h=t.getUniformLocation(this.program,o.name);i.push({name:o.name,glType:o.type,location:h})}return i}getAttributes(){const t=this._gl,e=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),i=[];for(let n=0;n<e;n++){const o=t.getActiveAttrib(this.program,n),h=t.getAttribLocation(this.program,o.name);i.push({name:o.name,glType:Kn(t,o.type),size:Yn(t,o.type),location:h,normalized:!1})}return i}setTexture(t,e){const i=this._gl;i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,e)}setUniformInt(t,e){this.setUniform("uniform1i",t,~~e)}setUniformIntArray(t,e){this.setUniform("uniform1iv",t,e)}setUniformBoolean(t,e){this.setUniform("uniform1i",t,e?1:0)}setUniformFloat(t,e){this.setUniform("uniform1f",t,e)}setUniformFloatArray(t,e){this.setUniform("uniform1fv",t,e)}setUniformFloatVector(t,e){this.setUniform("uniform2f",t,e.x,e.y)}setUniformMatrix(t,e){this.setUniform("uniformMatrix4fv",t,!1,e.data)}setUniform(t,e,...i){if(!this._compiled)throw Error(`Must compile shader before setting a uniform ${t}:${e}`);if(!this.isCurrentlyBound())throw Error("Currently accessed shader instance is not the current active shader in WebGL, must call `shader.use()` before setting uniforms");const o=this._gl.getUniformLocation(this.program,e);if(o){const h=[o,...i];this._gl[t].apply(this._gl,h)}else throw Error(`Uniform ${t}:${e} doesn't exist or is not used in the shader source code, unused uniforms are optimized away by most browsers`)}_createProgram(t,e,i){const n=t.createProgram();if(n===null)throw Error("Could not create graphics shader program");if(t.attachShader(n,e),t.attachShader(n,i),t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS))throw Error(`Could not link the program: [${t.getProgramInfoLog(n)}]`);return n}_compileShader(t,e,i){const n=t.VERTEX_SHADER===i?"vertex":"fragment",o=t.createShader(i);if(o===null)throw Error(`Could not build shader: [${e}]`);if(t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS)){const d=t.getShaderInfoLog(o);throw Error(`Could not compile ${n} shader:

${d}${this._processSourceForError(e,d)}`)}return o}_processSourceForError(t,e){const i=t.split(`
`),n=e.search(/\d:\d/),o=e.indexOf(" ",n),[h,d]=e.slice(n,o).split(":").map(u=>Number(u));for(let u=0;u<i.length;u++)i[u]=`${u+1}: ${i[u]}${d===u+1?" <----- ERROR!":""}`;return`

Source:
`+i.join(`
`)}}qe._ACTIVE_SHADER_INSTANCE=null;class si{constructor(t){this._gl=Me.gl,this.type="dynamic";const{size:e,type:i,data:n}=t;if(this.buffer=this._gl.createBuffer(),!n&&!e)throw Error("Must either provide data or a size to the VertexBuffer");n?this.bufferData=n:this.bufferData=new Float32Array(e),this.type=i??this.type;const o=this._gl;o.bindBuffer(o.ARRAY_BUFFER,this.buffer),o.bufferData(o.ARRAY_BUFFER,this.bufferData,this.type==="static"?o.STATIC_DRAW:o.DYNAMIC_DRAW)}bind(){const t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,this.buffer)}upload(t){const e=this._gl;e.bindBuffer(e.ARRAY_BUFFER,this.buffer),t?e.bufferSubData(e.ARRAY_BUFFER,0,this.bufferData,0,t):e.bufferData(e.ARRAY_BUFFER,this.bufferData,this.type==="static"?e.STATIC_DRAW:e.DYNAMIC_DRAW)}}class Pi{constructor(t){this._gl=Me.gl,this._logger=v.getInstance(),this._layout=[],this._attributes=[],this._vertexTotalSizeBytes=0;const{shader:e,vertexBuffer:i,attributes:n}=t;this._vertexBuffer=i,this._attributes=n,this._shader=e,this.initialize()}get vertexBuffer(){return this._vertexBuffer}get attributes(){return this._attributes}get totalVertexSizeBytes(){return this._vertexTotalSizeBytes}initialize(){if(!this._shader.compiled)throw Error("Shader not compiled, shader must be compiled before defining a vertex layout");this._layout.length=0;const t=this._shader.attributes;for(const i of this._attributes){const n=t[i[0]];if(!n)throw Error(`The attribute named: ${i[0]} size ${i[1]} not found in the shader source code:
 ${this._shader.vertexSource}`);if(n.size!==i[1])throw Error(`VertexLayout size definition for attribute: [${i[0]}, ${i[1]}], doesnt match shader source size ${n.size}:
 ${this._shader.vertexSource}`);this._layout.push(n)}let e=0;for(const i of this._layout){const n=pn(this._gl,i.glType);this._vertexTotalSizeBytes+=n*i.size,e+=i.size}this._vertexBuffer.bufferData.length%e!==0&&this._logger.warn(`The vertex component size (${e})  does divide evenly into the specified vertex buffer (${this._vertexBuffer.bufferData.length})`)}use(t=!1,e){const i=this._gl;if(!this._shader.isCurrentlyBound())throw Error("Shader associated with this vertex layout is not active! Call shader.use() before layout.use()");this._vertexBuffer.bind(),t&&this._vertexBuffer.upload(e);let n=0;for(const o of this._layout)i.vertexAttribPointer(o.location,o.size,o.glType,o.normalized,this.totalVertexSizeBytes,n),i.enableVertexAttribArray(o.location),n+=pn(i,o.glType)*o.size}}class le{static clear(){le.DrawCallCount=0,le.DrawnImagesCount=0}}le.DrawCallCount=0,le.DrawnImagesCount=0;class Dr{constructor(){this.type="ex.line",this.priority=0,this._maxLines=10922,this._vertexIndex=0,this._lineCount=0}initialize(t,e){this._gl=t,this._context=e,this._shader=new qe({vertexSource:fo,fragmentSource:_o}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._vertexBuffer=new si({size:6*2*this._maxLines,type:"dynamic"}),this._layout=new Pi({vertexBuffer:this._vertexBuffer,shader:this._shader,attributes:[["a_position",2],["a_color",4]]})}draw(t,e,i){this._isFull()&&this.flush(),this._lineCount++;const n=this._context.getTransform(),o=n.multiply(t),h=n.multiply(e),d=this._vertexBuffer.bufferData;d[this._vertexIndex++]=o.x,d[this._vertexIndex++]=o.y,d[this._vertexIndex++]=i.r/255,d[this._vertexIndex++]=i.g/255,d[this._vertexIndex++]=i.b/255,d[this._vertexIndex++]=i.a,d[this._vertexIndex++]=h.x,d[this._vertexIndex++]=h.y,d[this._vertexIndex++]=i.r/255,d[this._vertexIndex++]=i.g/255,d[this._vertexIndex++]=i.b/255,d[this._vertexIndex++]=i.a}_isFull(){return this._lineCount>=this._maxLines}hasPendingDraws(){return this._lineCount!==0}flush(){if(this._lineCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.LINES,0,this._lineCount*2),le.DrawnImagesCount+=this._lineCount,le.DrawCallCount++,this._vertexIndex=0,this._lineCount=0}}const mo=`#version 300 es\r
in vec2 a_position;\r
in vec4 a_color;\r
in float a_size;\r
out lowp vec4 v_color;\r
uniform mat4 u_matrix;\r
\r
void main() {\r
  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
  gl_PointSize = a_size * 2.0;\r
  v_color = a_color;\r
}`,vo=`#version 300 es\r
\r
precision mediump float;\r
in lowp vec4 v_color;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  float r = 0.0, delta = 0.0, alpha = 1.0;\r
  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\r
  r = dot(cxy, cxy);\r
\r
  delta = fwidth(r);\r
  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\r
  // "premultiply" the color by alpha\r
  vec4 color = v_color;\r
  color.a = color.a * alpha;\r
  color.rgb = color.rgb * color.a;\r
  fragColor = color;\r
}`;class Ms{constructor(){this.type="ex.point",this.priority=0,this._maxPoints=10922,this._pointCount=0,this._vertexIndex=0}initialize(t,e){this._gl=t,this._context=e,this._shader=new qe({vertexSource:mo,fragmentSource:vo}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._buffer=new si({size:7*this._maxPoints,type:"dynamic"}),this._layout=new Pi({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_color",4],["a_size",1]]})}draw(t,e,i){this._isFull()&&this.flush(),this._pointCount++;const n=this._context.getTransform(),o=this._context.opacity,h=this._context.snapToPixel,d=n.multiply(t);h&&(d.x=~~(d.x+Ut),d.y=~~(d.y+Ut));const u=this._buffer.bufferData;u[this._vertexIndex++]=d.x,u[this._vertexIndex++]=d.y,u[this._vertexIndex++]=e.r/255,u[this._vertexIndex++]=e.g/255,u[this._vertexIndex++]=e.b/255,u[this._vertexIndex++]=e.a*o,u[this._vertexIndex++]=i*Math.max(n.getScaleX(),n.getScaleY())}_isFull(){return this._pointCount>=this._maxPoints}hasPendingDraws(){return this._pointCount!==0}flush(){if(this._pointCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.POINTS,0,this._pointCount),le.DrawnImagesCount+=this._pointCount,le.DrawCallCount++,this._pointCount=0,this._vertexIndex=0}}const ci=`#version 300 es\r
in vec2 a_position;\r
\r
in vec2 a_texcoord;\r
out vec2 v_texcoord;\r
\r
void main() {\r
  gl_Position = vec4(a_position, 0.0, 1.0);\r
\r
  // Pass the texcoord to the fragment shader.\r
  v_texcoord = a_texcoord;\r
}`,Rs=`#version 300 es\r
precision mediump float;\r
\r
// Passed in from the vertex shader.\r
in vec2 v_texcoord;\r
\r
// The texture.\r
uniform sampler2D u_texture;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
   fragColor = texture(u_texture, v_texcoord);\r
}`;class ds{constructor(t){this._gl=t,this._shader=new qe({vertexSource:ci,fragmentSource:Rs}),this._shader.compile(),this._buffer=new si({type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new Pi({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}renderWithPostProcessor(t){const e=this._gl;t.getShader().use(),t.getLayout().use(),e.drawArrays(e.TRIANGLES,0,6)}renderToScreen(){const t=this._gl;this._shader.use(),this._layout.use(),t.drawArrays(t.TRIANGLES,0,6)}}class Wi{constructor(t,e){this._gl=Me.gl,this._logger=v.getInstance();const i=this._gl;this.buffer=i.createBuffer(),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.buffer);const n=t*6;if(!e)this.bufferData=new Uint32Array(n);else{const d=Math.floor(16383.5);this.bufferGlType=i.UNSIGNED_SHORT,this.bufferData=new Uint16Array(n),t>d&&this._logger.warn(`Total quads exceeds hardware index buffer limit (uint16), max(${d}) requested quads(${t})`)}let o=0;for(let h=0;h<n;h+=6)this.bufferData[h+0]=o+0,this.bufferData[h+1]=o+1,this.bufferData[h+2]=o+2,this.bufferData[h+3]=o+2,this.bufferData[h+4]=o+1,this.bufferData[h+5]=o+3,o+=4;i.bufferData(i.ELEMENT_ARRAY_BUFFER,this.bufferData,i.STATIC_DRAW)}get size(){return this.bufferData.length}upload(){const t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.bufferData,t.STATIC_DRAW)}bind(){const t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer)}}const Jn=`#version 300 es\r
precision mediump float;\r
\r
// UV coord\r
in vec2 v_texcoord;\r
\r
// Texture index\r
in lowp float v_textureIndex;\r
\r
// Textures in the current draw\r
uniform sampler2D u_textures[%%count%%];\r
\r
// Opacity\r
in float v_opacity;\r
\r
in vec4 v_tint;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
   // In order to support the most efficient sprite batching, we have multiple\r
   // textures loaded into the gpu (usually 8) this picker logic skips over textures\r
   // that do not apply to a particular sprite.\r
\r
   vec4 color = vec4(1.0, 0, 0, 1.0);\r
\r
   // GLSL is templated out to pick the right texture and set the vec4 color\r
   %%texture_picker%%\r
\r
   color.rgb = color.rgb * v_opacity;\r
   color.a = color.a * v_opacity;\r
   fragColor = color * v_tint;\r
}`,wo=`#version 300 es\r
in vec2 a_position;\r
\r
// Opacity \r
in float a_opacity;\r
out float v_opacity;\r
\r
// UV coordinate\r
in vec2 a_texcoord;\r
out vec2 v_texcoord;\r
\r
// Texture number\r
in lowp float a_textureIndex;\r
out lowp float v_textureIndex;\r
\r
in vec4 a_tint;\r
out vec4 v_tint;\r
\r
uniform mat4 u_matrix;\r
\r
void main() {\r
   // Set the vertex position using the ortho transform matrix\r
   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
\r
   // Pass through the Opacity to the fragment shader\r
   v_opacity = a_opacity;\r
   // Pass through the UV coord to the fragment shader\r
   v_texcoord = a_texcoord;\r
   // Pass through the texture number to the fragment shader\r
   v_textureIndex = a_textureIndex;\r
   // Pass through the tint\r
   v_tint = a_tint;\r
}`;class Ls{constructor(){this.type="ex.image",this.priority=0,this._maxImages=10922,this._maxTextures=0,this._imageCount=0,this._textures=[],this._vertexIndex=0}initialize(t,e){this._gl=t,this._context=e,this._maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),125);const i=this._transformFragmentSource(Jn,this._maxTextures);this._shader=new qe({fragmentSource:i,vertexSource:wo}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",e.ortho),this._shader.setUniformIntArray("u_textures",[...Array(this._maxTextures)].map((n,o)=>o)),this._buffer=new si({size:10*4*this._maxImages,type:"dynamic"}),this._layout=new Pi({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_opacity",1],["a_texcoord",2],["a_textureIndex",1],["a_tint",4]]}),this._quads=new Wi(this._maxImages,!0)}_transformFragmentSource(t,e){let i=t.replace("%%count%%",e.toString()),n="";for(let o=0;o<e;o++)o===0?n+=`if (v_textureIndex <= ${o}.5) {
`:n+=`   else if (v_textureIndex <= ${o}.5) {
`,n+=`      color = texture(u_textures[${o}], v_texcoord);
`,n+=`   }
`;return i=i.replace("%%texture_picker%%",n),i}_addImageAsTexture(t){const e=Xt.load(t);this._textures.indexOf(e)===-1&&this._textures.push(e)}_bindTextures(t){for(let e=0;e<this._maxTextures;e++)t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this._textures[e]||this._textures[0])}_getTextureIdForImage(t){return t?this._textures.indexOf(Xt.get(t)):-1}_isFull(){return this._imageCount>=this._maxImages||this._textures.length>=this._maxTextures}draw(t,e,i,n,o,h,d,u,x){var Q,J,et,dt;this._isFull()&&this.flush(),this._imageCount++,this._addImageAsTexture(t);let ft=(t==null?void 0:t.width)||n||0,xt=(t==null?void 0:t.height)||o||0,It=[0,0,(Q=n??(t==null?void 0:t.width))!==null&&Q!==void 0?Q:0,(J=o??(t==null?void 0:t.height))!==null&&J!==void 0?J:0],ut=[e??1,i??1];h!==void 0&&d!==void 0&&u!==void 0&&x!==void 0&&(It=[e??1,i??1,(et=n??(t==null?void 0:t.width))!==null&&et!==void 0?et:0,(dt=o??(t==null?void 0:t.height))!==null&&dt!==void 0?dt:0],ut=[h,d],ft=u,xt=x),e=It[0],i=It[1];const pt=It[2],Tt=It[3],Qt=this._context.getTransform(),zt=this._context.opacity,Lt=this._context.snapToPixel;let vt=m(ut[0],ut[1]),te=m(ut[0]+ft,ut[1]),oe=m(ut[0],ut[1]+xt),ae=m(ut[0]+ft,ut[1]+xt);vt=Qt.multiply(vt),te=Qt.multiply(te),oe=Qt.multiply(oe),ae=Qt.multiply(ae),Lt&&(vt.x=~~(vt.x+Ut),vt.y=~~(vt.y+Ut),te.x=~~(te.x+Ut),te.y=~~(te.y+Ut),oe.x=~~(oe.x+Ut),oe.y=~~(oe.y+Ut),ae.x=~~(ae.x+Ut),ae.y=~~(ae.y+Ut));const $t=this._context.tint,Ge=this._getTextureIdForImage(t),yi=t.width||ft,xi=t.height||xt,ln=e/yi,hn=i/xi,cn=(e+pt-.01)/yi,dn=(i+Tt-.01)/xi,Vt=this._layout.vertexBuffer.bufferData;Vt[this._vertexIndex++]=vt.x,Vt[this._vertexIndex++]=vt.y,Vt[this._vertexIndex++]=zt,Vt[this._vertexIndex++]=ln,Vt[this._vertexIndex++]=hn,Vt[this._vertexIndex++]=Ge,Vt[this._vertexIndex++]=$t.r/255,Vt[this._vertexIndex++]=$t.g/255,Vt[this._vertexIndex++]=$t.b/255,Vt[this._vertexIndex++]=$t.a,Vt[this._vertexIndex++]=oe.x,Vt[this._vertexIndex++]=oe.y,Vt[this._vertexIndex++]=zt,Vt[this._vertexIndex++]=ln,Vt[this._vertexIndex++]=dn,Vt[this._vertexIndex++]=Ge,Vt[this._vertexIndex++]=$t.r/255,Vt[this._vertexIndex++]=$t.g/255,Vt[this._vertexIndex++]=$t.b/255,Vt[this._vertexIndex++]=$t.a,Vt[this._vertexIndex++]=te.x,Vt[this._vertexIndex++]=te.y,Vt[this._vertexIndex++]=zt,Vt[this._vertexIndex++]=cn,Vt[this._vertexIndex++]=hn,Vt[this._vertexIndex++]=Ge,Vt[this._vertexIndex++]=$t.r/255,Vt[this._vertexIndex++]=$t.g/255,Vt[this._vertexIndex++]=$t.b/255,Vt[this._vertexIndex++]=$t.a,Vt[this._vertexIndex++]=ae.x,Vt[this._vertexIndex++]=ae.y,Vt[this._vertexIndex++]=zt,Vt[this._vertexIndex++]=cn,Vt[this._vertexIndex++]=dn,Vt[this._vertexIndex++]=Ge,Vt[this._vertexIndex++]=$t.r/255,Vt[this._vertexIndex++]=$t.g/255,Vt[this._vertexIndex++]=$t.b/255,Vt[this._vertexIndex++]=$t.a}hasPendingDraws(){return this._imageCount!==0}flush(){if(this._imageCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0,4*10*this._imageCount),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._bindTextures(t),this._quads.bind(),t.drawElements(t.TRIANGLES,this._imageCount*6,this._quads.bufferGlType,0),le.DrawnImagesCount+=this._imageCount,le.DrawCallCount++,this._imageCount=0,this._vertexIndex=0,this._textures.length=0}}const Tr=`#version 300 es\r
\r
precision mediump float;\r
\r
// UV coord\r
in vec2 v_uv;\r
\r
in vec2 v_size; // in pixels\r
\r
// Color coord to blend with image\r
in lowp vec4 v_color;\r
\r
// Stroke color if used\r
in lowp vec4 v_strokeColor;\r
\r
// Stroke thickness if used\r
in lowp float v_strokeThickness; // in pixels\r
\r
// Opacity\r
in float v_opacity;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
    // modified from https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\r
    vec2 uv = v_uv;\r
    vec2 fragCoord = uv * v_size;\r
    float maxX = v_size.x - v_strokeThickness;\r
    float minX = v_strokeThickness;\r
    float maxY = v_size.y - v_strokeThickness;\r
    float minY = v_strokeThickness;\r
\r
    if (fragCoord.x < maxX && fragCoord.x > minX &&\r
        fragCoord.y < maxY && fragCoord.y > minY) {\r
      fragColor = v_color;\r
    } else {\r
      fragColor = v_strokeColor;\r
    }\r
    fragColor.a *= v_opacity;\r
    fragColor.rgb *= fragColor.a;\r
\r
    // vec2 v2CenteredPos     = abs(fragCoord - v_size.xy / 2.0);\r
    // vec2 v2HalfShapeSizePx = v_size.xy/2.0 - v_strokeThickness/2.0;\r
\r
    // float fHalfBorderDist      = 0.0;\r
    // float fHalfBorderThickness = 0.0;\r
\r
    // if (fragCoord.x > max(v_radius, v_strokeThickness) && \r
    //     fragCoord.x < v_size.x - max(v_radius, v_strokeThickness))\r
    // {\r
    //     fHalfBorderDist      = v2CenteredPos.y - v2HalfShapeSizePx.y;\r
    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r
    // }\r
    // else if (fragCoord.y > max(v_radius, v_strokeThickness) && \r
    //          fragCoord.y < v_size.y - max(v_radius, v_strokeThickness))\r
    // {\r
    //     fHalfBorderDist      = v2CenteredPos.x - v2HalfShapeSizePx.x;\r
    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r
    // }\r
    // else\r
    // {\r
    //     vec2 edgeVec = max(vec2(0.0), v_radius - vec2(\r
    //         uv.x > 0.5 ? v_size.x - fragCoord.x : fragCoord.x,\r
    //         uv.y > 0.5 ? v_size.y - fragCoord.y : fragCoord.y));\r
        \r
    //     float ellipse_ab    = v_radius-v_strokeThickness;\r
    //     vec2 ellipse_isect = (v_strokeThickness > v_radius || v_strokeThickness > v_radius) ? vec2(0.0) :\r
    //                             edgeVec.xy * ellipse_ab*ellipse_ab / length(ellipse_ab*edgeVec.yx); \r
            \r
    //     fHalfBorderThickness = (v_radius - length(ellipse_isect)) / 2.0;\r
    //     fHalfBorderDist      = length(edgeVec) - (v_radius - fHalfBorderThickness);\r
    // }\r
\r
    // vec4 v4FromColor = v_strokeColor;\r
    // v4FromColor.rgb *= v4FromColor.a;\r
    // vec4 v4ToColor   = vec4(0.0); // background color is transparent\r
    // if (fHalfBorderDist < 0.0) {\r
    //     v4ToColor = v_color;\r
    //     v4ToColor.rgb *= v4ToColor.a;\r
    // }\r
\r
    // float mixPct = abs(fHalfBorderDist) - fHalfBorderThickness;\r
\r
    // vec4 finalColor = mix(v4FromColor, v4ToColor, mixPct);\r
    // gl_FragColor = finalColor;\r
}`,bo=`#version 300 es\r
in vec2 a_position;\r
\r
// UV coordinate\r
in vec2 a_uv;\r
out vec2 v_uv;\r
\r
in vec2 a_size;\r
out vec2 v_size;\r
\r
// Opacity \r
in float a_opacity;\r
out float v_opacity;\r
\r
in vec4 a_color;\r
out vec4 v_color;\r
\r
in vec4 a_strokeColor;\r
out vec4 v_strokeColor;\r
\r
in float a_strokeThickness;\r
out float v_strokeThickness;\r
\r
uniform mat4 u_matrix;\r
\r
\r
void main() {\r
   // Set the vertex position using the ortho transform matrix\r
   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
\r
   // Pass through UV coords\r
   v_uv = a_uv;\r
   // Pass through size\r
   v_size = a_size;\r
   // Pass through the Opacity to the fragment shader\r
   v_opacity = a_opacity;\r
   // Pass through the color to the fragment shader\r
   v_color = a_color;\r
   // Pass through the stroke color to the fragment shader\r
   v_strokeColor = a_strokeColor;\r
   // Pass through the stroke thickenss to the fragment shader\r
   v_strokeThickness = a_strokeThickness;\r
}`;class Fr{constructor(){this.type="ex.rectangle",this.priority=0,this._maxRectangles=10922,this._rectangleCount=0,this._vertexIndex=0}initialize(t,e){this._gl=t,this._context=e,this._shader=new qe({fragmentSource:Tr,vertexSource:bo}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",e.ortho),this._buffer=new si({size:16*4*this._maxRectangles,type:"dynamic"}),this._layout=new Pi({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_size",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new Wi(this._maxRectangles,!0)}_isFull(){return this._rectangleCount>=this._maxRectangles}draw(...t){t[0]instanceof p&&t[1]instanceof p?this.drawLine.apply(this,t):this.drawRectangle.apply(this,t)}drawLine(t,e,i,n=1){this._isFull()&&this.flush(),this._rectangleCount++;const o=this._context.getTransform(),h=this._context.opacity,d=this._context.snapToPixel,u=e.sub(t),x=u.size,Q=u.normalize().perpendicular(),J=n/2,et=o.multiply(Q.scale(J).add(t)),dt=o.multiply(Q.scale(-J).add(t)),ft=o.multiply(Q.scale(J).add(e)),xt=o.multiply(Q.scale(-J).add(e));d&&(et.x=~~(et.x+Ut),et.y=~~(et.y+Ut),ft.x=~~(ft.x+Ut),ft.y=~~(ft.y+Ut),dt.x=~~(dt.x+Ut),dt.y=~~(dt.y+Ut),xt.x=~~(xt.x+Ut),xt.y=~~(xt.y+Ut));const It=0,ut=0,pt=1,Tt=1,Qt=I.Transparent,zt=0,Lt=1,vt=this._layout.vertexBuffer.bufferData;vt[this._vertexIndex++]=et.x,vt[this._vertexIndex++]=et.y,vt[this._vertexIndex++]=It,vt[this._vertexIndex++]=ut,vt[this._vertexIndex++]=x,vt[this._vertexIndex++]=n,vt[this._vertexIndex++]=h,vt[this._vertexIndex++]=i.r/255,vt[this._vertexIndex++]=i.g/255,vt[this._vertexIndex++]=i.b/255,vt[this._vertexIndex++]=i.a,vt[this._vertexIndex++]=Qt.r/255,vt[this._vertexIndex++]=Qt.g/255,vt[this._vertexIndex++]=Qt.b/255,vt[this._vertexIndex++]=Qt.a,vt[this._vertexIndex++]=zt/Lt,vt[this._vertexIndex++]=dt.x,vt[this._vertexIndex++]=dt.y,vt[this._vertexIndex++]=It,vt[this._vertexIndex++]=Tt,vt[this._vertexIndex++]=x,vt[this._vertexIndex++]=n,vt[this._vertexIndex++]=h,vt[this._vertexIndex++]=i.r/255,vt[this._vertexIndex++]=i.g/255,vt[this._vertexIndex++]=i.b/255,vt[this._vertexIndex++]=i.a,vt[this._vertexIndex++]=Qt.r/255,vt[this._vertexIndex++]=Qt.g/255,vt[this._vertexIndex++]=Qt.b/255,vt[this._vertexIndex++]=Qt.a,vt[this._vertexIndex++]=zt/Lt,vt[this._vertexIndex++]=ft.x,vt[this._vertexIndex++]=ft.y,vt[this._vertexIndex++]=pt,vt[this._vertexIndex++]=ut,vt[this._vertexIndex++]=x,vt[this._vertexIndex++]=n,vt[this._vertexIndex++]=h,vt[this._vertexIndex++]=i.r/255,vt[this._vertexIndex++]=i.g/255,vt[this._vertexIndex++]=i.b/255,vt[this._vertexIndex++]=i.a,vt[this._vertexIndex++]=Qt.r/255,vt[this._vertexIndex++]=Qt.g/255,vt[this._vertexIndex++]=Qt.b/255,vt[this._vertexIndex++]=Qt.a,vt[this._vertexIndex++]=zt/Lt,vt[this._vertexIndex++]=xt.x,vt[this._vertexIndex++]=xt.y,vt[this._vertexIndex++]=pt,vt[this._vertexIndex++]=Tt,vt[this._vertexIndex++]=x,vt[this._vertexIndex++]=n,vt[this._vertexIndex++]=h,vt[this._vertexIndex++]=i.r/255,vt[this._vertexIndex++]=i.g/255,vt[this._vertexIndex++]=i.b/255,vt[this._vertexIndex++]=i.a,vt[this._vertexIndex++]=Qt.r/255,vt[this._vertexIndex++]=Qt.g/255,vt[this._vertexIndex++]=Qt.b/255,vt[this._vertexIndex++]=Qt.a,vt[this._vertexIndex++]=zt/Lt}drawRectangle(t,e,i,n,o=I.Transparent,h=0){this._isFull()&&this.flush(),this._rectangleCount++;const d=this._context.getTransform(),u=this._context.opacity,x=this._context.snapToPixel,Q=d.multiply(t.add(m(0,0))),J=d.multiply(t.add(m(e,0))),et=d.multiply(t.add(m(e,i))),dt=d.multiply(t.add(m(0,i)));x&&(Q.x=~~(Q.x+Ut),Q.y=~~(Q.y+Ut),J.x=~~(J.x+Ut),J.y=~~(J.y+Ut),dt.x=~~(dt.x+Ut),dt.y=~~(dt.y+Ut),et.x=~~(et.x+Ut),et.y=~~(et.y+Ut));const ft=0,xt=0,It=1,ut=1,pt=this._layout.vertexBuffer.bufferData;pt[this._vertexIndex++]=Q.x,pt[this._vertexIndex++]=Q.y,pt[this._vertexIndex++]=ft,pt[this._vertexIndex++]=xt,pt[this._vertexIndex++]=e,pt[this._vertexIndex++]=i,pt[this._vertexIndex++]=u,pt[this._vertexIndex++]=n.r/255,pt[this._vertexIndex++]=n.g/255,pt[this._vertexIndex++]=n.b/255,pt[this._vertexIndex++]=n.a,pt[this._vertexIndex++]=o.r/255,pt[this._vertexIndex++]=o.g/255,pt[this._vertexIndex++]=o.b/255,pt[this._vertexIndex++]=o.a,pt[this._vertexIndex++]=h,pt[this._vertexIndex++]=dt.x,pt[this._vertexIndex++]=dt.y,pt[this._vertexIndex++]=ft,pt[this._vertexIndex++]=ut,pt[this._vertexIndex++]=e,pt[this._vertexIndex++]=i,pt[this._vertexIndex++]=u,pt[this._vertexIndex++]=n.r/255,pt[this._vertexIndex++]=n.g/255,pt[this._vertexIndex++]=n.b/255,pt[this._vertexIndex++]=n.a,pt[this._vertexIndex++]=o.r/255,pt[this._vertexIndex++]=o.g/255,pt[this._vertexIndex++]=o.b/255,pt[this._vertexIndex++]=o.a,pt[this._vertexIndex++]=h,pt[this._vertexIndex++]=J.x,pt[this._vertexIndex++]=J.y,pt[this._vertexIndex++]=It,pt[this._vertexIndex++]=xt,pt[this._vertexIndex++]=e,pt[this._vertexIndex++]=i,pt[this._vertexIndex++]=u,pt[this._vertexIndex++]=n.r/255,pt[this._vertexIndex++]=n.g/255,pt[this._vertexIndex++]=n.b/255,pt[this._vertexIndex++]=n.a,pt[this._vertexIndex++]=o.r/255,pt[this._vertexIndex++]=o.g/255,pt[this._vertexIndex++]=o.b/255,pt[this._vertexIndex++]=o.a,pt[this._vertexIndex++]=h,pt[this._vertexIndex++]=et.x,pt[this._vertexIndex++]=et.y,pt[this._vertexIndex++]=It,pt[this._vertexIndex++]=ut,pt[this._vertexIndex++]=e,pt[this._vertexIndex++]=i,pt[this._vertexIndex++]=u,pt[this._vertexIndex++]=n.r/255,pt[this._vertexIndex++]=n.g/255,pt[this._vertexIndex++]=n.b/255,pt[this._vertexIndex++]=n.a,pt[this._vertexIndex++]=o.r/255,pt[this._vertexIndex++]=o.g/255,pt[this._vertexIndex++]=o.b/255,pt[this._vertexIndex++]=o.a,pt[this._vertexIndex++]=h}hasPendingDraws(){return this._rectangleCount!==0}flush(){if(this._rectangleCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,this._rectangleCount*6,this._quads.bufferGlType,0),le.DrawnImagesCount+=this._rectangleCount,le.DrawCallCount++,this._rectangleCount=0,this._vertexIndex=0}}const Mr=`#version 300 es\r
precision highp float;\r
\r
// UV coord\r
in vec2 v_uv;\r
\r
// Color coord to blend with image\r
in lowp vec4 v_color;\r
\r
// Stroke color if used\r
in lowp vec4 v_strokeColor;\r
\r
// Stroke thickness if used\r
in lowp float v_strokeThickness;\r
\r
// Opacity\r
in float v_opacity;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  // make (0, 0) the center the uv \r
  vec2 uv = v_uv * 2.0 - 1.0;\r
\r
  vec4 color = v_color;\r
  vec4 strokeColor = v_strokeColor;\r
\r
  // circle border is at radius 1.0 \r
  // dist is > 0 when inside the circle \r
  float d = length(uv);\r
  float dist = 1.0 - length(uv);\r
\r
  // Fade based on fwidth\r
  float fade = fwidth(dot(uv, uv));\r
\r
  // if dist is greater than 0 step to 1;\r
  // when we cross this 0 threshold add a smooth fade\r
  float fill = smoothstep(-fade/2.0, fade/2.0, dist);\r
\r
  // if dist is greater than the stroke thickness step to 1\r
  float stroke = 1.0 - smoothstep(v_strokeThickness, v_strokeThickness + fade, dist);\r
\r
  strokeColor.a *= fill * stroke;\r
  strokeColor.rgb *= strokeColor.a;\r
\r
  color.a *= fill * (1.0 - stroke);\r
  color.rgb *= color.a;\r
\r
  vec4 finalColor = mix(vec4(0.0), (color + strokeColor), fill);\r
  finalColor.rgb = finalColor.rgb * v_opacity;\r
  finalColor.a = finalColor.a * v_opacity;\r
  fragColor = finalColor;\r
}`,Co=`#version 300 es\r
in vec2 a_position;\r
\r
// UV coordinate\r
in vec2 a_uv;\r
out vec2 v_uv;\r
\r
// Opacity \r
in float a_opacity;\r
out float v_opacity;\r
\r
in vec4 a_color;\r
out vec4 v_color;\r
\r
in vec4 a_strokeColor;\r
out vec4 v_strokeColor;\r
\r
in float a_strokeThickness;\r
out float v_strokeThickness;\r
\r
uniform mat4 u_matrix;\r
\r
\r
void main() {\r
   // Set the vertex position using the ortho transform matrix\r
   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r
\r
   // Pass through UV coords\r
   v_uv = a_uv;\r
   // Pass through the Opacity to the fragment shader\r
   v_opacity = a_opacity;\r
   // Pass through the color to the fragment shader\r
   v_color = a_color;\r
   // Pass through the stroke color to the fragment shader\r
   v_strokeColor = a_strokeColor;\r
   // Pass through the stroke thickenss to the fragment shader\r
   v_strokeThickness = a_strokeThickness;\r
}`;class gn{constructor(){this.type="ex.circle",this.priority=0,this._maxCircles=10922,this._circleCount=0,this._vertexIndex=0}initialize(t,e){this._gl=t,this._context=e,this._shader=new qe({fragmentSource:Mr,vertexSource:Co}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",e.ortho),this._buffer=new si({size:14*4*this._maxCircles,type:"dynamic"}),this._layout=new Pi({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new Wi(this._maxCircles,!0)}_isFull(){return this._circleCount>=this._maxCircles}draw(t,e,i,n=I.Transparent,o=0){this._isFull()&&this.flush(),this._circleCount++;const h=this._context.getTransform(),d=this._context.opacity,u=this._context.snapToPixel,x=h.multiply(t.add(m(-e,-e))),Q=h.multiply(t.add(m(e,-e))),J=h.multiply(t.add(m(e,e))),et=h.multiply(t.add(m(-e,e)));u&&(x.x=~~(x.x+Ut),x.y=~~(x.y+Ut),Q.x=~~(Q.x+Ut),Q.y=~~(Q.y+Ut),et.x=~~(et.x+Ut),et.y=~~(et.y+Ut),J.x=~~(J.x+Ut),J.y=~~(J.y+Ut));const dt=0,ft=0,xt=1,It=1,ut=this._layout.vertexBuffer.bufferData;ut[this._vertexIndex++]=x.x,ut[this._vertexIndex++]=x.y,ut[this._vertexIndex++]=dt,ut[this._vertexIndex++]=ft,ut[this._vertexIndex++]=d,ut[this._vertexIndex++]=i.r/255,ut[this._vertexIndex++]=i.g/255,ut[this._vertexIndex++]=i.b/255,ut[this._vertexIndex++]=i.a,ut[this._vertexIndex++]=n.r/255,ut[this._vertexIndex++]=n.g/255,ut[this._vertexIndex++]=n.b/255,ut[this._vertexIndex++]=n.a,ut[this._vertexIndex++]=o/e,ut[this._vertexIndex++]=et.x,ut[this._vertexIndex++]=et.y,ut[this._vertexIndex++]=dt,ut[this._vertexIndex++]=It,ut[this._vertexIndex++]=d,ut[this._vertexIndex++]=i.r/255,ut[this._vertexIndex++]=i.g/255,ut[this._vertexIndex++]=i.b/255,ut[this._vertexIndex++]=i.a,ut[this._vertexIndex++]=n.r/255,ut[this._vertexIndex++]=n.g/255,ut[this._vertexIndex++]=n.b/255,ut[this._vertexIndex++]=n.a,ut[this._vertexIndex++]=o/e,ut[this._vertexIndex++]=Q.x,ut[this._vertexIndex++]=Q.y,ut[this._vertexIndex++]=xt,ut[this._vertexIndex++]=ft,ut[this._vertexIndex++]=d,ut[this._vertexIndex++]=i.r/255,ut[this._vertexIndex++]=i.g/255,ut[this._vertexIndex++]=i.b/255,ut[this._vertexIndex++]=i.a,ut[this._vertexIndex++]=n.r/255,ut[this._vertexIndex++]=n.g/255,ut[this._vertexIndex++]=n.b/255,ut[this._vertexIndex++]=n.a,ut[this._vertexIndex++]=o/e,ut[this._vertexIndex++]=J.x,ut[this._vertexIndex++]=J.y,ut[this._vertexIndex++]=xt,ut[this._vertexIndex++]=It,ut[this._vertexIndex++]=d,ut[this._vertexIndex++]=i.r/255,ut[this._vertexIndex++]=i.g/255,ut[this._vertexIndex++]=i.b/255,ut[this._vertexIndex++]=i.a,ut[this._vertexIndex++]=n.r/255,ut[this._vertexIndex++]=n.g/255,ut[this._vertexIndex++]=n.b/255,ut[this._vertexIndex++]=n.a,ut[this._vertexIndex++]=o/e}hasPendingDraws(){return this._circleCount!==0}flush(){if(this._circleCount===0)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,this._circleCount*6,this._quads.bufferGlType,0),le.DrawnImagesCount+=this._circleCount,le.DrawCallCount++,this._circleCount=0,this._vertexIndex=0}}class Zn{constructor(t,e,i=100){this.builder=t,this.recycler=e,this.maxObjects=i,this.totalAllocations=0,this.index=0,this.objects=[],this.disableWarnings=!1,this._logger=v.getInstance()}preallocate(){for(let t=0;t<this.maxObjects;t++)this.objects[t]=this.builder()}using(t){const e=t(this);return e?this.done(...e):this.done()}borrow(t){const e=this.get();t(e),this.index--}get(...t){return this.index===this.maxObjects&&(this.disableWarnings||this._logger.warn("Max pooled objects reached, possible memory leak? Doubling"),this.maxObjects=this.maxObjects*2),this.objects[this.index]?this.recycler(this.objects[this.index++],...t):(this.totalAllocations++,this.objects[this.index++]=this.builder(...t))}done(...t){this.index=0;for(const e of t){const i=this.objects.indexOf(e);this.objects[i]=this.builder(),this.totalAllocations++}return t}}class Rr{constructor(){this.z=0,this.priority=0,this.transform=nt.identity(),this.state={z:0,opacity:1,tint:I.White}}}const Ut=1e-4;class yo{constructor(t){this._webglCtx=t,this._debugText=new Wn}drawRect(t,e,i,n,o={color:I.Black}){this.drawLine(m(t,e),m(t+i,e),{...o}),this.drawLine(m(t+i,e),m(t+i,e+n),{...o}),this.drawLine(m(t+i,e+n),m(t,e+n),{...o}),this.drawLine(m(t,e+n),m(t,e),{...o})}drawLine(t,e,i={color:I.Black}){this._webglCtx.draw("ex.line",t,e,i.color)}drawPoint(t,e={color:I.Black,size:5}){this._webglCtx.draw("ex.point",t,e.color,e.size)}drawText(t,e){this._debugText.write(this._webglCtx,t,e)}}class Ns{constructor(t){this._logger=v.getInstance(),this._renderers=new Map,this._isDrawLifecycle=!1,this.useDrawSorting=!0,this._drawCallPool=new Zn(()=>new Rr,u=>(u.priority=0,u.z=0,u.renderer=void 0,u.args=void 0,u),4e3),this._drawCalls=[],this._postProcessTargets=[],this._postprocessors=[],this._transform=new B,this._state=new st,this.snapToPixel=!1,this.smoothing=!1,this.backgroundColor=I.ExcaliburBlue,this._alreadyWarnedDrawLifecycle=!1,this.debug=new yo(this);const{canvasElement:e,enableTransparency:i,smoothing:n,snapToPixel:o,backgroundColor:h,useDrawSorting:d}=t;if(this.__gl=e.getContext("webgl2",{antialias:n??this.smoothing,premultipliedAlpha:!1,alpha:i??!0,depth:!0,powerPreference:"high-performance"}),!this.__gl)throw Error("Failed to retrieve webgl context from browser");Me.register(this.__gl),Xt.register(this.__gl),this.snapToPixel=o??this.snapToPixel,this.smoothing=n??this.smoothing,this.backgroundColor=h??this.backgroundColor,this.useDrawSorting=d??this.useDrawSorting,this._drawCallPool.disableWarnings=!0,this._drawCallPool.preallocate(),this._init()}get z(){return this._state.current.z}set z(t){this._state.current.z=t}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get tint(){return this._state.current.tint}set tint(t){this._state.current.tint=t}get width(){return this.__gl.canvas.width}get height(){return this.__gl.canvas.height}get ortho(){return this._ortho}checkIfResolutionSupported(t){let e=!0;return(t.width>4096||t.height>4096)&&(e=!1),e}_init(){const t=this.__gl;this._ortho=L.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this.register(new Ls),this.register(new Fr),this.register(new gn),this.register(new Ms),this.register(new Dr),this._screenRenderer=new ds(t),this._renderTarget=new hi({gl:t,width:t.canvas.width,height:t.canvas.height}),this._postProcessTargets=[new hi({gl:t,width:t.canvas.width,height:t.canvas.height}),new hi({gl:t,width:t.canvas.width,height:t.canvas.height})]}register(t){this._renderers.set(t.type,t),t.initialize(this.__gl,this)}get(t){return this._renderers.get(t)}_isCurrentRenderer(t){return!this._currentRenderer||this._currentRenderer===t}beginDrawLifecycle(){this._isDrawLifecycle=!0}endDrawLifecycle(){this._isDrawLifecycle=!1}draw(t,...e){!this._isDrawLifecycle&&!this._alreadyWarnedDrawLifecycle&&(this._logger.warn(`Attempting to draw outside the the drawing lifecycle (preDraw/postDraw) is not supported and is a source of bugs/errors.
If you want to do custom drawing, use Actor.graphics, or any onPreDraw or onPostDraw handler.`),this._alreadyWarnedDrawLifecycle=!0);const i=this._renderers.get(t);if(i)if(this.useDrawSorting){const n=this._drawCallPool.get();n.z=this._state.current.z,n.priority=i.priority,n.renderer=t,this.getTransform().clone(n.transform),n.state.z=this._state.current.z,n.state.opacity=this._state.current.opacity,n.state.tint=this._state.current.tint,n.args=e,this._drawCalls.push(n)}else this._currentRenderer||(this._currentRenderer=i),this._isCurrentRenderer(i)||this._currentRenderer.flush(),i.draw(...e),this._currentRenderer=i;else throw Error(`No renderer with name ${t} has been registered`)}resetTransform(){this._transform.current=nt.identity()}updateViewport(t){const e=this.__gl;this._ortho=this._ortho=L.ortho(0,t.width,t.height,0,400,-400),this._renderTarget.setResolution(e.canvas.width,e.canvas.height),this._postProcessTargets[0].setResolution(e.canvas.width,e.canvas.height),this._postProcessTargets[1].setResolution(e.canvas.width,e.canvas.height)}drawImage(t,e,i,n,o,h,d,u,x){if(!(n===0||o===0)){{if(u===0||x===0)return;if(t.width===0||t.height===0)return}if(!t){v.getInstance().warn("Cannot draw a null or undefined image"),console.trace&&console.trace();return}this.draw("ex.image",t,e,i,n,o,h,d,u,x)}}drawLine(t,e,i,n=1){this.draw("ex.rectangle",t,e,i,n)}drawRectangle(t,e,i,n,o,h){this.draw("ex.rectangle",t,e,i,n,o,h)}drawCircle(t,e,i,n,o){this.draw("ex.circle",t,e,i,n,o)}save(){this._transform.save(),this._state.save()}restore(){this._transform.restore(),this._state.restore()}translate(t,e){this._transform.translate(this.snapToPixel?~~(t+Ut):t,this.snapToPixel?~~(e+Ut):e)}rotate(t){this._transform.rotate(t)}scale(t,e){this._transform.scale(t,e)}transform(t){this._transform.current=t}getTransform(){return this._transform.current}multiply(t){this._transform.current.multiply(t,this._transform.current)}addPostProcessor(t){this._postprocessors.push(t),t.initialize(this.__gl)}removePostProcessor(t){const e=this._postprocessors.indexOf(t);e!==-1&&this._postprocessors.splice(e,1)}clearPostProcessors(){this._postprocessors.length=0}clear(){const t=this.__gl;this._renderTarget.use(),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT)}flush(){const t=this.__gl;if(this._renderTarget.use(),this.useDrawSorting){const i=new Map;for(const[h]of this._renderers){const d=this._drawCalls.findIndex(u=>u.renderer===h);i.set(h,d)}this._drawCalls.sort((h,d)=>{const u=h.z-d.z,x=i.get(h.renderer)-i.get(d.renderer),Q=h.priority-d.priority;return u===0?Q===0?x:Q:u});const n=this._transform.current,o=this._state.current;if(this._drawCalls.length){let h=this._drawCalls[0].renderer,d=this._renderers.get(h);for(let u=0;u<this._drawCalls.length;u++)this._transform.current=this._drawCalls[u].transform,this._state.current=this._drawCalls[u].state,this._drawCalls[u].renderer!==h&&(d.flush(),h=this._drawCalls[u].renderer,d=this._renderers.get(h)),d.draw(...this._drawCalls[u].args);d.hasPendingDraws()&&d.flush()}this._transform.current=n,this._state.current=o,this._drawCallPool.done(),this._drawCalls.length=0}else for(const i of this._renderers.values())i.hasPendingDraws()&&i.flush();this._renderTarget.disable(),this._renderTarget.toRenderSource().use();for(let i=0;i<this._postprocessors.length;i++)this._postProcessTargets[i%2].use(),this._screenRenderer.renderWithPostProcessor(this._postprocessors[i]),this._postProcessTargets[i%2].toRenderSource().use();t.bindFramebuffer(t.FRAMEBUFFER,null),this._screenRenderer.renderToScreen()}}const he=1e-4;class xo{constructor(t){this._ex=t,this._debugText=new Wn}drawRect(t,e,i,n){this._ex.__ctx.save(),this._ex.__ctx.strokeStyle="red",this._ex.__ctx.strokeRect(this._ex.snapToPixel?~~(t+he):t,this._ex.snapToPixel?~~(e+he):e,this._ex.snapToPixel?~~(i+he):i,this._ex.snapToPixel?~~(n+he):n),this._ex.__ctx.restore()}drawLine(t,e,i={color:I.Black}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.strokeStyle=i.color.toString(),this._ex.__ctx.moveTo(this._ex.snapToPixel?~~(t.x+he):t.x,this._ex.snapToPixel?~~(t.y+he):t.y),this._ex.__ctx.lineTo(this._ex.snapToPixel?~~(e.x+he):e.x,this._ex.snapToPixel?~~(e.y+he):e.y),this._ex.__ctx.lineWidth=2,this._ex.__ctx.stroke(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawPoint(t,e={color:I.Black,size:5}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.fillStyle=e.color.toString(),this._ex.__ctx.arc(this._ex.snapToPixel?~~(t.x+he):t.x,this._ex.snapToPixel?~~(t.y+he):t.y,e.size,0,Math.PI*2),this._ex.__ctx.fill(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawText(t,e){this._debugText.write(this._ex,t,e)}}class As{constructor(t){this.useDrawSorting=!1,this.z=0,this.backgroundColor=I.ExcaliburBlue,this._state=new st,this.snapToPixel=!1,this.debug=new xo(this);const{canvasElement:e,enableTransparency:i,snapToPixel:n,smoothing:o,backgroundColor:h}=t;this.__ctx=e.getContext("2d",{alpha:i??!0}),this.backgroundColor=h??this.backgroundColor,this.snapToPixel=n??this.snapToPixel,this.smoothing=o??this.smoothing}get width(){return this.__ctx.canvas.width}get height(){return this.__ctx.canvas.height}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get tint(){return this._state.current.tint}set tint(t){this._state.current.tint=t}get smoothing(){return this.__ctx.imageSmoothingEnabled}set smoothing(t){this.__ctx.imageSmoothingEnabled=t}resetTransform(){this.__ctx.resetTransform()}updateViewport(t){}drawImage(t,e,i,n,o,h,d,u,x){if(n===0||o===0)return;if(u===0||x===0)return;if(t.width===0||t.height===0)return;this.__ctx.globalAlpha=this.opacity;const Q=[t,e,i,n,o,h,d,u,x].filter(J=>J!==void 0).map(J=>typeof J=="number"&&this.snapToPixel?~~J:J);this.__ctx.drawImage.apply(this.__ctx,Q),le.DrawCallCount++,le.DrawnImagesCount=1}drawLine(t,e,i,n=1){this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.strokeStyle=i.toString(),this.__ctx.moveTo(this.snapToPixel?~~(t.x+he):t.x,this.snapToPixel?~~(t.y+he):t.y),this.__ctx.lineTo(this.snapToPixel?~~(e.x+he):e.x,this.snapToPixel?~~(e.y+he):e.y),this.__ctx.lineWidth=n,this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}drawRectangle(t,e,i,n){this.__ctx.save(),this.__ctx.fillStyle=n.toString(),this.__ctx.fillRect(this.snapToPixel?~~(t.x+he):t.x,this.snapToPixel?~~(t.y+he):t.y,this.snapToPixel?~~(e+he):e,this.snapToPixel?~~(i+he):i),this.__ctx.restore()}drawCircle(t,e,i,n,o){this.__ctx.save(),this.__ctx.beginPath(),n&&(this.__ctx.strokeStyle=n.toString()),o&&(this.__ctx.lineWidth=o),this.__ctx.fillStyle=i.toString(),this.__ctx.arc(this.snapToPixel?~~(t.x+he):t.x,this.snapToPixel?~~(t.y+he):t.y,e,0,Math.PI*2),this.__ctx.fill(),n&&this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}save(){this.__ctx.save()}restore(){this.__ctx.restore()}translate(t,e){this.__ctx.translate(this.snapToPixel?~~(t+he):t,this.snapToPixel?~~(e+he):e)}rotate(t){this.__ctx.rotate(t)}scale(t,e){this.__ctx.scale(t,e)}getTransform(){throw new Error("Not implemented")}multiply(t){this.__ctx.setTransform(this.__ctx.getTransform().multiply(t.toDOMMatrix()))}addPostProcessor(t){}removePostProcessor(t){}clearPostProcessors(){}beginDrawLifecycle(){}endDrawLifecycle(){}clear(){this.__ctx.clearRect(0,0,this.width,this.height),this.__ctx.fillStyle=this.backgroundColor.toString(),this.__ctx.fillRect(0,0,this.width,this.height),le.clear()}flush(){}}var re;(function(a){a.Fixed="Fixed",a.FitContainerAndFill="FitContainerAndFill",a.FitScreenAndFill="FitScreenAndFill",a.FitContainerAndZoom="FitContainerAndZoom",a.FitScreenAndZoom="FitScreenAndZoom",a.FitScreen="FitScreen",a.FillScreen="FillScreen",a.FitContainer="FitContainer",a.FillContainer="FillContainer"})(re||(re={}));class Yi{static get SVGA(){return{width:800,height:600}}static get Standard(){return{width:1920,height:1080}}static get Atari2600(){return{width:160,height:192}}static get GameBoy(){return{width:160,height:144}}static get GameBoyAdvance(){return{width:240,height:160}}static get NintendoDS(){return{width:256,height:192}}static get NES(){return{width:256,height:224}}static get SNES(){return{width:256,height:244}}}class Gs{constructor(t){var e,i,n;this._antialiasing=!0,this._resolutionStack=[],this._viewportStack=[],this._pixelRatioOverride=null,this._isFullScreen=!1,this._isDisposed=!1,this._logger=v.getInstance(),this._fullscreenChangeHandler=()=>{this._isFullScreen=!this._isFullScreen,this._logger.debug("Fullscreen Change",this._isFullScreen)},this._pixelRatioChangeHandler=()=>{this._logger.debug("Pixel Ratio Change",window.devicePixelRatio),this._listenForPixelRatio(),this._devicePixelRatio=this._calculateDevicePixelRatio(),this.applyResolutionAndViewport()},this._resizeHandler=()=>{const o=this.parent;this._logger.debug("View port resized"),this._setResolutionAndViewportByDisplayMode(o),this.applyResolutionAndViewport()},this._devicePixelRatio=this._calculateDevicePixelRatio(),this._alreadyWarned=!1,this._contentArea=new N,this.viewport=t.viewport,this.resolution=(e=t.resolution)!==null&&e!==void 0?e:{...this.viewport},this._contentResolution=this.resolution,this._displayMode=(i=t.displayMode)!==null&&i!==void 0?i:re.Fixed,this._canvas=t.canvas,this.graphicsContext=t.context,this._antialiasing=(n=t.antialiasing)!==null&&n!==void 0?n:this._antialiasing,this._browser=t.browser,this._pixelRatioOverride=t.pixelRatio,this._applyDisplayMode(),this._listenForPixelRatio(),this._canvas.addEventListener("fullscreenchange",this._fullscreenChangeHandler),this.applyResolutionAndViewport()}_listenForPixelRatio(){this._mediaQueryList&&!this._mediaQueryList.addEventListener&&this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._mediaQueryList=this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener?this._mediaQueryList.addEventListener("change",this._pixelRatioChangeHandler,{once:!0}):this._mediaQueryList.addListener(this._pixelRatioChangeHandler)}dispose(){this._isDisposed||(this._isDisposed=!0,this._browser.window.off("resize",this._resizeHandler),this._resizeObserver&&this._resizeObserver.disconnect(),this.parent.removeEventListener("resize",this._resizeHandler),this._mediaQueryList.removeEventListener?this._mediaQueryList.removeEventListener("change",this._pixelRatioChangeHandler):this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._canvas.removeEventListener("fullscreenchange",this._fullscreenChangeHandler))}_calculateDevicePixelRatio(){return window.devicePixelRatio<1?1:window.devicePixelRatio||1}get pixelRatio(){return this._pixelRatioOverride?this._pixelRatioOverride:this._devicePixelRatio}get isHiDpi(){return this.pixelRatio!==1}get displayMode(){return this._displayMode}get canvas(){return this._canvas}get parent(){switch(this.displayMode){case re.FillContainer:case re.FitContainer:case re.FitContainerAndFill:case re.FitContainerAndZoom:return this.canvas.parentElement||document.body;default:return window}}get resolution(){return this._resolution}set resolution(t){this._resolution=t}get viewport(){return this._viewport?this._viewport:this._resolution}set viewport(t){this._viewport=t}get aspectRatio(){return this._resolution.width/this._resolution.height}get scaledWidth(){return this._resolution.width*this.pixelRatio}get scaledHeight(){return this._resolution.height*this.pixelRatio}setCurrentCamera(t){this._camera=t}pushResolutionAndViewport(){this._resolutionStack.push(this.resolution),this._viewportStack.push(this.viewport),this.resolution={...this.resolution},this.viewport={...this.viewport}}peekViewport(){return this._viewportStack[this._viewportStack.length-1]}peekResolution(){return this._resolutionStack[this._resolutionStack.length-1]}popResolutionAndViewport(){this.resolution=this._resolutionStack.pop(),this.viewport=this._viewportStack.pop()}applyResolutionAndViewport(){this._canvas.width=this.scaledWidth,this._canvas.height=this.scaledHeight,this.graphicsContext instanceof Ns&&!this.graphicsContext.checkIfResolutionSupported({width:this.scaledWidth,height:this.scaledHeight})&&!this._alreadyWarned&&(this._alreadyWarned=!0,this._logger.warn(`The currently configured resolution (${this.resolution.width}x${this.resolution.height}) and pixel ratio (${this.pixelRatio}) are too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly. Try reducing the resolution or disabling Hi DPI scaling to avoid this (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).`)),this._antialiasing?this._canvas.style.imageRendering="auto":(this._canvas.style.imageRendering="pixelated",this._canvas.style.imageRendering===""&&(this._canvas.style.imageRendering="crisp-edges")),this._canvas.style.width=this.viewport.width+"px",this._canvas.style.height=this.viewport.height+"px",this.graphicsContext.updateViewport(this.resolution),this.graphicsContext.resetTransform(),this.graphicsContext.smoothing=this._antialiasing,this.graphicsContext instanceof As&&this.graphicsContext.scale(this.pixelRatio,this.pixelRatio)}get antialiasing(){return this._antialiasing}set antialiasing(t){this._antialiasing=t,this.graphicsContext.smoothing=this._antialiasing}get isFullScreen(){return this._isFullScreen}goFullScreen(t){if(t){const e=document.getElementById(t);if(e)return e.requestFullscreen()}return this._canvas.requestFullscreen()}exitFullScreen(){return document.exitFullscreen()}pageToScreenCoordinates(t){let e=t.x,i=t.y;if(this._isFullScreen||(e-=ct(this._canvas).x,i-=ct(this._canvas).y),this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const n=window.innerWidth/this.aspectRatio,o=(window.innerHeight-n)/2;i=(i-o)/n*this.viewport.height,e=e/window.innerWidth*this.viewport.width}else{const n=window.innerHeight*this.aspectRatio,o=(window.innerWidth-n)/2;e=(e-o)/n*this.viewport.width,i=i/window.innerHeight*this.viewport.height}return e=e/this.viewport.width*this.resolution.width,i=i/this.viewport.height*this.resolution.height,new p(e,i)}screenToPageCoordinates(t){let e=t.x,i=t.y;if(e=e/this.resolution.width*this.viewport.width,i=i/this.resolution.height*this.viewport.height,this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const n=window.innerWidth/this.aspectRatio,o=(window.innerHeight-n)/2;i=i/this.viewport.height*n+o,e=e/this.viewport.width*window.innerWidth}else{const n=window.innerHeight*this.aspectRatio,o=(window.innerWidth-n)/2;e=e/this.viewport.width*n+o,i=i/this.viewport.height*window.innerHeight}return this._isFullScreen||(e+=ct(this._canvas).x,i+=ct(this._canvas).y),new p(e,i)}screenToWorldCoordinates(t){return this._camera?this._camera.inverse.multiply(t):t.sub(m(this.resolution.width/2,this.resolution.height/2))}worldToScreenCoordinates(t){return this._camera?this._camera.transform.multiply(t):t.add(m(this.resolution.width/2,this.resolution.height/2))}pageToWorldCoordinates(t){const e=this.pageToScreenCoordinates(t);return this.screenToWorldCoordinates(e)}worldToPageCoordinates(t){const e=this.worldToScreenCoordinates(t);return this.screenToPageCoordinates(e)}getWorldBounds(){const t=this.screenToWorldCoordinates(p.Zero),e=t.x+this.drawWidth,i=t.y+this.drawHeight;return new N(t.x,t.y,e,i)}get canvasWidth(){return this.canvas.width}get halfCanvasWidth(){return this.canvas.width/2}get canvasHeight(){return this.canvas.height}get halfCanvasHeight(){return this.canvas.height/2}get drawWidth(){return this._camera?this.resolution.width/this._camera.zoom:this.resolution.width}get halfDrawWidth(){return this.drawWidth/2}get drawHeight(){return this._camera?this.resolution.height/this._camera.zoom:this.resolution.height}get halfDrawHeight(){return this.drawHeight/2}get center(){return m(this.halfDrawWidth,this.halfDrawHeight)}get contentArea(){return this._contentArea}_computeFit(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=this.aspectRatio;let e=0,i=0;window.innerWidth/t<window.innerHeight?(e=window.innerWidth,i=window.innerWidth/t):(e=window.innerHeight*t,i=window.innerHeight),this.viewport={width:e,height:i},this._contentArea=N.fromDimension(this.resolution.width,this.resolution.height,p.Zero)}_computeFitScreenAndFill(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=window.innerWidth,e=window.innerHeight;this._computeFitAndFill(t,e)}_computeFitContainerAndFill(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=this.canvas.parentElement,e=t.clientWidth,i=t.clientHeight;this._computeFitAndFill(e,i)}_computeFitAndFill(t,e){if(this.viewport={width:t,height:e},t/e<=this._contentResolution.width/this._contentResolution.height){this.resolution={width:t*this._contentResolution.width/t,height:t*this._contentResolution.width/t*e/t};const i=(this.resolution.height-this._contentResolution.height)/2;this._contentArea=new N({top:i,left:0,right:this._contentResolution.width,bottom:this.resolution.height-i})}else{this.resolution={width:e*this._contentResolution.height/e*t/e,height:e*this._contentResolution.height/e};const i=(this.resolution.width-this._contentResolution.width)/2;this._contentArea=new N({top:0,left:i,right:this.resolution.width-i,bottom:this._contentResolution.height})}}_computeFitScreenAndZoom(){document.body.style.margin="0px",document.body.style.overflow="hidden",this.canvas.style.position="absolute";const t=window.innerWidth,e=window.innerHeight;this._computeFitAndZoom(t,e)}_computeFitContainerAndZoom(){document.body.style.margin="0px",document.body.style.overflow="hidden",this.canvas.style.position="absolute";const t=this.canvas.parentElement;t.style.position="relative",t.style.overflow="hidden";const e=t.clientWidth,i=t.clientHeight;this._computeFitAndZoom(e,i)}_computeFitAndZoom(t,e){const i=this.aspectRatio;let n=0,o=0;t/i<e?(n=t,o=t/i):(n=e*i,o=e);const h=t/n,d=e/o,u=Math.max(h,d),x=n*u,Q=o*u;x>t?this.canvas.style.left=-(x-t)/2+"px":this.canvas.style.left="",Q>e?this.canvas.style.top=-(Q-e)/2+"px":this.canvas.style.top="",this.viewport={width:x,height:Q};const J=N.fromDimension(this.viewport.width,this.viewport.height,p.Zero);if(this.viewport.width>t){const et=(this.viewport.width-t)/this.viewport.width*this.resolution.width;J.top=0,J.left=et/2,J.right=this.resolution.width-et/2,J.bottom=this.resolution.height}if(this.viewport.height>e){const et=(this.viewport.height-e)/this.viewport.height*this.resolution.height;J.top=et/2,J.left=0,J.bottom=this.resolution.height-et/2,J.right=this.resolution.width}this._contentArea=J}_computeFitContainer(){const t=this.aspectRatio;let e=0,i=0;const n=this.canvas.parentElement;n.clientWidth/t<n.clientHeight?(e=n.clientWidth,i=n.clientWidth/t):(e=n.clientHeight*t,i=n.clientHeight),this.viewport={width:e,height:i},this._contentArea=N.fromDimension(this.resolution.width,this.resolution.height,p.Zero)}_applyDisplayMode(){this._setResolutionAndViewportByDisplayMode(this.parent),this.parent instanceof Window?this._browser.window.on("resize",this._resizeHandler):(this._resizeObserver=new ResizeObserver(()=>{this._resizeHandler()}),this._resizeObserver.observe(this.parent)),this.parent.addEventListener("resize",this._resizeHandler)}_setResolutionAndViewportByDisplayMode(t){this.displayMode===re.FillContainer&&(this.resolution={width:t.clientWidth,height:t.clientHeight},this.viewport=this.resolution),this.displayMode===re.FillScreen&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.resolution={width:t.innerWidth,height:t.innerHeight},this.viewport=this.resolution),this.displayMode===re.FitScreen&&this._computeFit(),this.displayMode===re.FitContainer&&this._computeFitContainer(),this.displayMode===re.FitScreenAndFill&&this._computeFitScreenAndFill(),this.displayMode===re.FitContainerAndFill&&this._computeFitContainerAndFill(),this.displayMode===re.FitScreenAndZoom&&this._computeFitScreenAndZoom(),this.displayMode===re.FitContainerAndZoom&&this._computeFitContainerAndZoom()}}class Ki{static create(){return this._INSTANCE||(window.AudioContext||window.webkitAudioContext)&&(this._INSTANCE=new AudioContext),this._INSTANCE}}Ki._INSTANCE=null;function Io(a){return!!a.playbackState}class Ji{static unlock(){return new Promise((e,i)=>{if(Ji._UNLOCKED||!Ki.create())return e(!0);const n=setTimeout(()=>{v.getInstance().warn("Excalibur was unable to unlock the audio context, audio probably will not play in this browser."),e(!1)},200),o=Ki.create();o.resume().then(()=>{const h=o.createBuffer(1,1,22050),d=o.createBufferSource();let u=!1;d.buffer=h,d.connect(o.destination),d.onended=()=>u=!0,d.start(0),setTimeout(()=>{Io(d)?(d.playbackState===d.PLAYING_STATE||d.playbackState===d.FINISHED_STATE)&&(Ji._UNLOCKED=!0):(o.currentTime>0||u)&&(Ji._UNLOCKED=!0)},0),clearTimeout(n),e(!0)},()=>{i()})})}static isUnlocked(){return this._UNLOCKED}}Ji._UNLOCKED=!1;class We{constructor(){this.eventDispatcher=new Bi}on(t,e){this.eventDispatcher.on(t,e)}off(t,e){this.eventDispatcher.off(t,e)}emit(t,e){this.eventDispatcher.emit(t,e)}once(t,e){this.eventDispatcher.once(t,e)}}function $n(a,t=I.Red,e,i,n,o,h=1,d="butt"){a.save(),a.beginPath(),a.lineWidth=h,a.lineCap=d,a.strokeStyle=t.toString(),a.moveTo(e,i),a.lineTo(n,o),a.closePath(),a.stroke(),a.restore()}function Eo(a,t=I.Red,e){a.beginPath(),a.strokeStyle=t.toString(),a.arc(e.x,e.y,5,0,Math.PI*2),a.closePath(),a.stroke()}function Bo(a,t,e,i,n=1){const o=t?t.toString():"blue",h=i.scale(n);a.beginPath(),a.strokeStyle=o,a.moveTo(e.x,e.y),a.lineTo(e.x+h.x,e.y+h.y),a.closePath(),a.stroke()}function fn(a,t,e,i,n,o=5,h=I.White,d=null){let u;if(typeof o=="number")u={tl:o,tr:o,br:o,bl:o};else{const x={tl:0,tr:0,br:0,bl:0};for(const Q in x)if(x.hasOwnProperty(Q)){const J=Q;u[J]=o[J]||x[J]}}a.beginPath(),a.moveTo(t+u.tl,e),a.lineTo(t+i-u.tr,e),a.quadraticCurveTo(t+i,e,t+i,e+u.tr),a.lineTo(t+i,e+n-u.br),a.quadraticCurveTo(t+i,e+n,t+i-u.br,e+n),a.lineTo(t+u.bl,e+n),a.quadraticCurveTo(t,e+n,t,e+n-u.bl),a.lineTo(t,e+u.tl),a.quadraticCurveTo(t,e,t+u.tl,e),a.closePath(),d&&(a.fillStyle=d.toString(),a.fill()),h&&(a.strokeStyle=h.toString(),a.stroke())}function fi(a,t,e,i,n=I.White,o=null){a.beginPath(),a.arc(t,e,i,0,Math.PI*2),a.closePath(),o&&(a.fillStyle=o.toString(),a.fill()),n&&(a.strokeStyle=n.toString(),a.stroke())}const Lr="data:image/png;base64,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";var So=pe(1388);class ce extends Be{constructor(t){var e,i,n,o,h,d,u,x,Q,J;super(t),this.filtering=null,this.lineCap="butt",this.quality=1,this._dirty=!0,this._smoothing=!1,this._color=ki(I.Black,()=>this.flagDirty()),this._lineWidth=1,this._lineDash=[],this._padding=0,t&&(this.quality=(e=t.quality)!==null&&e!==void 0?e:this.quality,this.color=(i=t.color)!==null&&i!==void 0?i:I.Black,this.strokeColor=t==null?void 0:t.strokeColor,this.smoothing=(n=t.smoothing)!==null&&n!==void 0?n:this.smoothing,this.lineWidth=(o=t.lineWidth)!==null&&o!==void 0?o:this.lineWidth,this.lineDash=(h=t.lineDash)!==null&&h!==void 0?h:this.lineDash,this.lineCap=(d=t.lineCap)!==null&&d!==void 0?d:this.lineCap,this.padding=(u=t.padding)!==null&&u!==void 0?u:this.padding,this.filtering=(x=t.filtering)!==null&&x!==void 0?x:this.filtering),this._bitmap=document.createElement("canvas");const et=(Q=t==null?void 0:t.width)!==null&&Q!==void 0?Q:this._bitmap.width,dt=(J=t==null?void 0:t.height)!==null&&J!==void 0?J:this._bitmap.height;this.width=et,this.height=dt;const ft=this._bitmap.getContext("2d");if(ft)this._ctx=ft;else throw new Error("Browser does not support 2d canvas drawing, cannot create Raster graphic")}cloneRasterOptions(){return{color:this.color?this.color.clone():null,strokeColor:this.strokeColor?this.strokeColor.clone():null,smoothing:this.smoothing,lineWidth:this.lineWidth,lineDash:this.lineDash,lineCap:this.lineCap,quality:this.quality,padding:this.padding}}get dirty(){return this._dirty}flagDirty(){this._dirty=!0}get width(){return Math.abs(this._getTotalWidth()*this.scale.x)}set width(t){t/=Math.abs(this.scale.x),this._bitmap.width=t,this._originalWidth=t,this.flagDirty()}get height(){return Math.abs(this._getTotalHeight()*this.scale.y)}set height(t){t/=Math.abs(this.scale.y),this._bitmap.height=t,this._originalHeight=t,this.flagDirty()}_getTotalWidth(){var t;return(((t=this._originalWidth)!==null&&t!==void 0?t:this._bitmap.width)+this.padding*2)*1}_getTotalHeight(){var t;return(((t=this._originalHeight)!==null&&t!==void 0?t:this._bitmap.height)+this.padding*2)*1}get localBounds(){return N.fromDimension(this._getTotalWidth()*this.scale.x,this._getTotalHeight()*this.scale.y,p.Zero)}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this.flagDirty()}get color(){return this._color}set color(t){this.flagDirty(),this._color=ki(t,()=>this.flagDirty())}get strokeColor(){return this._strokeColor}set strokeColor(t){this.flagDirty(),this._strokeColor=ki(t,()=>this.flagDirty())}get lineWidth(){return this._lineWidth}set lineWidth(t){this._lineWidth=t,this.flagDirty()}get lineDash(){return this._lineDash}set lineDash(t){this._lineDash=t,this.flagDirty()}get padding(){return this._padding}set padding(t){this._padding=t,this.flagDirty()}rasterize(){this._dirty=!1,this._ctx.clearRect(0,0,this._getTotalWidth(),this._getTotalHeight()),this._ctx.save(),this._applyRasterProperties(this._ctx),this.execute(this._ctx),this._ctx.restore(),Xt.load(this._bitmap,this.filtering,!0)}_applyRasterProperties(t){var e,i,n;this._bitmap.width=this._getTotalWidth()*this.quality,this._bitmap.height=this._getTotalHeight()*this.quality,t.scale(this.quality,this.quality),t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash((e=this.lineDash)!==null&&e!==void 0?e:t.getLineDash()),t.lineCap=this.lineCap,t.strokeStyle=(i=this.strokeColor)===null||i===void 0?void 0:i.toString(),t.fillStyle=(n=this.color)===null||n===void 0?void 0:n.toString()}_drawImage(t,e,i){this._dirty&&this.rasterize(),t.scale(1/this.quality,1/this.quality),t.drawImage(this._bitmap,e,i)}}class _n extends ce{constructor(t){super(t),this._options=t}get ctx(){return this._ctx}clone(){return new _n({...this._options,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){var e,i;!((e=this._options)===null||e===void 0)&&e.draw&&((i=this._options)===null||i===void 0||i.draw(t)),this._options.cache||this.flagDirty()}}class us{}us.type={any:"",blob:"blob",json:"json",text:"text",document:"document",arraybuffer:"arraybuffer"};class zs{constructor(){this.states=new Map}get currentState(){return this._currentState}set currentState(t){this._currentState=t}static create(t,e){const i=new zs;i.data=e;for(const n in t.states)i.states.set(n,{name:n,...t.states[n]});for(const n of i.states.values())for(const o of n.transitions)if(o!=="*"&&!i.states.has(o))throw Error(`Invalid state machine, state [${n.name}] has a transition to another state that doesn't exist [${o}]`);return i.currentState=i.startState=i.states.get(t.start),i}in(t){return this.currentState.name===t}go(t,e){var i,n;if(this.currentState.transitions.includes(t)||this.currentState.transitions.includes("*")){const o=this.states.get(t);return this.currentState.onExit&&((i=this.currentState)===null||i===void 0?void 0:i.onExit({to:o.name,data:this.data}))===!1||o!=null&&o.onEnter&&(o==null?void 0:o.onEnter({from:this.currentState.name,eventData:e,data:this.data}))===!1?!1:(this.currentState=o,!((n=this.currentState)===null||n===void 0)&&n.onState&&this.currentState.onState(),!0)}return!1}update(t){this.currentState.onUpdate&&this.currentState.onUpdate(this.data,t)}save(t){localStorage.setItem(t,JSON.stringify({currentState:this.currentState.name,data:this.data}))}restore(t){const e=JSON.parse(localStorage.getItem(t));this.currentState=this.states.get(e.currentState),this.data=e.data}}class mn{constructor(t){this._src=t,this._audioContext=Ki.create(),this._volumeNode=this._audioContext.createGain(),this._playingPromise=new Promise(e=>{this._playingResolve=e}),this._stateMachine=zs.create({start:"STOPPED",states:{PLAYING:{onEnter:({data:e})=>{this._createNewBufferSource(),this._handleEnd(),this._instance.start(0,e.pausedAt*this._playbackRate,this.duration),e.startedAt=this._audioContext.currentTime-e.pausedAt,e.pausedAt=0},onState:()=>this._playStarted(),onExit:({to:e})=>{e==="STOPPED"&&this._playingResolve(!0),this._instance.onended=null,this._instance.disconnect(),this._instance.stop(0),this._instance=null},transitions:["STOPPED","PAUSED","SEEK"]},SEEK:{onEnter:({eventData:e,data:i})=>{i.pausedAt=(e??0)/this._playbackRate,i.startedAt=0},transitions:["*"]},STOPPED:{onEnter:({data:e})=>{e.pausedAt=0,e.startedAt=0,this._playingResolve(!0)},transitions:["PLAYING","PAUSED","SEEK"]},PAUSED:{onEnter:({data:e})=>{e.pausedAt=this._audioContext.currentTime-e.startedAt},transitions:["PLAYING","STOPPED","SEEK"]}}},{startedAt:0,pausedAt:0}),this._volume=1,this._loop=!1,this._playStarted=()=>{},this._playbackRate=1,this._createNewBufferSource()}_createNewBufferSource(){this._instance=this._audioContext.createBufferSource(),this._instance.buffer=this._src,this._instance.loop=this.loop,this._instance.playbackRate.value=this._playbackRate,this._instance.connect(this._volumeNode),this._volumeNode.connect(this._audioContext.destination)}_handleEnd(){this.loop||(this._instance.onended=()=>{this._playingResolve(!0)})}set loop(t){this._loop=t,this._instance&&(this._instance.loop=t,this.loop||(this._instance.onended=()=>{this._playingResolve(!0)}))}get loop(){return this._loop}set volume(t){t=y(t,0,1),this._volume=t,this._stateMachine.in("PLAYING")&&this._volumeNode.gain.setTargetAtTime?this._volumeNode.gain.setTargetAtTime(t,this._audioContext.currentTime,.1):this._volumeNode.gain.value=t}get volume(){return this._volume}get duration(){var t;return(t=this._duration)!==null&&t!==void 0?t:this.getTotalPlaybackDuration()}set duration(t){this._duration=t}isPlaying(){return this._stateMachine.in("PLAYING")}isPaused(){return this._stateMachine.in("PAUSED")||this._stateMachine.in("SEEK")}play(t=()=>{}){return this._playStarted=t,this._stateMachine.go("PLAYING"),this._playingPromise}pause(){this._stateMachine.go("PAUSED")}stop(){this._stateMachine.go("STOPPED")}seek(t){this._stateMachine.go("PAUSED"),this._stateMachine.go("SEEK",t)}getTotalPlaybackDuration(){return this._src.duration}getPlaybackPosition(){const{pausedAt:t,startedAt:e}=this._stateMachine.data;return t?t*this._playbackRate:e?(this._audioContext.currentTime-e)*this._playbackRate:0}set playbackRate(t){this._instance.playbackRate.value=this._playbackRate=t}get playbackRate(){return this._instance.playbackRate.value}}class vn extends tt{constructor(t,e="MediaEvent"){super(),this.target=t,this._name=e}set bubbles(t){}get bubbles(){return!1}get _path(){return null}set _path(t){}stopPropagation(){}action(){}propagate(){}layPath(t){}}class Qi extends vn{constructor(t,e){super(t,"NativeSoundEvent"),this.track=e}}class Nr extends vn{constructor(t,e){super(t,"NativeSoundProcessedEvent"),this._processedData=e,this.data=this._processedData}}function Vs(a){try{const t=new Audio,e=/.*\.([A-Za-z0-9]+)$/,i=a.match(e)[1];return!!t.canPlayType("audio/"+i)}catch(t){return v.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",t),!1}}class Re extends We{constructor(...t){super(),this.logger=v.getInstance(),this._loop=!1,this._volume=1,this._isStopped=!1,this._tracks=[],this._wasPlayingOnHidden=!1,this._playbackRate=1,this._audioContext=Ki.create(),this._resource=new Si("",us.type.arraybuffer);for(const e of t)if(Vs(e)){this.path=e;break}this.path||(this.logger.warn("This browser does not support any of the audio files specified:",t.join(", ")),this.logger.warn("Attempting to use",t[0]),this.path=t[0])}set loop(t){this._loop=t;for(const e of this._tracks)e.loop=this._loop;this.logger.debug("Set loop for all instances of sound",this.path,"to",this._loop)}get loop(){return this._loop}set volume(t){this._volume=t;for(const e of this._tracks)e.volume=this._volume;this.emit("volumechange",new Qi(this)),this.logger.debug("Set loop for all instances of sound",this.path,"to",this._volume)}get volume(){return this._volume}get duration(){return this._duration}set duration(t){this._duration=t}get instances(){return this._tracks}get path(){return this._resource.path}set path(t){this._resource.path=t}isLoaded(){return!!this.data}async load(){var t,e;if(this.data)return this.data;const i=await this._resource.load(),n=await this.decodeAudio(i.slice(0));return this._duration=(e=(t=this._duration)!==null&&t!==void 0?t:n==null?void 0:n.duration)!==null&&e!==void 0?e:void 0,this.emit("processed",new Nr(this,n)),this.data=n}async decodeAudio(t){try{return await this._audioContext.decodeAudioData(t.slice(0))}catch{return this.logger.error("Unable to decode  this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file."),await Promise.reject()}}wireEngine(t){t&&(this._engine=t,this._engine.on("hidden",()=>{t.pauseAudioWhenHidden&&this.isPlaying()&&(this._wasPlayingOnHidden=!0,this.pause())}),this._engine.on("visible",()=>{t.pauseAudioWhenHidden&&this._wasPlayingOnHidden&&(this.play(),this._wasPlayingOnHidden=!1)}),this._engine.on("start",()=>{this._isStopped=!1}),this._engine.on("stop",()=>{this.stop(),this._isStopped=!0}))}instanceCount(){return this._tracks.length}isPlaying(){return this._tracks.some(t=>t.isPlaying())}isPaused(){return this._tracks.some(t=>t.isPaused())}play(t){return this.isLoaded()?this._isStopped?(this.logger.warn("Cannot start playing. Engine is in a stopped state."),Promise.resolve(!1)):(this.volume=t||this.volume,this.isPaused()?this._resumePlayback():this._startPlayback()):(this.logger.warn("Cannot start playing. Resource",this.path,"is not loaded yet"),Promise.resolve(!0))}pause(){if(this.isPlaying()){for(const t of this._tracks)t.pause();this.emit("pause",new Qi(this)),this.logger.debug("Paused all instances of sound",this.path)}}stop(){for(const t of this._tracks)t.stop();this.emit("stop",new Qi(this)),this._tracks.length=0,this.logger.debug("Stopped all instances of sound",this.path)}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._tracks.forEach(e=>{e.playbackRate=this._playbackRate})}seek(t,e=0){this._tracks.length===0&&this._getTrackInstance(this.data),this._tracks[e].seek(t)}getTotalPlaybackDuration(){return this.data.duration}getPlaybackPosition(t=0){return this._tracks.length?this._tracks[t].getPlaybackPosition():0}getTrackId(t){return this._tracks.indexOf(t)}async _resumePlayback(){if(this.isPaused){const t=[];for(const e of this._tracks)t.push(e.play().then(()=>(this.emit("playbackend",new Qi(this,e)),this._tracks.splice(this.getTrackId(e),1),!0)));this.emit("resume",new Qi(this)),this.logger.debug("Resuming paused instances for sound",this.path,this._tracks),await Promise.all(t)}return!0}async _startPlayback(){const t=await this._getTrackInstance(this.data),e=await t.play(()=>{this.emit("playbackstart",new Qi(this,t)),this.logger.debug("Playing new instance for sound",this.path)});return this.emit("playbackend",new Qi(this,t)),this._tracks.splice(this.getTrackId(t),1),e}_getTrackInstance(t){const e=new mn(t);return e.loop=this.loop,e.volume=this.volume,e.duration=this.duration,e.playbackRate=this._playbackRate,this._tracks.push(e),e}}class ps extends We{constructor(t){super(),this.canvas=new _n({filtering:xe.Blended,smoothing:!0,cache:!0,draw:this.draw.bind(this)}),this._resourceList=[],this._index=0,this._playButtonShown=!1,this._resourceCount=0,this._numLoaded=0,this._progressCounts={},this._totalCounts={},this.logo=Lr,this.logoWidth=468,this.logoHeight=118,this.loadingBarColor=I.White,this.backgroundColor="#176BAA",this.suppressPlayButton=!1,this._playButtonStyles=So.Z.toString(),this.playButtonText="Play game",this.startButtonFactory=()=>{let e=document.getElementById("excalibur-play");return e||(e=document.createElement("button")),e.id="excalibur-play",e.textContent=this.playButtonText,e.style.display="none",e},this._loadingFuture=new _,t&&this.addResources(t)}get _image(){return this._imageElement||(this._imageElement=new Image,this._imageElement.src=this.logo),this._imageElement}get playButtonRootElement(){return this._playButtonRootElement}get playButtonElement(){return this._playButtonElement}get _playButton(){const t=document.getElementById("excalibur-play-root");return t&&(this._playButtonRootElement=t),this._playButtonRootElement||(this._playButtonRootElement=document.createElement("div"),this._playButtonRootElement.id="excalibur-play-root",this._playButtonRootElement.style.position="absolute",document.body.appendChild(this._playButtonRootElement)),this._styleBlock||(this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._playButtonStyles,document.head.appendChild(this._styleBlock)),this._playButtonElement||(this._playButtonElement=this.startButtonFactory(),this._playButtonRootElement.appendChild(this._playButtonElement)),this._playButtonElement}wireEngine(t){this._engine=t,this.canvas.width=this._engine.canvas.width,this.canvas.height=this._engine.canvas.height}addResource(t){const e=this._index++;this._resourceList.push(t),this._progressCounts[e]=0,this._totalCounts[e]=1,this._resourceCount++}addResources(t){let e=0;const i=t.length;for(e;e<i;e++)this.addResource(t[e])}isLoaded(){return this._numLoaded===this._resourceCount}async showPlayButton(){var t,e;if(this.suppressPlayButton)this.hidePlayButton(),await mt(500,(t=this._engine)===null||t===void 0?void 0:t.clock);else{const i=()=>{this._positionPlayButton()};return!((e=this._engine)===null||e===void 0)&&e.browser&&this._engine.browser.window.on("resize",i),this._playButtonShown=!0,this._playButton.style.display="block",document.body.addEventListener("keyup",o=>{o.key==="Enter"&&this._playButton.click()}),this._positionPlayButton(),await new Promise(o=>{const h=d=>{var u;d.stopPropagation(),this.hidePlayButton(),!((u=this._engine)===null||u===void 0)&&u.browser&&this._engine.browser.window.off("resize",i),o()};this._playButton.addEventListener("click",h),this._playButton.addEventListener("touchend",h),this._playButton.addEventListener("pointerup",h)})}}hidePlayButton(){this._playButtonShown=!1,this._playButton.style.display="none"}dispose(){this._playButtonRootElement.parentElement&&(this._playButtonRootElement.removeChild(this._playButtonElement),document.body.removeChild(this._playButtonRootElement),document.head.removeChild(this._styleBlock),this._playButtonRootElement=null,this._playButtonElement=null,this._styleBlock=null)}update(t,e){}areResourcesLoaded(){return this._loadingFuture.promise}async load(){var t,e;await((t=this._image)===null||t===void 0?void 0:t.decode()),this.canvas.flagDirty(),await Promise.all(this._resourceList.map(async i=>{await i.load().finally(()=>{this._numLoaded++,this.canvas.flagDirty()})}));for(const i of this._resourceList)i instanceof Re&&i.wireEngine(this._engine);return this._loadingFuture.resolve(),await mt(200,(e=this._engine)===null||e===void 0?void 0:e.clock),this.canvas.flagDirty(),await this.showPlayButton(),await Ji.unlock(),this.data=this._resourceList}markResourceComplete(){this._numLoaded++}get progress(){return this._resourceCount>0?y(this._numLoaded,0,this._resourceCount)/this._resourceCount:1}_positionPlayButton(){if(this._engine){const t=this._engine.screen.viewport.height,e=this._engine.screen.viewport.width;if(this._playButtonRootElement){const i=this._engine.canvas.offsetLeft,n=this._engine.canvas.offsetTop,o=this._playButton.clientWidth,h=this._playButton.clientHeight;this.playButtonPosition?(this._playButtonRootElement.style.left=`${this.playButtonPosition.x}px`,this._playButtonRootElement.style.top=`${this.playButtonPosition.y}px`):(this._playButtonRootElement.style.left=`${i+e/2-o/2}px`,this._playButtonRootElement.style.top=`${n+t/2-h/2+100}px`)}}}draw(t){const e=this._engine.canvasHeight/this._engine.pixelRatio,i=this._engine.canvasWidth/this._engine.pixelRatio;this._positionPlayButton(),t.fillStyle=this.backgroundColor,t.fillRect(0,0,i,e);let n=e/2;const o=Math.min(this.logoWidth,i*.75);let h=i/2-o/2;this.logoPosition&&(h=this.logoPosition.x,n=this.logoPosition.y);const d=Math.floor(o*(this.logoHeight/this.logoWidth)),u=this._engine.getAntialiasing();if(this._engine.setAntialiasing(!0),this.logoPosition?t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,h,n,o,d):t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,h,n-d-20,o,d),!this.suppressPlayButton&&this._playButtonShown){this._engine.setAntialiasing(u);return}let x=h,Q=n;this.loadingBarPosition&&(x=this.loadingBarPosition.x,Q=this.loadingBarPosition.y),t.lineWidth=2,fn(t,x,Q,o,20,10,this.loadingBarColor);const J=o*this.progress,et=5,dt=J-et*2,ft=20-et*2;fn(t,x+et,Q+et,dt>10?dt:10,ft,5,null,this.loadingBarColor),this._engine.setAntialiasing(u)}}const di={webgl:"WebGL",webaudio:"WebAudio",gamepadapi:"Gamepad API"};class tr{constructor(){this._features=null,this.failedTests=[],this._criticalTests={canvasSupport:function(){const t=document.createElement("canvas");return!!(t.getContext&&t.getContext("2d"))},arrayBufferSupport:function(){const t=new XMLHttpRequest;t.open("GET","/");try{t.responseType="arraybuffer"}catch{return!1}return t.responseType==="arraybuffer"},dataUrlSupport:function(){return document.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")===0},objectUrlSupport:function(){return"URL"in window&&"revokeObjectURL"in URL&&"createObjectURL"in URL},rgbaSupport:function(){const t=document.createElement("a").style;return t.cssText="background-color:rgba(150,255,150,.5)",(""+t.backgroundColor).indexOf("rgba")>-1}},this._warningTest={webAudioSupport:function(){return!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext)},webglSupport:function(){const t=document.createElement("canvas");return!!(t.getContext&&t.getContext("webgl"))}},this._features=this._loadBrowserFeatures()}getBrowserFeatures(){return this._features===null&&(this._features=this._loadBrowserFeatures()),this._features}logBrowserFeatures(){let t=`%cSUPPORTED BROWSER FEATURES
==========================%c
`;const e=["font-weight: bold; color: navy","font-weight: normal; color: inherit"],i=this.getBrowserFeatures();for(const n of Object.keys(di))i[n]?(t+="(%c✓%c)",e.push("font-weight: bold; color: green"),e.push("font-weight: normal; color: inherit")):(t+="(%c✗%c)",e.push("font-weight: bold; color: red"),e.push("font-weight: normal; color: inherit")),t+=" "+di[n]+`
`;e.unshift(t),console.log.apply(console,e)}_loadBrowserFeatures(){return{canvas:(()=>this._criticalTests.canvasSupport())(),arraybuffer:(()=>this._criticalTests.arrayBufferSupport())(),dataurl:(()=>this._criticalTests.dataUrlSupport())(),objecturl:(()=>this._criticalTests.objectUrlSupport())(),rgba:(()=>this._criticalTests.rgbaSupport())(),webaudio:(()=>this._warningTest.webAudioSupport())(),webgl:(()=>this._warningTest.webglSupport())(),gamepadapi:(()=>!!navigator.getGamepads)()}}test(){let t=!1;for(const e in this._criticalTests)this._criticalTests[e].call(this)||(this.failedTests.push(e),v.getInstance().error("Critical browser feature missing, Excalibur requires:",e),t=!0);if(t)return!1;for(const e in this._warningTest)this._warningTest[e]()||v.getInstance().warn("Warning browser feature missing, Excalibur will have reduced performance:",e);return!0}}var Gt;(function(a){a.PreventCollision="PreventCollision",a.Passive="Passive",a.Active="Active",a.Fixed="Fixed"})(Gt||(Gt={}));const Di=5,Zt={},Gr=()=>{for(const a in Zt)Zt[a]=0},de=(a,t)=>{const e=q.isEnabled("suppress-obsolete-message");Zt[a]<Di&&!e&&(v.getInstance().warn(a),console.trace&&t.showStackTrace&&console.trace()),Zt[a]++};function er(a){return a={message:"This feature will be removed in future versions of Excalibur.",alternateMethod:null,showStackTrace:!1,...a},function(t,e,i){if(i&&!(typeof i.value=="function"||typeof i.get=="function"||typeof i.set=="function"))throw new SyntaxError("Only classes/functions/getters/setters can be marked as obsolete");const o=`${`${t.name||""}${t.name&&e?".":""}${e||""}`} is marked obsolete: ${a.message}`+(a.alternateMethod?` Use ${a.alternateMethod} instead`:"");Zt[o]||(Zt[o]=0);const h=i?{...i}:t;if(!i){class d extends h{constructor(...x){de(o,a),super(...x)}}return d}return i&&i.value?(h.value=function(){return de(o,a),i.value.apply(this,arguments)},h):(i&&i.get&&(h.get=function(){return de(o,a),i.get.apply(this,arguments)}),i&&i.set&&(h.set=function(){return de(o,a),i.set.apply(this,arguments)}),h)}}var Ye=function(a,t,e,i){var n=arguments.length,o=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(a,t,e,i);else for(var d=a.length-1;d>=0;d--)(h=a[d])&&(o=(n<3?h(o):n>3?h(t,e,o):h(t,e))||o);return n>3&&o&&Object.defineProperty(t,e,o),o},Zi;(function(a){a.Arcade="arcade",a.Realistic="realistic"})(Zi||(Zi={}));var Ti;(function(a){a[a.DynamicAABBTree=0]="DynamicAABBTree"})(Ti||(Ti={}));var gs;(function(a){a[a.Euler=0]="Euler"})(gs||(gs={}));class Ft{static get gravity(){return Ft.acc}static set gravity(t){Ft.acc=t}static useArcadePhysics(){Ft.collisionResolutionStrategy=Zi.Arcade}static useRealisticPhysics(){Ft.collisionResolutionStrategy=Zi.Realistic}static get dynamicTreeVelocityMultiplyer(){return Ft.dynamicTreeVelocityMultiplier}static set dynamicTreeVelocityMultiplyer(t){Ft.dynamicTreeVelocityMultiplier=t}}Ft.acc=new p(0,0),Ft.enabled=!0,Ft.broadphaseStrategy=Ti.DynamicAABBTree,Ft.collisionResolutionStrategy=Zi.Arcade,Ft.defaultMass=10,Ft.integrator=gs.Euler,Ft.dynamicTreeVelocityMultiplier=2,Ft.boundsPadding=5,Ft.positionIterations=3,Ft.velocityIterations=8,Ft.slop=1,Ft.steeringFactor=.2,Ft.warmStart=!0,Ft.bodiesCanSleepByDefault=!1,Ft.surfaceEpsilon=.1,Ft.sleepEpsilon=.07,Ft.wakeThreshold=Ft.sleepEpsilon*3,Ft.sleepBias=.9,Ft.checkForFastBodies=!0,Ft.disableMinimumSpeedForFastBody=!1,Ye([er({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"dynamicTreeVelocityMultiplier"})],Ft,"dynamicTreeVelocityMultiplyer",null);var je;(function(a){a.World="world",a.Screen="screen"})(je||(je={}));class Os extends p{constructor(t){super(0,0),this._getX=t.getX,this._getY=t.getY,this._setX=t.setX,this._setY=t.setY}get x(){return this._x=this._getX()}set x(t){this._setX(t),this._x=t}get y(){return this._y=this._getY()}set y(t){this._setY(t),this._y=t}}class zr extends p{constructor(t,e){super(t.x,t.y),this.original=t,this.change=e}get x(){return this._x=this.original.x}set x(t){this.change(t,this._y),this._x=this.original.x=t}get y(){return this._y=this.original.y}set y(t){this.change(this._x,t),this._y=this.original.y=t}}class $i{constructor(){this._parent=null,this._children=[],this._pos=m(0,0),this._rotation=0,this._scale=m(1,1),this._isDirty=!1,this._isInverseDirty=!1,this._matrix=nt.identity(),this._inverse=nt.identity()}get parent(){return this._parent}set parent(t){if(this._parent){const e=this._parent._children.indexOf(this);e>-1&&this._parent._children.splice(e,1)}this._parent=t,this._parent&&this._parent._children.push(this),this.flagDirty()}get children(){return this._children}set pos(t){t.equals(this._pos)||(this._pos.x=t.x,this._pos.y=t.y,this.flagDirty())}get pos(){return new zr(this._pos,(t,e)=>{(t!==this._pos.x||e!==this._pos.y)&&this.flagDirty()})}set globalPos(t){let e=t.clone();this.parent&&(e=this.parent.inverse.multiply(t)),e.equals(this._pos)||(this._pos=e,this.flagDirty())}get globalPos(){return new Os({getX:()=>this.matrix.data[4],getY:()=>this.matrix.data[5],setX:t=>{if(this.parent){const{x:e}=this.parent.inverse.multiply(m(t,this.pos.y));this.pos.x=e}else this.pos.x=t;t!==this.matrix.data[4]&&this.flagDirty()},setY:t=>{if(this.parent){const{y:e}=this.parent.inverse.multiply(m(this.pos.x,t));this.pos.y=e}else this.pos.y=t;t!==this.matrix.data[5]&&this.flagDirty()}})}set rotation(t){const e=P(t);e!==this._rotation&&this.flagDirty(),this._rotation=e}get rotation(){return this._rotation}set globalRotation(t){let e=0;this.parent&&(e=this.parent.globalRotation);const i=P(t+e);i!==this._rotation&&this.flagDirty(),this._rotation=i}get globalRotation(){return this.parent?this.matrix.getRotation():this.rotation}set scale(t){t.equals(this._scale)||(this._scale.x=t.x,this._scale.y=t.y,this.flagDirty())}get scale(){return new zr(this._scale,(t,e)=>{(t!==this._scale.x||e!==this._scale.y)&&this.flagDirty()})}set globalScale(t){let e=m(1,1);this.parent&&(e=this.parent.globalScale),this.scale=t.scale(m(1/e.x,1/e.y))}get globalScale(){return new Os({getX:()=>this.parent?this.matrix.getScaleX():this.scale.x,getY:()=>this.parent?this.matrix.getScaleY():this.scale.y,setX:t=>{if(this.parent){const e=this.parent.globalScale.x;this.scale.x=t/e}else this.scale.x=t},setY:t=>{if(this.parent){const e=this.parent.globalScale.y;this.scale.y=t/e}else this.scale.y=t}})}get matrix(){return this._isDirty&&(this.parent===null?this._matrix=this._calculateMatrix():this._matrix=this.parent.matrix.multiply(this._calculateMatrix()),this._isDirty=!1),this._matrix}get inverse(){return this._isInverseDirty&&(this._inverse=this.matrix.inverse(),this._isInverseDirty=!1),this._inverse}_calculateMatrix(){return nt.identity().translate(this.pos.x,this.pos.y).rotate(this.rotation).scale(this.scale.x,this.scale.y)}flagDirty(){this._isDirty=!0,this._isInverseDirty=!0;for(let t=0;t<this._children.length;t++)this._children[t].flagDirty()}apply(t){return this.matrix.multiply(t)}applyInverse(t){return this.inverse.multiply(t)}setTransform(t,e,i){this._pos.x=t.x,this._pos.y=t.y,this._rotation=P(e),this._scale.x=i.x,this._scale.y=i.y,this.flagDirty()}clone(t){const e=t??new $i;this._pos.clone(e._pos),e._rotation=this._rotation,this._scale.clone(e._scale),e.flagDirty()}}function Hs(a){return!!(a!=null&&a.clone)}class Se{constructor(){this.owner=null}clone(){const t=new this.constructor;for(const e in this)if(this.hasOwnProperty(e)){const i=this[e];Hs(i)&&e!=="owner"&&e!=="clone"?t[e]=i.clone():t[e]=i}return t}}class wn extends Se{constructor(t,e){super(),this.type=t,this.value=e}}class Ie{constructor(){this.observers=[],this.subscriptions=[]}register(t){this.observers.push(t)}subscribe(t){this.subscriptions.push(t)}unregister(t){const e=this.observers.indexOf(t);e!==-1&&this.observers.splice(e,1)}unsubscribe(t){const e=this.subscriptions.indexOf(t);e!==-1&&this.subscriptions.splice(e,1)}notifyAll(t){const e=this.observers.length;for(let n=0;n<e;n++)this.observers[n].notify(t);const i=this.subscriptions.length;for(let n=0;n<i;n++)this.subscriptions[n](t)}clear(){this.observers.length=0,this.subscriptions.length=0}}class Pt extends Se{constructor(){super(...arguments),this.type="ex.transform",this._transform=new $i,this._addChildTransform=t=>{const e=t.get(Pt);e&&(e._transform.parent=this._transform)},this.zIndexChanged$=new Ie,this._z=0,this.coordPlane=je.World}get(){return this._transform}onAdd(t){for(const e of t.children)this._addChildTransform(e);t.childrenAdded$.subscribe(e=>this._addChildTransform(e)),t.childrenRemoved$.subscribe(e=>{const i=e.get(Pt);i&&(i._transform.parent=null)})}onRemove(t){this._transform.parent=null}get z(){return this._z}set z(t){const e=this._z;this._z=t,e!==t&&this.zIndexChanged$.notifyAll(t)}get pos(){return this._transform.pos}set pos(t){this._transform.pos=t}get globalPos(){return this._transform.globalPos}set globalPos(t){this._transform.globalPos=t}get rotation(){return this._transform.rotation}set rotation(t){this._transform.rotation=t}get globalRotation(){return this._transform.globalRotation}set globalRotation(t){this._transform.globalRotation=t}get scale(){return this._transform.scale}set scale(t){this._transform.scale=t}get globalScale(){return this._transform.globalScale}set globalScale(t){this._transform.globalScale=t}applyInverse(t){return this._transform.applyInverse(t)}apply(t){return this._transform.apply(t)}}class ie extends Se{constructor(){super(...arguments),this.type="ex.motion",this.vel=p.Zero,this.acc=p.Zero,this.scaleFactor=p.Zero,this.angularVelocity=0,this.torque=0,this.inertia=1}}class ni{constructor(t,e,i){this._name=t,this._category=e,this._mask=i}get name(){return this._name}get category(){return this._category}get mask(){return this._mask}canCollide(t){return(this.category&t.mask)!==0&&(t.category&this.mask)!==0}invert(){return new ni("~("+this.name+")",~this.category,~this.mask)}static combine(t){const e=t.map(o=>o.name).join("+"),i=t.reduce((o,h)=>h.category|o,0),n=~i;return new ni(e,i,n)}static collidesWith(t){return ni.combine(t).invert()}}ni.All=new ni("Collide with all groups",-1,-1);class ke{constructor(t,e){this.colliderA=t,this.colliderB=e,this.id=null,this.id=ke.calculatePairHash(t.id,e.id)}static canCollide(t,e){var i,n;const o=(i=t==null?void 0:t.owner)===null||i===void 0?void 0:i.get(Ht),h=(n=e==null?void 0:e.owner)===null||n===void 0?void 0:n.get(Ht);return!(t.id===e.id||t.owner&&e.owner&&t.owner.id===e.owner.id||t.localBounds.hasZeroDimensions()||e.localBounds.hasZeroDimensions()||!o||!h||!o.group.canCollide(h.group)||o.collisionType===Gt.Fixed&&h.collisionType===Gt.Fixed||h.collisionType===Gt.PreventCollision||o.collisionType===Gt.PreventCollision||!o.active||!h.active)}get canCollide(){const t=this.colliderA,e=this.colliderB;return ke.canCollide(t,e)}collide(){return this.colliderA.collide(this.colliderB)}hasCollider(t){return t===this.colliderA||t===this.colliderB}static calculatePairHash(t,e){return t.value<e.value?`#${t.value}+${e.value}`:`#${e.value}+${t.value}`}}class Ai{constructor(t,e){this.min=t,this.max=e}overlaps(t){return this.max>t.min&&t.max>this.min}getOverlap(t){return this.overlaps(t)?this.max>t.max?t.max-this.min:this.max-t.min:0}}class Fi{constructor(t){this.parent=t,this.parent=t||null,this.data=null,this.bounds=new N,this.left=null,this.right=null,this.height=0}isLeaf(){return!this.left&&!this.right}}class fs{constructor(t=new N(-Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)){this.worldBounds=t,this.root=null,this.nodes={}}_insert(t){if(this.root===null){this.root=t,this.root.parent=null;return}const e=t.bounds;let i=this.root;for(;!i.isLeaf();){const d=i.left,u=i.right,x=i.bounds.getPerimeter(),J=i.bounds.combine(e).getPerimeter(),et=2*J,dt=2*(J-x);let ft=0;const xt=e.combine(d.bounds);let It,ut;d.isLeaf()?ft=xt.getPerimeter()+dt:(ut=d.bounds.getPerimeter(),It=xt.getPerimeter(),ft=It-ut+dt);let pt=0;const Tt=e.combine(u.bounds);if(u.isLeaf()?pt=Tt.getPerimeter()+dt:(ut=u.bounds.getPerimeter(),It=Tt.getPerimeter(),pt=It-ut+dt),et<ft&&et<pt)break;ft<pt?i=d:i=u}const n=i.parent,o=new Fi(n);o.bounds=e.combine(i.bounds),o.height=i.height+1,n!==null?(n.left===i?n.left=o:n.right=o,o.left=i,o.right=t,i.parent=o,t.parent=o):(o.left=i,o.right=t,i.parent=o,t.parent=o,this.root=o);let h=t.parent;for(;h;){if(h=this._balance(h),!h.left)throw new Error("Parent of current leaf cannot have a null left child"+h);if(!h.right)throw new Error("Parent of current leaf cannot have a null right child"+h);h.height=1+Math.max(h.left.height,h.right.height),h.bounds=h.left.bounds.combine(h.right.bounds),h=h.parent}}_remove(t){if(t===this.root){this.root=null;return}const e=t.parent,i=e.parent;let n;if(e.left===t?n=e.right:n=e.left,i){i.left===e?i.left=n:i.right=n,n.parent=i;let o=i;for(;o;)o=this._balance(o),o.bounds=o.left.bounds.combine(o.right.bounds),o.height=1+Math.max(o.left.height,o.right.height),o=o.parent}else this.root=n,n.parent=null}trackCollider(t){const e=new Fi;e.data=t,e.bounds=t.bounds,e.bounds.left-=2,e.bounds.top-=2,e.bounds.right+=2,e.bounds.bottom+=2,this.nodes[t.id.value]=e,this._insert(e)}updateCollider(t){var e;const i=this.nodes[t.id.value];if(!i)return!1;const n=t.bounds;if(!this.worldBounds.contains(n))return v.getInstance().warn("Collider with id "+t.id.value+" is outside the world bounds and will no longer be tracked for physics"),this.untrackCollider(t),!1;if(i.bounds.contains(n))return!1;if(this._remove(i),n.left-=Ft.boundsPadding,n.top-=Ft.boundsPadding,n.right+=Ft.boundsPadding,n.bottom+=Ft.boundsPadding,t.owner){const o=(e=t.owner)===null||e===void 0?void 0:e.get(Ht);if(o){const h=o.vel.x*32/1e3*Ft.dynamicTreeVelocityMultiplier,d=o.vel.y*32/1e3*Ft.dynamicTreeVelocityMultiplier;h<0?n.left+=h:n.right+=h,d<0?n.top+=d:n.bottom+=d}}return i.bounds=n,this._insert(i),!0}untrackCollider(t){const e=this.nodes[t.id.value];e&&(this._remove(e),this.nodes[t.id.value]=null,delete this.nodes[t.id.value])}_balance(t){if(t===null)throw new Error("Cannot balance at null node");if(t.isLeaf()||t.height<2)return t;const e=t.left,i=t.right,n=t,o=e,h=i,d=e.left,u=e.right,x=i.left,Q=i.right,J=h.height-o.height;if(J>1)return h.left=n,h.parent=n.parent,n.parent=h,h.parent?h.parent.left===n?h.parent.left=h:h.parent.right=h:this.root=h,x.height>Q.height?(h.right=x,n.right=Q,Q.parent=n,n.bounds=o.bounds.combine(Q.bounds),h.bounds=n.bounds.combine(x.bounds),n.height=1+Math.max(o.height,Q.height),h.height=1+Math.max(n.height,x.height)):(h.right=Q,n.right=x,x.parent=n,n.bounds=o.bounds.combine(x.bounds),h.bounds=n.bounds.combine(Q.bounds),n.height=1+Math.max(o.height,x.height),h.height=1+Math.max(n.height,Q.height)),h;if(J<-1){if(o.left=n,o.parent=n.parent,n.parent=o,o.parent)if(o.parent.left===n)o.parent.left=o;else{if(o.parent.right!==n)throw"Error rotating Dynamic Tree";o.parent.right=o}else this.root=o;return d.height>u.height?(o.right=d,n.left=u,u.parent=n,n.bounds=h.bounds.combine(u.bounds),o.bounds=n.bounds.combine(d.bounds),n.height=1+Math.max(h.height,u.height),o.height=1+Math.max(n.height,d.height)):(o.right=u,n.left=d,d.parent=n,n.bounds=h.bounds.combine(d.bounds),o.bounds=n.bounds.combine(u.bounds),n.height=1+Math.max(h.height,d.height),o.height=1+Math.max(n.height,u.height)),o}return t}getHeight(){return this.root===null?0:this.root.height}query(t,e){const i=t.bounds,n=o=>{if(o&&o.bounds.overlaps(i))if(o.isLeaf()&&o.data!==t){if(e.call(t,o.data))return!0}else return n(o.left)||n(o.right);return!1};n(this.root)}rayCastQuery(t,e=1/0,i){const n=o=>{if(o&&o.bounds.rayCast(t,e))if(o.isLeaf()){if(i.call(t,o.data))return!0}else return n(o.left)||n(o.right);return!1};n(this.root)}getNodes(){const t=e=>e?[e].concat(t(e.left),t(e.right)):[];return t(this.root)}debug(t){const e=i=>{i&&(i.isLeaf()?i.bounds.draw(t,I.Green):i.bounds.draw(t,I.White),i.left&&e(i.left),i.right&&e(i.right))};e(this.root)}}class _i{constructor(t,e){this.pos=t,this.dir=e.normalize()}intersect(t){const e=t.begin.sub(this.pos);if(this.dir.cross(t.getSlope())===0&&e.cross(this.dir)!==0)return-1;const i=this.dir.cross(t.getSlope());if(i===0)return-1;const n=e.cross(t.getSlope())/i;if(n>=0){const o=e.cross(this.dir)/i/t.getLength();if(o>=0&&o<=1)return n}return-1}intersectPoint(t){const e=this.intersect(t);return e<0?null:this.getPoint(e)}getPoint(t){return this.pos.add(this.dir.scale(t))}}class ir{constructor(){this._dynamicCollisionTree=new fs,this._pairs=new Set,this._collisionPairCache=[],this._colliders=[]}getColliders(){return this._colliders}track(t){if(!t){v.getInstance().warn("Cannot track null collider");return}if(t instanceof Ae){const e=t.getColliders();for(const i of e)i.owner=t.owner,this._colliders.push(i),this._dynamicCollisionTree.trackCollider(i)}else this._colliders.push(t),this._dynamicCollisionTree.trackCollider(t)}untrack(t){if(!t){v.getInstance().warn("Cannot untrack a null collider");return}if(t instanceof Ae){const e=t.getColliders();for(const i of e){const n=this._colliders.indexOf(i);n!==-1&&this._colliders.splice(n,1),this._dynamicCollisionTree.untrackCollider(i)}}else{const e=this._colliders.indexOf(t);e!==-1&&this._colliders.splice(e,1),this._dynamicCollisionTree.untrackCollider(t)}}_pairExists(t,e){const i=ke.calculatePairHash(t.id,e.id);return this._pairs.has(i)}broadphase(t,e,i){const n=e/1e3,o=t.filter(d=>{var u,x;const Q=(u=d.owner)===null||u===void 0?void 0:u.get(Ht);return((x=d.owner)===null||x===void 0?void 0:x.active)&&Q.collisionType!==Gt.PreventCollision});this._collisionPairCache=[],this._pairs.clear();let h;for(let d=0,u=o.length;d<u;d++)h=o[d],this._dynamicCollisionTree.query(h,x=>{if(!this._pairExists(h,x)&&ke.canCollide(h,x)){const Q=new ke(h,x);this._pairs.add(Q.id),this._collisionPairCache.push(Q)}return!1});if(i&&(i.physics.pairs=this._collisionPairCache.length),Ft.checkForFastBodies)for(const d of o){const u=d.owner.get(Ht);if(u.collisionType!==Gt.Active)continue;const x=u.vel.size*n+u.acc.size*.5*n*n,Q=Math.min(d.bounds.height,d.bounds.width);if(Ft.disableMinimumSpeedForFastBody||x>Q/2){i&&i.physics.fastBodies++;const J=u.globalPos.sub(u.oldPos),et=d.center,dt=d.getFurthestPoint(u.vel),ft=dt.sub(J),xt=new _i(ft,u.vel);xt.pos=xt.pos.add(xt.dir.scale(-2*Ft.surfaceEpsilon));let It,ut=new p(1/0,1/0);if(this._dynamicCollisionTree.rayCastQuery(xt,x+Ft.surfaceEpsilon*2,pt=>{if(!this._pairExists(d,pt)&&ke.canCollide(d,pt)){const Tt=pt.rayCast(xt,x+Ft.surfaceEpsilon*10);if(Tt){const Qt=Tt.sub(ft);Qt.size<ut.size&&(ut=Qt,It=pt)}}return!1}),It&&p.isValid(ut)){const pt=new ke(d,It);this._pairs.has(pt.id)||(this._pairs.add(pt.id),this._collisionPairCache.push(pt));const Tt=et.sub(dt);u.globalPos=ft.add(Tt).add(ut).add(xt.dir.scale(10*Ft.surfaceEpsilon)),d.update(u.transform.get()),i&&i.physics.fastBodyCollisions++}}}return this._collisionPairCache}narrowphase(t,e){let i=[];for(let n=0;n<t.length;n++){const o=t[n].collide();if(i=i.concat(o),e&&o.length>0)for(const h of o)e.physics.contacts.set(h.id,h)}return e&&(e.physics.collisions+=i.length),i}update(t){let e=0;const i=t.length;for(let n=0;n<i;n++)this._dynamicCollisionTree.updateCollider(t[n])&&e++;return e}debug(t){this._dynamicCollisionTree.debug(t)}}class Mi{constructor(){this.id=E("collider",Mi._ID++),this.__compositeColliderId=null,this.events=new Bi}touching(t){return!!this.collide(t)}}Mi._ID=0;class Ae extends Mi{constructor(t){super(),this._collisionProcessor=new ir,this._dynamicAABBTree=new fs,this._colliders=[];for(const e of t)this.addCollider(e)}clearColliders(){this._colliders=[]}addCollider(t){this.events.wire(t.events),t.__compositeColliderId=this.id,this._colliders.push(t),this._collisionProcessor.track(t),this._dynamicAABBTree.trackCollider(t)}removeCollider(t){this.events.unwire(t.events),t.__compositeColliderId=null,ot(t,this._colliders),this._collisionProcessor.untrack(t),this._dynamicAABBTree.untrackCollider(t)}getColliders(){return this._colliders}get worldPos(){var t,e;return(e=(t=this._transform)===null||t===void 0?void 0:t.pos)!==null&&e!==void 0?e:p.Zero}get center(){var t,e;return(e=(t=this._transform)===null||t===void 0?void 0:t.pos)!==null&&e!==void 0?e:p.Zero}get bounds(){var t,e;const i=this.getColliders();return i.reduce((o,h)=>o.combine(h.bounds),(e=(t=i[0])===null||t===void 0?void 0:t.bounds)!==null&&e!==void 0?e:new N().translate(this.worldPos))}get localBounds(){var t,e;const i=this.getColliders();return i.reduce((o,h)=>o.combine(h.localBounds),(e=(t=i[0])===null||t===void 0?void 0:t.localBounds)!==null&&e!==void 0?e:new N)}get axes(){const t=this.getColliders();let e=[];for(const i of t)e=e.concat(i.axes);return e}getFurthestPoint(t){const e=this.getColliders(),i=[];for(const h of e)i.push(h.getFurthestPoint(t));let n=i[0],o=-Number.MAX_VALUE;for(const h of i){const d=h.dot(t);d>o&&(n=h,o=d)}return n}getInertia(t){const e=this.getColliders();let i=0;for(const n of e)i+=n.getInertia(t);return i}collide(t){let e=[t];t instanceof Ae&&(e=t.getColliders());const i=[];for(const o of e)this._dynamicAABBTree.query(o,h=>(i.push(new ke(o,h)),!1));let n=[];for(const o of i)n=n.concat(o.collide());return n}getClosestLineBetween(t){const e=this.getColliders(),i=[];if(t instanceof Ae){const n=t.getColliders();for(const o of e)for(const h of n){const d=o.getClosestLineBetween(h);d&&i.push(d)}}else for(const n of e){const o=t.getClosestLineBetween(n);o&&i.push(o)}if(i.length){let n=i[0].getLength(),o=i[0];for(const h of i){const d=h.getLength();d<n&&(n=d,o=h)}return o}return null}contains(t){const e=this.getColliders();for(const i of e)if(i.contains(t))return!0;return!1}rayCast(t,e){const i=this.getColliders(),n=[];for(const o of i){const h=o.rayCast(t,e);h&&n.push(h)}if(n.length){let o=n[0],h=o.dot(t.dir);for(const d of n){const u=t.dir.dot(d);u<h&&(o=d,h=u)}return o}return null}project(t){const e=this.getColliders(),i=[];for(const n of e){const o=n.project(t);o&&i.push(o)}if(i.length){const n=new Ai(i[0].min,i[0].max);for(const o of i)n.min=Math.min(o.min,n.min),n.max=Math.max(o.max,n.max);return n}return null}update(t){if(t){const e=this.getColliders();for(const i of e)i.owner=this.owner,i.update(t)}}debug(t,e){const i=this.getColliders();for(const n of i)n.debug(t,e)}clone(){return new Ae(this._colliders.map(t=>t.clone()))}}class Le{constructor(t,e){this.begin=t,this.end=e}get slope(){return(this.end.y-this.begin.y)/(this.end.x-this.begin.x)}get intercept(){return this.begin.y-this.slope*this.begin.x}normal(){return this._normal?this._normal:this._normal=this.end.sub(this.begin).normal()}dir(){return this._dir?this._dir:this._dir=this.end.sub(this.begin)}getPoints(){return[this.begin,this.end]}getSlope(){if(this._slope)return this._slope;const t=this.begin,e=this.end,i=t.distance(e);return this._slope=e.sub(t).scale(1/i)}getEdge(){const t=this.begin;return this.end.sub(t)}getLength(){if(this._length)return this._length;const t=this.begin,e=this.end,i=t.distance(e);return this._length=i}get midpoint(){return this.begin.add(this.end).scale(.5)}flip(){return new Le(this.end,this.begin)}below(t){return(this.end.x-this.begin.x)*(t.y-this.begin.y)-(this.end.y-this.begin.y)*(t.x-this.begin.x)>=0}clip(t,e){let i=t;i=i.normalize();const n=i.dot(this.begin)-e,o=i.dot(this.end)-e,h=[];if(n<=0&&h.push(this.begin),o<=0&&h.push(this.end),n*o<0){const d=n/(n-o);h.push(this.begin.add(this.end.sub(this.begin).scale(d)))}return h.length!==2?null:new Le(h[0],h[1])}distanceToPoint(t,e=!1){const i=t.x,n=t.y,o=this.getLength(),h=this.end.y-this.begin.y,d=this.end.x-this.begin.x,u=(h*i-d*n+this.end.x*this.begin.y-this.end.y*this.begin.x)/o;return e?u:Math.abs(u)}findVectorToPoint(t){const e=this.begin.sub(t),i=this.getSlope();return e.sub(i.scale(e.dot(i)))}findPoint(t=null,e=null){const i=this.slope,n=this.intercept;if(t!==null)return new p(t,i*t+n);if(e!==null)return new p((e-n)/i,e);throw new Error("You must provide an X or a Y value")}hasPoint(){let t,e=0;if(typeof arguments[0]=="number"&&typeof arguments[1]=="number")t=new p(arguments[0],arguments[1]),e=arguments[2]||0;else if(arguments[0]instanceof p)t=arguments[0],e=arguments[1]||0;else throw"Could not determine the arguments for Vector.hasPoint";const i=t.x-this.begin.x,n=t.y-this.begin.y,o=this.end.x-this.begin.x,h=this.end.y-this.begin.y,d=i*h-n*o;return Math.abs(d)>e?!1:Math.abs(o)>=Math.abs(h)?o>0?this.begin.x<=t.x&&t.x<=this.end.x:this.end.x<=t.x&&t.x<=this.begin.x:h>0?this.begin.y<=t.y&&t.y<=this.end.y:this.end.y<=t.y&&t.y<=this.begin.y}}function Us(a,t,e,i){const n=a.sub(e),o=t.dot(t),h=t.dot(i),d=i.dot(i),u=t.dot(n),x=i.dot(n),Q=o*d-h*h;let J=Q,et=Q;if(Q===0||Q<=.01){const xt=u/h;return new Le(a,e.add(i.scale(xt)))}let dt=h*x-d*u,ft=o*x-h*u;return dt<0?(dt=0,ft=x,et=d):dt>J&&(dt=J,ft=x+h,et=d),ft<0?(ft=0,-u<0?dt=0:-u>o?dt=J:(dt=-u,J=o)):ft>et&&(ft=et,-u+h<0?dt=0:-u+h>o?dt=J:(dt=-u+h,J=o)),dt=Math.abs(dt)<.001?0:dt/J,ft=Math.abs(ft)<.001?0:ft/et,new Le(a.add(t.scale(dt)),e.add(i.scale(ft)))}const Pe={PolygonPolygonClosestLine(a,t){const e=t.worldPos,i=e.sub(a.worldPos),n=i.negate(),o=new _i(a.worldPos,i),h=new _i(e,n),d=a.rayCast(o).add(o.dir.scale(.1)),u=t.rayCast(h).add(h.dir.scale(.1)),x=a.getClosestFace(d),Q=t.getClosestFace(u),J=x.face.begin,et=x.face.getEdge(),dt=Q.face.begin,ft=Q.face.getEdge();return Us(J,et,dt,ft)},PolygonEdgeClosestLine(a,t){const i=t.worldPos.sub(a.worldPos),n=new _i(a.worldPos,i),o=a.rayCast(n).add(n.dir.scale(.1)),h=a.getClosestFace(o),d=h.face.begin,u=h.face.getEdge(),x=t.asLine(),Q=x.begin,J=x.getEdge();return Us(d,u,Q,J)},PolygonCircleClosestLine(a,t){const e=t.worldPos,i=e.sub(a.worldPos),n=new _i(a.worldPos,i.normalize()),o=a.rayCast(n).add(n.dir.scale(.1)),h=a.getClosestFace(o),d=h.face.begin,u=h.face.getEdge();let x=(u.x*(e.x-d.x)+u.y*(e.y-d.y))/(u.x*u.x+u.y*u.y);x>1?x=1:x<0&&(x=0);const Q=Math.sqrt(Math.pow(d.x+u.x*x-e.x,2)+Math.pow(d.y+u.y*x-e.y,2))-t.radius,J=(d.x+u.x*x-e.x)*t.radius/(t.radius+Q),et=(d.y+u.y*x-e.y)*t.radius/(t.radius+Q);return new Le(u.scale(x).add(d),new p(e.x+J,e.y+et))},CircleCircleClosestLine(a,t){const i=t.worldPos.sub(a.worldPos),o=a.worldPos.sub(t.worldPos),h=new _i(a.worldPos,i),d=new _i(t.worldPos,o),u=a.rayCast(h),x=t.rayCast(d);return new Le(u,x)},CircleEdgeClosestLine(a,t){const e=a.worldPos,i=t.asLine(),n=i.begin,o=i.getEdge(),h=n,d=o;let u=(d.x*(e.x-h.x)+d.y*(e.y-h.y))/(d.x*d.x+d.y*d.y);u>1?u=1:u<0&&(u=0);const x=Math.sqrt(Math.pow(h.x+d.x*u-e.x,2)+Math.pow(h.y+d.y*u-e.y,2))-a.radius,Q=(h.x+d.x*u-e.x)*a.radius/(a.radius+x),J=(h.y+d.y*u-e.y)*a.radius/(a.radius+x);return new Le(d.scale(u).add(h),new p(e.x+Q,e.y+J))},EdgeEdgeClosestLine(a,t){const e=a.asLine(),i=e.begin,n=e.getEdge(),o=i,h=n,d=t.asLine(),u=d.begin,x=d.getEdge();return Us(o,h,u,x)}};class ve extends Mi{constructor(t){super(),this.offset=p.Zero,this._globalMatrix=nt.identity(),this.offset=t.offset||p.Zero,this.radius=t.radius||0,this._globalMatrix.translate(this.offset.x,this.offset.y)}get worldPos(){return this._globalMatrix.getPosition()}get radius(){var t;const e=this._transform,i=(t=e==null?void 0:e.globalScale)!==null&&t!==void 0?t:p.One;return this._naturalRadius*Math.min(i.x,i.y)}set radius(t){var e;const i=this._transform,n=(e=i==null?void 0:i.globalScale)!==null&&e!==void 0?e:p.One;this._naturalRadius=t/Math.min(n.x,n.y)}clone(){return new ve({offset:this.offset.clone(),radius:this.radius})}get center(){return this._globalMatrix.getPosition()}contains(t){var e,i;return((i=(e=this._transform)===null||e===void 0?void 0:e.pos)!==null&&i!==void 0?i:this.offset).distance(t)<=this.radius}rayCast(t,e=1/0){const i=this.center,n=t.dir,o=t.pos,h=Math.sqrt(Math.pow(n.dot(o.sub(i)),2)-Math.pow(o.sub(i).distance(),2)+Math.pow(this.radius,2));if(h<0)return null;{let d=0;if(h===0)return d=-n.dot(o.sub(i)),d>0&&d<e?t.getPoint(d):null;{const u=-n.dot(o.sub(i))+h,x=-n.dot(o.sub(i))-h,Q=[];u>=0&&Q.push(u),x>=0&&Q.push(x);const J=Math.min(...Q);return J<=e?t.getPoint(J):null}}}getClosestLineBetween(t){if(t instanceof ve)return Pe.CircleCircleClosestLine(this,t);if(t instanceof Nt)return Pe.PolygonCircleClosestLine(t,this).flip();if(t instanceof Ee)return Pe.CircleEdgeClosestLine(this,t).flip();throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}collide(t){if(t instanceof ve)return Ke.CollideCircleCircle(this,t);if(t instanceof Nt)return Ke.CollideCirclePolygon(this,t);if(t instanceof Ee)return Ke.CollideCircleEdge(this,t);throw new Error(`Circle could not collide with unknown CollisionShape ${typeof t}`)}getFurthestPoint(t){return this.center.add(t.normalize().scale(this.radius))}getFurthestLocalPoint(t){return t.normalize().scale(this.radius)}get bounds(){var t,e,i;const n=this._transform,o=(t=n==null?void 0:n.globalScale)!==null&&t!==void 0?t:p.One,h=(e=n==null?void 0:n.globalRotation)!==null&&e!==void 0?e:0,d=(i=n==null?void 0:n.globalPos)!==null&&i!==void 0?i:p.Zero;return new N(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius).rotate(h).scale(o).translate(d)}get localBounds(){return new N(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius)}get axes(){return[]}getInertia(t){return t*this.radius*this.radius/2}update(t){var e;this._transform=t,((e=t.matrix)!==null&&e!==void 0?e:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}project(t){const e=[],n=this.center.dot(t);return e.push(n),e.push(n+this.radius),e.push(n-this.radius),new Ai(Math.min.apply(Math,e),Math.max.apply(Math,e))}debug(t,e){var i,n,o,h;const d=this._transform,u=(i=d==null?void 0:d.globalScale)!==null&&i!==void 0?i:p.One,x=(n=d==null?void 0:d.globalRotation)!==null&&n!==void 0?n:0,Q=(o=d==null?void 0:d.globalPos)!==null&&o!==void 0?o:p.Zero;t.save(),t.translate(Q.x,Q.y),t.rotate(x),t.scale(u.x,u.y),t.drawCircle((h=this.offset)!==null&&h!==void 0?h:p.Zero,this._naturalRadius,I.Transparent,e,2),t.restore()}}class ts{constructor(t,e,i,n,o,h,d,u){var x,Q;this._canceled=!1,this.colliderA=t,this.colliderB=e,this.mtv=i,this.normal=n,this.tangent=o,this.points=h,this.localPoints=d,this.info=u,this.id=ke.calculatePairHash(t.id,e.id),(t.__compositeColliderId||e.__compositeColliderId)&&(this.id+="|"+ke.calculatePairHash((x=t.__compositeColliderId)!==null&&x!==void 0?x:t.id,(Q=e.__compositeColliderId)!==null&&Q!==void 0?Q:e.id))}matchAwake(){const t=this.colliderA.owner.get(Ht),e=this.colliderB.owner.get(Ht);t&&e&&t.sleeping!==e.sleeping&&(t.sleeping&&t.collisionType!==Gt.Fixed&&e.sleepMotion>=Ft.wakeThreshold&&t.setSleeping(!1),e.sleeping&&e.collisionType!==Gt.Fixed&&t.sleepMotion>=Ft.wakeThreshold&&e.setSleeping(!1))}isCanceled(){return this._canceled}cancel(){this._canceled=!0}}class _s{static findPolygonPolygonSeparation(t,e){let i=-Number.MAX_VALUE,n=null,o=null,h=-1,d=null;const u=t.getSides(),x=t.getLocalSides();for(let Q=0;Q<u.length;Q++){const J=u[Q],et=J.normal(),dt=e.getFurthestPoint(et.negate()),ft=J.distanceToPoint(dt,!0);ft>i&&(i=ft,n=J,o=et,h=Q,d=dt)}return{collider:t,separation:o?i:99,axis:o,side:n,localSide:x[h],sideId:h,point:d,localPoint:o?e.getFurthestLocalPoint(o.negate()):null}}static findCirclePolygonSeparation(t,e){const i=e.axes,o=e.center.sub(t.worldPos),h=e.getFurthestPoint(o.negate());i.push(h.sub(t.worldPos).normalize());let d=Number.MAX_VALUE,u=null,x=-1;for(let Q=0;Q<i.length;Q++){const J=e.project(i[Q]),et=t.project(i[Q]),dt=J.getOverlap(et);if(dt<=0)return null;dt<d&&(d=dt,u=i[Q],x=Q)}return x<0?null:u.normalize().scale(d)}}const Ke={CollideCircleCircle(a,t){const e=a.worldPos,i=t.worldPos,n=a.radius+t.radius,o=e.distance(i);if(o>n)return[];const h=n-o,d=i.sub(e).normalize(),u=d.perpendicular(),x=d.scale(h),Q=a.getFurthestPoint(d),J=a.getFurthestLocalPoint(d),et={collider:a,separation:h,axis:d,point:Q};return[new ts(a,t,x,d,u,[Q],[J],et)]},CollideCirclePolygon(a,t){var e,i;let n=_s.findCirclePolygonSeparation(a,t);if(!n)return[];n=n.dot(t.center.sub(a.center))<0?n.negate():n;const h=a.getFurthestPoint(n),u=((i=(e=a.owner)===null||e===void 0?void 0:e.get(Pt))!==null&&i!==void 0?i:new Pt).applyInverse(h),x=n.normalize(),Q={collider:a,separation:-n.size,axis:x,point:h,localPoint:u,side:t.findSide(x.negate()),localSide:t.findLocalSide(x.negate())};return[new ts(a,t,n,x,x.perpendicular(),[h],[u],Q)]},CollideCircleEdge(a,t){const e=a.center,i=t.asLine(),n=i.end.sub(i.begin),o=n.dot(i.end.sub(e)),h=n.dot(e.sub(i.begin)),d=t.asLine(),u=t.asLocalLine();if(h<=0){const ut=i.begin.sub(e),pt=ut.dot(ut);if(pt>a.radius*a.radius)return[];const Tt=ut.normalize(),Qt=a.radius-Math.sqrt(pt),zt={collider:a,separation:Qt,axis:Tt,point:d.begin,side:d,localSide:u};return[new ts(a,t,Tt.scale(Qt),Tt,Tt.perpendicular(),[d.begin],[u.begin],zt)]}if(o<=0){const ut=i.end.sub(e),pt=ut.dot(ut);if(pt>a.radius*a.radius)return[];const Tt=ut.normalize(),Qt=a.radius-Math.sqrt(pt),zt={collider:a,separation:Qt,axis:Tt,point:d.end,side:d,localSide:u};return[new ts(a,t,Tt.scale(Qt),Tt,Tt.perpendicular(),[d.end],[u.end],zt)]}const x=n.dot(n),Q=i.begin.scale(o).add(i.end.scale(h)).scale(1/x),J=e.sub(Q),et=J.dot(J);if(et>a.radius*a.radius)return[];let dt=n.perpendicular();dt.dot(e.sub(i.begin))<0&&(dt.x=-dt.x,dt.y=-dt.y),dt=dt.normalize();const ft=a.radius-Math.sqrt(et),xt=dt.scale(ft),It={collider:a,separation:ft,axis:dt,point:Q,side:d,localSide:u};return[new ts(a,t,xt,dt.negate(),dt.negate().perpendicular(),[Q],[Q.sub(t.worldPos)],It)]},CollideEdgeEdge(){return[]},CollidePolygonEdge(a,t){var e;const i=a.center,o=t.center.sub(i).normalize(),h=new Nt({points:[t.begin,t.end,t.end.add(o.scale(100)),t.begin.add(o.scale(100))],offset:t.offset});h.owner=t.owner,((e=t.owner)===null||e===void 0?void 0:e.get(Pt))&&h.update(t.owner.get(Pt).get());const u=this.CollidePolygonPolygon(a,h);return u.length&&(u[0].colliderB=t,u[0].id=ke.calculatePairHash(a.id,t.id)),u},CollidePolygonPolygon(a,t){var e,i,n,o;const h=_s.findPolygonPolygonSeparation(a,t);if(h.separation>0)return[];const d=_s.findPolygonPolygonSeparation(t,a);if(d.separation>0)return[];const u=h.separation>d.separation?h:d,Q=(u.collider===a?t:a).findSide(u.axis.negate()),J=u.side,et=J.dir().normalize(),dt=Q.clip(et.negate(),-et.dot(J.begin));let ft=null;if(dt&&(ft=dt.clip(et,et.dot(J.end))),ft){const xt=ft.getPoints().filter(Tt=>J.below(Tt));let It=u.axis,ut=It.perpendicular();t.center.sub(a.center).dot(It)<0&&(It=It.negate(),ut=It.perpendicular());let pt=[];if(u.collider===a){const Tt=(i=(e=t.owner)===null||e===void 0?void 0:e.get(Pt))!==null&&i!==void 0?i:new Pt;pt=xt.map(Qt=>Tt.applyInverse(Qt))}else{const Tt=(o=(n=a.owner)===null||n===void 0?void 0:n.get(Pt))!==null&&o!==void 0?o:new Pt;pt=xt.map(Qt=>Tt.applyInverse(Qt))}return[new ts(a,t,It.scale(-u.separation),It,ut,xt,pt,u)]}return[]},FindContactSeparation(a,t){var e,i,n,o;const h=a.colliderA,d=(i=(e=a.colliderA.owner)===null||e===void 0?void 0:e.get(Pt))!==null&&i!==void 0?i:new Pt,u=a.colliderB,x=(o=(n=a.colliderB.owner)===null||n===void 0?void 0:n.get(Pt))!==null&&o!==void 0?o:new Pt;if(h instanceof ve&&u instanceof ve){const Q=h.radius+u.radius,J=d.pos.distance(x.pos);return-(Q-J)}if(h instanceof Nt&&u instanceof Nt&&a.info.localSide){let Q,J;return a.info.collider===h?(Q=new Le(d.apply(a.info.localSide.begin),d.apply(a.info.localSide.end)),J=x.apply(t)):(Q=new Le(x.apply(a.info.localSide.begin),x.apply(a.info.localSide.end)),J=d.apply(t)),Q.distanceToPoint(J,!0)}if(h instanceof Nt&&u instanceof ve||u instanceof Nt&&h instanceof ve){const Q=d.apply(t);if(a.info.side)return a.info.side.distanceToPoint(Q,!0)}if(h instanceof Ee&&u instanceof Nt||u instanceof Ee&&h instanceof Nt){let Q;if(a.info.collider===h?Q=x.apply(t):Q=d.apply(t),a.info.side)return a.info.side.distanceToPoint(Q,!0)}if(h instanceof ve&&u instanceof Ee||u instanceof ve&&h instanceof Ee){const Q=x.apply(t);let J;h instanceof ve&&(J=h.getFurthestPoint(a.normal));const et=Q.distance(J);if(a.info.side)return et>0?-et:0}return 0}};class Ee extends Mi{constructor(t){var e;super(),this._globalMatrix=nt.identity(),this.begin=t.begin||p.Zero,this.end=t.end||p.Zero,this.offset=(e=t.offset)!==null&&e!==void 0?e:p.Zero}clone(){return new Ee({begin:this.begin.clone(),end:this.end.clone()})}get worldPos(){var t;const e=this._transform;return(t=e==null?void 0:e.globalPos.add(this.offset))!==null&&t!==void 0?t:this.offset}get center(){const t=this._getTransformedBegin(),e=this._getTransformedEnd();return t.average(e)}_getTransformedBegin(){return this._globalMatrix.multiply(this.begin)}_getTransformedEnd(){return this._globalMatrix.multiply(this.end)}getSlope(){const t=this._getTransformedBegin(),e=this._getTransformedEnd(),i=t.distance(e);return e.sub(t).scale(1/i)}getLength(){const t=this._getTransformedBegin(),e=this._getTransformedEnd();return t.distance(e)}contains(){return!1}rayCast(t,e=1/0){const i=this._getTransformedBegin().sub(t.pos);if(t.dir.cross(this.getSlope())===0&&i.cross(t.dir)!==0)return null;const n=t.dir.cross(this.getSlope());if(n===0)return null;const o=i.cross(this.getSlope())/n;if(o>=0&&o<=e){const h=i.cross(t.dir)/n/this.getLength();if(h>=0&&h<=1)return t.getPoint(o)}return null}getClosestLineBetween(t){if(t instanceof ve)return Pe.CircleEdgeClosestLine(t,this);if(t instanceof Nt)return Pe.PolygonEdgeClosestLine(t,this).flip();if(t instanceof Ee)return Pe.EdgeEdgeClosestLine(this,t);throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}collide(t){if(t instanceof ve)return Ke.CollideCircleEdge(t,this);if(t instanceof Nt)return Ke.CollidePolygonEdge(t,this);if(t instanceof Ee)return Ke.CollideEdgeEdge();throw new Error(`Edge could not collide with unknown CollisionShape ${typeof t}`)}getFurthestPoint(t){const e=this._getTransformedBegin(),i=this._getTransformedEnd();return t.dot(e)>0?e:i}_boundsFromBeginEnd(t,e,i=10){return new N(Math.min(t.x,e.x)-i,Math.min(t.y,e.y)-i,Math.max(t.x,e.x)+i,Math.max(t.y,e.y)+i)}get bounds(){const t=this._getTransformedBegin(),e=this._getTransformedEnd();return this._boundsFromBeginEnd(t,e)}get localBounds(){return this._boundsFromBeginEnd(this.begin,this.end)}asLine(){return new Le(this._getTransformedBegin(),this._getTransformedEnd())}asLocalLine(){return new Le(this.begin,this.end)}get axes(){const e=this._getTransformedEnd().sub(this._getTransformedBegin()).normal(),i=[];return i.push(e),i.push(e.negate()),i.push(e.normal()),i.push(e.normal().negate()),i}getInertia(t){const e=this.end.sub(this.begin).distance()/2;return t*e*e}update(t){var e;this._transform=t,((e=t.matrix)!==null&&e!==void 0?e:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}project(t){const e=[],i=[this._getTransformedBegin(),this._getTransformedEnd()],n=i.length;for(let o=0;o<n;o++)e.push(i[o].dot(t));return new Ai(Math.min.apply(Math,e),Math.max.apply(Math,e))}debug(t,e){const i=this._getTransformedBegin(),n=this._getTransformedEnd();t.drawLine(i,n,e,2),t.drawCircle(i,2,e),t.drawCircle(n,2,e)}}class Nt extends Mi{constructor(t){var e,i;super(),this._logger=v.getInstance(),this._transformedPoints=[],this._sides=[],this._localSides=[],this._globalMatrix=nt.identity(),this._transformedPointsDirty=!0,this._sidesDirty=!0,this._localSidesDirty=!0,this._localBoundsDirty=!0,this.offset=(e=t.offset)!==null&&e!==void 0?e:p.Zero,this._globalMatrix.translate(this.offset.x,this.offset.y),this.points=(i=t.points)!==null&&i!==void 0?i:[],this._isCounterClockwiseWinding(this.points)||this.points.reverse(),this.isConvex()||this._logger.warn("Excalibur only supports convex polygon colliders and will not behave properly.Call PolygonCollider.triangulate() to build a new collider composed of smaller convex triangles"),this._calculateTransformation()}set points(t){this._localBoundsDirty=!0,this._localSidesDirty=!0,this._sidesDirty=!0,this._points=t}get points(){return this._points}_isCounterClockwiseWinding(t){let e=0;for(let i=0;i<t.length;i++)e+=(t[(i+1)%t.length].x-t[i].x)*(t[(i+1)%t.length].y+t[i].y);return e<0}isConvex(){if(this.points.length<3)return!1;let t=this.points[this.points.length-2],e=this.points[this.points.length-1],i=Math.atan2(e.y-t.y,e.x-t.x),n=0,o=0,h=0;for(const[d,u]of this.points.entries()){if(t=e,n=i,e=u,i=Math.atan2(e.y-t.y,e.x-t.x),t.equals(e))return!1;let x=i-n;if(x<=-Math.PI?x+=Math.PI*2:x>Math.PI&&(x-=Math.PI*2),d===0){if(x===0)return!1;o=x>0?1:-1}else if(o*x<=0)return!1;h+=x}return Math.abs(Math.round(h/(Math.PI*2)))===1}tessellate(){const t=[];for(let e=1;e<this.points.length-2;e++)t.push([this.points[0],this.points[e+1],this.points[e+2]]);return t.push([this.points[0],this.points[1],this.points[2]]),new Ae(t.map(e=>se.Polygon(e)))}triangulate(){if(this.points.length<3)throw Error("Invalid polygon");function t(h,d){return h>=d.length?d[h%d.length]:h<0?d[h%d.length+d.length]:d[h]}function e(h,d,u,x){const Q=u.sub(d),J=x.sub(u),et=d.sub(x),dt=h.sub(d),ft=h.sub(u),xt=h.sub(x),It=Q.cross(dt),ut=J.cross(ft),pt=et.cross(xt);return!(It>0||ut>0||pt>0)}const i=[],n=[...this.points],o=O(0,this.points.length-1);for(;o.length>3;)for(let h=0;h<o.length;h++){const d=o[h],u=t(h-1,o),x=t(h+1,o),Q=n[d],J=n[u],et=n[x],dt=J.sub(Q);if(!(et.sub(Q).cross(dt)>0))continue;let It=!0;for(let ut=0;ut<o.length;ut++){const pt=o[ut];if(pt===d||pt===u||pt===x)continue;const Tt=n[pt];if(e(Tt,J,Q,et)){It=!1;break}}if(It){i.push([J,Q,et]),o.splice(h,1);break}}return i.push([n[o[0]],n[o[1]],n[o[2]]]),new Ae(i.map(h=>se.Polygon(h)))}clone(){return new Nt({offset:this.offset.clone(),points:this.points.map(t=>t.clone())})}get worldPos(){return this._transform?this._transform.pos.add(this.offset):this.offset}get center(){return this.bounds.center}_calculateTransformation(){const t=this.points,e=t.length;this._transformedPoints.length=0;for(let i=0;i<e;i++)this._transformedPoints[i]=this._globalMatrix.multiply(t[i].clone())}getTransformedPoints(){return this._transformedPointsDirty&&(this._calculateTransformation(),this._transformedPointsDirty=!1),this._transformedPoints}getSides(){if(this._sidesDirty){const t=[],e=this.getTransformedPoints(),i=e.length;for(let n=0;n<i;n++)t.push(new Le(e[n],e[(n+1)%i]));this._sides=t,this._sidesDirty=!1}return this._sides}getLocalSides(){if(this._localSidesDirty){const t=[],e=this.points,i=e.length;for(let n=0;n<i;n++)t.push(new Le(e[n],e[(n+1)%i]));this._localSides=t,this._localSidesDirty=!1}return this._localSides}findSide(t){const e=this.getSides();let i=e[0],n=-Number.MAX_VALUE;for(let o=0;o<e.length;o++){const h=e[o],u=h.normal().dot(t);u>n&&(i=h,n=u)}return i}findLocalSide(t){const e=this.getLocalSides();let i=e[0],n=-Number.MAX_VALUE;for(let o=0;o<e.length;o++){const h=e[o],u=h.normal().dot(t);u>n&&(i=h,n=u)}return i}get axes(){const t=[],e=this.getSides();for(let i=0;i<e.length;i++)t.push(e[i].normal());return t}update(t){var e;this._transform=t,this._transformedPointsDirty=!0,this._sidesDirty=!0,((e=t.matrix)!==null&&e!==void 0?e:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}contains(t){const e=new _i(t,new p(1,0));return this.getSides().reduce(function(n,o){return e.intersect(o)>=0?n+1:n},0)%2!==0}getClosestLineBetween(t){if(t instanceof ve)return Pe.PolygonCircleClosestLine(this,t);if(t instanceof Nt)return Pe.PolygonPolygonClosestLine(this,t);if(t instanceof Ee)return Pe.PolygonEdgeClosestLine(this,t);throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}collide(t){if(t instanceof ve)return Ke.CollideCirclePolygon(t,this);if(t instanceof Nt)return Ke.CollidePolygonPolygon(this,t);if(t instanceof Ee)return Ke.CollidePolygonEdge(this,t);throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof t}`)}getFurthestPoint(t){const e=this.getTransformedPoints();let i=null,n=-Number.MAX_VALUE;for(let o=0;o<e.length;o++){const h=t.dot(e[o]);h>n&&(n=h,i=e[o])}return i}getFurthestLocalPoint(t){const e=this.points;let i=e[0],n=-Number.MAX_VALUE;for(let o=0;o<e.length;o++){const h=t.dot(e[o]);h>n&&(n=h,i=e[o])}return i}getClosestFace(t){const e=this.getSides();let i=Number.POSITIVE_INFINITY,n=-1,o=-1;for(let h=0;h<e.length;h++){const d=e[h].distanceToPoint(t);d<i&&(i=d,n=h,o=d)}return n!==-1?{distance:e[n].normal().scale(o),face:e[n]}:null}get bounds(){return this.localBounds.transform(this._globalMatrix)}get localBounds(){return this._localBoundsDirty&&(this._localBounds=N.fromPoints(this.points),this._localBoundsDirty=!1),this._localBounds}getInertia(t){if(this._cachedMass===t&&this._cachedInertia)return this._cachedInertia;let e=0,i=0;const n=this.points;for(let o=0;o<n.length;o++){const h=(o+1)%n.length,d=n[h].cross(n[o]);e+=d*(n[o].dot(n[o])+n[o].dot(n[h])+n[h].dot(n[h])),i+=d}return this._cachedMass=t,this._cachedInertia=t/6*(e/i)}rayCast(t,e=1/0){const i=this.getSides(),n=i.length;let o=Number.MAX_VALUE,h=-1;for(let d=0;d<n;d++){const u=t.intersect(i[d]);u>=0&&u<o&&u<=e&&(o=u,h=d)}return h>=0?t.getPoint(o):null}project(t){const e=this.getTransformedPoints(),i=e.length;let n=Number.MAX_VALUE,o=-Number.MAX_VALUE;for(let h=0;h<i;h++){const d=e[h].dot(t);n=Math.min(n,d),o=Math.max(o,d)}return new Ai(n,o)}debug(t,e){const i=this.getTransformedPoints()[0],n=[i,...this.getTransformedPoints(),i];for(let o=0;o<n.length-1;o++)t.drawLine(n[o],n[o+1],e,2),t.drawCircle(n[o],2,e),t.drawCircle(n[o+1],2,e)}}class se{static Box(t,e,i=p.Half,n=p.Zero){return new Nt({points:new N(-t*i.x,-e*i.y,t-t*i.x,e-e*i.y).getPoints(),offset:n})}static Polygon(t,e=p.Zero){return new Nt({points:t,offset:e})}static Circle(t,e=p.Zero){return new ve({radius:t,offset:e})}static Edge(t,e){return new Ee({begin:t,end:e})}static Capsule(t,e,i=p.Zero){const n=v.getInstance();return t===e&&n.warn("A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider"),e>=t?new Ae([se.Circle(t/2,m(0,-e/2+t/2).add(i)),se.Box(t,e-t,p.Half,i),se.Circle(t/2,m(0,e/2-t/2).add(i))]):new Ae([se.Circle(e/2,m(-t/2+e/2,0).add(i)),se.Box(t-e,e,p.Half,i),se.Circle(e/2,m(t/2-e/2,0).add(i))])}}class _e extends Se{constructor(t){super(),this.type="ex.collider",this.events=new Bi,this.$colliderAdded=new Ie,this.$colliderRemoved=new Ie,this.set(t)}get(){return this._collider}set(t){return this.clear(),t&&(this._collider=t,this._collider.owner=this.owner,this.events.wire(t.events),this.$colliderAdded.notifyAll(t),this.update()),t}clear(){this._collider&&(this.events.unwire(this._collider.events),this.$colliderRemoved.notifyAll(this._collider),this._collider.owner=null,this._collider=null)}get bounds(){var t,e;return(e=(t=this._collider)===null||t===void 0?void 0:t.bounds)!==null&&e!==void 0?e:new N}get localBounds(){var t,e;return(e=(t=this._collider)===null||t===void 0?void 0:t.localBounds)!==null&&e!==void 0?e:new N}update(){var t;const e=(t=this.owner)===null||t===void 0?void 0:t.get(Pt);this._collider&&(this._collider.owner=this.owner,e&&this._collider.update(e.get()))}collide(t){let e=this._collider,i=t._collider;if(!e||!i)return[];let n=!1;if(i instanceof Ae&&(e=i,i=this._collider,n=!0),this._collider){const o=e.collide(i);return o?(n&&o.forEach(h=>{h.mtv=h.mtv.negate(),h.normal=h.normal.negate(),h.tangent=h.normal.perpendicular(),h.colliderA=this._collider,h.colliderB=t._collider}),o):[]}return[]}onAdd(t){this._collider&&this.update(),this.events.on("precollision",e=>{const i=e;t.events.emit("precollision",new $e(i.target.owner,i.other.owner,i.side,i.intersection))}),this.events.on("postcollision",e=>{const i=e;t.events.emit("postcollision",new ti(i.target.owner,i.other.owner,i.side,i.intersection))}),this.events.on("collisionstart",e=>{const i=e;t.events.emit("collisionstart",new Ps(i.target.owner,i.other.owner,i.contact))}),this.events.on("collisionend",e=>{const i=e;t.events.emit("collisionend",new gi(i.target.owner,i.other.owner))})}onRemove(){this.events.clear(),this.$colliderRemoved.notifyAll(this._collider)}useBoxCollider(t,e,i=p.Half,n=p.Zero){const o=se.Box(t,e,i,n);return this.set(o)}usePolygonCollider(t,e=p.Zero){const i=se.Polygon(t,e);return this.set(i)}useCircleCollider(t,e=p.Zero){const i=se.Circle(t,e);return this.set(i)}useEdgeCollider(t,e){const i=se.Edge(t,e);return this.set(i)}useCompositeCollider(t){return this.set(new Ae(t))}}var Ne;(function(a){a.Rotation="rotation",a.X="x",a.Y="y"})(Ne||(Ne={}));class Ht extends Se{constructor(t){var e,i,n;super(),this.type="ex.body",this.dependencies=[Pt,ie],this.id=E("body",Ht._ID++),this.events=new Bi,this._oldTransform=new $i,this.__oldTransformCaptured=!1,this.enableFixedUpdateInterpolate=!0,this.collisionType=Gt.PreventCollision,this.group=ni.All,this._mass=Ft.defaultMass,this.sleepMotion=Ft.sleepEpsilon*5,this.canSleep=Ft.bodiesCanSleepByDefault,this._sleeping=!1,this.bounciness=.2,this.friction=.99,this.useGravity=!0,this.limitDegreeOfFreedom=[],this.oldVel=new p(0,0),this.oldAcc=p.Zero,t&&(this.collisionType=(e=t.type)!==null&&e!==void 0?e:this.collisionType,this.group=(i=t.group)!==null&&i!==void 0?i:this.group,this.useGravity=(n=t.useGravity)!==null&&n!==void 0?n:this.useGravity)}get matrix(){return this.transform.get().matrix}get mass(){return this._mass}set mass(t){this._mass=t,this._cachedInertia=void 0,this._cachedInverseInertia=void 0}get inverseMass(){return this.collisionType===Gt.Fixed?0:1/this.mass}get sleeping(){return this._sleeping}setSleeping(t){this._sleeping=t,t?(this.vel=p.Zero,this.acc=p.Zero,this.angularVelocity=0,this.sleepMotion=0):this.sleepMotion=Ft.sleepEpsilon*5}updateMotion(){this._sleeping&&this.setSleeping(!0);const t=this.vel.size*this.vel.size+Math.abs(this.angularVelocity*this.angularVelocity),e=Ft.sleepBias;this.sleepMotion=e*this.sleepMotion+(1-e)*t,this.sleepMotion=y(this.sleepMotion,0,10*Ft.sleepEpsilon),this.canSleep&&this.sleepMotion<Ft.sleepEpsilon&&this.setSleeping(!0)}get inertia(){if(this._cachedInertia)return this._cachedInertia;const t=this.owner.get(_e);if(t){t.$colliderAdded.subscribe(()=>{this._cachedInertia=null}),t.$colliderRemoved.subscribe(()=>{this._cachedInertia=null});const e=t.get();if(e)return this._cachedInertia=e.getInertia(this.mass)}return 0}get inverseInertia(){return this._cachedInverseInertia?this._cachedInverseInertia:this._cachedInverseInertia=this.collisionType===Gt.Fixed?0:1/this.inertia}get active(){var t;return!!(!((t=this.owner)===null||t===void 0)&&t.active)}get center(){return this.globalPos}get transform(){var t;return(t=this.owner)===null||t===void 0?void 0:t.get(Pt)}get motion(){var t;return(t=this.owner)===null||t===void 0?void 0:t.get(ie)}get pos(){return this.transform.pos}set pos(t){this.transform.pos=t}get globalPos(){return this.transform.globalPos}set globalPos(t){this.transform.globalPos=t}get oldPos(){return this._oldTransform.pos}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t}get torque(){return this.motion.torque}set torque(t){this.motion.torque=t}get oldRotation(){return this._oldTransform.rotation}get rotation(){return this.transform.globalRotation}set rotation(t){this.transform.globalRotation=t}get scale(){return this.transform.globalScale}set scale(t){this.transform.globalScale=t}get oldScale(){return this._oldTransform.scale}get scaleFactor(){return this.motion.scaleFactor}set scaleFactor(t){this.motion.scaleFactor=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}applyImpulse(t,e){if(this.collisionType!==Gt.Active)return;const i=e.scale(this.inverseMass);if(this.limitDegreeOfFreedom.includes(Ne.X)&&(i.x=0),this.limitDegreeOfFreedom.includes(Ne.Y)&&(i.y=0),this.vel.addEqual(i),!this.limitDegreeOfFreedom.includes(Ne.Rotation)){const n=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*n.cross(e)}}applyLinearImpulse(t){if(this.collisionType!==Gt.Active)return;const e=t.scale(this.inverseMass);this.limitDegreeOfFreedom.includes(Ne.X)&&(e.x=0),this.limitDegreeOfFreedom.includes(Ne.Y)&&(e.y=0),this.vel=this.vel.add(e)}applyAngularImpulse(t,e){if(this.collisionType===Gt.Active&&!this.limitDegreeOfFreedom.includes(Ne.Rotation)){const i=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*i.cross(e)}}captureOldTransform(){this.__oldTransformCaptured=!0,this.transform.get().clone(this._oldTransform),this.oldVel.setTo(this.vel.x,this.vel.y),this.oldAcc.setTo(this.acc.x,this.acc.y)}}Ht._ID=0;class Ri{constructor(t){this.data=t,this.type="Component Added"}}function Li(a){return!!a&&a.type==="Component Added"}class Xe{constructor(t){this.data=t,this.type="Component Removed"}}function Vr(a){return!!a&&a.type==="Component Removed"}class we extends We{constructor(t,e){if(super(),this.id=we._ID++,this._name="anonymous",this.active=!0,this._componentsToRemove=[],this._componentTypeToInstance=new Map,this._componentStringToInstance=new Map,this._tagsMemo=[],this._typesMemo=[],this.componentAdded$=new Ie,this.componentRemoved$=new Ie,this._parent=null,this.childrenAdded$=new Ie,this.childrenRemoved$=new Ie,this._children=[],this._isInitialized=!1,this._setName(e),t)for(const i of t)this.addComponent(i)}_setName(t){t&&(this._name=t)}get name(){return this._name}get events(){return this.eventDispatcher}kill(){this.active=!1}isKilled(){return!this.active}get tags(){return this._tagsMemo}hasTag(t){return this.tags.includes(t)}addTag(t){return this.addComponent(new wn(t))}removeTag(t,e=!1){return this.removeComponent(t,e)}get types(){return this._typesMemo}_rebuildMemos(){this._tagsMemo=Array.from(this._componentStringToInstance.values()).filter(t=>t instanceof wn).map(t=>t.type),this._typesMemo=Array.from(this._componentStringToInstance.keys())}getComponents(){return Array.from(this._componentStringToInstance.values())}_notifyAddComponent(t){this._rebuildMemos();const e=new Ri({component:t,entity:this});this.componentAdded$.notifyAll(e)}_notifyRemoveComponent(t){const e=new Xe({component:t,entity:this});this.componentRemoved$.notifyAll(e),this._rebuildMemos()}get parent(){return this._parent}get children(){return this._children}unparent(){this._parent&&(this._parent.removeChild(this),this._parent=null)}addChild(t){if(t.parent===null){if(this.getAncestors().includes(t))throw new Error("Cycle detected, cannot add entity");this._children.push(t),t._parent=this,this.childrenAdded$.notifyAll(t)}else throw new Error("Entity already has a parent, cannot add without unparenting");return this}removeChild(t){return t.parent===this&&(ot(t,this._children),t._parent=null,this.childrenRemoved$.notifyAll(t)),this}removeAllChildren(){return this.children.forEach(t=>{this.removeChild(t)}),this}getAncestors(){const t=[this];let e=this.parent;for(;e;)t.push(e),e=e.parent;return t.reverse()}getDescendants(){let t=[this],e=[this];for(;e.length>0;){const i=e.pop();e=e.concat(i.children),t=t.concat(i.children)}return t}clone(){const t=new we;for(const e of this.types)t.addComponent(this.get(e).clone());for(const e of this.children)t.addChild(e.clone());return t}addTemplate(t,e=!1){for(const i of t.getComponents())this.addComponent(i.clone(),e);for(const i of t.children)this.addChild(i.clone().addTemplate(i));return this}addComponent(t,e=!1){if(this.has(t.type))if(e)this.removeComponent(t);else return this;if(t.dependencies&&t.dependencies.length)for(const n of t.dependencies)this.addComponent(new n);t.owner=this;const i=t.constructor;return this._componentTypeToInstance.set(i,t),this._componentStringToInstance.set(t.type,t),t.onAdd&&t.onAdd(this),this._notifyAddComponent(t),this}removeComponent(t,e=!1){return e?typeof t=="string"?this._removeComponentByType(t):t instanceof Se&&this._removeComponentByType(t.type):this._componentsToRemove.push(t),this}_removeComponentByType(t){if(this.has(t)){const e=this.get(t);e.owner=null,e.onRemove&&e.onRemove(this);const i=e.constructor;this._componentTypeToInstance.delete(i),this._componentStringToInstance.delete(e.type),this._notifyRemoveComponent(e)}}processComponentRemoval(){for(const t of this._componentsToRemove){const e=typeof t=="string"?t:t.type;this._removeComponentByType(e)}this._componentsToRemove.length=0}has(t){return typeof t=="string"?this._componentStringToInstance.has(t):this._componentTypeToInstance.has(t)}get(t){return typeof t=="string"?this._componentStringToInstance.get(t):this._componentTypeToInstance.get(t)}get isInitialized(){return this._isInitialized}_initialize(t){this.isInitialized||(this.onInitialize(t),super.emit("initialize",new Xi(t,this)),this._isInitialized=!0)}_preupdate(t,e){this.emit("preupdate",new qt(t,e,this)),this.onPreUpdate(t,e)}_postupdate(t,e){this.emit("postupdate",new Yt(t,e,this)),this.onPostUpdate(t,e)}onInitialize(t){}onPreUpdate(t,e){}onPostUpdate(t,e){}update(t,e){this._initialize(t),this._preupdate(t,e);for(const i of this.children)i.update(t,e);this._postupdate(t,e)}}we._ID=0;function bn(a){return!!a.tick}class Cn{constructor(t,e){this._options=t,this._graphics=e,this.graphics=[]}get name(){return this._options.name}hide(t){if(!t)this.graphics.length=0;else{let e=null;t instanceof Be?e=t:e=this._graphics.getGraphic(t),this.graphics=this.graphics.filter(i=>i.graphic!==e),this._graphics.recalculateBounds()}}show(t,e){e={...e};let i;return t instanceof Be?i=this._graphics.copyGraphics?t.clone():t:(i=this._graphics.getGraphic(t),i||v.getInstance().error(`No such graphic added to component named ${t}. These named graphics are available: `,this._graphics.getNames())),i?(this.graphics.push({graphic:i,options:e}),this._graphics.recalculateBounds(),i):null}use(t,e){return e={...e},this.hide(),this.show(t,e)}get order(){return this._options.order}set order(t){this._options.order=t}get offset(){var t;return(t=this._options.offset)!==null&&t!==void 0?t:p.Zero}set offset(t){this._options.offset=t}get currentKeys(){var t;return(t=this.name)!==null&&t!==void 0?t:"anonymous"}}class sr{constructor(t){this._component=t,this._layers=[],this._layerMap={},this.default=new Cn({name:"default",order:0},t),this._maybeAddLayer(this.default)}create(t){const e=new Cn(t,this._component);return this._maybeAddLayer(e)}get(t){return t?this._getLayer(t):this._layers}currentKeys(){const t=[];for(const e of this._layers)t.push(e.currentKeys);return t}has(t){return t in this._layerMap}_maybeAddLayer(t){return this._layerMap[t.name]?this._layerMap[t.name]:(this._layerMap[t.name]=t,this._layers.push(t),this._layers.sort((e,i)=>e.order-i.order),t)}_getLayer(t){return this._layerMap[t]}}class Qe extends Se{constructor(t){super(),this.type="ex.graphics",this._graphics={},this.visible=!0,this.opacity=1,this.offset=p.Zero,this.anchor=p.Half,this.copyGraphics=!1,this._localBounds=null,t={visible:this.visible,...t};const{current:e,anchor:i,opacity:n,visible:o,graphics:h,offset:d,copyGraphics:u,onPreDraw:x,onPostDraw:Q}=t;this._graphics=h||{},this.offset=d??this.offset,this.opacity=n??this.opacity,this.anchor=i??this.anchor,this.copyGraphics=u??this.copyGraphics,this.onPreDraw=x??this.onPreDraw,this.onPostDraw=Q??this.onPostDraw,this.visible=!!o,this.layers=new sr(this),e&&this._graphics[e]&&this.show(this._graphics[e])}getGraphic(t){return this._graphics[t]}getNames(){return Object.keys(this._graphics)}get current(){return this.layers.default.graphics}get graphics(){return this._graphics}add(t,e){let i="default",n=null;return typeof t=="string"?(i=t,n=e):n=t,this._graphics[i]=this.copyGraphics?n.clone():n,i==="default"&&this.show("default"),n}show(t,e){const i=this.layers.default.show(t,e);return this.recalculateBounds(),i}use(t,e){const i=this.layers.default.use(t,e);return this.recalculateBounds(),i}hide(t){this.layers.default.hide(t)}set localBounds(t){this._localBounds=t}recalculateBounds(){let t=new N;for(const e of this.layers.get())for(const{graphic:i,options:n}of e.graphics){let o=this.anchor,h=this.offset;n!=null&&n.anchor&&(o=n.anchor),n!=null&&n.offset&&(h=n.offset);const d=i.localBounds,u=-d.width*o.x+h.x,x=-d.height*o.y+h.y;t=i==null?void 0:i.localBounds.translate(m(u+e.offset.x,x+e.offset.y)).combine(t)}this._localBounds=t}get localBounds(){return(!this._localBounds||this._localBounds.hasZeroDimensions())&&this.recalculateBounds(),this._localBounds}update(t,e=0){for(const i of this.layers.get())for(const{graphic:n}of i.graphics)bn(n)&&(n==null||n.tick(t,e))}}class js extends ce{constructor(t){super(t),this.width=t.width,this.height=t.height,this.rasterize()}clone(){return new js({width:this.width,height:this.height,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){this.color&&t.fillRect(0,0,this.width,this.height),this.strokeColor&&t.strokeRect(0,0,this.width,this.height)}}class Xs extends ce{constructor(t){var e,i;super(t),this._radius=0,this.padding=(e=t.padding)!==null&&e!==void 0?e:2,this.radius=t.radius,this.filtering=(i=t.filtering)!==null&&i!==void 0?i:xe.Blended,this.rasterize()}get radius(){return this._radius}set radius(t){this._radius=t,this.width=this._radius*2,this.height=this._radius*2,this.flagDirty()}clone(){return new Xs({radius:this.radius,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){this.radius>0&&(t.beginPath(),t.arc(this.radius,this.radius,this.radius,0,Math.PI*2),this.color&&t.fill(),this.strokeColor&&t.stroke())}}class es extends Se{constructor(){super(...arguments),this.type="ex.pointer",this.useColliderShape=!0,this.useGraphicsBounds=!1}}class ne{static CreateReversibleEasingFunction(t){return(e,i,n,o)=>n<i?i-(t(e,n,i,o)-n):t(e,i,n,o)}static CreateVectorEasingFunction(t){return(e,i,n,o)=>new p(t(e,i.x,n.x,o),t(e,i.y,n.y,o))}}ne.Linear=ne.CreateReversibleEasingFunction((a,t,e,i)=>(e=e-t,e*a/i+t)),ne.EaseInQuad=ne.CreateReversibleEasingFunction((a,t,e,i)=>(e=e-t,a/=i,e*a*a+t)),ne.EaseOutQuad=ne.CreateReversibleEasingFunction((a,t,e,i)=>(e=e-t,a/=i,-e*a*(a-2)+t)),ne.EaseInOutQuad=ne.CreateReversibleEasingFunction((a,t,e,i)=>(e=e-t,a/=i/2,a<1?e/2*a*a+t:(a--,-e/2*(a*(a-2)-1)+t))),ne.EaseInCubic=ne.CreateReversibleEasingFunction((a,t,e,i)=>(e=e-t,a/=i,e*a*a*a+t)),ne.EaseOutCubic=ne.CreateReversibleEasingFunction((a,t,e,i)=>(e=e-t,a/=i,a--,e*(a*a*a+1)+t)),ne.EaseInOutCubic=ne.CreateReversibleEasingFunction((a,t,e,i)=>(e=e-t,a/=i/2,a<1?e/2*a*a*a+t:(a-=2,e/2*(a*a*a+2)+t)));class nr{constructor(t){this._actions=[],this._completedActions=[],this._entity=t}add(t){this._actions.push(t)}remove(t){const e=this._actions.indexOf(t);this._actions.splice(e,1)}clearActions(){this._actions.length=0,this._completedActions.length=0,this._currentAction&&this._currentAction.stop()}getActions(){return this._actions.concat(this._completedActions)}hasNext(){return this._actions.length>0}isComplete(){return this._actions.length===0}reset(){this._actions=this.getActions();const t=this._actions.length;for(let e=0;e<t;e++)this._actions[e].reset();this._completedActions=[]}update(t){this._actions.length>0&&(this._currentAction=this._actions[0],this._currentAction.update(t),this._currentAction.isComplete(this._entity)&&this._completedActions.push(this._actions.shift()))}}class rr{constructor(t,e,i){this._stopped=!1,this._repeatBuilder=e,this._repeatContext=new ms(t),this._actionQueue=this._repeatContext.getQueue(),this._repeat=i,this._originalRepeat=i,this._repeatBuilder(this._repeatContext),this._repeat--}update(t){this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext),this._repeat--),this._actionQueue.update(t)}isComplete(){return this._stopped||this._repeat<=0&&this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._repeat=this._originalRepeat}}class or{constructor(t,e){this._stopped=!1,this._repeatBuilder=e,this._repeatContext=new ms(t),this._actionQueue=this._repeatContext.getQueue(),this._repeatBuilder(this._repeatContext)}update(t){this._stopped||(this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext)),this._actionQueue.update(t))}isComplete(){return this._stopped}stop(){this._stopped=!0,this._actionQueue.clearActions()}reset(){}}class ar{constructor(t,e,i,n){if(this._started=!1,this._stopped=!1,this._entity=t,this._tx=t.get(Pt),this._motion=t.get(ie),this._speed=n,this._offset=new p(e,i),n<=0)throw v.getInstance().error("Attempted to moveBy with speed less than or equal to zero : "+n),new Error("Speed must be greater than 0 pixels per second")}update(t){this._started||(this._started=!0,this._start=new p(this._tx.pos.x,this._tx.pos.y),this._end=this._start.add(this._offset),this._distance=this._offset.size,this._dir=this._end.sub(this._start).normalize()),this.isComplete(this._entity)?(this._tx.pos=m(this._end.x,this._end.y),this._motion.vel=m(0,0)):this._motion.vel=this._dir.scale(this._speed)}isComplete(t){const e=t.get(Pt);return this._stopped||e.pos.distance(this._start)>=this._distance}stop(){this._motion.vel=m(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class lr{constructor(t,e,i,n){this.entity=t,this._started=!1,this._stopped=!1,this._tx=t.get(Pt),this._motion=t.get(ie),this._end=new p(e,i),this._speed=n}update(t){this._started||(this._started=!0,this._start=new p(this._tx.pos.x,this._tx.pos.y),this._distance=this._start.distance(this._end),this._dir=this._end.sub(this._start).normalize());const e=this._dir.scale(this._speed);this._motion.vel=m(e.x,e.y),this.isComplete(this.entity)&&(this._tx.pos=m(this._end.x,this._end.y),this._motion.vel=m(0,0))}isComplete(t){const e=t.get(Pt);return this._stopped||new p(e.pos.x,e.pos.y).distance(this._start)>=this._distance}stop(){this._motion.vel=m(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}var ze;(function(a){a[a.ShortestPath=0]="ShortestPath",a[a.LongestPath=1]="LongestPath",a[a.Clockwise=2]="Clockwise",a[a.CounterClockwise=3]="CounterClockwise"})(ze||(ze={}));class Or{constructor(t,e,i,n){this._started=!1,this._stopped=!1,this._tx=t.get(Pt),this._motion=t.get(ie),this._end=e,this._speed=i,this._rotationType=n||ze.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation;const e=Math.abs(this._end-this._start),i=S-e;switch(e>i?(this._shortDistance=i,this._longDistance=e):(this._shortDistance=e,this._longDistance=i),this._shortestPathIsPositive=(this._start-this._end+S)%S>=Math.PI,this._rotationType){case ze.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case ze.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case ze.Clockwise:this._direction=1,this._shortestPathIsPositive?this._distance=this._shortDistance:this._distance=this._longDistance;break;case ze.CounterClockwise:this._direction=-1,this._shortestPathIsPositive?this._distance=this._longDistance:this._distance=this._shortDistance;break}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class yn{constructor(t,e,i,n){this._started=!1,this._stopped=!1,this._tx=t.get(Pt),this._motion=t.get(ie),this._speed=i,this._offset=e,this._rotationType=n||ze.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation,this._end=this._start+this._offset;const e=Math.abs(this._end-this._start),i=S-e;switch(e>i?(this._shortDistance=i,this._longDistance=e):(this._shortDistance=e,this._longDistance=i),this._shortestPathIsPositive=(this._start-this._end+S)%S>=Math.PI,this._rotationType){case ze.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case ze.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case ze.Clockwise:this._direction=1,this._shortDistance>=0?this._distance=this._shortDistance:this._distance=this._longDistance;break;case ze.CounterClockwise:this._direction=-1,this._shortDistance<=0?this._distance=this._shortDistance:this._distance=this._longDistance;break}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._start=void 0,this._currentNonCannonAngle=void 0,this._distance=void 0}}class hr{constructor(t,e,i,n,o){this._started=!1,this._stopped=!1,this._tx=t.get(Pt),this._motion=t.get(ie),this._endX=e,this._endY=i,this._speedX=n,this._speedY=o}update(t){if(this._started||(this._started=!0,this._startX=this._tx.scale.x,this._startY=this._tx.scale.y,this._distanceX=Math.abs(this._endX-this._startX),this._distanceY=Math.abs(this._endY-this._startY)),Math.abs(this._tx.scale.x-this._startX)>=this._distanceX)this._motion.scaleFactor.x=0;else{const e=this._endY<this._startY?-1:1;this._motion.scaleFactor.x=this._speedX*e}if(Math.abs(this._tx.scale.y-this._startY)>=this._distanceY)this._motion.scaleFactor.y=0;else{const e=this._endY<this._startY?-1:1;this._motion.scaleFactor.y=this._speedY*e}this.isComplete()&&(this._tx.scale=m(this._endX,this._endY),this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.y-this._startX)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startY)>=this._distanceY-.01}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class xn{constructor(t,e,i,n){this._started=!1,this._stopped=!1,this._tx=t.get(Pt),this._motion=t.get(ie),this._offset=new p(e,i),this._speedX=this._speedY=n}update(t){this._started||(this._started=!0,this._startScale=this._tx.scale.clone(),this._endScale=this._startScale.add(this._offset),this._distanceX=Math.abs(this._endScale.x-this._startScale.x),this._distanceY=Math.abs(this._endScale.y-this._startScale.y),this._directionX=this._endScale.x<this._startScale.x?-1:1,this._directionY=this._endScale.y<this._startScale.y?-1:1),this._motion.scaleFactor.x=this._speedX*this._directionX,this._motion.scaleFactor.y=this._speedY*this._directionY,this.isComplete()&&(this._tx.scale=this._endScale,this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.x-this._startScale.x)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startScale.y)>=this._distanceY-.01}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class cr{constructor(t){this._method=null,this._hasBeenCalled=!1,this._method=t}update(t){this._method(),this._hasBeenCalled=!0}isComplete(){return this._hasBeenCalled}reset(){this._hasBeenCalled=!1}stop(){this._hasBeenCalled=!0}}class dr{constructor(t,e,i,n,o){this.easingFcn=o,this._currentLerpTime=0,this._lerpDuration=1*1e3,this._lerpStart=new p(0,0),this._lerpEnd=new p(0,0),this._initialized=!1,this._stopped=!1,this._tx=t.get(Pt),this._motion=t.get(ie),this._lerpDuration=n,this._lerpEnd=new p(e,i)}_initialize(){this._lerpStart=new p(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0}update(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;let e=this._tx.pos.x,i=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(this._lerpEnd.x<this._lerpStart.x?e=this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):e=this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),this._lerpEnd.y<this._lerpStart.y?i=this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):i=this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=m((e-this._tx.pos.x)/(t/1e3),(i-this._tx.pos.y)/(t/1e3))):(this._tx.pos=m(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=p.Zero)}isComplete(){return this._stopped||this._currentLerpTime>=this._lerpDuration}reset(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}stop(){this._motion.vel=m(0,0),this._stopped=!0}}class In{constructor(t,e,i,n,o){this.easingFcn=o,this._currentLerpTime=0,this._lerpDuration=1*1e3,this._lerpStart=new p(0,0),this._lerpEnd=new p(0,0),this._initialized=!1,this._stopped=!1,this._tx=t.get(Pt),this._motion=t.get(ie),this._lerpDuration=n,this._offset=new p(e,i)}_initialize(){this._lerpStart=new p(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0,this._lerpEnd=this._lerpStart.add(this._offset)}update(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;let e=this._tx.pos.x,i=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(this._lerpEnd.x<this._lerpStart.x?e=this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):e=this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),this._lerpEnd.y<this._lerpStart.y?i=this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):i=this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=m((e-this._tx.pos.x)/(t/1e3),(i-this._tx.pos.y)/(t/1e3))):(this._tx.pos=m(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=p.Zero)}isComplete(){return this._stopped||this._currentLerpTime>=this._lerpDuration}reset(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}stop(){this._motion.vel=m(0,0),this._stopped=!0}}class Ar{constructor(t,e,i,n=1){this._timeVisible=0,this._timeNotVisible=0,this._elapsedTime=0,this._totalTime=0,this._stopped=!1,this._started=!1,this._graphics=t.get(Qe),this._timeVisible=e,this._timeNotVisible=i,this._duration=(e+i)*n}update(t){this._started||(this._started=!0,this._elapsedTime=0,this._totalTime=0),this._graphics&&(this._elapsedTime+=t,this._totalTime+=t,this._graphics.visible&&this._elapsedTime>=this._timeVisible&&(this._graphics.visible=!1,this._elapsedTime=0),!this._graphics.visible&&this._elapsedTime>=this._timeNotVisible&&(this._graphics.visible=!0,this._elapsedTime=0),this.isComplete()&&(this._graphics.visible=!0))}isComplete(){return this._stopped||this._totalTime>=this._duration}stop(){this._graphics&&(this._graphics.visible=!0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._elapsedTime=0,this._totalTime=0}}class Hr{constructor(t,e,i){this._multiplier=1,this._started=!1,this._stopped=!1,this._graphics=t.get(Qe),this._endOpacity=e,this._speed=this._ogspeed=i}update(t){this._graphics&&(this._started||(this._started=!0,this._speed=this._ogspeed,this._endOpacity<this._graphics.opacity?this._multiplier=-1:this._multiplier=1),this._speed>0&&(this._graphics.opacity+=this._multiplier*(Math.abs(this._graphics.opacity-this._endOpacity)*t)/this._speed),this._speed-=t,this.isComplete()&&(this._graphics.opacity=this._endOpacity),v.getInstance().debug("[Action fade] Actor opacity:",this._graphics.opacity))}isComplete(){return this._stopped||Math.abs(this._graphics.opacity-this._endOpacity)<.05}stop(){this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class qs{constructor(t){this._elapsedTime=0,this._started=!1,this._stopped=!1,this._delay=t}update(t){this._started||(this._started=!0),this._elapsedTime+=t}isComplete(){return this._stopped||this._elapsedTime>=this._delay}stop(){this._stopped=!0}reset(){this._elapsedTime=0,this._started=!1,this._stopped=!1}}class Ur{constructor(t){this._stopped=!1,this._entity=t}update(t){this._entity.get(vs).clearActions(),this._entity.kill(),this._stopped=!0}isComplete(){return this._stopped}stop(){}reset(){}}class En{constructor(t,e,i){this._started=!1,this._stopped=!1,this._tx=t.get(Pt),this._motion=t.get(ie),this._followTx=e.get(Pt),this._followMotion=e.get(ie),this._current=new p(this._tx.pos.x,this._tx.pos.y),this._end=new p(this._followTx.pos.x,this._followTx.pos.y),this._maximumDistance=i!==void 0?i:this._current.distance(this._end),this._speed=0}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const e=Math.sqrt(Math.pow(this._followMotion.vel.x,2)+Math.pow(this._followMotion.vel.y,2));if(e!==0&&(this._speed=e),this._current=m(this._tx.pos.x,this._tx.pos.y),this._end=m(this._followTx.pos.x,this._followTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize(),this._distanceBetween>=this._maximumDistance){const i=this._dir.scale(this._speed);this._motion.vel=m(i.x,i.y)}else this._motion.vel=m(0,0);this.isComplete()&&(this._tx.pos=m(this._end.x,this._end.y),this._motion.vel=m(0,0))}stop(){this._motion.vel=m(0,0),this._stopped=!0}isComplete(){return this._stopped}reset(){this._started=!1,this._stopped=!1}}class ur{constructor(t,e,i){this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this._tx=t.get(Pt),this._motion=t.get(ie),this._meetTx=e.get(Pt),this._meetMotion=e.get(ie),this._current=new p(this._tx.pos.x,this._tx.pos.y),this._end=new p(this._meetTx.pos.x,this._meetTx.pos.y),this._speed=i||0,i!==void 0&&(this._speedWasSpecified=!0)}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const e=Math.sqrt(Math.pow(this._meetMotion.vel.x,2)+Math.pow(this._meetMotion.vel.y,2));e!==0&&!this._speedWasSpecified&&(this._speed=e),this._current=m(this._tx.pos.x,this._tx.pos.y),this._end=m(this._meetTx.pos.x,this._meetTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize();const i=this._dir.scale(this._speed);this._motion.vel=m(i.x,i.y),this.isComplete()&&(this._tx.pos=m(this._end.x,this._end.y),this._motion.vel=m(0,0))}isComplete(){return this._stopped||this._distanceBetween<=1}stop(){this._motion.vel=m(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._distanceBetween=void 0}}class ms{constructor(t){this._entity=t,this._queue=new nr(t)}getQueue(){return this._queue}update(t){this._queue.update(t)}clearActions(){this._queue.clearActions()}runAction(t){return t.reset(),this._queue.add(t),this}easeTo(...t){var e,i;let n=0,o=0,h=0,d=ne.Linear;return t[0]instanceof p?(n=t[0].x,o=t[0].y,h=t[1],d=(e=t[2])!==null&&e!==void 0?e:d):(n=t[0],o=t[1],h=t[2],d=(i=t[3])!==null&&i!==void 0?i:d),this._queue.add(new dr(this._entity,n,o,h,d)),this}easeBy(...t){var e,i;let n=0,o=0,h=0,d=ne.Linear;return t[0]instanceof p?(n=t[0].x,o=t[0].y,h=t[1],d=(e=t[2])!==null&&e!==void 0?e:d):(n=t[0],o=t[1],h=t[2],d=(i=t[3])!==null&&i!==void 0?i:d),this._queue.add(new In(this._entity,n,o,h,d)),this}moveTo(t,e,i){let n=0,o=0,h=0;return t instanceof p?(n=t.x,o=t.y,h=e):(n=t,o=e,h=i),this._queue.add(new lr(this._entity,n,o,h)),this}moveBy(t,e,i){let n=0,o=0,h=0;return t instanceof p?(n=t.x,o=t.y,h=e):(n=t,o=e,h=i),this._queue.add(new ar(this._entity,n,o,h)),this}rotateTo(t,e,i){return this._queue.add(new Or(this._entity,t,e,i)),this}rotateBy(t,e,i){return this._queue.add(new yn(this._entity,t,e,i)),this}scaleTo(t,e,i,n){let o=1,h=1,d=0,u=0;return t instanceof p&&e instanceof p&&(o=t.x,h=t.y,d=e.x,u=e.y),typeof t=="number"&&typeof e=="number"&&(o=t,h=e,d=i,u=n),this._queue.add(new hr(this._entity,o,h,d,u)),this}scaleBy(t,e,i){let n=1,o=1;return t instanceof p&&(n=t.x,o=t.y,i=e),typeof t=="number"&&typeof e=="number"&&(n=t,o=e),this._queue.add(new xn(this._entity,n,o,i)),this}blink(t,e,i=1){return this._queue.add(new Ar(this._entity,t,e,i)),this}fade(t,e){return this._queue.add(new Hr(this._entity,t,e)),this}delay(t){return this._queue.add(new qs(t)),this}die(){return this._queue.add(new Ur(this._entity)),this}callMethod(t){return this._queue.add(new cr(t)),this}repeat(t,e){return e?(this._queue.add(new rr(this._entity,t,e)),this):(this.repeatForever(t),this)}repeatForever(t){return this._queue.add(new or(this._entity,t)),this}follow(t,e){return e===void 0?this._queue.add(new En(this._entity,t)):this._queue.add(new En(this._entity,t,e)),this}meet(t,e){return e===void 0?this._queue.add(new ur(this._entity,t)):this._queue.add(new ur(this._entity,t,e)),this}toPromise(){return new Promise(e=>{this._queue.add(new cr(()=>{e()}))})}}class vs extends Se{constructor(){super(...arguments),this.type="ex.actions",this.dependencies=[Pt,ie]}onAdd(t){this._ctx=new ms(t)}onRemove(){this._ctx=null}getQueue(){var t;return(t=this._ctx)===null||t===void 0?void 0:t.getQueue()}runAction(t){var e;return(e=this._ctx)===null||e===void 0?void 0:e.runAction(t)}update(t){var e;return(e=this._ctx)===null||e===void 0?void 0:e.update(t)}clearActions(){var t;(t=this._ctx)===null||t===void 0||t.clearActions()}easeTo(...t){return this._ctx.easeTo.apply(this._ctx,t)}easeBy(...t){return this._ctx.easeBy.apply(this._ctx,t)}moveTo(t,e,i){return this._ctx.moveTo.apply(this._ctx,[t,e,i])}moveBy(t,e,i){return this._ctx.moveBy.apply(this._ctx,[t,e,i])}rotateTo(t,e,i){return this._ctx.rotateTo(t,e,i)}rotateBy(t,e,i){return this._ctx.rotateBy(t,e,i)}scaleTo(t,e,i,n){return this._ctx.scaleTo.apply(this._ctx,[t,e,i,n])}scaleBy(t,e,i){return this._ctx.scaleBy.apply(this._ctx,[t,e,i])}blink(t,e,i){return this._ctx.blink(t,e,i)}fade(t,e){return this._ctx.fade(t,e)}delay(t){return this._ctx.delay(t)}die(){return this._ctx.die()}callMethod(t){return this._ctx.callMethod(t)}repeat(t,e){return this._ctx.repeat(t,e)}repeatForever(t){return this._ctx.repeatForever(t)}follow(t,e){return this._ctx.follow(t,e)}meet(t,e){return this._ctx.meet(t,e)}toPromise(){return this._ctx.toPromise()}}var Bn;(function(a){a.Em="em",a.Rem="rem",a.Px="px",a.Pt="pt",a.Percent="%"})(Bn||(Bn={}));var ws;(function(a){a.Left="left",a.Right="right",a.Center="center",a.Start="start",a.End="end"})(ws||(ws={}));var Ni;(function(a){a.Top="top",a.Hanging="hanging",a.Middle="middle",a.Alphabetic="alphabetic",a.Ideographic="ideographic",a.Bottom="bottom"})(Ni||(Ni={}));var Sn;(function(a){a.Normal="normal",a.Italic="italic",a.Oblique="oblique"})(Sn||(Sn={}));var kn;(function(a){a.LeftToRight="ltr",a.RightToLeft="rtl"})(kn||(kn={}));class ri extends Be{constructor(t={}){var e,i,n,o,h,d,u,x,Q,J,et,dt,ft,xt,It,ut,pt,Tt,Qt;super(t),this.filtering=xe.Blended,this.quality=2,this.padding=2,this.smoothing=!1,this.lineWidth=1,this.lineDash=[],this.color=I.Black,this.family="sans-serif",this.style=Sn.Normal,this.bold=!1,this.unit=Bn.Px,this.textAlign=ws.Left,this.baseAlign=Ni.Alphabetic,this.direction=kn.LeftToRight,this.size=10,this.shadow=null,this._textBounds=new N,this._cachedTextMeasurement=new Map,this._bitmapToTextMeasurement=new Map,this._textToBitmap=new Map,this._bitmapUsage=new Map,this._textFragments=[],this.smoothing=(e=t==null?void 0:t.smoothing)!==null&&e!==void 0?e:this.smoothing,this.padding=(i=t==null?void 0:t.padding)!==null&&i!==void 0?i:this.padding,this.color=(n=t==null?void 0:t.color)!==null&&n!==void 0?n:this.color,this.strokeColor=(o=t==null?void 0:t.strokeColor)!==null&&o!==void 0?o:this.strokeColor,this.lineDash=(h=t==null?void 0:t.lineDash)!==null&&h!==void 0?h:this.lineDash,this.lineWidth=(d=t==null?void 0:t.lineWidth)!==null&&d!==void 0?d:this.lineWidth,this.filtering=(u=t==null?void 0:t.filtering)!==null&&u!==void 0?u:this.filtering,this.family=(x=t==null?void 0:t.family)!==null&&x!==void 0?x:this.family,this.style=(Q=t==null?void 0:t.style)!==null&&Q!==void 0?Q:this.style,this.bold=(J=t==null?void 0:t.bold)!==null&&J!==void 0?J:this.bold,this.size=(et=t==null?void 0:t.size)!==null&&et!==void 0?et:this.size,this.unit=(dt=t==null?void 0:t.unit)!==null&&dt!==void 0?dt:this.unit,this.textAlign=(ft=t==null?void 0:t.textAlign)!==null&&ft!==void 0?ft:this.textAlign,this.baseAlign=(xt=t==null?void 0:t.baseAlign)!==null&&xt!==void 0?xt:this.baseAlign,this.direction=(It=t==null?void 0:t.direction)!==null&&It!==void 0?It:this.direction,this.quality=(ut=t==null?void 0:t.quality)!==null&&ut!==void 0?ut:this.quality,t!=null&&t.shadow&&(this.shadow={},this.shadow.blur=(pt=t.shadow.blur)!==null&&pt!==void 0?pt:this.shadow.blur,this.shadow.offset=(Tt=t.shadow.offset)!==null&&Tt!==void 0?Tt:this.shadow.offset,this.shadow.color=(Qt=t.shadow.color)!==null&&Qt!==void 0?Qt:this.shadow.color)}clone(){return new ri({...this.cloneGraphicOptions(),size:this.size,unit:this.unit,family:this.family,style:this.style,bold:this.bold,textAlign:this.textAlign,baseAlign:this.baseAlign,direction:this.direction,shadow:this.shadow?{blur:this.shadow.blur,offset:this.shadow.offset,color:this.shadow.color}:null})}get fontString(){return`${this.style} ${this.bold?"bold":""} ${this.size}${this.unit} ${this.family}`}get localBounds(){return this._textBounds}_drawImage(t,e,i){}_rotate(t){var e;const i=(e=this.origin)!==null&&e!==void 0?e:this._textBounds.center;t.translate(i.x,i.y),t.rotate(this.rotation),t.translate(-i.x,-i.y)}_flip(t){this.flipHorizontal&&(t.translate(this._textBounds.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,-this._textBounds.height/2/this.scale.y),t.scale(1,-1))}measureText(t){let e=!1,i=this._cachedTextMeasurement.get(t);i||(e=!0);const n=this._getRasterPropertiesHash();if((!i||n!==i.rasterProps)&&(e=!0),e){const o=t.split(`
`),h=o.reduce((xt,It)=>xt.length>It.length?xt:It),d=this._getTextBitmap(t);this._applyFont(d);const u=d.measureText(h);let x=Math.abs(u.actualBoundingBoxAscent)+Math.abs(u.actualBoundingBoxDescent);const Q=x*o.length;x=Q;const J=Q-Math.abs(u.actualBoundingBoxAscent),et=0,dt=0,ft=new N({left:et-Math.abs(u.actualBoundingBoxLeft)-this.padding,top:dt-Math.abs(u.actualBoundingBoxAscent)-this.padding,bottom:dt+J+this.padding,right:et+Math.abs(u.actualBoundingBoxRight)+this.padding});return i={text:t,rasterProps:n,measurement:ft},this._cachedTextMeasurement.set(t,i),this._bitmapToTextMeasurement.set(d,i),i.measurement}else return i.measurement}_setDimension(t,e){e.canvas.width=(t.width+this.padding*2)*2*this.quality,e.canvas.height=(t.height+this.padding*2)*2*this.quality}_postDraw(t){t.restore()}_getRasterPropertiesHash(t){var e,i;return"__hashcode__"+this.fontString+this.showDebug+this.textAlign+this.baseAlign+this.direction+JSON.stringify(this.shadow)+(this.padding.toString()+this.smoothing.toString()+this.lineWidth.toString()+this.lineDash.toString()+((e=this.strokeColor)===null||e===void 0?void 0:e.toString())+(t?t.toString():(i=this.color)===null||i===void 0?void 0:i.toString()).toString())}_applyRasterProperties(t,e){var i,n,o;t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash((i=this.lineDash)!==null&&i!==void 0?i:t.getLineDash()),t.strokeStyle=(n=this.strokeColor)===null||n===void 0?void 0:n.toString(),t.fillStyle=e?e.toString():(o=this.color)===null||o===void 0?void 0:o.toString()}_applyFont(t){t.translate(this.padding+t.canvas.width/2,this.padding+t.canvas.height/2),t.scale(this.quality,this.quality),t.textAlign=this.textAlign,t.textBaseline=this.baseAlign,t.font=this.fontString,t.direction=this.direction,this.shadow&&(t.shadowColor=this.shadow.color.toString(),t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offset.x,t.shadowOffsetY=this.shadow.offset.y)}_drawText(t,e,i,n){const o=e.split(`
`);this._applyRasterProperties(t,i),this._applyFont(t);for(let h=0;h<o.length;h++){const d=o[h];this.color&&t.fillText(d,0,h*n),this.strokeColor&&t.strokeText(d,0,h*n)}this.showDebug&&($n(t,I.Red,-t.canvas.width/2,0,t.canvas.width/2,0,2),$n(t,I.Red,0,-t.canvas.height/2,0,t.canvas.height/2,2))}_getTextBitmap(t,e){const i=t+this._getRasterPropertiesHash(e),n=this._textToBitmap.get(i);if(n)return n;const h=document.createElement("canvas").getContext("2d");return this._textToBitmap.set(i,h),h}_splitTextBitmap(t){const e=[];let i=0,n=0;const o=Math.min(4096,t.canvas.width),h=Math.min(4096,t.canvas.height);for(;i<t.canvas.width;){for(;n<t.canvas.height;){const d=document.createElement("canvas");d.width=o,d.height=h,d.getContext("2d").drawImage(t.canvas,i,n,o,h,0,0,o,h),e.push({x:i,y:n,canvas:d}),n+=h}i+=o,n=0}return e}render(t,e,i,n,o){this.showDebug&&this.clearCache(),this.checkAndClearCache();const h=this._getTextBitmap(e,i),d=!this._bitmapUsage.get(h);this._textBounds=this.measureText(e),d&&this._setDimension(this._textBounds,h),this._preDraw(t,n,o);const u=e.split(`
`),x=this._textBounds.height/u.length;if(d){this._drawText(h,e,i,x);for(const Q of this._textFragments)Xt.delete(Q.canvas);this._textFragments=this._splitTextBitmap(h);for(const Q of this._textFragments)Xt.load(Q.canvas,this.filtering,!0)}for(const Q of this._textFragments)t.drawImage(Q.canvas,0,0,Q.canvas.width,Q.canvas.height,Q.x/this.quality+n-h.canvas.width/this.quality/2,Q.y/this.quality+o-h.canvas.height/this.quality/2,Q.canvas.width/this.quality,Q.canvas.height/this.quality);this._postDraw(t),this._bitmapUsage.set(h,performance.now())}get cacheSize(){return this._bitmapUsage.size}clearCache(){this._bitmapUsage.clear()}checkAndClearCache(){for(const[t,e]of this._bitmapUsage.entries())if(e+1e3<performance.now()){this._bitmapUsage.delete(t);const i=this._bitmapToTextMeasurement.get(t);i&&(this._cachedTextMeasurement.delete(i.text),this._bitmapToTextMeasurement.delete(t)),Xt.delete(t.canvas)}}}class Ws extends Be{constructor(t){var e,i;super(t),this._text="",this._textWidth=0,this._textHeight=0,this.font=(e=t.font)!==null&&e!==void 0?e:new ri,this.color=(i=t.color)!==null&&i!==void 0?i:this.color,this.text=t.text}clone(){var t,e;return new Ws({text:this.text.slice(),color:(e=(t=this.color)===null||t===void 0?void 0:t.clone())!==null&&e!==void 0?e:I.Black,font:this.font.clone()})}get text(){return this._text}set text(t){this._text=t;const e=this.font.measureText(this._text);this._textWidth=e.width,this._textHeight=e.height}get font(){return this._font}set font(t){this._font=t}get width(){return this._textWidth===0&&this._calculateDimension(),this._textWidth*this.scale.x}get height(){return this._textHeight===0&&this._calculateDimension(),this._textHeight*this.scale.y}_calculateDimension(){const{width:t,height:e}=this.font.measureText(this._text);this._textWidth=t,this._textHeight=e}get localBounds(){return this.font.measureText(this._text).scale(this.scale)}_rotate(t){}_flip(t){}_drawImage(t,e,i){var n;let o=I.Black;this.font instanceof ri&&(o=(n=this.color)!==null&&n!==void 0?n:this.font.color),(this.isStale()||this.font.isStale())&&(this.font.flipHorizontal=this.flipHorizontal,this.font.flipVertical=this.flipVertical,this.font.rotation=this.rotation,this.font.origin=this.origin,this.font.opacity=this.opacity),this.font.tint=this.tint;const{width:h,height:d}=this.font.measureText(this._text);this._textWidth=h,this._textHeight=d,this.font.render(t,this._text,o,e,i),this.font.showDebug&&t.debug.drawRect(e-h,i-d,h*2,d*2)}}class mi extends we{constructor(t){super(),this._anchor=ki(p.Half,vt=>this._handleAnchorChange(vt)),this.logger=v.getInstance(),this.scene=null,this._draggable=!1,this._dragging=!1,this._pointerDragStartHandler=()=>{this._dragging=!0},this._pointerDragEndHandler=()=>{this._dragging=!1},this._pointerDragMoveHandler=vt=>{this._dragging&&(this.pos=vt.worldPos)},this._pointerDragLeaveHandler=vt=>{this._dragging&&(this.pos=vt.worldPos)};const{name:e,x:i,y:n,pos:o,coordPlane:h,scale:d,width:u,height:x,radius:Q,collider:J,vel:et,acc:dt,rotation:ft,angularVelocity:xt,z:It,color:ut,visible:pt,anchor:Tt,collisionType:Qt,collisionGroup:zt}={...t};this._setName(e),this.anchor=Tt??mi.defaults.anchor.clone();const Lt=new Pt;this.addComponent(Lt),this.pos=o??m(i??0,n??0),this.rotation=ft??0,this.scale=d??m(1,1),this.z=It??0,Lt.coordPlane=h??je.World,this.addComponent(new es),this.addComponent(new Qe({anchor:this.anchor})),this.addComponent(new ie),this.vel=et??p.Zero,this.acc=dt??p.Zero,this.angularVelocity=xt??0,this.addComponent(new vs),this.addComponent(new Ht),this.body.collisionType=Qt??Gt.Passive,zt&&(this.body.group=zt),J?this.addComponent(new _e(J)):Q?this.addComponent(new _e(se.Circle(Q))):u>0&&x>0?this.addComponent(new _e(se.Box(u,x,this.anchor))):this.addComponent(new _e),this.graphics.visible=pt??!0,ut&&(this.color=ut,u&&x?this.graphics.add(new js({color:ut,width:u,height:x})):Q&&this.graphics.add(new Xs({color:ut,radius:Q})))}get body(){return this.get(Ht)}get transform(){return this.get(Pt)}get motion(){return this.get(ie)}get graphics(){return this.get(Qe)}get collider(){return this.get(_e)}get pointer(){return this.get(es)}get actions(){return this.get(vs)}get pos(){return this.transform.pos}set pos(t){this.transform.pos=t.clone()}get oldPos(){return this.body.oldPos}set oldPos(t){this.body.oldPos.setTo(t.x,t.y)}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t.clone()}get oldVel(){return this.body.oldVel}set oldVel(t){this.body.oldVel.setTo(t.x,t.y)}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t.clone()}set oldAcc(t){this.body.oldAcc.setTo(t.x,t.y)}get oldAcc(){return this.body.oldAcc}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}get scale(){return this.get(Pt).scale}set scale(t){this.get(Pt).scale=t}get anchor(){return this._anchor}set anchor(t){this._anchor=ki(t,e=>this._handleAnchorChange(e)),this._handleAnchorChange(t)}_handleAnchorChange(t){this.graphics&&(this.graphics.anchor=t)}get isOffScreen(){return this.hasTag("ex.offscreen")}get draggable(){return this._draggable}set draggable(t){t&&(t&&!this._draggable?(this.on("pointerdragstart",this._pointerDragStartHandler),this.on("pointerdragend",this._pointerDragEndHandler),this.on("pointerdragmove",this._pointerDragMoveHandler),this.on("pointerdragleave",this._pointerDragLeaveHandler)):!t&&this._draggable&&(this.off("pointerdragstart",this._pointerDragStartHandler),this.off("pointerdragend",this._pointerDragEndHandler),this.off("pointerdragmove",this._pointerDragMoveHandler),this.off("pointerdragleave",this._pointerDragLeaveHandler)),this._draggable=t)}get color(){return this._color}set color(t){var e;this._color=t.clone();const n=(e=this.graphics.layers.default.graphics[0])===null||e===void 0?void 0:e.graphic;(n instanceof ce||n instanceof Ws)&&(n.color=this._color)}onInitialize(t){}_initialize(t){super._initialize(t);for(const e of this.children)e._initialize(t)}on(t,e){super.on(t,e)}once(t,e){super.once(t,e)}off(t,e){super.off(t,e)}_prekill(t){super.emit("prekill",new At(this)),this.onPreKill(t)}onPreKill(t){}_postkill(t){super.emit("postkill",new lt(this)),this.onPostKill(t)}onPostKill(t){}kill(){this.scene?(this._prekill(this.scene),this.emit("kill",new rt(this)),super.kill(),this._postkill(this.scene)):this.logger.warn("Cannot kill actor, it was never added to the Scene")}unkill(){this.active=!0}isKilled(){return!this.active}get z(){return this.get(Pt).z}set z(t){this.get(Pt).z=t}get center(){const t=this.getGlobalPos();return new p(t.x+this.width/2-this.anchor.x*this.width,t.y+this.height/2-this.anchor.y*this.height)}get localCenter(){return new p(this.pos.x+this.width/2-this.anchor.x*this.width,this.pos.y+this.height/2-this.anchor.y*this.height)}get width(){return this.collider.localBounds.width*this.getGlobalScale().x}get height(){return this.collider.localBounds.height*this.getGlobalScale().y}getGlobalRotation(){return this.get(Pt).globalRotation}getGlobalPos(){return this.get(Pt).globalPos}getGlobalScale(){return this.get(Pt).globalScale}contains(t,e,i=!1){const n=m(t,e),o=this.get(_e);o.update();const h=o.get();if(!h)return!1;const d=h.contains(n);return i?d||this.children.some(u=>u.contains(t,e,!0)):d}within(t,e){const i=this.get(_e),n=t.get(_e),o=i.get(),h=n.get();return o&&h?o.getClosestLineBetween(h).getLength()<=e:!1}update(t,e){this._initialize(t),this._preupdate(t,e),this._postupdate(t,e)}onPreUpdate(t,e){}onPostUpdate(t,e){}_preupdate(t,e){this.emit("preupdate",new qt(t,e,this)),this.onPreUpdate(t,e)}_postupdate(t,e){this.emit("postupdate",new qt(t,e,this)),this.onPostUpdate(t,e)}}mi.defaults={anchor:p.Half};function Pn(a){return a instanceof pr}class pr extends mi{constructor(t){super({...t}),this.get(Pt).coordPlane=je.Screen,this.anchor=m(0,0),this.body.collisionType=Gt.PreventCollision,this.collider.useBoxCollider(this.width,this.height,this.anchor)}_initialize(t){this._engine=t,super._initialize(t)}contains(t,e,i=!0){if(i)return super.contains(t,e);const n=this._engine.worldToScreenCoordinates(new p(t,e));return super.contains(n.x,n.y)}}class Gi{constructor(t,e,i,n,o,h){if(this._logger=v.getInstance(),this.id=0,this._elapsedTime=0,this._totalTimeAlive=0,this._running=!1,this._numberOfTicks=0,this.interval=10,this.repeats=!1,this.maxNumberOfRepeats=-1,this.randomRange=[0,0],this._baseInterval=10,this._generateRandomInterval=()=>this._baseInterval+this.random.integer(this.randomRange[0],this.randomRange[1]),this._complete=!1,this.scene=null,typeof t!="function"){const d=t;t=d.fcn,e=d.interval,i=d.repeats,n=d.numberOfRepeats,o=d.randomRange,h=d.random}if(n&&n>=0&&(this.maxNumberOfRepeats=n,!i))throw new Error("repeats must be set to true if numberOfRepeats is set");if(this.id=Gi._MAX_ID++,this._callbacks=[],this._baseInterval=this.interval=e,o){if(o[0]>o[1])throw new Error("min value must be lower than max value for range");this.random=h??new D,this.randomRange=o,this.interval=this._generateRandomInterval(),this.on(()=>{this.interval=this._generateRandomInterval()})}this.repeats=i||this.repeats,t&&this.on(t)}get complete(){return this._complete}on(t){this._callbacks.push(t)}off(t){const e=this._callbacks.indexOf(t);this._callbacks.splice(e,1)}update(t){this._running&&(this._totalTimeAlive+=t,this._elapsedTime+=t,this.maxNumberOfRepeats>-1&&this._numberOfTicks>=this.maxNumberOfRepeats&&(this._complete=!0,this._running=!1,this._elapsedTime=0),!this.complete&&this._elapsedTime>=this.interval&&(this._callbacks.forEach(e=>{e.call(this)}),this._numberOfTicks++,this.repeats?this._elapsedTime=0:(this._complete=!0,this._running=!1,this._elapsedTime=0)))}reset(t,e){if(t&&t>=0&&(this._baseInterval=this.interval=t),this.maxNumberOfRepeats&&this.maxNumberOfRepeats>=0&&(this.maxNumberOfRepeats=e,!this.repeats))throw new Error("repeats must be set to true if numberOfRepeats is set");this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0}get timesRepeated(){return this._numberOfTicks}getTimeRunning(){return this._totalTimeAlive}get timeToNextAction(){return this.complete?0:this.interval-this._elapsedTime}get timeElapsedTowardNextAction(){return this._elapsedTime}get isRunning(){return this._running}pause(){return this._running=!1,this}resume(){return this._running=!0,this}start(){return this.scene||this._logger.warn("Cannot start a timer not part of a scene, timer wont start until added"),this._running=!0,this.complete&&(this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0),this}stop(){return this._running=!1,this._elapsedTime=0,this._numberOfTicks=0,this}cancel(){this.pause(),this.scene&&this.scene.cancelTimer(this)}}Gi._MAX_ID=0;class Qn extends Se{constructor(t){super(),this.type="ex.parallax",this.parallaxFactor=m(1,1),this.parallaxFactor=t??this.parallaxFactor}}class Dn extends Se{constructor(t,e=!0){super(),this.draw=t,this.useTransform=e,this.type="ex.debuggraphics"}}class Tn extends we{constructor(t){var e,i;super(null,t.name),this._token=0,this._onScreenXStart=0,this._onScreenXEnd=Number.MAX_VALUE,this._onScreenYStart=0,this._onScreenYEnd=Number.MAX_VALUE,this.logger=v.getInstance(),this.tiles=[],this._rows=[],this._cols=[],this.renderFromTopOfGraphic=!1,this._collidersDirty=!0,this._originalOffsets=new WeakMap,this.addComponent(new Pt),this.addComponent(new ie),this.addComponent(new Ht({type:Gt.Fixed})),this.addComponent(new Qe({onPostDraw:(o,h)=>this.draw(o,h)})),this.addComponent(new Dn(o=>this.debug(o))),this.addComponent(new _e),this._graphics=this.get(Qe),this._transform=this.get(Pt),this._motion=this.get(ie),this._collider=this.get(_e),this._composite=this._collider.useCompositeCollider([]),this._transform.pos=(e=t.pos)!==null&&e!==void 0?e:p.Zero,this._oldPos=this._transform.pos,this.renderFromTopOfGraphic=(i=t.renderFromTopOfGraphic)!==null&&i!==void 0?i:this.renderFromTopOfGraphic,this.tileWidth=t.tileWidth,this.tileHeight=t.tileHeight,this.rows=t.rows,this.columns=t.columns,this.tiles=new Array(this.rows*this.columns),this._rows=new Array(this.rows),this._cols=new Array(this.columns);let n=[];for(let o=0;o<this.columns;o++){for(let h=0;h<this.rows;h++){const d=new jr({x:o,y:h,map:this});d.map=this,this.tiles[o+h*this.columns]=d,n.push(d),this._rows[h]||(this._rows[h]=[]),this._rows[h].push(d)}this._cols[o]=n,n=[]}this._graphics.localBounds=new N({left:0,top:0,right:this.columns*this.tileWidth,bottom:this.rows*this.tileHeight})}flagCollidersDirty(){this._collidersDirty=!0}get x(){var t;return(t=this._transform.pos.x)!==null&&t!==void 0?t:0}set x(t){var e;!((e=this._transform)===null||e===void 0)&&e.pos&&(this.get(Pt).pos=m(t,this.y))}get y(){var t,e;return(e=(t=this._transform)===null||t===void 0?void 0:t.pos.y)!==null&&e!==void 0?e:0}set y(t){var e;!((e=this._transform)===null||e===void 0)&&e.pos&&(this._transform.pos=m(this.x,t))}get z(){var t;return(t=this._transform.z)!==null&&t!==void 0?t:0}set z(t){this._transform&&(this._transform.z=t)}get rotation(){var t,e;return(e=(t=this._transform)===null||t===void 0?void 0:t.rotation)!==null&&e!==void 0?e:0}set rotation(t){var e;!((e=this._transform)===null||e===void 0)&&e.rotation&&(this._transform.rotation=t)}get scale(){var t,e;return(e=(t=this._transform)===null||t===void 0?void 0:t.scale)!==null&&e!==void 0?e:p.One}set scale(t){var e;!((e=this._transform)===null||e===void 0)&&e.scale&&(this._transform.scale=t)}get pos(){return this._transform.pos}set pos(t){this._transform.pos=t}get vel(){return this._motion.vel}set vel(t){this._motion.vel=t}on(t,e){super.on(t,e)}_initialize(t){super._initialize(t)}_getOrSetColliderOriginalOffset(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);{const e=t.offset;return this._originalOffsets.set(t,e),e}}_updateColliders(){this._composite.clearColliders();const t=[];this._composite=this._collider.useCompositeCollider([]);let e;for(let i=0;i<this.columns;i++){for(let n=0;n<this.rows;n++){n===0&&(e=null);const o=this.tiles[i+n*this.columns];if(o.solid)if(o.getColliders().length>0){for(const h of o.getColliders()){const d=this._getOrSetColliderOriginalOffset(h);h.offset=m(o.x*this.tileWidth,o.y*this.tileHeight).add(d),h.owner=this,this._composite.addCollider(h)}e=null}else e?e=e.combine(o.bounds):e=o.bounds;else e&&t.push(e),e=null}if(e){const n=t[t.length-1];n&&n.top===e.top&&n.bottom===e.bottom?t[t.length-1]=n.combine(e):t.push(e)}}for(const i of t){const n=se.Box(i.width,i.height,p.Zero,m(i.left-this.pos.x,i.top-this.pos.y));n.owner=this,this._composite.addCollider(n)}this._collider.update()}getTileByIndex(t){return this.tiles[t]}getTile(t,e){return t<0||e<0||t>=this.columns||e>=this.rows?null:this.tiles[t+e*this.columns]}getTileByPoint(t){const e=Math.floor((t.x-this.pos.x)/this.tileWidth),i=Math.floor((t.y-this.pos.y)/this.tileHeight),n=this.getTile(e,i);return e>=0&&i>=0&&e<this.columns&&i<this.rows&&n?n:null}getRows(){return this._rows}getColumns(){return this._cols}update(t,e){if(this.onPreUpdate(t,e),this.emit("preupdate",new qt(t,e,this)),!this._oldPos.equals(this.pos)){this.flagCollidersDirty();for(let x=0;x<this.tiles.length;x++)this.tiles[x]&&this.tiles[x].flagDirty()}this._collidersDirty&&(this._collidersDirty=!1,this._updateColliders()),this._token++;const i=t.getWorldBounds(),n=m(i.left,i.top),o=m(i.right,i.bottom);let h=this.pos;const d=this.get(Qn);let u=p.One;if(d){const x=p.One.sub(d.parallaxFactor);u=t.currentScene.camera.pos.scale(x),h=h.add(u)}this._onScreenXStart=Math.max(Math.floor((n.x-h.x)/this.tileWidth)-2,0),this._onScreenYStart=Math.max(Math.floor((n.y-h.y)/this.tileHeight)-2,0),this._onScreenXEnd=Math.max(Math.floor((o.x-h.x)/this.tileWidth)+2,0),this._onScreenYEnd=Math.max(Math.floor((o.y-h.y)/this.tileHeight)+2,0),this._transform.pos=m(this.x,this.y),this.onPostUpdate(t,e),this.emit("postupdate",new Yt(t,e,this))}draw(t,e){this.emit("predraw",new yt(t,e,this));let i=this._onScreenXStart;const n=Math.min(this._onScreenXEnd,this.columns);let o=this._onScreenYStart;const h=Math.min(this._onScreenYEnd,this.rows);let d,u,x;for(i;i<n;i++){for(o;o<h;o++)for(d=this.getTile(i,o).getGraphics(),u=0,x=d.length;u<x;u++){const Q=d[u];if(Q){bn(Q)&&(Q==null||Q.tick(e,this._token));const J=this.renderFromTopOfGraphic?0:Q.height-this.tileHeight;Q.draw(t,i*this.tileWidth,o*this.tileHeight-J)}}o=this._onScreenYStart}this.emit("postdraw",new kt(t,e,this))}debug(t){const e=this.tileWidth*this.columns,i=this.tileHeight*this.rows,n=p.Zero;for(let h=0;h<this.rows+1;h++){const d=m(0,h*this.tileHeight);t.drawLine(n.add(d),n.add(m(e,d.y)),I.Red,2)}for(let h=0;h<this.columns+1;h++){const d=m(h*this.tileWidth,0);t.drawLine(n.add(d),n.add(m(d.x,i)),I.Red,2)}const o=this._composite.getColliders();for(const h of o){const d=I.Gray;d.a=.5;const u=h.localBounds,x=h.worldPos.sub(this.pos);t.drawRectangle(x,u.width,u.height,d)}}}class jr extends we{constructor(t){var e,i;super(),this._posDirty=!1,this._solid=!1,this._graphics=[],this._colliders=[],this.data=new Map,this.x=t.x,this.y=t.y,this.map=t.map,this.width=t.map.tileWidth,this.height=t.map.tileHeight,this.solid=(e=t.solid)!==null&&e!==void 0?e:this.solid,this._graphics=(i=t.graphics)!==null&&i!==void 0?i:[],this._recalculate()}get pos(){return this._posDirty&&(this._recalculate(),this._posDirty=!1),this._pos}get solid(){return this._solid}set solid(t){var e;(e=this.map)===null||e===void 0||e.flagCollidersDirty(),this._solid=t}getGraphics(){return this._graphics}addGraphic(t){this._graphics.push(t)}removeGraphic(t){ot(t,this._graphics)}clearGraphics(){this._graphics.length=0}getColliders(){return this._colliders}addCollider(t){this._colliders.push(t),this.map.flagCollidersDirty()}removeCollider(t){const e=this._colliders.indexOf(t);e>-1&&this._colliders.splice(e,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}flagDirty(){return this._posDirty=!0}_recalculate(){this._pos=this.map.pos.add(m(this.x*this.map.tileWidth,this.y*this.map.tileHeight)),this._bounds=new N(this._pos.x,this._pos.y,this._pos.x+this.width,this._pos.y+this.height),this._posDirty=!1}get bounds(){return this._posDirty&&this._recalculate(),this._bounds}get center(){return this._posDirty&&this._recalculate(),new p(this._pos.x+this.width/2,this._pos.y+this.height/2)}}class Xr{constructor(t){this.camera=t}lockToActor(t){this.camera.addStrategy(new Mn(t))}lockToActorAxis(t,e){this.camera.addStrategy(new qr(t,e))}elasticToActor(t,e,i){this.camera.addStrategy(new Wr(t,e,i))}radiusAroundActor(t,e){this.camera.addStrategy(new Rn(t,e))}limitCameraBounds(t){this.camera.addStrategy(new Yr(t))}}var Fn;(function(a){a[a.X=0]="X",a[a.Y=1]="Y"})(Fn||(Fn={}));class Mn{constructor(t){this.target=t,this.action=(e,i,n,o)=>e.center}}class qr{constructor(t,e){this.target=t,this.axis=e,this.action=(i,n,o,h)=>{const d=i.center,u=n.getFocus();return this.axis===Fn.X?new p(d.x,u.y):new p(u.x,d.y)}}}class Wr{constructor(t,e,i){this.target=t,this.cameraElasticity=e,this.cameraFriction=i,this.action=(n,o,h,d)=>{const u=n.center;let x=o.getFocus(),Q=o.vel.clone();const J=u.sub(x).scale(this.cameraElasticity);Q=Q.add(J);const et=Q.scale(-1).scale(this.cameraFriction);return Q=Q.add(et),x=x.add(Q),x}}}class Rn{constructor(t,e){this.target=t,this.radius=e,this.action=(i,n,o,h)=>{const d=i.center,u=n.getFocus(),x=d.sub(u),Q=x.size;if(Q>=this.radius){const J=Q-this.radius;return u.add(x.normalize().scale(J))}return u}}}class Yr{constructor(t){this.target=t,this.boundSizeChecked=!1,this.action=(e,i,n,o)=>{const h=i.getFocus();this.boundSizeChecked||((e.bottom-e.top<n.drawHeight||e.right-e.left<n.drawWidth)&&v.getInstance().warn("Camera bounds should not be smaller than the engine viewport"),this.boundSizeChecked=!0);let d=h.x,u=h.y;return h.x<e.left+n.halfDrawWidth?d=e.left+n.halfDrawWidth:h.x>e.right-n.halfDrawWidth&&(d=e.right-n.halfDrawWidth),h.y<e.top+n.halfDrawHeight?u=e.top+n.halfDrawHeight:h.y>e.bottom-n.halfDrawHeight&&(u=e.bottom-n.halfDrawHeight),m(d,u)}}}class Kr extends We{constructor(){super(...arguments),this.transform=nt.identity(),this.inverse=nt.identity(),this._cameraStrategies=[],this.strategy=new Xr(this),this._z=1,this.dz=0,this.az=0,this.rotation=0,this._angularVelocity=0,this._posChanged=!1,this._pos=Pr(p.Zero,()=>this._posChanged=!0),this.vel=p.Zero,this.acc=p.Zero,this._cameraMoving=!1,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=null,this._lerpEnd=null,this._isShaking=!1,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._elapsedShakeTime=0,this._xShake=0,this._yShake=0,this._isZooming=!1,this._zoomStart=1,this._zoomEnd=1,this._currentZoomTime=0,this._zoomDuration=0,this._zoomEasing=ne.EaseInOutCubic,this._easing=ne.EaseInOutCubic,this._halfWidth=0,this._halfHeight=0,this._viewport=null,this._isInitialized=!1}get zoom(){return this._z}set zoom(t){this._z=t,this._engine&&(this._halfWidth=this._engine.halfDrawWidth,this._halfHeight=this._engine.halfDrawHeight)}get angularVelocity(){return this._angularVelocity}set angularVelocity(t){this._angularVelocity=t}get pos(){return this._pos}set pos(t){this._pos=Pr(t,()=>this._posChanged=!0),this._posChanged=!0}get x(){return this.pos.x}set x(t){!this._follow&&!this._cameraMoving&&(this.pos=m(t,this.pos.y))}get y(){return this.pos.y}set y(t){!this._follow&&!this._cameraMoving&&(this.pos=m(this.pos.x,t))}get dx(){return this.vel.x}set dx(t){this.vel=m(t,this.vel.y)}get dy(){return this.vel.y}set dy(t){this.vel=m(this.vel.x,t)}get ax(){return this.acc.x}set ax(t){this.acc=m(t,this.acc.y)}get ay(){return this.acc.y}set ay(t){this.acc=m(this.acc.x,t)}getFocus(){return this.pos}move(t,e,i=ne.EaseInOutCubic){if(typeof i!="function")throw"Please specify an EasingFunction";return this._follow?Promise.reject(t):(this._lerpPromise&&this._lerpResolve&&this._lerpResolve(t),this._lerpPromise=new Promise(n=>{this._lerpResolve=n}),this._lerpStart=this.getFocus().clone(),this._lerpDuration=e,this._lerpEnd=t,this._currentLerpTime=0,this._cameraMoving=!0,this._easing=i,this._lerpPromise)}shake(t,e,i){this._isShaking=!0,this._shakeMagnitudeX=t,this._shakeMagnitudeY=e,this._shakeDuration=i}zoomOverTime(t,e=0,i=ne.EaseInOutCubic){if(this._zoomPromise=new Promise(n=>{this._zoomResolve=n}),e)this._isZooming=!0,this._zoomEasing=i,this._currentZoomTime=0,this._zoomDuration=e,this._zoomStart=this.zoom,this._zoomEnd=t;else return this._isZooming=!1,this.zoom=t,Promise.resolve(!0);return this._zoomPromise}get viewport(){return this._viewport?this._viewport:new N(0,0,0,0)}addStrategy(t){this._cameraStrategies.push(t)}removeStrategy(t){ot(t,this._cameraStrategies)}clearAllStrategies(){this._cameraStrategies.length=0}_preupdate(t,e){this.emit("preupdate",new qt(t,e,this)),this.onPreUpdate(t,e)}onPreUpdate(t,e){}_postupdate(t,e){this.emit("postupdate",new Yt(t,e,this)),this.onPostUpdate(t,e)}onPostUpdate(t,e){}get isInitialized(){return this._isInitialized}_initialize(t){if(!this.isInitialized){this._engine=t,this._screen=t.screen;const e=this._screen.resolution;let i=m(e.width/2,e.height/2);if(!this._engine.loadingComplete){const n=this._screen.peekResolution();n&&(i=m(n.width/2,n.height/2))}this._halfWidth=i.x,this._halfHeight=i.y,this._posChanged||(this.pos=i),this.updateTransform(),this.runStrategies(t,t.clock.elapsed()),this.updateViewport(),this.updateTransform(),this.onInitialize(t),super.emit("initialize",new Xi(t,this)),this._isInitialized=!0}}onInitialize(t){}on(t,e){super.on(t,e)}off(t,e){super.off(t,e)}once(t,e){super.once(t,e)}runStrategies(t,e){for(const i of this._cameraStrategies)this.pos=i.action.call(i,i.target,this,t,e)}updateViewport(){this._viewport=new N(this.x-this._halfWidth,this.y-this._halfHeight,this.x+this._halfWidth,this.y+this._halfHeight)}update(t,e){if(this._initialize(t),this._preupdate(t,e),this.pos=this.pos.add(this.vel.scale(e/1e3)),this.zoom+=this.dz*e/1e3,this.vel=this.vel.add(this.acc.scale(e/1e3)),this.dz+=this.az*e/1e3,this.rotation+=this.angularVelocity*e/1e3,this._isZooming)if(this._currentZoomTime<this._zoomDuration){const i=this._zoomEasing,n=i(this._currentZoomTime,this._zoomStart,this._zoomEnd,this._zoomDuration);this.zoom=n,this._currentZoomTime+=e}else this._isZooming=!1,this.zoom=this._zoomEnd,this._currentZoomTime=0,this._zoomResolve(!0);if(this._cameraMoving)if(this._currentLerpTime<this._lerpDuration){const n=ne.CreateVectorEasingFunction(this._easing)(this._currentLerpTime,this._lerpStart,this._lerpEnd,this._lerpDuration);this.pos=n,this._currentLerpTime+=e}else{this.pos=this._lerpEnd;const i=this._lerpEnd.clone();this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1,this._lerpResolve(i)}this._isDoneShaking()?(this._isShaking=!1,this._elapsedShakeTime=0,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._xShake=0,this._yShake=0):(this._elapsedShakeTime+=e,this._xShake=(Math.random()*this._shakeMagnitudeX|0)+1,this._yShake=(Math.random()*this._shakeMagnitudeY|0)+1),this.runStrategies(t,e),this.updateViewport(),this.updateTransform(),this._postupdate(t,e)}draw(t){t.multiply(this.transform)}updateTransform(){const t=this._screen.resolution.width/this.zoom,e=this._screen.resolution.height/this.zoom,i=m(-this.x+t/2+this._xShake,-this.y+e/2+this._yShake);this.transform.reset(),this.transform.scale(this.zoom,this.zoom),this.transform.translate(i.x,i.y),this.transform.inverse(this.inverse)}_isDoneShaking(){return!this._isShaking||this._elapsedShakeTime>=this._shakeDuration}}const ko={pos:p.Zero,width:10,height:10,visible:!1,action:()=>{},filter:()=>!0,repeat:-1};class Jr extends mi{constructor(t){super({x:t.pos.x,y:t.pos.y,width:t.width,height:t.height}),this.action=()=>{},this.filter=()=>!0,this.repeat=-1,t={...ko,...t},this.filter=t.filter||this.filter,this.repeat=t.repeat||this.repeat,this.action=t.action||this.action,t.target&&(this.target=t.target),this.graphics.visible=t.visible,this.body.collisionType=Gt.Passive,this.eventDispatcher=new Bi,this.events.on("collisionstart",e=>{this.filter(e.other)&&(this.emit("enter",new Ts(this,e.other)),this._dispatchAction(),this.repeat===0&&this.kill())}),this.events.on("collisionend",e=>{this.filter(e.other)&&this.emit("exit",new qn(this,e.other))})}set target(t){this._target=t,this.filter=e=>e===t}get target(){return this._target}_initialize(t){super._initialize(t)}_dispatchAction(){this.repeat!==0&&(this.action.call(this),this.repeat--)}}var De;(function(a){a.Update="update",a.Draw="draw"})(De||(De={}));class oi{constructor(){this.priority=0}notify(t){}}class Zr{constructor(t){this.data=t,this.type="Entity Added"}}function Ys(a){return!!a&&a.type==="Entity Added"}class $r{constructor(t){this.data=t,this.type="Entity Removed"}}function Po(a){return!!a&&a.type==="Entity Removed"}class to{constructor(t){this._world=t,this.entities=[],this._entityIndex={},this._entitiesToRemove=[]}updateEntities(t,e){for(const i of this.entities)i.update(t.engine,e),i.active||this.removeEntity(i)}findEntitiesForRemoval(){for(const t of this.entities)t.active||this.removeEntity(t)}notify(t){Li(t)&&this._world.queryManager.addEntity(t.data.entity),Vr(t)&&this._world.queryManager.removeComponent(t.data.entity,t.data.component)}addEntity(t){t.active=!0,t&&!this._entityIndex[t.id]&&(this._entityIndex[t.id]=t,this.entities.push(t),this._world.queryManager.addEntity(t),t.componentAdded$.register(this),t.componentRemoved$.register(this),t.children.forEach(e=>this.addEntity(e)),t.childrenAdded$.register({notify:e=>{this.addEntity(e)}}),t.childrenRemoved$.register({notify:e=>{this.removeEntity(e,!1)}}))}removeEntity(t,e=!0){var i;let n=0;t instanceof we?n=t.id:n=t;const o=this._entityIndex[n];if(o&&o.active&&o.kill(),o&&e){this._entitiesToRemove.push(o);return}delete this._entityIndex[n],o&&(ot(o,this.entities),this._world.queryManager.removeEntity(o),o.componentAdded$.unregister(this),o.componentRemoved$.unregister(this),o.children.forEach(h=>this.removeEntity(h,e)),o.childrenAdded$.clear(),o.childrenRemoved$.clear(),!((i=this._world.context)===null||i===void 0)&&i.engine&&this._world.context.engine.stats.currFrame.actors.killed++)}processEntityRemovals(){for(const t of this._entitiesToRemove)t.active||this.removeEntity(t,!1)}processComponentRemovals(){for(const t of this.entities)t.processComponentRemoval()}getById(t){return this._entityIndex[t]}getByName(t){return this.entities.filter(e=>e.name===t)}clear(){for(const t of this.entities)this.removeEntity(t)}}const ai=a=>[...a].sort((e,i)=>e.localeCompare(i)).join("+");class gr extends Ie{constructor(t){super(),this._entities=[],t[0]instanceof Function?this.types=t.map(e=>new e().type):this.types=t}get key(){return this._key?this._key:this._key=ai(this.types)}getEntities(t){return t&&this._entities.sort(t),this._entities}addEntity(t){!Et(this._entities,t)&&this.matches(t)&&(this._entities.push(t),this.notifyAll(new Zr(t)))}removeEntity(t){ot(t,this._entities)&&this.notifyAll(new $r(t))}clear(){this._entities.length=0;for(const t of this.observers)this.unregister(t)}matches(t){let e=[];t instanceof we?e=t.types:e=t;let i=!0;for(const n of this.types)if(i=i&&e.indexOf(n)>-1,!i)return!1;return i}contain(t){return this.types.indexOf(t)>-1}}class eo{constructor(t){this._world=t,this._queries={}}_addQuery(t){this._queries[ai(t.types)]=t;for(const e of this._world.entityManager.entities)t.addEntity(e)}maybeRemoveQuery(t){t.observers.length===0&&(t.clear(),delete this._queries[ai(t.types)])}addEntity(t){for(const e in this._queries)this._queries[e]&&this._queries[e].addEntity(t)}removeComponent(t,e){for(const i in this._queries)this._queries[i].contain(e.type)&&this._queries[i].removeEntity(t)}removeEntity(t){for(const e in this._queries)this._queries[e].removeEntity(t)}createQuery(t){const e=this.getQuery(t);if(e)return e;const i=new gr(t);return this._addQuery(i),i}getQuery(t){const e=ai(t);return this._queries[e]?this._queries[e]:null}}class Ln{constructor(t){this._world=t,this.systems=[],this.initialized=!1}get(t){return this.systems.find(e=>e instanceof t)}addSystem(t){if(!t.types||t.types.length===0)throw new Error("Attempted to add a System without any types");const e=this._world.queryManager.createQuery(t.types);this.systems.push(t),this.systems.sort((i,n)=>i.priority-n.priority),e.register(t),this.initialized&&t.initialize&&t.initialize(this._world.context)}removeSystem(t){ot(t,this.systems);const e=this._world.queryManager.getQuery(t.types);e&&(e.unregister(t),this._world.queryManager.maybeRemoveQuery(e))}initialize(){if(!this.initialized){this.initialized=!0;for(const t of this.systems)t.initialize&&t.initialize(this._world.context)}}updateSystems(t,e,i){const n=this.systems.filter(o=>o.systemType===t);for(const o of n)o.preupdate&&o.preupdate(e,i);for(const o of n){const h=this._world.queryManager.getQuery(o.types).getEntities(o.sort);if(e instanceof Zs)for(const d of h)d._initialize(e==null?void 0:e.engine);o.update(h,i)}for(const o of n)o.postupdate&&o.postupdate(e,i)}clear(){for(const t of this.systems)this.removeSystem(t)}}class fr{constructor(t){this.context=t,this.queryManager=new eo(this),this.entityManager=new to(this),this.systemManager=new Ln(this)}update(t,e){t===De.Update&&this.entityManager.updateEntities(this.context,e),this.systemManager.updateSystems(t,this.context,e),this.entityManager.findEntitiesForRemoval(),this.entityManager.processComponentRemovals(),this.entityManager.processEntityRemovals()}add(t){t instanceof we&&this.entityManager.addEntity(t),t instanceof oi&&this.systemManager.addSystem(t)}remove(t,e=!0){t instanceof we&&this.entityManager.removeEntity(t,e),t instanceof oi&&this.systemManager.removeSystem(t)}clearEntities(){this.entityManager.clear()}clearSystems(){this.systemManager.clear()}}class Te{static integrate(t,e,i,n){const o=n/1e3;e.vel.addEqual(i.scale(o,Te._ACC)),t.pos.add(e.vel.scale(o,Te._VEL),Te._POS).addEqual(i.scale(.5*o*o,Te._VEL_ACC)),e.angularVelocity+=e.torque*(1/e.inertia)*o;const h=t.rotation+e.angularVelocity*o;t.scale.add(e.scaleFactor.scale(o,this._SCALE_FACTOR),Te._SCALE),t.get().setTransform(Te._POS,h,Te._SCALE)}}Te._POS=new p(0,0),Te._SCALE=new p(1,1),Te._ACC=new p(0,0),Te._VEL=new p(0,0),Te._VEL_ACC=new p(0,0),Te._SCALE_FACTOR=new p(0,0);class io extends oi{constructor(){super(...arguments),this.types=["ex.transform","ex.motion"],this.systemType=De.Update,this.priority=-1}update(t,e){let i,n;for(let o=0;o<t.length;o++){i=t[o].get(Pt),n=t[o].get(ie);const h=t[o].get(Ht);if(h!=null&&h.sleeping)continue;const d=n.acc.clone();(h==null?void 0:h.collisionType)===Gt.Active&&(h!=null&&h.useGravity)&&d.addEqual(Ft.gravity),h==null||h.captureOldTransform(),Te.integrate(i,n,d,e)}}}class so{constructor(){this.directionMap=new Map,this.distanceMap=new Map}solve(t){this.preSolve(t),t=t.filter(e=>!e.isCanceled()),t.sort((e,i)=>{const n=this.distanceMap.get(e.id),o=this.distanceMap.get(i.id);return n-o});for(const e of t)this.solvePosition(e),this.solveVelocity(e);return this.postSolve(t),t}preSolve(t){for(const e of t){const i=b.fromDirection(e.mtv),n=e.mtv.negate(),o=e.colliderA.worldPos.squareDistance(e.colliderB.worldPos);this.distanceMap.set(e.id,o),e.colliderA.events.emit("precollision",new $e(e.colliderA,e.colliderB,i,n)),e.colliderB.events.emit("precollision",new $e(e.colliderB,e.colliderA,b.getOpposite(i),n.negate()))}}postSolve(t){var e,i;for(const n of t){if(n.isCanceled())continue;const o=n.colliderA,h=n.colliderB,d=(e=o.owner)===null||e===void 0?void 0:e.get(Ht),u=(i=h.owner)===null||i===void 0?void 0:i.get(Ht);if(d&&u&&(d.collisionType===Gt.Passive||u.collisionType===Gt.Passive))continue;const x=b.fromDirection(n.mtv),Q=n.mtv.negate();n.colliderA.events.emit("postcollision",new ti(n.colliderA,n.colliderB,x,Q)),n.colliderB.events.emit("postcollision",new ti(n.colliderB,n.colliderA,b.getOpposite(x),Q.negate()))}}solvePosition(t){var e,i;if(!t.colliderA.bounds.overlaps(t.colliderB.bounds,1e-4)){t.cancel();return}if(Math.abs(t.mtv.x)<1e-4&&Math.abs(t.mtv.y)<1e-4){t.cancel();return}let o=t.mtv;const h=t.colliderA,d=t.colliderB,u=(e=h.owner)===null||e===void 0?void 0:e.get(Ht),x=(i=d.owner)===null||i===void 0?void 0:i.get(Ht);if(u&&x){if(u.collisionType===Gt.Passive||x.collisionType===Gt.Passive)return;u.collisionType===Gt.Active&&x.collisionType===Gt.Active&&(o=o.scale(.5)),u.collisionType===Gt.Active&&(u.globalPos.x-=o.x,u.globalPos.y-=o.y,h.update(u.transform.get())),x.collisionType===Gt.Active&&(x.globalPos.x+=o.x,x.globalPos.y+=o.y,d.update(x.transform.get()))}}solveVelocity(t){var e,i;if(t.isCanceled())return;const n=t.colliderA,o=t.colliderB,h=(e=n.owner)===null||e===void 0?void 0:e.get(Ht),d=(i=o.owner)===null||i===void 0?void 0:i.get(Ht);if(h&&d){if(h.collisionType===Gt.Passive||d.collisionType===Gt.Passive)return;const u=t.normal,x=u.negate();if(h.collisionType===Gt.Active&&h.vel.normalize().dot(x)<0){const Q=u.scale(u.dot(h.vel.negate()));h.vel=h.vel.add(Q)}if(d.collisionType===Gt.Active&&d.vel.normalize().dot(u)<0){const Q=x.scale(x.dot(d.vel.negate()));d.vel=d.vel.add(Q)}}}}class vi{constructor(t,e,i){this.point=t,this.local=e,this.contact=i,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.aToContact=new p(0,0),this.bToContact=new p(0,0),this.originalVelocityAndRestitution=0,this.update()}update(){var t,e;const i=(t=this.contact.colliderA.owner)===null||t===void 0?void 0:t.get(Ht),n=(e=this.contact.colliderB.owner)===null||e===void 0?void 0:e.get(Ht);if(i&&n){const o=this.contact.normal,h=this.contact.tangent;this.aToContact=this.point.sub(i.globalPos),this.bToContact=this.point.sub(n.globalPos);const d=this.aToContact.cross(o),u=this.bToContact.cross(o);this.normalMass=i.inverseMass+n.inverseMass+i.inverseInertia*d*d+n.inverseInertia*u*u;const x=this.aToContact.cross(h),Q=this.bToContact.cross(h);this.tangentMass=i.inverseMass+n.inverseMass+i.inverseInertia*x*x+n.inverseInertia*Q*Q}return this}getRelativeVelocity(){var t,e;const i=(t=this.contact.colliderA.owner)===null||t===void 0?void 0:t.get(Ht),n=(e=this.contact.colliderB.owner)===null||e===void 0?void 0:e.get(Ht);if(i&&n){const o=i.vel.add(p.cross(i.angularVelocity,this.aToContact));return n.vel.add(p.cross(n.angularVelocity,this.bToContact)).sub(o)}return p.Zero}}class _r{constructor(){this.lastFrameContacts=new Map,this.idToContactConstraint=new Map}getContactConstraints(t){var e;return(e=this.idToContactConstraint.get(t))!==null&&e!==void 0?e:[]}solve(t){return this.preSolve(t),t=t.filter(e=>!e.isCanceled()),this.solveVelocity(t),this.solvePosition(t),this.postSolve(t),t}preSolve(t){var e,i,n;for(const h of t){const d=b.fromDirection(h.mtv);h.colliderA.events.emit("precollision",new $e(h.colliderA,h.colliderB,d,h.mtv)),h.colliderA.events.emit("beforecollisionresolve",new ei(h.colliderA,h.colliderB,d,h.mtv,h)),h.colliderB.events.emit("precollision",new $e(h.colliderB,h.colliderA,b.getOpposite(d),h.mtv.negate())),h.colliderB.events.emit("beforecollisionresolve",new ei(h.colliderB,h.colliderA,b.getOpposite(d),h.mtv.negate(),h)),h.matchAwake()}const o=Array.from(this.idToContactConstraint.keys());for(const h of t){const d=o.indexOf(h.id);d>-1&&o.splice(d,1);const u=(e=this.idToContactConstraint.get(h.id))!==null&&e!==void 0?e:[];let x=0;const Q=h.colliderA.owner.get(Ht),J=h.colliderB.owner.get(Ht);if(Q&&J)for(const et of h.points){const dt=h.normal,ft=h.tangent,xt=et.sub(Q.globalPos),It=et.sub(J.globalPos),ut=xt.cross(dt),pt=It.cross(dt),Tt=Q.inverseMass+J.inverseMass+Q.inverseInertia*ut*ut+J.inverseInertia*pt*pt,Qt=xt.cross(ft),zt=It.cross(ft),Lt=Q.inverseMass+J.inverseMass+Q.inverseInertia*Qt*Qt+J.inverseInertia*zt*zt;u[x]&&((n=(i=u[x])===null||i===void 0?void 0:i.point)===null||n===void 0?void 0:n.squareDistance(et))<4?(u[x].point=et,u[x].local=h.localPoints[x]):u[x]=new vi(et,h.localPoints[x],h),u[x].aToContact=xt,u[x].bToContact=It,u[x].normalMass=1/Tt,u[x].tangentMass=1/Lt;const vt=Q.bounciness>J.bounciness?Q.bounciness:J.bounciness,te=h.normal.dot(u[x].getRelativeVelocity());u[x].originalVelocityAndRestitution=0,te<-.1&&(u[x].originalVelocityAndRestitution=-vt*te),x++}this.idToContactConstraint.set(h.id,u)}for(const h of o)this.idToContactConstraint.delete(h);if(Ft.warmStart)this.warmStart(t);else for(const h of t){const d=this.getContactConstraints(h.id);for(const u of d)u.normalImpulse=0,u.tangentImpulse=0}}postSolve(t){for(const e of t){const i=e.colliderA.owner.get(Ht),n=e.colliderB.owner.get(Ht);if(i&&n){if(i.collisionType===Gt.Passive||n.collisionType===Gt.Passive)continue;i.updateMotion(),n.updateMotion()}const o=b.fromDirection(e.mtv);e.colliderA.events.emit("postcollision",new ti(e.colliderA,e.colliderB,o,e.mtv)),e.colliderA.events.emit("aftercollisionresolve",new ii(e.colliderA,e.colliderB,o,e.mtv,e)),e.colliderB.events.emit("postcollision",new ti(e.colliderB,e.colliderA,b.getOpposite(o),e.mtv.negate())),e.colliderB.events.emit("aftercollisionresolve",new ii(e.colliderB,e.colliderA,b.getOpposite(o),e.mtv.negate(),e))}this.lastFrameContacts.clear();for(const e of t)this.lastFrameContacts.set(e.id,e)}warmStart(t){var e,i,n;for(const o of t){const h=(e=o.colliderA.owner)===null||e===void 0?void 0:e.get(Ht),d=(i=o.colliderB.owner)===null||i===void 0?void 0:i.get(Ht);if(h&&d){const u=(n=this.idToContactConstraint.get(o.id))!==null&&n!==void 0?n:[];for(const x of u)if(Ft.warmStart){const Q=o.normal.scale(x.normalImpulse),J=o.tangent.scale(x.tangentImpulse),et=Q.add(J);h.applyImpulse(x.point,et.negate()),d.applyImpulse(x.point,et)}else x.normalImpulse=0,x.tangentImpulse=0}}}solvePosition(t){var e,i,n;for(let o=0;o<Ft.positionIterations;o++)for(const h of t){const d=(e=h.colliderA.owner)===null||e===void 0?void 0:e.get(Ht),u=(i=h.colliderB.owner)===null||i===void 0?void 0:i.get(Ht);if(d&&u){if(d.collisionType===Gt.Passive||u.collisionType===Gt.Passive)continue;const x=(n=this.idToContactConstraint.get(h.id))!==null&&n!==void 0?n:[];for(const Q of x){const J=h.normal,et=Ke.FindContactSeparation(h,Q.local),dt=Ft.steeringFactor,ft=-5,xt=Ft.slop,It=y(dt*(et+xt),ft,0),ut=J.scale(-It*Q.normalMass);if(d.collisionType===Gt.Active){const pt=ut.negate().scale(d.inverseMass);d.limitDegreeOfFreedom.includes(Ne.X)&&(pt.x=0),d.limitDegreeOfFreedom.includes(Ne.Y)&&(pt.y=0),d.globalPos=d.globalPos.add(pt),d.limitDegreeOfFreedom.includes(Ne.Rotation)||(d.rotation-=Q.aToContact.cross(ut)*d.inverseInertia)}if(u.collisionType===Gt.Active){const pt=ut.scale(u.inverseMass);u.limitDegreeOfFreedom.includes(Ne.X)&&(pt.x=0),u.limitDegreeOfFreedom.includes(Ne.Y)&&(pt.y=0),u.globalPos=u.globalPos.add(pt),u.limitDegreeOfFreedom.includes(Ne.Rotation)||(u.rotation+=Q.bToContact.cross(ut)*u.inverseInertia)}}}}}solveVelocity(t){var e,i,n;for(let o=0;o<Ft.velocityIterations;o++)for(const h of t){const d=(e=h.colliderA.owner)===null||e===void 0?void 0:e.get(Ht),u=(i=h.colliderB.owner)===null||i===void 0?void 0:i.get(Ht);if(d&&u){if(d.collisionType===Gt.Passive||u.collisionType===Gt.Passive)continue;const x=Math.min(d.friction,u.friction),Q=(n=this.idToContactConstraint.get(h.id))!==null&&n!==void 0?n:[];for(const J of Q){let ft=-J.getRelativeVelocity().dot(h.tangent)*J.tangentMass;const xt=x*J.normalImpulse,It=y(J.tangentImpulse+ft,-xt,xt);ft=It-J.tangentImpulse,J.tangentImpulse=It;const ut=h.tangent.scale(ft);d.applyImpulse(J.point,ut.negate()),u.applyImpulse(J.point,ut)}for(const J of Q){const dt=J.getRelativeVelocity().dot(h.normal);let ft=-J.normalMass*(dt-J.originalVelocityAndRestitution);const xt=Math.max(J.normalImpulse+ft,0);ft=xt-J.normalImpulse,J.normalImpulse=xt;const It=h.normal.scale(ft);d.applyImpulse(J.point,It.negate()),u.applyImpulse(J.point,It)}}}}}class zi extends oi{constructor(){super(...arguments),this.types=["ex.transform","ex.motion","ex.collider"],this.systemType=De.Update,this.priority=-1,this._realisticSolver=new _r,this._arcadeSolver=new so,this._processor=new ir,this._lastFrameContacts=new Map,this._currentFrameContacts=new Map,this._trackCollider=t=>this._processor.track(t),this._untrackCollider=t=>this._processor.untrack(t)}notify(t){if(Ys(t)){const e=t.data.get(_e);e.$colliderAdded.subscribe(this._trackCollider),e.$colliderRemoved.subscribe(this._untrackCollider);const i=e.get();i&&this._processor.track(i)}else{const e=t.data.get(_e),i=e.get();e&&i&&this._processor.untrack(i)}}initialize(t){this._engine=t.engine}update(t,e){var i,n,o,h;if(!Ft.enabled)return;let d=[];for(const J of t){const et=J.get(_e),dt=et==null?void 0:et.get();if(et&&(!((i=et.owner)===null||i===void 0)&&i.active)&&dt)if(et.update(),dt instanceof Ae){const ft=dt.getColliders();d=d.concat(ft)}else d.push(dt)}this._processor.update(d);const u=this._processor.broadphase(d,e);this._currentFrameContacts.clear();let x=this._processor.narrowphase(u,(h=(o=(n=this._engine)===null||n===void 0?void 0:n.debug)===null||o===void 0?void 0:o.stats)===null||h===void 0?void 0:h.currFrame);x=this.getSolver().solve(x);for(const J of x){const et=J.id.indexOf("|");if(et>0){const dt=J.id.substring(et+1);this._currentFrameContacts.set(dt,J)}else this._currentFrameContacts.set(J.id,J)}this.runContactStartEnd(),this._lastFrameContacts.clear(),this._lastFrameContacts=new Map(this._currentFrameContacts)}getSolver(){return Ft.collisionResolutionStrategy===Zi.Realistic?this._realisticSolver:this._arcadeSolver}debug(t){this._processor.debug(t)}runContactStartEnd(){for(const[t,e]of this._currentFrameContacts)if(!this._lastFrameContacts.has(t)){const i=e.colliderA,n=e.colliderB;i.events.emit("collisionstart",new Ps(i,n,e)),i.events.emit("contactstart",new pi(i,n,e)),n.events.emit("collisionstart",new Ps(n,i,e)),n.events.emit("contactstart",new pi(n,i,e))}for(const[t,e]of this._lastFrameContacts)if(!this._currentFrameContacts.has(t)){const i=e.colliderA,n=e.colliderB;i.events.emit("collisionend",new gi(i,n)),i.events.emit("contactend",new fe(i,n)),n.events.emit("collisionend",new gi(n,i)),n.events.emit("contactend",new fe(n,i))}}}var Ks;(function(a){a.Forward="forward",a.Backward="backward"})(Ks||(Ks={}));var be;(function(a){a.End="end",a.Loop="loop",a.PingPong="pingpong",a.Freeze="freeze"})(be||(be={}));class Vi extends Be{constructor(t){var e,i;super(t),this.events=new Bi,this.frames=[],this.strategy=be.Loop,this.frameDuration=100,this.timeScale=1,this._idempotencyToken=-1,this._firstTick=!0,this._currentFrame=0,this._timeLeftInFrame=0,this._direction=1,this._done=!1,this._playing=!0,this._reversed=!1,this.frames=t.frames,this.strategy=(e=t.strategy)!==null&&e!==void 0?e:this.strategy,this.frameDuration=t.totalDuration?t.totalDuration/this.frames.length:(i=t.frameDuration)!==null&&i!==void 0?i:this.frameDuration,t.reverse&&this.reverse(),this.goToFrame(0)}clone(){return new Vi({frames:this.frames.map(t=>({...t})),frameDuration:this.frameDuration,reverse:this._reversed,strategy:this.strategy,...this.cloneGraphicOptions()})}get width(){const t=this.currentFrame;return t?Math.abs(t.graphic.width*this.scale.x):0}get height(){const t=this.currentFrame;return t?Math.abs(t.graphic.height*this.scale.y):0}static fromSpriteSheet(t,e,i,n=be.Loop){const o=t.sprites.length-1,h=e.filter(d=>d<0||d>o);return h.length&&Vi._LOGGER.warn(`Indices into SpriteSheet were provided that don't exist: ${h.join(",")} no frame will be shown`),new Vi({frames:t.sprites.filter((d,u)=>e.indexOf(u)>-1).map(d=>({graphic:d,duration:i})),strategy:n})}get currentFrame(){return this._currentFrame>=0&&this._currentFrame<this.frames.length?this.frames[this._currentFrame]:null}get currentFrameIndex(){return this._currentFrame}get isPlaying(){return this._playing}reverse(){this.frames=this.frames.slice().reverse(),this._reversed=!this._reversed}get direction(){return!!(this._reversed&&this._direction===1)?Ks.Backward:Ks.Forward}play(){this._playing=!0}pause(){this._playing=!1,this._firstTick=!0}reset(){this._done=!1,this._firstTick=!0,this._currentFrame=0}get canFinish(){switch(this.strategy){case be.End:case be.Freeze:return!0;default:return!1}}get done(){return this._done}goToFrame(t){this._currentFrame=t,this._timeLeftInFrame=this.frameDuration;const e=this.frames[this._currentFrame];e&&!this._done&&(this._timeLeftInFrame=(e==null?void 0:e.duration)||this.frameDuration,this.events.emit("frame",e))}_nextFrame(){const t=this._currentFrame;if(this._done)return t;let e=-1;switch(this.strategy){case be.Loop:{e=(t+1)%this.frames.length,e===0&&this.events.emit("loop",this);break}case be.End:{e=t+1,e>=this.frames.length&&(this._done=!0,this._currentFrame=this.frames.length,this.events.emit("end",this));break}case be.Freeze:{e=y(t+1,0,this.frames.length-1),e>=this.frames.length-1&&(this._done=!0,this.events.emit("end",this));break}case be.PingPong:{t+this._direction>=this.frames.length&&(this._direction=-1,this.events.emit("loop",this)),t+this._direction<0&&(this._direction=1,this.events.emit("loop",this)),e=t+this._direction%this.frames.length;break}}return e}tick(t,e=0){this._idempotencyToken!==e&&(this._idempotencyToken=e,this._playing&&(this._firstTick&&(this._firstTick=!1,this.events.emit("frame",this.currentFrame)),this._timeLeftInFrame-=t*this.timeScale,this._timeLeftInFrame<=0&&this.goToFrame(this._nextFrame())))}_drawImage(t,e,i){this.currentFrame&&this.currentFrame.graphic.draw(t,e,i)}}Vi._LOGGER=v.getInstance();class bs extends Be{constructor(t){super(t),this.members=[],this.members=t.members,this._updateDimensions()}clone(){return new bs({members:[...this.members],...this.cloneGraphicOptions()})}_updateDimensions(){let t=new N;for(const{graphic:e,pos:i}of this.members)t=e.localBounds.translate(i).combine(t);return this.width=t.width,this.height=t.height,t}get localBounds(){let t=new N;for(const{graphic:e,pos:i}of this.members)t=e.localBounds.translate(i).combine(t);return t}_isAnimationOrGroup(t){return t instanceof Vi||t instanceof bs}tick(t,e){for(const i of this.members){const n=i.graphic;this._isAnimationOrGroup(n)&&n.tick(t,e)}}reset(){for(const t of this.members){const e=t.graphic;this._isAnimationOrGroup(e)&&e.reset()}}_preDraw(t,e,i){this._updateDimensions(),super._preDraw(t,e,i)}_drawImage(t,e,i){for(const n of this.members)t.save(),t.translate(e,i),n.graphic.draw(t,n.pos.x,n.pos.y),this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}function no(a){return class extends a{assign(t){for(const e in t)typeof this[e]!="function"&&(this[e]=t[e])}constructor(...t){super(...t),t.filter(function(i){return i!==void 0}).length===1&&t[0]&&typeof t[0]=="object"&&!(t[0]instanceof Array)&&this.assign(t[0])}}}var Cs;(function(a){a[a.Circle=0]="Circle",a[a.Rectangle=1]="Rectangle"})(Cs||(Cs={}));class Qo extends we{constructor(t,e,i,n,o,h,d,u,x,Q){super(),this.position=new p(0,0),this.velocity=new p(0,0),this.acceleration=new p(0,0),this.particleRotationalVelocity=0,this.currentRotation=0,this.focus=null,this.focusAccel=0,this.opacity=1,this.beginColor=I.White,this.endColor=I.White,this.life=300,this.fadeFlag=!1,this._rRate=1,this._gRate=1,this._bRate=1,this._aRate=0,this._currentColor=I.White,this.emitter=null,this.particleSize=5,this.particleSprite=null,this.sizeRate=0,this.elapsedMultiplier=0,this.visible=!0,this.isOffscreen=!1;let J=t;if(J&&!(t instanceof ui)){const et=t;J=et.emitter,e=et.life,i=et.opacity,o=et.endColor,n=et.beginColor,h=et.position,d=et.velocity,u=et.acceleration,x=et.startSize,Q=et.endSize}this.emitter=J,this.life=e||this.life,this.opacity=i||this.opacity,this.endColor=o||this.endColor.clone(),this.beginColor=n||this.beginColor.clone(),this._currentColor=this.beginColor.clone(),this.position=(h||this.position).add(this.emitter.pos),this.velocity=d||this.velocity,this.acceleration=u||this.acceleration,this._rRate=(this.endColor.r-this.beginColor.r)/this.life,this._gRate=(this.endColor.g-this.beginColor.g)/this.life,this._bRate=(this.endColor.b-this.beginColor.b)/this.life,this._aRate=this.opacity/this.life,this.startSize=x||0,this.endSize=Q||0,this.endSize>0&&this.startSize>0&&(this.sizeRate=(this.endSize-this.startSize)/this.life,this.particleSize=this.startSize),this.addComponent(this.transform=new Pt),this.addComponent(this.graphics=new Qe),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=m(1,1),this.particleSprite?(this.graphics.opacity=this.opacity,this.graphics.use(this.particleSprite)):(this.graphics.localBounds=N.fromDimension(this.particleSize,this.particleSize,p.Half),this.graphics.onPostDraw=et=>{et.save(),this.graphics.opacity=this.opacity;const dt=this._currentColor.clone();dt.a=1,et.debug.drawPoint(m(0,0),{color:dt,size:this.particleSize}),et.restore()})}kill(){this.emitter.removeParticle(this)}update(t,e){if(this.life=this.life-e,this.elapsedMultiplier=this.elapsedMultiplier+e,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=y(this._aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=y(this.sizeRate*e+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this._currentColor.r=y(this._currentColor.r+this._rRate*e,0,255),this._currentColor.g=y(this._currentColor.g+this._gRate*e,0,255),this._currentColor.b=y(this._currentColor.b+this._bRate*e,0,255),this._currentColor.a=y(this.opacity,1e-4,1),this.focus){const i=this.focus.sub(this.position).normalize().scale(this.focusAccel).scale(e/1e3);this.velocity=this.velocity.add(i)}else this.velocity=this.velocity.add(this.acceleration.scale(e/1e3));this.position=this.position.add(this.velocity.scale(e/1e3)),this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*e/1e3)%(2*Math.PI)),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=m(1,1),this.graphics.opacity=this.opacity}}class Nn extends no(Qo){constructor(t,e,i,n,o,h,d,u,x,Q){super(t,e,i,n,o,h,d,u,x,Q)}}class ui extends mi{constructor(t){var e,i;super({width:(e=t.width)!==null&&e!==void 0?e:0,height:(i=t.height)!==null&&i!==void 0?i:0}),this._particlesToEmit=0,this.numParticles=0,this.isEmitting=!0,this.particles=[],this.deadParticles=[],this.minVel=0,this.maxVel=0,this.acceleration=new p(0,0),this.minAngle=0,this.maxAngle=0,this.emitRate=1,this.particleLife=2e3,this.fadeFlag=!1,this.focus=null,this.focusAccel=null,this.startSize=null,this.endSize=null,this.minSize=5,this.maxSize=5,this.beginColor=I.White,this.endColor=I.White,this._sprite=null,this.emitterType=Cs.Rectangle,this.radius=0,this.particleRotationalVelocity=0,this.randomRotation=!1;const{x:n,y:o,pos:h,isEmitting:d,minVel:u,maxVel:x,acceleration:Q,minAngle:J,maxAngle:et,emitRate:dt,particleLife:ft,opacity:xt,fadeFlag:It,focus:ut,focusAccel:pt,startSize:Tt,endSize:Qt,minSize:zt,maxSize:Lt,beginColor:vt,endColor:te,particleSprite:oe,emitterType:ae,radius:$t,particleRotationalVelocity:Ge,randomRotation:yi,random:xi}={...t};this.pos=h??m(n??0,o??0),this.isEmitting=d??this.isEmitting,this.minVel=u??this.minVel,this.maxVel=x??this.maxVel,this.acceleration=Q??this.acceleration,this.minAngle=J??this.minAngle,this.maxAngle=et??this.maxAngle,this.emitRate=dt??this.emitRate,this.particleLife=ft??this.particleLife,this.opacity=xt??this.opacity,this.fadeFlag=It??this.fadeFlag,this.focus=ut??this.focus,this.focusAccel=pt??this.focusAccel,this.startSize=Tt??this.startSize,this.endSize=Qt??this.endSize,this.minSize=zt??this.minSize,this.maxSize=Lt??this.maxSize,this.beginColor=vt??this.beginColor,this.endColor=te??this.endColor,this.particleSprite=oe??this.particleSprite,this.emitterType=ae??this.emitterType,this.radius=$t??this.radius,this.particleRotationalVelocity=Ge??this.particleRotationalVelocity,this.randomRotation=yi??this.randomRotation,this.body.collisionType=Gt.PreventCollision,this.random=xi??new D}get opacity(){return super.graphics.opacity}set opacity(t){super.graphics.opacity=t}get particleSprite(){return this._sprite}set particleSprite(t){t&&(this._sprite=t)}removeParticle(t){this.deadParticles.push(t)}emitParticles(t){var e;for(let i=0;i<t;i++){const n=this._createParticle();this.particles.push(n),!((e=this===null||this===void 0?void 0:this.scene)===null||e===void 0)&&e.world&&this.scene.world.add(n)}}clearParticles(){this.particles.length=0}_createParticle(){let t=0,e=0;const i=z(this.minAngle,this.maxAngle,this.random),n=z(this.minVel,this.maxVel,this.random),o=this.startSize||z(this.minSize,this.maxSize,this.random),h=n*Math.cos(i),d=n*Math.sin(i);if(this.emitterType===Cs.Rectangle)t=z(0,this.width,this.random),e=z(0,this.height,this.random);else if(this.emitterType===Cs.Circle){const x=z(0,this.radius,this.random);t=x*Math.cos(i),e=x*Math.sin(i)}const u=new Nn(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new p(t,e),new p(h,d),this.acceleration,this.startSize,this.endSize);return u.fadeFlag=this.fadeFlag,u.particleSize=o,this.particleSprite&&(u.particleSprite=this.particleSprite,u.graphics.opacity=this.opacity,u.graphics.use(this._sprite)),u.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(u.currentRotation=z(0,Math.PI*2,this.random)),this.focus&&(u.focus=this.focus.add(new p(this.pos.x,this.pos.y)),u.focusAccel=this.focusAccel),u}update(t,e){var i;super.update(t,e),this.isEmitting&&(this._particlesToEmit+=this.emitRate*(e/1e3),this._particlesToEmit>1&&(this.emitParticles(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit)));for(let n=0;n<this.deadParticles.length;n++)ot(this.deadParticles[n],this.particles),!((i=this===null||this===void 0?void 0:this.scene)===null||i===void 0)&&i.world&&this.scene.world.remove(this.deadParticles[n],!1);this.deadParticles.length=0}}class mr extends oi{constructor(){super(...arguments),this.types=["ex.transform","ex.graphics"],this.systemType=De.Draw,this.priority=0,this._token=0,this._sortedTransforms=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0}}get sortedTransforms(){return this._sortedTransforms}initialize(t){this._camera=t.camera,this._engine=t.engine}preupdate(){this._graphicsContext=this._engine.graphicsContext,this._zHasChanged&&(this._sortedTransforms.sort((t,e)=>t.z-e.z),this._zHasChanged=!1)}notify(t){if(Ys(t)){const e=t.data.get(Pt);this._sortedTransforms.push(e),e.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}else{const e=t.data.get(Pt);e.zIndexChanged$.unsubscribe(this._zIndexUpdate);const i=this._sortedTransforms.indexOf(e);i>-1&&this._sortedTransforms.splice(i,1)}}update(t,e){this._token++;let i;this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext);for(const n of this._sortedTransforms){const o=n.owner;if(o.hasTag("ex.offscreen")||(i=o.get(Qe),!i.visible))continue;n.coordPlane===je.Screen&&this._graphicsContext.restore(),this._graphicsContext.save(),i.update(e,this._token);const h=o.get(Qn);if(h){const u=p.One.sub(h.parallaxFactor),x=this._camera.pos.scale(u);this._graphicsContext.translate(x.x,x.y)}this._applyTransform(o),i.onPreDraw&&i.onPreDraw(this._graphicsContext,e);const d=o instanceof Nn?o.opacity:1;this._graphicsContext.opacity=i.opacity*d,this._drawGraphicsComponent(i),i.onPostDraw&&i.onPostDraw(this._graphicsContext,e),this._graphicsContext.restore(),n.coordPlane===je.Screen&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}this._graphicsContext.restore()}_drawGraphicsComponent(t){var e,i;if(t.visible)for(const n of t.layers.get())for(const{graphic:o,options:h}of n.graphics){let d=t.anchor,u=t.offset;h!=null&&h.anchor&&(d=h.anchor),h!=null&&h.offset&&(u=h.offset);const x=-o.width*d.x+u.x,Q=-o.height*d.y+u.y;if(o==null||o.draw(this._graphicsContext,x+n.offset.x,Q+n.offset.y),!((e=this._engine)===null||e===void 0)&&e.isDebug&&this._engine.debug.graphics.showBounds){const J=m(x+n.offset.x,Q+n.offset.y);if(o instanceof bs)for(const et of o.members)(i=et.graphic)===null||i===void 0||i.localBounds.translate(J.add(et.pos)).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor);else o==null||o.localBounds.translate(J).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}}_applyTransform(t){const e=t.getAncestors();for(const i of e){const n=i==null?void 0:i.get(Pt),o=i==null?void 0:i.get(Ht);let h=n.pos,d=n.scale,u=n.rotation;if(o&&this._engine.fixedUpdateFps&&o.__oldTransformCaptured&&o.enableFixedUpdateInterpolate){const x=this._engine.currentFrameLagMs/(1e3/this._engine.fixedUpdateFps);h=n.pos.scale(x).add(o.oldPos.scale(1-x)),d=n.scale.scale(x).add(o.oldScale.scale(1-x));const Q=(1-x)*Math.cos(o.oldRotation)+x*Math.cos(n.rotation),J=(1-x)*Math.sin(o.oldRotation)+x*Math.sin(n.rotation);u=Math.atan2(J,Q)}n&&(this._graphicsContext.z=n.z,this._graphicsContext.translate(h.x,h.y),this._graphicsContext.scale(d.x,d.y),this._graphicsContext.rotate(u))}}}class ro extends oi{constructor(){super(...arguments),this.types=["ex.transform"],this.systemType=De.Draw,this.priority=999}initialize(t){this._graphicsContext=t.engine.graphicsContext,this._camera=t.camera,this._engine=t.engine,this._collisionSystem=t.world.systemManager.get(zi)}update(t,e){var i;if(!this._engine.isDebug)return;const n=this._engine.debug.filter;let o,h;const d=this._engine.debug.entity;let u;const x=this._engine.debug.transform;let Q;const J=this._engine.debug.motion;let et;const dt=this._engine.debug.collider,ft=this._engine.debug.physics;let xt;const It=this._engine.debug.graphics;let ut,pt;const Tt=this._engine.debug.body,Qt=this._engine.debug.camera;for(const zt of t){if(zt.hasTag("offscreen")||zt instanceof Nn||n.useFilter&&(!(n.ids.length===0||n.ids.includes(zt.id))||!(n.nameQuery===""||zt.name.includes(n.nameQuery))))continue;let Lt=p.Zero;const vt=m(0,16);if(o=zt.id,h=zt.name,u=zt.get(Pt),this._pushCameraTransform(u),this._graphicsContext.save(),this._applyTransform(zt),u&&((x.showAll||x.showPosition)&&this._graphicsContext.debug.drawPoint(p.Zero,{size:4,color:x.positionColor}),(x.showAll||x.showPositionLabel)&&(this._graphicsContext.debug.drawText(`pos${u.pos.toString(2)}`,Lt),Lt=Lt.add(vt)),(x.showAll||x.showZIndex)&&(this._graphicsContext.debug.drawText(`z(${u.z.toFixed(1)})`,Lt),Lt=Lt.add(vt)),(d.showAll||d.showId)&&(this._graphicsContext.debug.drawText(`id(${o}) ${zt.parent?"child of id("+((i=zt.parent)===null||i===void 0?void 0:i.id)+")":""}`,Lt),Lt=Lt.add(vt)),(d.showAll||d.showName)&&(this._graphicsContext.debug.drawText(`name(${h})`,Lt),Lt=Lt.add(vt)),(x.showAll||x.showRotation)&&(this._graphicsContext.drawLine(p.Zero,p.fromAngle(u.rotation).scale(50).add(p.Zero),x.rotationColor,2),this._graphicsContext.debug.drawText(`rot deg(${V(u.rotation).toFixed(2)})`,Lt),Lt=Lt.add(vt)),(x.showAll||x.showScale)&&this._graphicsContext.drawLine(p.Zero,u.scale.add(p.Zero),x.scaleColor,2)),xt=zt.get(Qe),xt&&(It.showAll||It.showBounds)&&xt.localBounds.draw(this._graphicsContext,It.boundsColor),ut=zt.get(Dn),ut&&(ut.useTransform||this._graphicsContext.restore(),ut.draw(this._graphicsContext),ut.useTransform||(this._graphicsContext.save(),this._applyTransform(zt))),pt=zt.get(Ht),pt&&((Tt.showAll||Tt.showCollisionGroup)&&(this._graphicsContext.debug.drawText(`collision group(${pt.group.name})`,Lt),Lt=Lt.add(vt)),(Tt.showAll||Tt.showCollisionType)&&(this._graphicsContext.debug.drawText(`collision type(${pt.collisionType})`,Lt),Lt=Lt.add(vt)),(Tt.showAll||Tt.showMass)&&(this._graphicsContext.debug.drawText(`mass(${pt.mass})`,Lt),Lt=Lt.add(vt)),(Tt.showAll||Tt.showMotion)&&(this._graphicsContext.debug.drawText(`motion(${pt.sleepMotion})`,Lt),Lt=Lt.add(vt)),(Tt.showAll||Tt.showSleeping)&&(this._graphicsContext.debug.drawText(`sleeping(${pt.canSleep?pt.sleeping:"cant sleep"})`,Lt),Lt=Lt.add(vt))),this._graphicsContext.restore(),Q=zt.get(ie),Q&&((J.showAll||J.showVelocity)&&(this._graphicsContext.debug.drawText(`vel${Q.vel.toString(2)}`,Lt.add(u.globalPos)),this._graphicsContext.drawLine(u.globalPos,u.globalPos.add(Q.vel),J.velocityColor,2),Lt=Lt.add(vt)),(J.showAll||J.showAcceleration)&&this._graphicsContext.drawLine(u.globalPos,u.globalPos.add(Q.acc),J.accelerationColor,2)),et=zt.get(_e),et){const te=et.get();if((dt.showAll||dt.showGeometry)&&te&&te.debug(this._graphicsContext,dt.geometryColor),dt.showAll||dt.showBounds){if(te instanceof Ae){const oe=te.getColliders();for(const ae of oe){const $t=ae.bounds,Ge=m($t.left,$t.top);this._graphicsContext.debug.drawRect(Ge.x,Ge.y,$t.width,$t.height,{color:dt.boundsColor}),(dt.showAll||dt.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${ae.owner.id})`,Ge)}et.bounds.draw(this._graphicsContext,dt.boundsColor)}else if(te){const oe=et.bounds,ae=m(oe.left,oe.top);this._graphicsContext.debug.drawRect(ae.x,ae.y,oe.width,oe.height,{color:dt.boundsColor}),(dt.showAll||dt.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${et.owner.id})`,ae)}}}this._popCameraTransform(u)}if(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(ft.showAll||ft.showBroadphaseSpacePartitionDebug)&&this._collisionSystem.debug(this._graphicsContext),ft.showAll||ft.showCollisionContacts||ft.showCollisionNormals)for(const[zt,Lt]of this._engine.debug.stats.currFrame.physics.contacts){if(ft.showAll||ft.showCollisionContacts)for(const vt of Lt.points)this._graphicsContext.debug.drawPoint(vt,{size:5,color:ft.collisionContactColor});if(ft.showAll||ft.showCollisionNormals)for(const vt of Lt.points)this._graphicsContext.debug.drawLine(vt,Lt.normal.scale(30).add(vt),{color:ft.collisionNormalColor})}this._graphicsContext.restore(),Qt&&(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(Qt.showAll||Qt.showFocus)&&this._graphicsContext.drawCircle(this._camera.pos,4,Qt.focusColor),(Qt.showAll||Qt.showZoom)&&this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`,this._camera.pos),this._graphicsContext.restore()),this._graphicsContext.flush()}_applyTransform(t){const e=t.getAncestors();for(const i of e){const n=i==null?void 0:i.get(Pt);n&&(this._graphicsContext.translate(n.pos.x,n.pos.y),this._graphicsContext.scale(n.scale.x,n.scale.y),this._graphicsContext.rotate(n.rotation))}}_pushCameraTransform(t){t.coordPlane===je.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}_popCameraTransform(t){t.coordPlane===je.World&&this._graphicsContext.restore()}}class Js extends oi{constructor(){super(...arguments),this.types=["ex.transform","ex.pointer"],this.systemType=De.Update,this.priority=-1,this.overrideUseColliderShape=!1,this.overrideUseGraphicsBounds=!1,this.lastFrameEntityToPointers=new Map,this.currentFrameEntityToPointers=new Map,this._sortedTransforms=[],this._sortedEntities=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0}}initialize(t){this._engine=t.engine}preupdate(){this._receiver=this._engine.input.pointers,this._zHasChanged&&(this._sortedTransforms.sort((t,e)=>e.z-t.z),this._sortedEntities=this._sortedTransforms.map(t=>t.owner),this._zHasChanged=!1)}notify(t){if(Ys(t)){const e=t.data.get(Pt);this._sortedTransforms.push(e),this._sortedEntities.push(e.owner),e.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}else{const e=t.data.get(Pt);e.zIndexChanged$.unsubscribe(this._zIndexUpdate);const i=this._sortedTransforms.indexOf(e);i>-1&&(this._sortedTransforms.splice(i,1),this._sortedEntities.splice(i,1))}}entityCurrentlyUnderPointer(t,e){return this.currentFrameEntityToPointers.has(t.id)&&this.currentFrameEntityToPointers.get(t.id).includes(e)}entityWasUnderPointer(t,e){return this.lastFrameEntityToPointers.has(t.id)&&this.lastFrameEntityToPointers.get(t.id).includes(e)}entered(t,e){return this.entityCurrentlyUnderPointer(t,e)&&!this.lastFrameEntityToPointers.has(t.id)}left(t,e){return!this.currentFrameEntityToPointers.has(t.id)&&this.entityWasUnderPointer(t,e)}addPointerToEntity(t,e){if(!this.currentFrameEntityToPointers.has(t.id)){this.currentFrameEntityToPointers.set(t.id,[e]);return}const i=this.currentFrameEntityToPointers.get(t.id);this.currentFrameEntityToPointers.set(t.id,i.concat(e))}update(t){this._processPointerToEntity(this._sortedEntities),this._dispatchEvents(this._sortedEntities),this._receiver.update(),this.lastFrameEntityToPointers.clear(),this.lastFrameEntityToPointers=new Map(this.currentFrameEntityToPointers),this.currentFrameEntityToPointers.clear(),this._receiver.clear()}_processPointerToEntity(t){var e;let i,n,o,h;for(const d of t){if(i=d.get(Pt),h=(e=d.get(es))!==null&&e!==void 0?e:new es,n=d.get(_e),n&&(h.useColliderShape||this.overrideUseColliderShape)){n.update();const u=n.get();if(u)for(const[x,Q]of this._receiver.currentFramePointerCoords.entries())u.contains(i.coordPlane===je.World?Q.worldPos:Q.screenPos)&&this.addPointerToEntity(d,x)}if(o=d.get(Qe),o&&(h.useGraphicsBounds||this.overrideUseGraphicsBounds)){const u=o.localBounds.transform(i.get().matrix);for(const[x,Q]of this._receiver.currentFramePointerCoords.entries())u.contains(i.coordPlane===je.World?Q.worldPos:Q.screenPos)&&this.addPointerToEntity(d,x)}}}_processDownAndEmit(t){const e=new Map;for(const i of this._receiver.currentFrameDown)i.active&&t.active&&this.entityCurrentlyUnderPointer(t,i.pointerId)&&(t.events.emit("pointerdown",i),this._receiver.isDragStart(i.pointerId)&&t.events.emit("pointerdragstart",i)),e.set(i.pointerId,i);return e}_processUpAndEmit(t){const e=new Map;for(const i of this._receiver.currentFrameUp)i.active&&t.active&&this.entityCurrentlyUnderPointer(t,i.pointerId)&&(t.events.emit("pointerup",i),this._receiver.isDragEnd(i.pointerId)&&t.events.emit("pointerdragend",i)),e.set(i.pointerId,i);return e}_processMoveAndEmit(t){const e=new Map;for(const i of this._receiver.currentFrameMove)i.active&&t.active&&this.entityCurrentlyUnderPointer(t,i.pointerId)&&(t.events.emit("pointermove",i),this._receiver.isDragging(i.pointerId)&&t.events.emit("pointerdragmove",i)),e.set(i.pointerId,i);return e}_processEnterLeaveAndEmit(t,e){for(const i of e){if(i.active&&t.active&&this.entered(t,i.pointerId)){t.events.emit("pointerenter",i),this._receiver.isDragging(i.pointerId)&&t.events.emit("pointerdragenter",i);break}if(i.active&&t.active&&(this.left(t,i.pointerId)||this.entityCurrentlyUnderPointer(t,i.pointerId)&&i.type==="up")){t.events.emit("pointerleave",i),this._receiver.isDragging(i.pointerId)&&t.events.emit("pointerdragleave",i);break}}}_processCancelAndEmit(t){for(const e of this._receiver.currentFrameCancel)e.active&&t.active&&this.entityCurrentlyUnderPointer(t,e.pointerId)&&t.events.emit("pointercancel",e)}_processWheelAndEmit(t){for(const e of this._receiver.currentFrameWheel)e.active&&t.active&&this.entityCurrentlyUnderPointer(t,0)&&t.events.emit("pointerwheel",e)}_dispatchEvents(t){const e=new Set(this.lastFrameEntityToPointers.keys()),i=new Set(this.currentFrameEntityToPointers.keys()),n=t.filter(u=>e.has(u.id)||i.has(u.id));let o,h,d;for(const u of n){d=this._processDownAndEmit(u),h=this._processUpAndEmit(u),o=this._processMoveAndEmit(u);const x=[...o.values(),...d.values(),...h.values()];this._processEnterLeaveAndEmit(u,x),this._processCancelAndEmit(u),this._processWheelAndEmit(u)}}}class oo extends oi{constructor(){super(...arguments),this.types=["ex.actions"],this.systemType=De.Update,this.priority=-1,this._actions=[]}notify(t){if(Ys(t)){const e=t.data.get(vs);this._actions.push(e)}else{const e=t.data.get(vs),i=this._actions.indexOf(e);i>-1&&this._actions.splice(i,1)}}update(t,e){for(const i of this._actions)i.update(e)}}class Gn extends Se{constructor(t){super(),this.type="ex.isometricentity",this.elevation=0,this.map=t}}class is extends oi{constructor(){super(...arguments),this.types=["ex.transform","ex.isometricentity"],this.systemType=De.Update,this.priority=99}update(t,e){let i,n;for(const o of t){i=o.get(Pt),n=o.get(Gn);const d=Math.max(n.map.columns*n.map.tileWidth,n.map.rows*n.map.tileHeight)*n.elevation+i.pos.y;i.z=d}}}class vr extends oi{constructor(){super(...arguments),this.types=["ex.transform","ex.graphics"],this.systemType=De.Draw,this.priority=-1}initialize(t){this._camera=t.camera}update(t){let e,i,n;for(const o of t){i=o.get(Qe),e=o.get(Pt),n=o.get(Qn);let h;if(n){const u=p.One.sub(n.parallaxFactor);h=this._camera.pos.scale(u)}const d=this._isOffscreen(e,i,h);d&&!o.hasTag("ex.offscreen")&&(o.eventDispatcher.emit("exitviewport",new Ds(o)),o.addTag("ex.offscreen")),!d&&o.hasTag("ex.offscreen")&&(o.eventDispatcher.emit("enterviewport",new Xn(o)),o.removeTag("ex.offscreen"))}}_isOffscreen(t,e,i){if(t.coordPlane===je.World){let n=e.localBounds;i&&(n=n.translate(i));const o=n.transform(t.get().matrix);return!this._camera.viewport.overlaps(o)}else return!1}}class Zs extends We{constructor(){super(),this._logger=v.getInstance(),this.camera=new Kr,this.world=new fr(this),this._isInitialized=!1,this._timers=[],this._cancelQueue=[],this.world.add(new oo),this.world.add(new io),this.world.add(new zi),this.world.add(new Js),this.world.add(new is),this.world.add(new vr),this.world.add(new mr),this.world.add(new ro)}get actors(){return this.world.entityManager.entities.filter(t=>t instanceof mi)}get entities(){return this.world.entityManager.entities}get triggers(){return this.world.entityManager.entities.filter(t=>t instanceof Jr)}get tileMaps(){return this.world.entityManager.entities.filter(t=>t instanceof Tn)}get timers(){return this._timers}on(t,e){super.on(t,e)}once(t,e){super.once(t,e)}off(t,e){super.off(t,e)}onInitialize(t){}onActivate(t){}onDeactivate(t){}onPreUpdate(t,e){}onPostUpdate(t,e){}onPreDraw(t,e){}onPostDraw(t,e){}_initializeChildren(){for(const t of this.entities)t._initialize(this.engine)}get isInitialized(){return this._isInitialized}_initialize(t){this.isInitialized||(this.engine=t,this.camera._initialize(t),this.world.systemManager.initialize(),this.onInitialize.call(this,t),this._initializeChildren(),this._logger.debug("Scene.onInitialize",this,t),this.eventDispatcher.emit("initialize",new Xi(t,this)),this._isInitialized=!0)}_activate(t){this._logger.debug("Scene.onActivate",this),this.onActivate(t)}_deactivate(t){this._logger.debug("Scene.onDeactivate",this),this.onDeactivate(t)}_preupdate(t,e){this.emit("preupdate",new qt(t,e,this)),this.onPreUpdate(t,e)}_postupdate(t,e){this.emit("postupdate",new Yt(t,e,this)),this.onPostUpdate(t,e)}_predraw(t,e){this.emit("predraw",new yt(t,e,this)),this.onPreDraw(t,e)}_postdraw(t,e){this.emit("postdraw",new kt(t,e,this)),this.onPostDraw(t,e)}update(t,e){this._preupdate(t,e);let i,n;for(i=0,n=this._cancelQueue.length;i<n;i++)this.removeTimer(this._cancelQueue[i]);this._cancelQueue.length=0;for(const o of this._timers)o.update(e);this.world.update(De.Update,e),this.camera&&this.camera.update(t,e),this._collectActorStats(t),this._postupdate(t,e)}draw(t,e){var i;this._predraw(t,e),this.world.update(De.Draw,e),!((i=this.engine)===null||i===void 0)&&i.isDebug&&this.debugDraw(t),this._postdraw(t,e)}debugDraw(t){this.emit("predebugdraw",new Mt(t,this)),this.emit("postdebugdraw",new Wt(t,this))}contains(t){return this.actors.indexOf(t)>-1}add(t){if(this.emit("entityadded",{target:t}),this.world.add(t),t.scene=this,t instanceof Gi){Et(this._timers,t)||this.addTimer(t);return}}remove(t){t instanceof we&&(this.emit("entityremoved",{target:t}),this.world.remove(t)),t instanceof Gi&&this.removeTimer(t)}clear(t=!0){for(const e of this.entities)this.world.remove(e,t);for(const e of this.timers)this.removeTimer(e)}addTimer(t){return this._timers.push(t),t.scene=this,t}removeTimer(t){const e=this._timers.indexOf(t);return e!==-1&&this._timers.splice(e,1),t}cancelTimer(t){return this._cancelQueue.push(t),t}isTimerActive(t){return this._timers.indexOf(t)>-1&&!t.complete}isCurrentScene(){return this.engine?this.engine.currentScene===this:!1}_collectActorStats(t){const e=this.actors.filter(i=>i instanceof pr);for(const i of e)t.stats.currFrame.actors.ui++;for(const i of this.actors){t.stats.currFrame.actors.alive++;for(const n of i.children)Pn(n)?t.stats.currFrame.actors.ui++:t.stats.currFrame.actors.alive++}}}var ss;(function(a){a.Protanope="Protanope",a.Deuteranope="Deuteranope",a.Tritanope="Tritanope"})(ss||(ss={}));const wr=`#version 300 es\r
precision mediump float;\r
// our texture\r
uniform sampler2D u_image;\r
// the texCoords passed in from the vertex shader.\r
in vec2 v_texcoord;\r
\r
// color blind type\r
uniform int u_type;\r
\r
// simulation?\r
uniform bool u_simulate;\r
\r
out vec4 fragColor;\r
\r
void main() {\r
  vec4 o =  texture(u_image, v_texcoord);\r
  // RGB to LMS matrix conversion\r
  float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);\r
  float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);\r
  float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);\r
  // Simulate color blindness\r
  float l;\r
  float m;\r
  float s;\r
  //MODE CODE//\r
  if (u_type == 0) {\r
    // Protanope\r
    l = 0.0 * L + 2.02344 * M + -2.52581 * S;\r
    m = 0.0 * L + 1.0 * M + 0.0 * S;\r
    s = 0.0 * L + 0.0 * M + 1.0 * S;;\r
  } else if (u_type == 1) {\r
    // Deuteranope\r
    l = 1.0 * L + 0.0 * M + 0.0 * S;\r
    m = 0.494207 * L + 0.0 * M + 1.24827 * S;\r
    s = 0.0 * L + 0.0 * M + 1.0 * S;\r
  } else if (u_type == 2) {\r
    // Tritanope\r
    l = 1.0 * L + 0.0 * M + 0.0 * S;\r
    m = 0.0 * L + 1.0 * M + 0.0 * S;\r
    s = -0.395913 * L + 0.801109 * M + 0.0 * S;\r
  }\r
\r
  // LMS to RGB matrix conversion\r
  vec4 error; // simulate the colors\r
  error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);\r
  error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);\r
  error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\r
  error.a = 1.0;\r
  vec4 diff = o - error;\r
  vec4 correction; // correct the colors\r
  correction.r = 0.0;\r
  correction.g =  (diff.r * 0.7) + (diff.g * 1.0);\r
  correction.b =  (diff.r * 0.7) + (diff.b * 1.0);\r
  correction = o + correction;\r
  correction.a = o.a;\r
  //SIMULATE//\r
\r
  // sim \r
  if (u_simulate) {\r
    fragColor = error.rgba;\r
  } else {\r
    fragColor = correction.rgba;\r
  }\r
}`;class ao{constructor(t){this._shader=new qe({vertexSource:`#version 300 es
      in vec2 a_position;
      in vec2 a_texcoord;
      out vec2 v_texcoord;

      void main() {
        gl_Position = vec4(a_position, 0.0, 1.0);
        // Pass the texcoord to the fragment shader.
        v_texcoord = a_texcoord;
      }`,fragmentSource:t}),this._shader.compile(),this._buffer=new si({type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new Pi({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}getShader(){return this._shader}getLayout(){return this._layout}}class ns{constructor(t,e=!1){this._colorBlindnessMode=t,this._simulate=!1,this._simulate=e}initialize(t){this._shader=new ao(wr),this.simulate=this._simulate,this.colorBlindnessMode=this._colorBlindnessMode}getShader(){return this._shader.getShader()}getLayout(){return this._shader.getLayout()}set colorBlindnessMode(t){if(this._colorBlindnessMode=t,this._shader){const e=this._shader.getShader();e.use(),this._colorBlindnessMode===ss.Protanope?e.setUniformInt("u_type",0):this._colorBlindnessMode===ss.Deuteranope?e.setUniformInt("u_type",1):this._colorBlindnessMode===ss.Tritanope&&e.setUniformInt("u_type",2)}}get colorBlindnessMode(){return this._colorBlindnessMode}set simulate(t){if(this._simulate=t,this._shader){const e=this._shader.getShader();e.use(),e.setUniformBoolean("u_simulate",t)}}get simulate(){return this._simulate}}class br{constructor(t){this._engine=t,this._colorBlindPostProcessor=new ns(ss.Protanope)}correct(t){this._engine.graphicsContext instanceof Ns&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!1,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}simulate(t){this._engine.graphicsContext instanceof Ns&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!0,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}clear(){this._engine.graphicsContext.removePostProcessor(this._colorBlindPostProcessor)}}class lo{constructor(t){this.stats={currFrame:new $s,prevFrame:new $s},this.filter={useFilter:!1,nameQuery:"",ids:[]},this.entity={showAll:!1,showId:!0,showName:!1},this.transform={showAll:!1,showPosition:!1,showPositionLabel:!1,positionColor:I.Yellow,showZIndex:!1,showScale:!1,scaleColor:I.Green,showRotation:!1,rotationColor:I.Blue},this.graphics={showAll:!1,showBounds:!0,boundsColor:I.Yellow},this.collider={showAll:!1,showBounds:!0,boundsColor:I.Blue,showOwner:!1,showGeometry:!0,geometryColor:I.Green},this.physics={showAll:!1,showBroadphaseSpacePartitionDebug:!1,showCollisionNormals:!1,collisionNormalColor:I.Cyan,showCollisionContacts:!0,collisionContactColor:I.Red},this.motion={showAll:!1,showVelocity:!1,velocityColor:I.Yellow,showAcceleration:!1,accelerationColor:I.Red},this.body={showAll:!1,showCollisionGroup:!1,showCollisionType:!1,showSleeping:!1,showMotion:!1,showMass:!1},this.camera={showAll:!1,showFocus:!1,focusColor:I.Red,showZoom:!1},this._engine=t,this.colorBlindMode=new br(this._engine)}useTestClock(){const t=this._engine.clock,e=t.isRunning();t.stop();const i=t.toTestClock();return e&&i.start(),this._engine.clock=i,i}useStandardClock(){const t=this._engine.clock,e=t.isRunning();t.stop();const i=t.toStandardClock();return e&&i.start(),this._engine.clock=i,i}}class $s{constructor(){this._id=0,this._delta=0,this._fps=0,this._actorStats={alive:0,killed:0,ui:0,get remaining(){return this.alive-this.killed},get total(){return this.remaining+this.ui}},this._durationStats={update:0,draw:0,get total(){return this.update+this.draw}},this._physicsStats=new zn,this._graphicsStats={drawCalls:0,drawnImages:0}}reset(t){t?(this.id=t.id,this.delta=t.delta,this.fps=t.fps,this.actors.alive=t.actors.alive,this.actors.killed=t.actors.killed,this.actors.ui=t.actors.ui,this.duration.update=t.duration.update,this.duration.draw=t.duration.draw,this._physicsStats.reset(t.physics),this.graphics.drawCalls=t.graphics.drawCalls,this.graphics.drawnImages=t.graphics.drawnImages):(this.id=this.delta=this.fps=0,this.actors.alive=this.actors.killed=this.actors.ui=0,this.duration.update=this.duration.draw=0,this._physicsStats.reset(),this.graphics.drawnImages=this.graphics.drawCalls=0)}clone(){const t=new $s;return t.reset(this),t}get id(){return this._id}set id(t){this._id=t}get delta(){return this._delta}set delta(t){this._delta=t}get fps(){return this._fps}set fps(t){this._fps=t}get actors(){return this._actorStats}get duration(){return this._durationStats}get physics(){return this._physicsStats}get graphics(){return this._graphicsStats}}class zn{constructor(){this._pairs=0,this._collisions=0,this._contacts=new Map,this._fastBodies=0,this._fastBodyCollisions=0,this._broadphase=0,this._narrowphase=0}reset(t){t?(this.pairs=t.pairs,this.collisions=t.collisions,this.contacts=t.contacts,this.fastBodies=t.fastBodies,this.fastBodyCollisions=t.fastBodyCollisions,this.broadphase=t.broadphase,this.narrowphase=t.narrowphase):(this.pairs=this.collisions=this.fastBodies=0,this.fastBodyCollisions=this.broadphase=this.narrowphase=0,this.contacts.clear())}clone(){const t=new zn;return t.reset(this),t}get pairs(){return this._pairs}set pairs(t){this._pairs=t}get collisions(){return this._collisions}set collisions(t){this._collisions=t}get contacts(){return this._contacts}set contacts(t){this._contacts=t}get fastBodies(){return this._fastBodies}set fastBodies(t){this._fastBodies=t}get fastBodyCollisions(){return this._fastBodyCollisions}set fastBodyCollisions(t){this._fastBodyCollisions=t}get broadphase(){return this._broadphase}set broadphase(t){this._broadphase=t}get narrowphase(){return this._narrowphase}set narrowphase(t){this._narrowphase=t}}var ys;(function(a){a.Canvas="Canvas",a.Document="Document"})(ys||(ys={}));var rs;(function(a){a.Num0="Numpad0",a.Num1="Numpad1",a.Num2="Numpad2",a.Num3="Numpad3",a.Num4="Numpad4",a.Num5="Numpad5",a.Num6="Numpad6",a.Num7="Numpad7",a.Num8="Numpad8",a.Num9="Numpad9",a.NumAdd="NumpadAdd",a.NumSubtract="NumpadSubtract",a.NumMultiply="NumpadMultiply",a.NumDivide="NumpadDivide",a.NumDecimal="NumpadDecimal",a.Numpad0="Numpad0",a.Numpad1="Numpad1",a.Numpad2="Numpad2",a.Numpad3="Numpad3",a.Numpad4="Numpad4",a.Numpad5="Numpad5",a.Numpad6="Numpad6",a.Numpad7="Numpad7",a.Numpad8="Numpad8",a.Numpad9="Numpad9",a.NumpadAdd="NumpadAdd",a.NumpadSubtract="NumpadSubtract",a.NumpadMultiply="NumpadMultiply",a.NumpadDivide="NumpadDivide",a.NumpadDecimal="NumpadDecimal",a.NumLock="NumLock",a.ShiftLeft="ShiftLeft",a.ShiftRight="ShiftRight",a.AltLeft="AltLeft",a.AltRight="AltRight",a.ControlLeft="ControlLeft",a.ControlRight="ControlRight",a.MetaLeft="MetaLeft",a.MetaRight="MetaRight",a.Key0="Digit0",a.Key1="Digit1",a.Key2="Digit2",a.Key3="Digit3",a.Key4="Digit4",a.Key5="Digit5",a.Key6="Digit6",a.Key7="Digit7",a.Key8="Digit8",a.Key9="Digit9",a.Digit0="Digit0",a.Digit1="Digit1",a.Digit2="Digit2",a.Digit3="Digit3",a.Digit4="Digit4",a.Digit5="Digit5",a.Digit6="Digit6",a.Digit7="Digit7",a.Digit8="Digit8",a.Digit9="Digit9",a.F1="F1",a.F2="F2",a.F3="F3",a.F4="F4",a.F5="F5",a.F6="F6",a.F7="F7",a.F8="F8",a.F9="F9",a.F10="F10",a.F11="F11",a.F12="F12",a.A="KeyA",a.B="KeyB",a.C="KeyC",a.D="KeyD",a.E="KeyE",a.F="KeyF",a.G="KeyG",a.H="KeyH",a.I="KeyI",a.J="KeyJ",a.K="KeyK",a.L="KeyL",a.M="KeyM",a.N="KeyN",a.O="KeyO",a.P="KeyP",a.Q="KeyQ",a.R="KeyR",a.S="KeyS",a.T="KeyT",a.U="KeyU",a.V="KeyV",a.W="KeyW",a.X="KeyX",a.Y="KeyY",a.Z="KeyZ",a.KeyA="KeyA",a.KeyB="KeyB",a.KeyC="KeyC",a.KeyD="KeyD",a.KeyE="KeyE",a.KeyF="KeyF",a.KeyG="KeyG",a.KeyH="KeyH",a.KeyI="KeyI",a.KeyJ="KeyJ",a.KeyK="KeyK",a.KeyL="KeyL",a.KeyM="KeyM",a.KeyN="KeyN",a.KeyO="KeyO",a.KeyP="KeyP",a.KeyQ="KeyQ",a.KeyR="KeyR",a.KeyS="KeyS",a.KeyT="KeyT",a.KeyU="KeyU",a.KeyV="KeyV",a.KeyW="KeyW",a.KeyX="KeyX",a.KeyY="KeyY",a.KeyZ="KeyZ",a.Semicolon="Semicolon",a.Quote="Quote",a.Comma="Comma",a.Minus="Minus",a.Period="Period",a.Slash="Slash",a.Equal="Equal",a.BracketLeft="BracketLeft",a.Backslash="Backslash",a.BracketRight="BracketRight",a.Backquote="Backquote",a.Up="ArrowUp",a.Down="ArrowDown",a.Left="ArrowLeft",a.Right="ArrowRight",a.ArrowUp="ArrowUp",a.ArrowDown="ArrowDown",a.ArrowLeft="ArrowLeft",a.ArrowRight="ArrowRight",a.Space="Space",a.Backspace="Backspace",a.Delete="Delete",a.Esc="Escape",a.Escape="Escape",a.Enter="Enter",a.NumpadEnter="NumpadEnter",a.ContextMenu="ContextMenu"})(rs||(rs={}));class tn extends tt{constructor(t,e,i){super(),this.key=t,this.value=e,this.originalEvent=i}}class ho extends We{constructor(){super(),this._keys=[],this._keysUp=[],this._keysDown=[],this._handleKeyDown=t=>{const e=t.code;if(this._keys.indexOf(e)===-1){this._keys.push(e),this._keysDown.push(e);const i=new tn(e,t.key,t);this.eventDispatcher.emit("down",i),this.eventDispatcher.emit("press",i)}},this._handleKeyUp=t=>{const e=t.code,i=this._keys.indexOf(e);this._keys.splice(i,1),this._keysUp.push(e);const n=new tn(e,t.key,t);this.eventDispatcher.emit("up",n),this.eventDispatcher.emit("release",n)}}on(t,e){super.on(t,e)}init(t){if(!t)try{const e=()=>{};window.top.addEventListener("blur",e),window.top.removeEventListener("blur",e),t=window.top}catch{t=window,v.getInstance().warn("Failed to bind to keyboard events to top frame. If you are trying to embed Excalibur in a cross-origin iframe, keyboard events will not fire.")}t.addEventListener("blur",()=>{this._keys.length=0}),t.addEventListener("keyup",this._handleKeyUp),t.addEventListener("keydown",this._handleKeyDown)}update(){this._keysDown.length=0,this._keysUp.length=0;for(let t=0;t<this._keys.length;t++)this.eventDispatcher.emit("hold",new tn(this._keys[t]))}getKeys(){return this._keys}wasPressed(t){return this._keysDown.indexOf(t)>-1}isHeld(t){return this._keys.indexOf(t)>-1}wasReleased(t){return this._keysUp.indexOf(t)>-1}triggerEvent(t,e,i){t==="down"&&this._handleKeyDown(new KeyboardEvent("keydown",{code:e,key:i??null})),t==="up"&&this._handleKeyUp(new KeyboardEvent("keyup",{code:e,key:i??null}))}}class xs extends We{constructor(){super(),this.enabled=!1,this.supported=!!navigator.getGamepads,this._gamePadTimeStamps=[0,0,0,0],this._oldPads=[],this._pads=[],this._initSuccess=!1,this._navigator=navigator,this._minimumConfiguration=null}init(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))}setMinimumGamepadConfiguration(t){this._enableAndUpdate(),this._minimumConfiguration=t}_enableAndUpdate(){this.enabled||(this.enabled=!0,this.update())}_isGamepadValid(t){if(!this._minimumConfiguration)return!0;if(!t)return!1;const e=t.axes.filter(n=>typeof n!==void 0).length,i=t.buttons.filter(n=>typeof n!==void 0).length;return e>=this._minimumConfiguration.axis&&i>=this._minimumConfiguration.buttons&&t.connected}on(t,e){this._enableAndUpdate(),super.on(t,e)}off(t,e){this._enableAndUpdate(),super.off(t,e)}update(){if(!this.enabled||!this.supported)return;this.init();const t=this._navigator.getGamepads();for(let e=0;e<t.length;e++){if(t[e])!this.at(e).connected&&this._isGamepadValid(t[e])&&this.eventDispatcher.emit("connect",new ee(e,this.at(e))),this.at(e).connected=!0;else{const u=this.at(e);u.connected&&this.eventDispatcher.emit("disconnect",new Ue(e,u)),u.connected=!1;continue}if(t[e].timestamp&&t[e].timestamp===this._gamePadTimeStamps[e])continue;this._gamePadTimeStamps[e]=t[e].timestamp,this.at(e).navigatorGamepad=t[e];let i,n,o,h,d;for(i in sn)n=sn[i],typeof n=="number"&&t[e].buttons[n]&&(d=t[e].buttons[n].value,d!==this._oldPads[e].getButton(n)&&(t[e].buttons[n].pressed?(this.at(e).updateButton(n,d),this.at(e).eventDispatcher.emit("button",new Ze(n,d,this.at(e)))):this.at(e).updateButton(n,0)));for(o in os)h=os[o],typeof h=="number"&&(d=t[e].axes[h],d!==this._oldPads[e].getAxes(h)&&(this.at(e).updateAxes(h,d),this.at(e).eventDispatcher.emit("axis",new ye(h,d,this.at(e)))));this._oldPads[e]=this._clonePad(t[e])}}at(t){if(this._enableAndUpdate(),t>=this._pads.length)for(let e=this._pads.length-1,i=t;e<i;e++)this._pads.push(new en),this._oldPads.push(new en);return this._pads[t]}getValidGamepads(){this._enableAndUpdate();const t=[];for(let e=0;e<this._pads.length;e++)this._isGamepadValid(this.at(e).navigatorGamepad)&&this.at(e).connected&&t.push(this.at(e));return t}count(){return this._pads.filter(t=>t.connected).length}_clonePads(t){const e=[];for(let i=0,n=t.length;i<n;i++)e.push(this._clonePad(t[i]));return e}_clonePad(t){let e,i;const n=new en;if(!t)return n;for(e=0,i=t.buttons.length;e<i;e++)t.buttons[e]&&n.updateButton(e,t.buttons[e].value);for(e=0,i=t.axes.length;e<i;e++)n.updateAxes(e,t.axes[e]);return n}}xs.MinAxisMoveThreshold=.05;class en extends We{constructor(){super(),this.connected=!1,this._buttons=new Array(16),this._axes=new Array(4);for(let t=0;t<this._buttons.length;t++)this._buttons[t]=0;for(let t=0;t<this._axes.length;t++)this._axes[t]=0}isButtonPressed(t,e=1){return this._buttons[t]>=e}getButton(t){return this._buttons[t]}getAxes(t){const e=this._axes[t];return Math.abs(e)<xs.MinAxisMoveThreshold?0:e}updateButton(t,e){this._buttons[t]=e}updateAxes(t,e){this._axes[t]=e}}var sn;(function(a){a[a.Face1=0]="Face1",a[a.Face2=1]="Face2",a[a.Face3=2]="Face3",a[a.Face4=3]="Face4",a[a.LeftBumper=4]="LeftBumper",a[a.RightBumper=5]="RightBumper",a[a.LeftTrigger=6]="LeftTrigger",a[a.RightTrigger=7]="RightTrigger",a[a.Select=8]="Select",a[a.Start=9]="Start",a[a.LeftStick=10]="LeftStick",a[a.RightStick=11]="RightStick",a[a.DpadUp=12]="DpadUp",a[a.DpadDown=13]="DpadDown",a[a.DpadLeft=14]="DpadLeft",a[a.DpadRight=15]="DpadRight"})(sn||(sn={}));var os;(function(a){a[a.LeftStickX=0]="LeftStickX",a[a.LeftStickY=1]="LeftStickY",a[a.RightStickX=2]="RightStickX",a[a.RightStickY=3]="RightStickY"})(os||(os={}));class Cr{constructor(t){this.nativeComponent=t,this._paused=!1,this._nativeHandlers={}}on(t,e){this._nativeHandlers[t]&&this.off(t,this._nativeHandlers[t]),this._nativeHandlers[t]=this._decorate(e),this.nativeComponent.addEventListener(t,this._nativeHandlers[t])}off(t,e){e||(e=this._nativeHandlers[t]),this.nativeComponent.removeEventListener(t,e),this._nativeHandlers[t]=null}_decorate(t){return e=>{this._paused||t(e)}}pause(){this._paused=!0}resume(){this._paused=!1}clear(){for(const t in this._nativeHandlers)this.off(t)}}class wi{constructor(t,e){this._windowGlobal=t,this._documentGlobal=e,this._windowComponent=new Cr(this._windowGlobal),this._documentComponent=new Cr(this._documentGlobal)}get window(){return this._windowComponent}get document(){return this._documentComponent}pause(){this.window.pause(),this.document.pause()}resume(){this.window.resume(),this.document.resume()}clear(){this.window.clear(),this.document.clear()}}class nn{constructor(t,e,i){this.worldPos=t,this.pagePos=e,this.screenPos=i}static fromPagePosition(t,e,i){let n,o,h,d;arguments.length===3?(n=t,o=e,h=new p(n,o),d=i):(h=t,n=h.x,o=h.y,d=e);const u=d.screen.pageToScreenCoordinates(h),x=d.screen.screenToWorldCoordinates(u);return new nn(x,h,u)}}class rn{constructor(t,e,i,n,o,h){this.type=t,this.pointerId=e,this.button=i,this.pointerType=n,this.coordinates=o,this.nativeEvent=h,this.active=!0}cancel(){this.active=!1}get pagePos(){return this.coordinates.pagePos}get screenPos(){return this.coordinates.screenPos}get worldPos(){return this.coordinates.worldPos}}class Vn{constructor(t,e,i,n,o,h,d,u,x,Q,J,et){this.x=t,this.y=e,this.pageX=i,this.pageY=n,this.screenX=o,this.screenY=h,this.index=d,this.deltaX=u,this.deltaY=x,this.deltaZ=Q,this.deltaMode=J,this.ev=et,this.active=!0}cancel(){this.active=!1}}class yr extends We{constructor(){super(),this.lastPagePos=p.Zero,this.lastScreenPos=p.Zero,this.lastWorldPos=p.Zero,this._onPointerMove=t=>{this.lastPagePos=new p(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new p(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new p(t.worldPos.x,t.worldPos.y)},this._onPointerDown=t=>{this.lastPagePos=new p(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new p(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new p(t.worldPos.x,t.worldPos.y)},this.on("move",this._onPointerMove),this.on("down",this._onPointerDown)}on(t,e){super.on(t,e)}once(t,e){super.once(t,e)}off(t,e){super.off(t,e)}}var Is;(function(a){a.Pixel="Pixel",a.Line="Line",a.Page="Page"})(Is||(Is={}));var Oi;(function(a){a[a.NoButton=-1]="NoButton",a[a.Left=0]="Left",a[a.Middle=1]="Middle",a[a.Right=2]="Right",a[a.Unknown=3]="Unknown"})(Oi||(Oi={}));var bi;(function(a){a.Left="Left",a.Middle="Middle",a.Right="Right",a.Unknown="Unknown",a.NoButton="NoButton"})(bi||(bi={}));var Ci;(function(a){a.Touch="Touch",a.Mouse="Mouse",a.Pen="Pen",a.Unknown="Unknown"})(Ci||(Ci={}));function Do(a){return globalThis.TouchEvent&&a instanceof globalThis.TouchEvent}function To(a){return globalThis.PointerEvent&&a instanceof globalThis.PointerEvent}class on extends We{constructor(t,e){super(),this.target=t,this.engine=e,this.primary=new yr,this._activeNativePointerIdsToNormalized=new Map,this.lastFramePointerCoords=new Map,this.currentFramePointerCoords=new Map,this.currentFramePointerDown=new Map,this.lastFramePointerDown=new Map,this.currentFrameDown=[],this.currentFrameUp=[],this.currentFrameMove=[],this.currentFrameCancel=[],this.currentFrameWheel=[],this._pointers=[this.primary],this._boundHandle=this._handle.bind(this),this._boundWheel=this._handleWheel.bind(this)}recreate(t,e){const i=new on(t,e);return i.primary=this.primary,i._pointers=this._pointers,i}at(t){if(t>=this._pointers.length)for(let e=this._pointers.length-1,i=t;e<i;e++)this._pointers.push(new yr);return this._pointers[t]}count(){return this._pointers.length}isDown(t){var e;return(e=this.currentFramePointerDown.get(t))!==null&&e!==void 0?e:!1}wasDown(t){var e;return(e=this.lastFramePointerDown.get(t))!==null&&e!==void 0?e:!1}isDragging(t){return this.isDown(t)}isDragStart(t){return this.isDown(t)&&!this.wasDown(t)}isDragEnd(t){return!this.isDown(t)&&this.wasDown(t)}on(t,e){super.on(t,e)}once(t,e){super.once(t,e)}off(t,e){super.off(t,e)}update(){this.lastFramePointerDown=new Map(this.currentFramePointerDown),this.lastFramePointerCoords=new Map(this.currentFramePointerCoords);for(const t of this.currentFrameDown)this.emit("down",t),this.at(t.pointerId).emit("down",t),this.primary.emit("pointerdown",t);for(const t of this.currentFrameUp)this.emit("up",t),this.at(t.pointerId).emit("up",t);for(const t of this.currentFrameMove)this.emit("move",t),this.at(t.pointerId).emit("move",t);for(const t of this.currentFrameCancel)this.emit("cancel",t),this.at(t.pointerId).emit("cancel",t);for(const t of this.currentFrameWheel)this.emit("wheel",t),this.primary.emit("pointerwheel",t)}clear(){for(const t of this.currentFrameUp){this.currentFramePointerCoords.delete(t.pointerId);const e=this._activeNativePointerIdsToNormalized.entries();for(const[i,n]of e)n===t.pointerId&&this._activeNativePointerIdsToNormalized.delete(i)}this.currentFrameDown.length=0,this.currentFrameUp.length=0,this.currentFrameMove.length=0,this.currentFrameCancel.length=0,this.currentFrameWheel.length=0}init(){this.target===this.engine.canvas?this.engine.canvas.style.touchAction="none":document.body.style.touchAction="none",window.PointerEvent?(this.target.addEventListener("pointerdown",this._boundHandle),this.target.addEventListener("pointerup",this._boundHandle),this.target.addEventListener("pointermove",this._boundHandle),this.target.addEventListener("pointercancel",this._boundHandle)):(this.target.addEventListener("touchstart",this._boundHandle),this.target.addEventListener("touchend",this._boundHandle),this.target.addEventListener("touchmove",this._boundHandle),this.target.addEventListener("touchcancel",this._boundHandle),this.target.addEventListener("mousedown",this._boundHandle),this.target.addEventListener("mouseup",this._boundHandle),this.target.addEventListener("mousemove",this._boundHandle));const t={passive:!(this.engine.pageScrollPreventionMode===Hi.All||this.engine.pageScrollPreventionMode===Hi.Canvas)};"onwheel"in document.createElement("div")?this.target.addEventListener("wheel",this._boundWheel,t):document.onmousewheel!==void 0?this.target.addEventListener("mousewheel",this._boundWheel,t):this.target.addEventListener("MozMousePixelScroll",this._boundWheel,t)}detach(){window.PointerEvent?(this.target.removeEventListener("pointerdown",this._boundHandle),this.target.removeEventListener("pointerup",this._boundHandle),this.target.removeEventListener("pointermove",this._boundHandle),this.target.removeEventListener("pointercancel",this._boundHandle)):(this.target.removeEventListener("touchstart",this._boundHandle),this.target.removeEventListener("touchend",this._boundHandle),this.target.removeEventListener("touchmove",this._boundHandle),this.target.removeEventListener("touchcancel",this._boundHandle),this.target.removeEventListener("mousedown",this._boundHandle),this.target.removeEventListener("mouseup",this._boundHandle),this.target.removeEventListener("mousemove",this._boundHandle)),"onwheel"in document.createElement("div")?this.target.removeEventListener("wheel",this._boundWheel):document.onmousewheel!==void 0?this.target.addEventListener("mousewheel",this._boundWheel):this.target.addEventListener("MozMousePixelScroll",this._boundWheel)}_normalizePointerId(t){this._activeNativePointerIdsToNormalized.set(t,-1);const i=Array.from(this._activeNativePointerIdsToNormalized.keys()).sort((n,o)=>n-o).findIndex(n=>n===t);return this._activeNativePointerIdsToNormalized.set(t,i),i}_handle(t){t.preventDefault();const e=new Map;let i,n;if(Do(t)){i=bi.Unknown,n=Ci.Touch;for(let o=0;o<t.changedTouches.length;o++){const h=t.changedTouches[o],d=nn.fromPagePosition(h.pageX,h.pageY,this.engine),u=o+1,x=this._normalizePointerId(u);this.currentFramePointerCoords.set(x,d),e.set(x,d)}}else{i=this._nativeButtonToPointerButton(t.button),n=Ci.Mouse;const o=nn.fromPagePosition(t.pageX,t.pageY,this.engine);let h=1;To(t)&&(h=t.pointerId,n=this._stringToPointerType(t.pointerType));const d=this._normalizePointerId(h);this.currentFramePointerCoords.set(d,o),e.set(d,o)}for(const[o,h]of e.entries())switch(t.type){case"mousedown":case"pointerdown":case"touchstart":this.currentFrameDown.push(new rn("down",o,i,n,h,t)),this.currentFramePointerDown.set(o,!0);break;case"mouseup":case"pointerup":case"touchend":this.currentFrameUp.push(new rn("up",o,i,n,h,t)),this.currentFramePointerDown.set(o,!1);break;case"mousemove":case"pointermove":case"touchmove":this.currentFrameMove.push(new rn("move",o,i,n,h,t));break;case"touchcancel":case"pointercancel":this.currentFrameCancel.push(new rn("cancel",o,i,n,h,t));break}}_handleWheel(t){(this.engine.pageScrollPreventionMode===Hi.All||this.engine.pageScrollPreventionMode===Hi.Canvas&&t.target===this.engine.canvas)&&t.preventDefault();const e=this.engine.screen.pageToScreenCoordinates(m(t.pageX,t.pageY)),i=this.engine.screen.screenToWorldCoordinates(e),n=-1/40,o=t.deltaX||t.wheelDeltaX*n||0,h=t.deltaY||t.wheelDeltaY*n||t.wheelDelta*n||t.detail||0,d=t.deltaZ||0;let u=Is.Pixel;t.deltaMode&&(t.deltaMode===1?u=Is.Line:t.deltaMode===2&&(u=Is.Page));const x=new Vn(i.x,i.y,t.pageX,t.pageY,e.x,e.y,0,o,h,d,u,t);this.currentFrameWheel.push(x)}triggerEvent(t,e){const i=this.engine.screen.worldToPageCoordinates(e);window.PointerEvent?this._handle(new window.PointerEvent("pointer"+t,{pointerId:0,clientX:i.x,clientY:i.y})):this._handle(new window.MouseEvent("mouse"+t,{clientX:i.x,clientY:i.y}));const n=this.engine.currentScene.world.systemManager.get(Js),o=this.engine.currentScene.world.queryManager.createQuery(n.types);n.preupdate(),n.update(o.getEntities())}_nativeButtonToPointerButton(t){switch(t){case Oi.NoButton:return bi.NoButton;case Oi.Left:return bi.Left;case Oi.Middle:return bi.Middle;case Oi.Right:return bi.Right;case Oi.Unknown:return bi.Unknown;default:return at(t)}}_stringToPointerType(t){switch(t){case"touch":return Ci.Touch;case"mouse":return Ci.Mouse;case"pen":return Ci.Pen;default:return Ci.Unknown}}}class xr{constructor(t){var e;this._samplePeriod=100,this._currentFrameTime=0,this._frames=0,this._previousSampleTime=0,this._beginFrameTime=0,this._fps=t.initialFps,this._samplePeriod=(e=t.samplePeriod)!==null&&e!==void 0?e:this._samplePeriod,this._currentFrameTime=1e3/t.initialFps,this._nowFn=t.nowFn,this._previousSampleTime=this._nowFn()}start(){this._beginFrameTime=this._nowFn()}end(){this._frames++;const t=this._nowFn();this._currentFrameTime=t-this._beginFrameTime,t>=this._previousSampleTime+this._samplePeriod&&(this._fps=this._frames*1e3/(t-this._previousSampleTime),this._previousSampleTime=t,this._frames=0)}get fps(){return this._fps}get instant(){return 1e3/this._currentFrameTime}}class On{constructor(t){var e,i,n;this._onFatalException=()=>{},this._maxFps=1/0,this._lastTime=0,this._elapsed=1,this._scheduledCbs=[],this._totalElapsed=0,this._options=t,this.tick=t.tick,this._lastTime=(e=this.now())!==null&&e!==void 0?e:0,this._maxFps=(i=t.maxFps)!==null&&i!==void 0?i:this._maxFps,this._onFatalException=(n=t.onFatalException)!==null&&n!==void 0?n:this._onFatalException,this.fpsSampler=new xr({initialFps:60,nowFn:()=>this.now()})}elapsed(){return this._elapsed}now(){return performance.now()}toTestClock(){return new co({...this._options,defaultUpdateMs:16.6})}toStandardClock(){return new Ir({...this._options})}setFatalExceptionHandler(t){this._onFatalException=t}schedule(t,e=0){const i=this._totalElapsed+e;this._scheduledCbs.push([t,i])}_runScheduledCbs(){for(let t=this._scheduledCbs.length-1;t>-1;t--)this._scheduledCbs[t][1]<=this._totalElapsed&&(this._scheduledCbs[t][0](),this._scheduledCbs.splice(t,1))}update(t){try{this.fpsSampler.start();const e=this.now();let i=e-this._lastTime||1;const n=1e3/this._maxFps;if(i>=n){let o=0;n!==0&&(o=i%n,i=i-o),i>200&&(i=1),this._elapsed=t||i,this._totalElapsed+=this._elapsed,this._runScheduledCbs(),this.tick(t||i),n!==0?this._lastTime=e-o:this._lastTime=e,this.fpsSampler.end()}}catch(e){this._onFatalException(e),this.stop()}}}class Ir extends On{constructor(t){super(t),this._running=!1}isRunning(){return this._running}start(){if(this._running)return;this._running=!0;const t=()=>{if(this._running)try{this._requestId=window.requestAnimationFrame(t),this.update()}catch(e){throw window.cancelAnimationFrame(this._requestId),e}};t()}stop(){this._running=!1}}class co extends On{constructor(t){super({...t}),this._logger=v.getInstance(),this._running=!1,this._currentTime=0,this._updateMs=t.defaultUpdateMs}now(){var t;return(t=this._currentTime)!==null&&t!==void 0?t:0}isRunning(){return this._running}start(){this._running=!0}stop(){this._running=!1}step(t){const e=t??this._updateMs;this._running?(this.update(e),this._currentTime+=e):this._logger.warn("The clock is not running, no step will be performed")}run(t,e){for(let i=0;i<t;i++)this.step(e??this._updateMs)}}var Fo=pe(7379);class Ao{constructor(){this._toasterCss=Fo.Z.toString(),this._isInitialized=!1}_initialize(){this._isInitialized||(this._container=document.createElement("div"),this._container.id="ex-toast-container",document.body.appendChild(this._container),this._isInitialized=!0,this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._toasterCss,document.head.appendChild(this._styleBlock))}dispose(){this._container.parentElement.removeChild(this._container),this._styleBlock.parentElement.removeChild(this._styleBlock),this._isInitialized=!1}_createFragment(t){const e=document.createElement("span");return e.innerText=t,e}toast(t,e,i){this._initialize();const n=document.createElement("div");n.className="ex-toast-message";const o=t.split("[LINK]").map(Q=>this._createFragment(Q));if(e){const Q=document.createElement("a");Q.href=e,i?Q.innerText=i:Q.innerText=e,o.splice(1,0,Q)}const h=document.createElement("div");o.forEach(Q=>{h.appendChild(Q)}),n.appendChild(h);const d=document.createElement("button");d.innerText="x",d.addEventListener("click",()=>{this._container.removeChild(n)}),n.appendChild(d);const u=Q=>{if(Q.key==="Escape")try{this._container.removeChild(n)}catch{}document.removeEventListener("keydown",u)};document.addEventListener("keydown",u);const x=this._container.firstChild;this._container.insertBefore(n,x)}}Z();var Hi;(function(a){a[a.None=0]="None",a[a.Canvas=1]="Canvas",a[a.All=2]="All"})(Hi||(Hi={}));class as extends We{constructor(t){var e,i,n,o,h,d;super(),this.maxFps=Number.POSITIVE_INFINITY,this.scenes={},this._suppressPlayButton=!1,this.pauseAudioWhenHidden=!0,this._isDebug=!1,this.enableCanvasTransparency=!0,this.onFatalException=J=>{v.getInstance().fatal(J)},this._toaster=new Ao,this._timescale=1,this._isInitialized=!1,this._deferredGoTo=null,this._originalOptions={},this._performanceThresholdTriggered=!1,this._fpsSamples=[],this._loadingComplete=!1,this._isReady=!1,this._isReadyPromise=new Promise(J=>{this._isReadyResolve=J}),this.currentFrameElapsedMs=0,this.currentFrameLagMs=0,this._lagMs=0,this._screenShotRequests=[],t={...as._DEFAULT_ENGINE_OPTIONS,...t},this._originalOptions=t,q.freeze(),this.browser=new wi(window,document);const u=new tr;if(!t.suppressMinimumBrowserFeatureDetection&&!(this._compatible=u.test())){const J=document.createElement("div");if(J.innerText="Sorry, your browser does not support all the features needed for Excalibur",document.body.appendChild(J),u.failedTests.forEach(function(et){const dt=document.createElement("div");dt.innerText="Browser feature missing "+et,document.body.appendChild(dt)}),t.canvasElementId){const et=document.getElementById(t.canvasElementId);et&&et.parentElement.removeChild(et)}return}else this._compatible=!0;console.log&&!t.suppressConsoleBootMessage&&(console.log(`%cPowered by Excalibur.js (v${Uo})`,"background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;"),console.log(`
      /| ________________
O|===|* >________________>
      \\|`),console.log("Visit","http://excaliburjs.com","for more information")),t.suppressPlayButton&&(this._suppressPlayButton=!0),this._logger=v.getInstance(),this._logger.defaultLevel===C.Debug&&u.logBrowserFeatures(),this._logger.debug("Building engine..."),this.canvasElementId=t.canvasElementId,t.canvasElementId?(this._logger.debug("Using Canvas element specified: "+t.canvasElementId),this.canvas=document.getElementById(t.canvasElementId)):t.canvasElement?(this._logger.debug("Using Canvas element specified:",t.canvasElement),this.canvas=t.canvasElement):(this._logger.debug("Using generated canvas element"),this.canvas=document.createElement("canvas"));let x=(e=t.displayMode)!==null&&e!==void 0?e:re.Fixed;t.width&&t.height||t.viewport?(t.displayMode===void 0&&(x=re.Fixed),this._logger.debug("Engine viewport is size "+t.width+" x "+t.height)):t.displayMode||(this._logger.debug("Engine viewport is fit"),x=re.FitScreen),this._originalDisplayMode=x;let Q=q.isEnabled("use-canvas-context");if(!Q)try{this.graphicsContext=new Ns({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting})}catch(J){this._logger.warn(`Excalibur could not load webgl for some reason (${J.message}) and loaded a Canvas 2D fallback. Some features of Excalibur will not work in this mode. 

Read more about this issue at https://excaliburjs.com/docs/webgl`),Q=!0}Q&&(this.graphicsContext=new As({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting})),this.screen=new Gs({canvas:this.canvas,context:this.graphicsContext,antialiasing:(i=t.antialiasing)!==null&&i!==void 0?i:!0,browser:this.browser,viewport:(n=t.viewport)!==null&&n!==void 0?n:t.width&&t.height?{width:t.width,height:t.height}:Yi.SVGA,resolution:t.resolution,displayMode:x,pixelRatio:t.suppressHiDPIScaling?1:(o=t.pixelRatio)!==null&&o!==void 0?o:null}),Xt.filtering=t.antialiasing?xe.Blended:xe.Pixel,t.backgroundColor&&(this.backgroundColor=t.backgroundColor.clone()),this.maxFps=(h=t.maxFps)!==null&&h!==void 0?h:this.maxFps,this.fixedUpdateFps=(d=t.fixedUpdateFps)!==null&&d!==void 0?d:this.fixedUpdateFps,this.clock=new Ir({maxFps:this.maxFps,tick:this._mainloop.bind(this),onFatalException:J=>this.onFatalException(J)}),this.enableCanvasTransparency=t.enableCanvasTransparency,this._loader=new ps,this._loader.wireEngine(this),this.debug=new lo(this),this._initialize(t),this.rootScene=this.currentScene=new Zs,this.addScene("root",this.rootScene),window.___EXCALIBUR_DEVTOOL=this}get canvasWidth(){return this.screen.canvasWidth}get halfCanvasWidth(){return this.screen.halfCanvasWidth}get canvasHeight(){return this.screen.canvasHeight}get halfCanvasHeight(){return this.screen.halfCanvasHeight}get drawWidth(){return this.screen.drawWidth}get halfDrawWidth(){return this.screen.halfDrawWidth}get drawHeight(){return this.screen.drawHeight}get halfDrawHeight(){return this.screen.halfDrawHeight}get isHiDpi(){return this.screen.isHiDpi}get stats(){return this.debug.stats}get isFullscreen(){return this.screen.isFullScreen}get displayMode(){return this.screen.displayMode}get pixelRatio(){return this.screen.pixelRatio}get isDebug(){return this._isDebug}get snapToPixel(){return this.graphicsContext.snapToPixel}set snapToPixel(t){this.graphicsContext.snapToPixel=t}on(t,e){super.on(t,e)}once(t,e){super.once(t,e)}off(t,e){super.off(t,e)}_monitorPerformanceThresholdAndTriggerFallback(){const{allow:t}=this._originalOptions.configurePerformanceCanvas2DFallback;let{threshold:e,showPlayerMessage:i}=this._originalOptions.configurePerformanceCanvas2DFallback;if(e===void 0&&(e=as._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.threshold),i===void 0&&(i=as._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.showPlayerMessage),!q.isEnabled("use-canvas-context")&&t&&this.ready&&!this._performanceThresholdTriggered){this._fpsSamples.length===e.numberOfFrames&&this._fpsSamples.splice(0,1),this._fpsSamples.push(this.clock.fpsSampler.fps);let n=0;for(let h=0;h<this._fpsSamples.length;h++)n+=this._fpsSamples[h];const o=n/this._fpsSamples.length;this._fpsSamples.length===e.numberOfFrames&&o<=e.fps&&(this._performanceThresholdTriggered=!0,this._logger.warn(`Switching to browser 2D Canvas fallback due to performance. Some features of Excalibur will not work in this mode.
this might mean your browser doesn't have webgl enabled or hardware acceleration is unavailable.

If in Chrome:
  * Visit Settings > Advanced > System, and ensure "Use Hardware Acceleration" is checked.
  * Visit chrome://flags/#ignore-gpu-blocklist and ensure "Override software rendering list" is "enabled"
If in Firefox, visit about:config
  * Ensure webgl.disabled = false
  * Ensure webgl.force-enabled = true
  * Ensure layers.acceleration.force-enabled = true

Read more about this issue at https://excaliburjs.com/docs/performance`),i&&this._toaster.toast("Excalibur is encountering performance issues. It's possible that your browser doesn't have hardware acceleration enabled. Visit [LINK] for more information and potential solutions.","https://excaliburjs.com/docs/performance"),this.useCanvas2DFallback(),this.emit("fallbackgraphicscontext",this.graphicsContext))}}useCanvas2DFallback(){var t,e,i;const n=this.canvas.cloneNode(!1);this.canvas.parentNode.replaceChild(n,this.canvas),this.canvas=n;const o=this._originalOptions,h=this._originalDisplayMode;this.graphicsContext=new As({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:o.antialiasing,backgroundColor:o.backgroundColor,snapToPixel:o.snapToPixel,useDrawSorting:o.useDrawSorting}),this.screen&&this.screen.dispose(),this.screen=new Gs({canvas:this.canvas,context:this.graphicsContext,antialiasing:(t=o.antialiasing)!==null&&t!==void 0?t:!0,browser:this.browser,viewport:(e=o.viewport)!==null&&e!==void 0?e:o.width&&o.height?{width:o.width,height:o.height}:Yi.SVGA,resolution:o.resolution,displayMode:h,pixelRatio:o.suppressHiDPIScaling?1:(i=o.pixelRatio)!==null&&i!==void 0?i:null}),this.screen.setCurrentCamera(this.currentScene.camera),this.input.pointers.detach();const d=o&&o.pointerScope===ys.Document?document:this.canvas;this.input.pointers=this.input.pointers.recreate(d,this),this.input.pointers.init()}getWorldBounds(){return this.screen.getWorldBounds()}get timescale(){return this._timescale}set timescale(t){if(t<=0){v.getInstance().error("Cannot set engine.timescale to a value of 0 or less than 0.");return}this._timescale=t}addTimer(t){return this.currentScene.addTimer(t)}removeTimer(t){return this.currentScene.removeTimer(t)}addScene(t,e){this.scenes[t]&&this._logger.warn("Scene",t,"already exists overwriting"),this.scenes[t]=e}removeScene(t){if(t instanceof Zs)for(const e in this.scenes)this.scenes.hasOwnProperty(e)&&this.scenes[e]===t&&delete this.scenes[e];typeof t=="string"&&delete this.scenes[t]}add(t){if(arguments.length===2){this.addScene(arguments[0],arguments[1]);return}this._deferredGoTo&&this.scenes[this._deferredGoTo]?this.scenes[this._deferredGoTo].add(t):this.currentScene.add(t)}remove(t){t instanceof we&&this.currentScene.remove(t),t instanceof Zs&&this.removeScene(t),typeof t=="string"&&this.removeScene(t)}goToScene(t,e){if(!this.isInitialized){this._deferredGoTo=t;return}if(this.scenes[t]){const i=this.currentScene,n=this.scenes[t];if(this._logger.debug("Going to scene:",t),this.currentScene.isInitialized){const h={engine:this,previousScene:i,nextScene:n};this.currentScene._deactivate.apply(this.currentScene,[h,n]),this.currentScene.eventDispatcher.emit("deactivate",new Qs(h,this.currentScene))}this.currentScene=n,this.screen.setCurrentCamera(n.camera),this.currentScene._initialize(this);const o={engine:this,previousScene:i,nextScene:n,data:e};this.currentScene._activate.apply(this.currentScene,[o,n]),this.currentScene.eventDispatcher.emit("activate",new hs(o,this.currentScene))}else this._logger.error("Scene",t,"does not exist!")}screenToWorldCoordinates(t){return this.screen.screenToWorldCoordinates(t)}worldToScreenCoordinates(t){return this.screen.worldToScreenCoordinates(t)}_initialize(t){this.pageScrollPreventionMode=t.scrollPreventionMode;const e=t&&t.pointerScope===ys.Document?document:this.canvas;this.input={keyboard:new ho,pointers:new on(e,this),gamepads:new xs},this.input.keyboard.init(),this.input.pointers.init(),this.input.gamepads.init();let i,n;typeof document.hidden<"u"?(i="hidden",n="visibilitychange"):"msHidden"in document?(i="msHidden",n="msvisibilitychange"):"webkitHidden"in document&&(i="webkitHidden",n="webkitvisibilitychange"),this.browser.document.on(n,()=>{document[i]?(this.eventDispatcher.emit("hidden",new ji(this)),this._logger.debug("Window hidden")):(this.eventDispatcher.emit("visible",new Ui(this)),this._logger.debug("Window visible"))}),!this.canvasElementId&&!t.canvasElement&&document.body.appendChild(this.canvas)}onInitialize(t){}setAntialiasing(t){this.screen.antialiasing=t}getAntialiasing(){return this.screen.antialiasing}get isInitialized(){return this._isInitialized}_overrideInitialize(t){if(!this.isInitialized)if(this.onInitialize(t),super.emit("initialize",new Xi(t,this)),this._isInitialized=!0,this._deferredGoTo){const e=this._deferredGoTo;this._deferredGoTo=null,this.goToScene(e)}else this.goToScene("root")}_update(t){if(!this.ready){this._loader.update(this,t),this.input.keyboard.update(),this.input.gamepads.update();return}this._preupdate(t),this.currentScene.update(this,t),this._postupdate(t),this.input.keyboard.update(),this.input.gamepads.update()}_preupdate(t){this.emit("preupdate",new qt(this,t,this)),this.onPreUpdate(this,t)}onPreUpdate(t,e){}_postupdate(t){this.emit("postupdate",new Yt(this,t,this)),this.onPostUpdate(this,t)}onPostUpdate(t,e){}_draw(t){if(this.graphicsContext.beginDrawLifecycle(),this.graphicsContext.clear(),this._predraw(this.graphicsContext,t),!this._isReady){this._loader.canvas.draw(this.graphicsContext,0,0),this.graphicsContext.flush();return}this.graphicsContext.backgroundColor=this.backgroundColor,this.currentScene.draw(this.graphicsContext,t),this._postdraw(this.graphicsContext,t),this.graphicsContext.flush(),this.graphicsContext.endDrawLifecycle(),this._checkForScreenShots()}_predraw(t,e){this.emit("predraw",new yt(t,e,this)),this.onPreDraw(t,e)}onPreDraw(t,e){}_postdraw(t,e){this.emit("postdraw",new kt(t,e,this)),this.onPostDraw(t,e)}onPostDraw(t,e){}showDebug(t){this._isDebug=t}toggleDebug(){return this._isDebug=!this._isDebug,this._isDebug}get loadingComplete(){return this._loadingComplete}get ready(){return this._isReady}isReady(){return this._isReadyPromise}async start(t){if(!this._compatible)throw new Error("Excalibur is incompatible with your browser");return t&&(this.screen.pushResolutionAndViewport(),this.screen.resolution=this.screen.viewport,this.screen.applyResolutionAndViewport(),this._loader=t,this._loader.suppressPlayButton=this._suppressPlayButton||this._loader.suppressPlayButton,this._loader.wireEngine(this)),this._logger.debug("Starting game clock..."),this.browser.resume(),this.clock.start(),this._logger.debug("Game clock started"),t&&(await this.load(this._loader),this._loadingComplete=!0,this.screen.popResolutionAndViewport(),this.screen.applyResolutionAndViewport()),this._loadingComplete=!0,this._overrideInitialize(this),this._isReady=!0,this._isReadyResolve(),this.emit("start",new bt(this)),this._isReadyPromise}_mainloop(t){this.emit("preframe",new Kt(this,this.stats.prevFrame));const e=t*this.timescale;this.currentFrameElapsedMs=e;const i=this.stats.prevFrame.id+1;this.stats.currFrame.reset(),this.stats.currFrame.id=i,this.stats.currFrame.delta=e,this.stats.currFrame.fps=this.clock.fpsSampler.fps,le.clear();const n=this.clock.now(),o=1e3/this.fixedUpdateFps;if(this.fixedUpdateFps)for(this._lagMs+=e;this._lagMs>=o;)this._update(o),this._lagMs-=o;else this._update(e);const h=this.clock.now();this.currentFrameLagMs=this._lagMs,this._draw(e);const d=this.clock.now();this.stats.currFrame.duration.update=h-n,this.stats.currFrame.duration.draw=d-h,this.stats.currFrame.graphics.drawnImages=le.DrawnImagesCount,this.stats.currFrame.graphics.drawCalls=le.DrawCallCount,this.emit("postframe",new Fe(this,this.stats.currFrame)),this.stats.prevFrame.reset(this.stats.currFrame),this._monitorPerformanceThresholdAndTriggerFallback()}stop(){this.clock.isRunning()&&(this.emit("stop",new Bt(this)),this.browser.pause(),this.clock.stop(),this._logger.debug("Game stopped"))}isRunning(){return this.clock.isRunning()}screenshot(t=!1){return new Promise(i=>{this._screenShotRequests.push({preserveHiDPIResolution:t,resolve:i})})}_checkForScreenShots(){for(const t of this._screenShotRequests){const e=t.preserveHiDPIResolution?this.canvas.width:this.screen.resolution.width,i=t.preserveHiDPIResolution?this.canvas.height:this.screen.resolution.height,n=document.createElement("canvas");n.width=e,n.height=i,n.getContext("2d").drawImage(this.canvas,0,0,e,i);const h=new Image,d=n.toDataURL("image/png");h.src=d,t.resolve(h)}this._screenShotRequests.length=0}async load(t){try{await t.load()}catch(e){this._logger.error("Error loading resources, things may not behave properly",e),await Promise.resolve()}}}as._DEFAULT_ENGINE_OPTIONS={width:0,height:0,enableCanvasTransparency:!0,useDrawSorting:!0,configurePerformanceCanvas2DFallback:{allow:!0,showPlayerMessage:!1,threshold:{fps:20,numberOfFrames:100}},canvasElementId:"",canvasElement:void 0,snapToPixel:!1,pointerScope:ys.Canvas,suppressConsoleBootMessage:null,suppressMinimumBrowserFeatureDetection:null,suppressHiDPIScaling:null,suppressPlayButton:null,scrollPreventionMode:Hi.Canvas,backgroundColor:I.fromHex("#2185d0")};class Mo extends mi{constructor(t){super(t),this._font=new ri,this._text=new Ws({text:"",font:this._font});const{text:e,pos:i,x:n,y:o,spriteFont:h,font:d,color:u}=t;this.pos=i??(n&&o?m(n,o):this.pos),this.text=e??this.text,this.font=d??this.font,this.spriteFont=h??this.spriteFont,this._text.color=u??this.color;const x=this.get(Qe);x.anchor=p.Zero,x.use(this._text)}get font(){return this._font}set font(t){this._font=t,this._text.font=t}get text(){return this._text.text}set text(t){this._text.text=t}get color(){return this._text.color}set color(t){this._text&&(this._text.color=t)}get opacity(){return this._text.opacity}set opacity(t){this._text.opacity=t}get spriteFont(){return this._spriteFont}set spriteFont(t){t&&(this._spriteFont=t,this._text.font=this._spriteFont)}_initialize(t){super._initialize(t)}getTextWidth(){return this._text.width}}class l extends we{constructor(t,e,i,n){super([new Pt,new Qe({offset:i??p.Zero,onPostDraw:(et,dt)=>this.draw(et,dt)}),new Gn(n)]),this.solid=!1,this._tileBounds=new N,this._graphics=[],this._colliders=[],this.x=t,this.y=e,this.map=n,this._transform=this.get(Pt),this._isometricEntityComponent=this.get(Gn);const o=this.map.tileWidth/2,h=this.map.tileHeight/2,d=(this.x-this.y)*o,u=(this.x+this.y)*h;this._transform.pos=m(d,u),this._isometricEntityComponent.elevation=0,this._gfx=this.get(Qe),this._gfx.visible=!1;const x=this.map.tileWidth,Q=this.map.tileHeight,J=m(0,this.map.renderFromTopOfGraphic?Q:0);this._gfx.localBounds=this._tileBounds=new N({left:-x/2,top:-Q,right:x/2,bottom:Q}).translate(J)}getGraphics(){return this._graphics}addGraphic(t){this._graphics.push(t),this._gfx.visible=!0,this._gfx.localBounds=this._recalculateBounds()}_recalculateBounds(){let t=this._tileBounds.clone();for(const e of this._graphics){const i=m(this.map.graphicsOffset.x-this.map.tileWidth/2,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:e.height-this.map.tileHeight));t=t.combine(e.localBounds.translate(i))}return t}removeGraphic(t){const e=this._graphics.indexOf(t);e>-1&&this._graphics.splice(e,1),this._gfx.localBounds=this._recalculateBounds()}clearGraphics(){this._graphics.length=0,this._gfx.visible=!1,this._gfx.localBounds=this._recalculateBounds()}getColliders(){return this._colliders}addCollider(t){this._colliders.push(t),this.map.flagCollidersDirty()}removeCollider(t){const e=this._colliders.indexOf(t);e>-1&&this._colliders.splice(e,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}get pos(){return this.map.tileToWorld(m(this.x,this.y))}get center(){return this.pos.add(m(0,this.map.tileHeight/2))}draw(t,e){const i=this.map.tileWidth/2;t.save(),t.translate(-i,0);for(const n of this._graphics)n.draw(t,this.map.graphicsOffset.x,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:n.height-this.map.tileHeight));t.restore()}}class s extends we{constructor(t){super([new Pt,new Ht({type:Gt.Fixed}),new _e,new Dn(x=>this.debug(x),!1)],t.name),this.renderFromTopOfGraphic=!1,this.graphicsOffset=m(0,0),this._collidersDirty=!1,this._originalOffsets=new WeakMap;const{pos:e,tileWidth:i,tileHeight:n,columns:o,rows:h,renderFromTopOfGraphic:d,graphicsOffset:u}=t;this.transform=this.get(Pt),e&&(this.transform.pos=e),this.collider=this.get(_e),this.collider&&this.collider.set(this._composite=new Ae([])),this.renderFromTopOfGraphic=d??this.renderFromTopOfGraphic,this.graphicsOffset=u??this.graphicsOffset,this.tileWidth=i,this.tileHeight=n,this.columns=o,this.rows=h,this.tiles=new Array(o*h);for(let x=0;x<h;x++)for(let Q=0;Q<o;Q++){const J=new l(Q,x,this.graphicsOffset,this);this.tiles[Q+x*o]=J,this.addChild(J)}}update(){this._collidersDirty&&(this.updateColliders(),this._collidersDirty=!1)}flagCollidersDirty(){this._collidersDirty=!0}_getOrSetColliderOriginalOffset(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);{const e=t.offset;return this._originalOffsets.set(t,e),e}}updateColliders(){this._composite.clearColliders();const t=this.get(Pt).pos;for(const e of this.tiles)if(e.solid)for(const i of e.getColliders()){const n=this._getOrSetColliderOriginalOffset(i);i.offset=this.tileToWorld(m(e.x,e.y)).sub(t).add(n).sub(m(this.tileWidth/2,this.tileHeight)),i.owner=this,this._composite.addCollider(i)}this.collider.update()}worldToTile(t){t=t.sub(this.transform.globalPos);const e=this.tileWidth/2,i=this.tileHeight/2;return m(~~((t.x/e+t.y/i)/2),~~((t.y/i-t.x/e)/2))}tileToWorld(t){const e=this.tileWidth/2,i=this.tileHeight/2,n=(t.x-t.y)*e,o=(t.x+t.y)*i;return m(n,o).add(this.transform.pos)}getTile(t,e){return t<0||e<0||t>=this.columns||e>=this.rows?null:this.tiles[t+e*this.columns]}getTileByPoint(t){const e=this.worldToTile(t);return this.getTile(e.x,e.y)}_getMaxZIndex(){let t=Number.NEGATIVE_INFINITY;for(const e of this.tiles){const i=e.get(Pt).z;i>t&&(t=i)}return t}debug(t){t.save(),t.z=this._getMaxZIndex()+.5;for(let e=0;e<this.rows+1;e++){const i=this.tileToWorld(m(0,e)),n=this.tileToWorld(m(this.columns,e));t.drawLine(i,n,I.Red,2)}for(let e=0;e<this.columns+1;e++){const i=this.tileToWorld(m(e,0)),n=this.tileToWorld(m(e,this.rows));t.drawLine(i,n,I.Red,2)}for(const e of this.tiles)t.drawCircle(this.tileToWorld(m(e.x,e.y)),3,I.Yellow);t.restore()}}class r{constructor(t,e){this._stopped=!1,this._sequenceBuilder=e,this._sequenceContext=new ms(t),this._actionQueue=this._sequenceContext.getQueue(),this._sequenceBuilder(this._sequenceContext)}update(t){this._actionQueue.update(t)}isComplete(){return this._stopped||this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._stopped=!1,this._actionQueue.reset()}clone(t){return new r(t,this._sequenceBuilder)}}class c{constructor(t){this._actions=t}update(t){for(let e=0;e<this._actions.length;e++)this._actions[e].update(t)}isComplete(t){return this._actions.every(e=>e.isComplete(t))}reset(){this._actions.forEach(t=>t.reset())}stop(){this._actions.forEach(t=>t.stop())}}class f{static create(t,e){if(this._CURRENT_GROUP>this._MAX_GROUPS)throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);if(this._GROUPS.get(t))throw new Error(`Collision group ${t} already exists`);const i=new ni(t,this._CURRENT_BIT,e!==void 0?e:~this._CURRENT_BIT);return this._CURRENT_BIT=this._CURRENT_BIT<<1|0,this._CURRENT_GROUP++,this._GROUPS.set(t,i),i}static get groups(){return Array.from(this._GROUPS.values())}static groupByName(t){return this._GROUPS.get(t)}static reset(){this._GROUPS=new Map,this._CURRENT_BIT=this._STARTING_BIT,this._CURRENT_GROUP=1}}f._STARTING_BIT=1,f._MAX_GROUPS=32,f._CURRENT_GROUP=1,f._CURRENT_BIT=f._STARTING_BIT,f._GROUPS=new Map;function G(a){return!!a._initialize}function j(a){return!!a.onInitialize}function ht(a){return!!a._preupdate}function wt(a){return!!a.onPreUpdate}function Dt(a){return!!a.onPostUpdate}function jt(a){return!!a.onPostUpdate}function me(a){return!!a.onPreDraw}function Je(a){return!!a.onPostDraw}class Ve{constructor(t,e=I.Magenta,i=!0){this.path=t,this.color=e,this.bustCache=i,this._stream=null,this._gif=null,this._textures=[],this._animation=null,this._transparentColor=null,this._resource=new Si(t,"arraybuffer",i),this._transparentColor=e}async load(){const t=await this._resource.load();this._stream=new Hn(t),this._gif=new an(this._stream,this._transparentColor);const e=this._gif.images.map(i=>new un(i.src,!1));return await Promise.all(e.map(i=>i.load())),this.data=this._textures=e}isLoaded(){return!!this.data}toSprite(t=0){return this._textures[t].toSprite()}toSpriteSheet(){const t=this._textures.map(e=>e.toSprite());return new cs({sprites:t})}toAnimation(t){const e=this.toSpriteSheet(),i=e.sprites.length;return this._animation=Vi.fromSpriteSheet(e,O(0,i),t),this._animation}get readCheckBytes(){return this._gif.checkBytes}}const li=a=>a.reduce(function(t,e){return t*2+e},0),Es=a=>{const t=[];for(let e=7;e>=0;e--)t.push(!!(a&1<<e));return t};class Hn{constructor(t){if(this.data=null,this.len=0,this.position=0,this.readByte=()=>{if(this.position>=this.data.byteLength)throw new Error("Attempted to read past end of stream.");return this.data[this.position++]},this.readBytes=e=>{const i=[];for(let n=0;n<e;n++)i.push(this.readByte());return i},this.read=e=>{let i="";for(let n=0;n<e;n++)i+=String.fromCharCode(this.readByte());return i},this.readUnsigned=()=>{const e=this.readBytes(2);return(e[1]<<8)+e[0]},this.data=new Uint8Array(t),this.len=this.data.byteLength,this.len===0)throw new Error("No data loaded from file")}}const Er=function(a,t){let e=0;const i=function(et){let dt=0;for(let ft=0;ft<et;ft++)t.charCodeAt(e>>3)&1<<(e&7)&&(dt|=1<<ft),e++;return dt},n=[],o=1<<a,h=o+1;let d=a+1,u=[];const x=function(){u=[],d=a+1;for(let et=0;et<o;et++)u[et]=[et];u[o]=[],u[h]=null};let Q,J;for(;;){if(J=Q,Q=i(d),Q===o){x();continue}if(Q===h)break;if(Q<u.length)J!==o&&u.push(u[J].concat(u[Q][0]));else{if(Q!==u.length)throw new Error("Invalid LZW code.");u.push(u[J].concat(u[J][0]))}n.push.apply(n,u[Q]),u.length===1<<d&&d<12&&d++}return n};class an{constructor(t,e=I.Magenta){this._st=null,this._handler={},this._transparentColor=null,this.frames=[],this.images=[],this.globalColorTable=[],this.checkBytes=[],this.parseColorTable=i=>{const n=[];for(let o=0;o<i;o++){const d="#"+this._st.readBytes(3).map(u=>{const x=u.toString(16);return x.length===1?"0"+x:x}).join("");n.push(d)}return n},this.readSubBlocks=()=>{let i,n;n="";do i=this._st.readByte(),n+=this._st.read(i);while(i!==0);return n},this.parseHeader=()=>{const i={sig:null,ver:null,width:null,height:null,colorRes:null,globalColorTableSize:null,gctFlag:null,sorted:null,globalColorTable:[],bgColor:null,pixelAspectRatio:null};if(i.sig=this._st.read(3),i.ver=this._st.read(3),i.sig!=="GIF")throw new Error("Not a GIF file.");i.width=this._st.readUnsigned(),i.height=this._st.readUnsigned();const n=Es(this._st.readByte());i.gctFlag=n.shift(),i.colorRes=li(n.splice(0,3)),i.sorted=n.shift(),i.globalColorTableSize=li(n.splice(0,3)),i.bgColor=this._st.readByte(),i.pixelAspectRatio=this._st.readByte(),i.gctFlag&&(i.globalColorTable=this.parseColorTable(1<<i.globalColorTableSize+1),this.globalColorTable=i.globalColorTable),this._handler.hdr&&this._handler.hdr(i)&&this.checkBytes.push(this._handler.hdr)},this.parseExt=i=>{const n=x=>{this.checkBytes.push(this._st.readByte());const Q=Es(this._st.readByte());x.reserved=Q.splice(0,3),x.disposalMethod=li(Q.splice(0,3)),x.userInput=Q.shift(),x.transparencyGiven=Q.shift(),x.delayTime=this._st.readUnsigned(),x.transparencyIndex=this._st.readByte(),x.terminator=this._st.readByte(),this._handler.gce&&this._handler.gce(x)&&this.checkBytes.push(this._handler.gce)},o=x=>{x.comment=this.readSubBlocks(),this._handler.com&&this._handler.com(x)&&this.checkBytes.push(this._handler.com)},h=x=>{this.checkBytes.push(this._st.readByte()),x.ptHeader=this._st.readBytes(12),x.ptData=this.readSubBlocks(),this._handler.pte&&this._handler.pte(x)&&this.checkBytes.push(this._handler.pte)},d=x=>{const Q=et=>{this.checkBytes.push(this._st.readByte()),et.unknown=this._st.readByte(),et.iterations=this._st.readUnsigned(),et.terminator=this._st.readByte(),this._handler.app&&this._handler.app.NETSCAPE&&this._handler.app.NETSCAPE(et)&&this.checkBytes.push(this._handler.app)},J=et=>{et.appData=this.readSubBlocks(),this._handler.app&&this._handler.app[et.identifier]&&this._handler.app[et.identifier](et)&&this.checkBytes.push(this._handler.app[et.identifier])};switch(this.checkBytes.push(this._st.readByte()),x.identifier=this._st.read(8),x.authCode=this._st.read(3),x.identifier){case"NETSCAPE":Q(x);break;default:J(x);break}},u=x=>{x.data=this.readSubBlocks(),this._handler.unknown&&this._handler.unknown(x)&&this.checkBytes.push(this._handler.unknown)};switch(i.label=this._st.readByte(),i.label){case 249:i.extType="gce",n(i);break;case 254:i.extType="com",o(i);break;case 1:i.extType="pte",h(i);break;case 255:i.extType="app",d(i);break;default:i.extType="unknown",u(i);break}},this.parseImg=i=>{const n=(d,u)=>{const x=new Array(d.length),Q=d.length/u,J=(xt,It)=>{const ut=d.slice(It*u,(It+1)*u);x.splice.apply(x,[xt*u,u].concat(ut))},et=[0,4,2,1],dt=[8,8,4,2];let ft=0;for(let xt=0;xt<4;xt++)for(let It=et[xt];It<Q;It+=dt[xt])J(It,ft),ft++;return x};i.leftPos=this._st.readUnsigned(),i.topPos=this._st.readUnsigned(),i.width=this._st.readUnsigned(),i.height=this._st.readUnsigned();const o=Es(this._st.readByte());i.lctFlag=o.shift(),i.interlaced=o.shift(),i.sorted=o.shift(),i.reserved=o.splice(0,2),i.lctSize=li(o.splice(0,3)),i.lctFlag&&(i.lct=this.parseColorTable(1<<i.lctSize+1)),i.lzwMinCodeSize=this._st.readByte();const h=this.readSubBlocks();i.pixels=Er(i.lzwMinCodeSize,h),i.interlaced&&(i.pixels=n(i.pixels,i.width)),this.frames.push(i),this.arrayToImage(i),this._handler.img&&this._handler.img(i)&&this.checkBytes.push(this._handler)},this.parseBlock=()=>{const i={sentinel:this._st.readByte(),type:""};switch(String.fromCharCode(i.sentinel)){case"!":i.type="ext",this.parseExt(i);break;case",":i.type="img",this.parseImg(i);break;case";":i.type="eof",this._handler.eof&&this._handler.eof(i)&&this.checkBytes.push(this._handler.eof);break;default:throw new Error("Unknown block: 0x"+i.sentinel.toString(16))}i.type!=="eof"&&this.parseBlock()},this.arrayToImage=i=>{let n=0;const o=document.createElement("canvas");o.id=n.toString(),o.width=i.width,o.height=i.height,n++;const h=o.getContext("2d"),d=1;let u=0,x=0;for(let J=0;J<i.pixels.length;J++)x%i.width===0&&(u++,x=0),this.globalColorTable[i.pixels[J]]===this._transparentColor.toHex()?h.fillStyle="rgba(0, 0, 0, 0)":h.fillStyle=this.globalColorTable[i.pixels[J]],h.fillRect(x,u,d,d),x++;const Q=new Image;Q.src=o.toDataURL(),this.images.push(Q)},this._st=t,this._handler={},this._transparentColor=e,this.parseHeader(),this.parseBlock()}}class Bs extends Be{constructor(t){super(),this.color=I.Black,this.thickness=1;const{start:e,end:i,color:n,thickness:o}=t;this.start=e,this.end=i,this.color=n??this.color,this.thickness=o??this.thickness;const{width:h,height:d}=N.fromPoints([e,i]);this.width=h,this.height=d}_drawImage(t,e,i){t.drawLine(this.start,this.end,this.color,this.thickness)}clone(){return new Bs({start:this.start,end:this.end,color:this.color,thickness:this.thickness})}}class Br extends ce{constructor(t){super(t),this.points=t.points,this.filtering=xe.Blended,this.rasterize()}get points(){return this._points}set points(t){this._points=t;const e=this.minPoint;this.width=this._points.reduce((i,n)=>Math.max(n.x,i),0)-e.x,this.height=this._points.reduce((i,n)=>Math.max(n.y,i),0)-e.y,this.flagDirty()}get minPoint(){const t=this._points.reduce((i,n)=>Math.min(n.x,i),1/0),e=this._points.reduce((i,n)=>Math.min(n.y,i),1/0);return m(t,e)}clone(){return new Br({points:this.points.map(t=>t.clone()),...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){if(this.points&&this.points.length){t.beginPath();const e=this.minPoint.negate(),i=this.points[0].add(e);t.moveTo(i.x,i.y),this.points.forEach(n=>{t.lineTo(n.x+e.x,n.y+e.y)}),t.lineTo(i.x,i.y),t.closePath(),this.color&&t.fill(),this.strokeColor&&t.stroke()}}}class Ro{constructor(){this._queue=[]}get length(){return this._queue.length}enqueue(){const t=new _;return this._queue.push(t),t.promise}dequeue(t){this._queue.shift().resolve(t)}}class Lo{constructor(t){this._count=t,this._waitQueue=new Ro}get count(){return this._count}get waiting(){return this._waitQueue.length}async enter(){return this._count!==0?(this._count--,Promise.resolve()):this._waitQueue.enqueue()}exit(t=1){if(t!==0){for(;t!==0&&this._waitQueue.length!==0;)this._waitQueue.dequeue(null),t--;this._count+=t}}}const Uo="0.27.0";Z()})();var ga=U.fWn,fa=U.Ia8,_a=U.rqv,ma=U.hLI,va=U.yyv,wa=U.tX5,Ei=U.vtX,ba=U.r7K,Ca=U.lCh,ya=U.cE4,Oe=U.fwF,xa=U.sce,po=U._c7,Ia=U.KUs,Ea=U.Ajp,Ba=U.RDh,Sa=U._H9,ka=U.mxs,Pa=U.OmD,zo=U.kBf,Qa=U.C4F,Da=U.NQt,Ta=U.JjN,Fa=U.V1s,Ma=U.Xz7,Ra=U.Cdc,La=U.FKn,Na=U.wTW,Ga=U.SUY,za=U.ab2,Va=U.GfZ,Oa=U.YMS,Ha=U.oyv,Ua=U.aUb,ja=U.SdD,na=U.JUv,Vo=U.jEj,Xa=U.TFq,qa=U.HDU,Wa=U.R_y,Ya=U.ydN,Ka=U.t50,Ja=U.s$$,ls=U.v2G,Ii=U.Ilk,Za=U.s9i,$a=U.dxL,tl=U.LLX,el=U.wA2,il=U.R_p,sl=U.IQ$,nl=U.I5F,rl=U.X8$,ol=U.FR6,al=U.U8o,ll=U.kbG,hl=U.iS_,cl=U.cGG,dl=U.RPN,Al=U.skb,ul=U.SLU,pl=U.RdJ,gl=U.cNu,fl=U.gU7,_l=U.LSk,ml=U.Nmp,ra=U.d1Y,vl=U.xrL,wl=U.sRW,bl=U.cmV,Cl=U.qWz,yl=U.N0Q,xl=U.q8b,Il=U.ynB,El=U.jT9,Bl=U.wAz,oa=U.D4V,Sl=U.N6H,kl=U.W1A,Pl=U.JHW,Ql=U.v2K,Dl=U.pBf,Sr=U.GMl,Tl=U.zW2,Fl=U.B0K,Ml=U.Nv7,Rl=U.C_p,Ll=U.iqw,Nl=U.MUA,Gl=U.xqU,zl=U.pTp,Vl=U.vUK,Ol=U.j9l,ks=U.Zxw,Hl=U.Hdx,Ul=U.Z$d,jl=U.iqV,Xl=U.o$7,ql=U.olM,Wl=U.Zm$,Yl=U.$QH,Kl=U.i78,Jl=U.h6u,Zl=U.hts,$l=U.j88,th=U.VME,eh=U.nt,ih=U.Ukr,sh=U.zsu,nh=U.oA6,aa=U.TVh,rh=U.TwZ,oh=U.GTT,ah=U.xxj,lh=U.XdK,hh=U.Jmb,Jt=U.cXo,ch=U.Dm5,Ot=U.IIB,dh=U.zI0,Ah=U.LYD,uh=U.cEG,ph=U.SEl,gh=U.t9V,fh=U.SKZ,Un=U.__J,_h=U.RI$,mh=U.x12,vh=U.ccz,la=U.aNw,wh=U.xwn,bh=U.dNK,Ch=U.ini,yh=U.YdH,xh=U.y3G,Ih=U.l57,Eh=U.xn0,Bh=U.t2V,Sh=U.uxB,kh=U.cpd,Ph=U.fiy,Qh=U.$XZ,Dh=U.uqK,Th=U.STE,Fh=U.y$z,Mh=U.mAD,Rh=U.sOq,ha=U.hUw,Lh=U._0G,Nh=U.Sqs,Gh=U.hpZ,zh=U.Vol,ca=U.wIZ,Vh=U.cBi,Oh=U.RFv,Hh=U.kfC,Uh=U.mgq,jh=U.YVA,Xh=U.Kgp,qh=U.HH$,Wh=U.M_d,Yh=U.rgh,Kh=U.Ra6,Jh=U.KhR,Zh=U.BS5,$h=U.xhz,tc=U.xOq,ec=U.a9j,ic=U.bHk,sc=U.CgK,nc=U.cuY,rc=U.kvE,oc=U.SBu,ac=U.AE_,lc=U.ctO,hc=U.OLH,cc=U.kky,dc=U.nSF,Ac=U.zHn,uc=U.zwx,pc=U.AeJ,gc=U.hLz,fc=U.D9g,_c=U.wA,mc=U.jhr,vc=U.GVs,wc=U._zO,bc=U.w6$,Cc=U.mhV,yc=U.MOD,xc=U.kwd,Ic=U.Lmr,kr=U.xsS,Ec=U.lLr,Bc=U.Z$r,jn=U.IXb,Sc=U.SGH,kc=U.SMj,Pc=U.L34,Qc=U.exe,Ce=U.bnF,Dc=U.MFA,ue=U.$uU,Tc=U.jyi,Fc=U.E03,ge=U.V6q,Mc=U.rg2,Rc=U.DVW,Lc=U.nVo,Nc=U.F6N,Gc=U.xP7,zc=U.Odq,Vc=U.Zif,Oc=U.ZGJ,Hc=U.MJk,Ho=U.xvT,Uc=U.PHM,jc=U.dpR,Xc=U.n9L,qc=U.KwO,Wc=U.B7y,Yc=U.x7r,Kc=U.wx7,Jc=U.Uvn,Zc=U.OFT,$c=U.xzN,td=U.M5Z,ed=U.ZrN,St=U.OWs,id=U.dF9,sd=U.oZy,nd=U.rD2,rd=U.VHo,od=U.ohE,ad=U.R$E,ld=U.q3I,hd=U.Pab,cd=U.uZ5,dd=U.McK,Ad=U.F9c,ud=U.k0b,pd=U.hnT,gd=U.RSJ,fd=U.Mku,_d=U.h90,md=U.rms,vd=U.ErP,wd=U.aVg,bd=U.lPc,Cd=U.Z8E,yd=U._N2,xd=U.yFn,Id=U.lNv,Ed=U.cu9,Bd=U.MZQ,Sd=U.FUM,kd=U.BxR,Pd=U.vdf,Ss=U.iaL,He=U.w6H,Qd=U.Q4c,Dd=U.Xxe,Td=U.Uxb,Fd=U.Yr5,Rt=U.Bhw,Md=U.yOA;const Rd=Object.freeze(Object.defineProperty({__proto__:null,ActionContext:ga,ActionQueue:fa,ActionSequence:_a,ActionsComponent:ma,ActionsSystem:va,ActivateEvent:wa,Actor:Ei,AddedComponent:ba,AddedEntity:Ca,AffineMatrix:ya,Animation:Oe,AnimationDirection:xa,AnimationStrategy:po,ArcadeSolver:Ia,AudioContextFactory:Ea,Axis:Ba,BaseAlign:Sa,Blink:ka,BodyComponent:Pa,BoundingBox:zo,BroadphaseStrategy:Qa,BrowserComponent:Da,BrowserEvents:Ta,Camera:Fa,Canvas:Ma,Circle:Ra,CircleCollider:La,Class:Na,Clock:Ga,ClosestLine:za,ClosestLineJumpTable:Va,Collider:Oa,ColliderComponent:Ha,CollisionContact:Ua,CollisionEndEvent:ja,CollisionGroup:na,CollisionGroupManager:Vo,CollisionJumpTable:Xa,CollisionPostSolveEvent:qa,CollisionPreSolveEvent:Wa,CollisionResolutionStrategy:Ya,CollisionStartEvent:Ka,CollisionSystem:Ja,CollisionType:ls,Color:Ii,ColorBlindFlags:Za,ColorBlindnessMode:$a,ColorBlindnessPostProcessor:tl,Component:el,CompositeCollider:il,Configurable:sl,ConsoleAppender:nl,ContactConstraintPoint:rl,ContactEndEvent:ol,ContactStartEvent:al,CoordPlane:ll,DeactivateEvent:hl,Debug:cl,DebugGraphicsComponent:dl,DebugSystem:Al,DebugText:ul,DegreeOfFreedom:pl,Delay:gl,Detector:fl,Die:_l,Direction:ml,DisplayMode:ra,DynamicTree:vl,DynamicTreeCollisionProcessor:wl,EX_VERSION:bl,EaseBy:Cl,EaseTo:yl,EasingFunctions:xl,EdgeCollider:Il,ElasticToActorStrategy:El,EmitterType:Bl,Engine:oa,EnterTriggerEvent:Sl,EnterViewPortEvent:kl,Entity:Pl,EntityManager:Ql,EventDispatcher:Dl,EventTypes:Sr,Events:Tl,ExResponse:Fl,ExcaliburGraphicsContext2DCanvas:Ml,ExcaliburGraphicsContextWebGL:Rl,ExcaliburWebGLContextAccessor:Ll,ExitTriggerEvent:Nl,ExitViewPortEvent:Gl,Fade:zl,Flags:Vl,Follow:Ol,Font:ks,FontStyle:Hl,FontUnit:Ul,FpsSampler:jl,FrameStats:Xl,Future:ql,GameEvent:Wl,GameStartEvent:Yl,GameStopEvent:Kl,GamepadAxisEvent:Jl,GamepadButtonEvent:Zl,GamepadConnectEvent:$l,GamepadDisconnectEvent:th,Gif:eh,GlobalCoordinates:ih,Graphic:sh,GraphicsComponent:nh,GraphicsGroup:aa,GraphicsLayer:rh,GraphicsLayers:oh,GraphicsSystem:ah,HiddenEvent:lh,ImageFiltering:hh,ImageSource:Jt,InitializeEvent:ch,Input:Ot,Integrator:dh,IsometricEntityComponent:Ah,IsometricEntitySystem:uh,IsometricMap:ph,IsometricTile:gh,KillEvent:fh,Label:Un,LimitCameraBoundsStrategy:_h,Line:mh,LineSegment:vh,Loader:la,LockCameraToActorAxisStrategy:wh,LockCameraToActorStrategy:bh,LogLevel:Ch,Logger:yh,Matrix:xh,MatrixLocations:Ih,MediaEvent:Eh,Meet:Bh,MotionComponent:Sh,MotionSystem:kh,MoveBy:Ph,MoveTo:Qh,NativeSoundEvent:Dh,NativeSoundProcessedEvent:Th,Observable:Fh,OffscreenSystem:Mh,Pair:Rh,ParallaxComponent:ha,ParallelActions:Lh,ParseGif:Nh,Particle:Gh,ParticleEmitter:zh,Physics:ca,PhysicsStats:Vh,PointerComponent:Oh,PointerSystem:Hh,Polygon:Uh,PolygonCollider:jh,Pool:Xh,PostCollisionEvent:qh,PostDebugDrawEvent:Wh,PostDrawEvent:Yh,PostFrameEvent:Kh,PostKillEvent:Jh,PostUpdateEvent:Zh,PreCollisionEvent:$h,PreDebugDrawEvent:tc,PreDrawEvent:ec,PreFrameEvent:ic,PreKillEvent:sc,PreUpdateEvent:nc,Projection:rc,QuadIndexBuffer:oc,Query:ac,QueryManager:lc,RadiusAroundActorStrategy:hc,Random:cc,Raster:dc,Ray:Ac,RealisticSolver:uc,Rectangle:pc,RemovedComponent:gc,RemovedEntity:fc,Repeat:_c,RepeatForever:mc,Resolution:vc,Resource:wc,RotateBy:bc,RotateTo:Cc,RotationType:yc,ScaleBy:xc,ScaleTo:Ic,Scene:kr,Screen:Ec,ScreenAppender:Bc,ScreenElement:jn,ScreenShader:Sc,ScrollPreventionMode:kc,Semaphore:Pc,Shader:Qc,Shape:Ce,Side:Dc,Sound:ue,Sprite:Tc,SpriteFont:Fc,SpriteSheet:ge,StandardClock:Mc,StateMachine:Rc,StrategyContainer:Lc,Stream:Nc,System:Gc,SystemManager:zc,SystemType:Vc,TagComponent:Oc,TestClock:Hc,Text:Ho,TextAlign:Uc,TextureLoader:jc,Tile:Xc,TileMap:qc,Timer:Wc,Toaster:Yc,Transform:Kc,TransformComponent:Jc,TreeNode:Zc,Trigger:$c,TwoPI:td,Util:ed,Vector:St,VectorView:id,VertexBuffer:sd,VertexLayout:nd,VisibleEvent:rd,WebAudio:od,WebAudioInstance:ad,World:ld,canonicalizeAngle:hd,clamp:cd,createId:dd,frac:Ad,hasGraphicsTick:ud,hasOnInitialize:pd,hasOnPostUpdate:gd,hasOnPreUpdate:fd,hasPostDraw:_d,hasPreDraw:md,has_initialize:vd,has_postupdate:wd,has_preupdate:bd,isAddedComponent:Cd,isAddedSystemEntity:yd,isRemoveSystemEntity:xd,isRemovedComponent:Id,isScreenElement:Ed,maxMessages:Bd,obsolete:Sd,pixelSnapEpsilon:kd,randomInRange:Pd,randomIntInRange:Ss,range:He,resetObsoleteCounter:Qd,sign:Dd,toDegrees:Td,toRadians:Fd,vec:Rt,webgl:Md},Symbol.toStringTag,{value:"Module"}));function Ld($){if($.__esModule)return $;var it=$.default;if(typeof it=="function"){var g=function F(){if(this instanceof F){var W=[null];W.push.apply(W,arguments);var Z=Function.bind.apply(it,W);return new Z}return it.apply(this,arguments)};g.prototype=it.prototype}else g={};return Object.defineProperty(g,"__esModule",{value:!0}),Object.keys($).forEach(function(F){var W=Object.getOwnPropertyDescriptor($,F);Object.defineProperty(g,F,W.get?W:{enumerable:!0,get:function(){return $[F]}})}),g}var Oo={},Nd={get exports(){return Oo},set exports($){Oo=$}};const da=Ld(Rd);/*! For license information please see excalibur-tiled.min.js.LICENSE.txt */(function($,it){(function(g,F){$.exports=F(da)})(self,g=>(()=>{var F={"./node_modules/fast-xml-parser/src/json2xml.js":(q,E,T)=>{const D=T("./node_modules/fast-xml-parser/src/util.js").buildOptions,S={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataTagName:!1,cdataPositionChar:"\\c",format:!1,indentBy:"  ",supressEmptyNode:!1,tagValueProcessor:function(v){return v},attrValueProcessor:function(v){return v}},K=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","cdataTagName","cdataPositionChar","format","indentBy","supressEmptyNode","tagValueProcessor","attrValueProcessor","rootNodeName"];function w(v){this.options=D(v,S,K),this.options.ignoreAttributes||this.options.attrNodeName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=m),this.options.cdataTagName?this.isCDATA=C:this.isCDATA=function(){return!1},this.replaceCDATAstr=P,this.replaceCDATAarr=V,this.processTextOrObjNode=y,this.options.format?(this.indentate=p,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine=""),this.options.supressEmptyNode?(this.buildTextNode=X,this.buildObjNode=O):(this.buildTextNode=z,this.buildObjNode=R),this.buildTextValNode=z,this.buildObjectNode=R}function y(v,H,Y){const I=this.j2x(v,Y+1);return v[this.options.textNodeName]!==void 0&&Object.keys(v).length===1?this.buildTextNode(I.val,H,I.attrStr,Y):this.buildObjNode(I.val,H,I.attrStr,Y)}function P(v,H){return v=this.options.tagValueProcessor(""+v),this.options.cdataPositionChar===""||v===""?v+"<![CDATA["+H+"]]"+this.tagEndChar:v.replace(this.options.cdataPositionChar,"<![CDATA["+H+"]]"+this.tagEndChar)}function V(v,H){if(v=this.options.tagValueProcessor(""+v),this.options.cdataPositionChar===""||v==="")return v+"<![CDATA["+H.join("]]><![CDATA[")+"]]"+this.tagEndChar;for(let Y in H)v=v.replace(this.options.cdataPositionChar,"<![CDATA["+H[Y]+"]]>");return v+this.newLine}function R(v,H,Y,I){return Y&&v.indexOf("<")===-1?this.indentate(I)+"<"+H+Y+">"+v+"</"+H+this.tagEndChar:this.indentate(I)+"<"+H+Y+this.tagEndChar+v+this.indentate(I)+"</"+H+this.tagEndChar}function O(v,H,Y,I){return v!==""?this.buildObjectNode(v,H,Y,I):this.indentate(I)+"<"+H+Y+"/"+this.tagEndChar}function z(v,H,Y,I){return this.indentate(I)+"<"+H+Y+">"+this.options.tagValueProcessor(v)+"</"+H+this.tagEndChar}function X(v,H,Y,I){return v!==""?this.buildTextValNode(v,H,Y,I):this.indentate(I)+"<"+H+Y+"/"+this.tagEndChar}function p(v){return this.options.indentBy.repeat(v)}function m(v){return!!v.startsWith(this.options.attributeNamePrefix)&&v.substr(this.attrPrefixLen)}function C(v){return v===this.options.cdataTagName}w.prototype.parse=function(v){return Array.isArray(v)&&this.options.rootNodeName&&this.options.rootNodeName.length>1&&(v={[this.options.rootNodeName]:v}),this.j2x(v,0).val},w.prototype.j2x=function(v,H){let Y="",I="";for(let k in v)if(v[k]!==void 0)if(v[k]===null)I+=this.indentate(H)+"<"+k+"/"+this.tagEndChar;else if(v[k]instanceof Date)I+=this.buildTextNode(v[k],k,"",H);else if(typeof v[k]!="object"){const b=this.isAttribute(k);b?Y+=" "+b+'="'+this.options.attrValueProcessor(""+v[k])+'"':this.isCDATA(k)?v[this.options.textNodeName]?I+=this.replaceCDATAstr(v[this.options.textNodeName],v[k]):I+=this.replaceCDATAstr("",v[k]):k===this.options.textNodeName?v[this.options.cdataTagName]||(I+=this.options.tagValueProcessor(""+v[k])):I+=this.buildTextNode(v[k],k,"",H)}else if(Array.isArray(v[k]))if(this.isCDATA(k))I+=this.indentate(H),v[this.options.textNodeName]?I+=this.replaceCDATAarr(v[this.options.textNodeName],v[k]):I+=this.replaceCDATAarr("",v[k]);else{const b=v[k].length;for(let N=0;N<b;N++){const _=v[k][N];_===void 0||(I+=_===null?this.indentate(H)+"<"+k+"/"+this.tagEndChar:typeof _=="object"?this.processTextOrObjNode(_,k,H):this.buildTextNode(_,k,"",H))}}else if(this.options.attrNodeName&&k===this.options.attrNodeName){const b=Object.keys(v[k]),N=b.length;for(let _=0;_<N;_++)Y+=" "+b[_]+'="'+this.options.attrValueProcessor(""+v[k][b[_]])+'"'}else I+=this.processTextOrObjNode(v[k],k,H);return{attrStr:Y,val:I}},q.exports=w},"./node_modules/fast-xml-parser/src/nimndata.js":(q,E,T)=>{const D=function(z){return String.fromCharCode(z)},S={nilChar:D(176),missingChar:D(201),nilPremitive:D(175),missingPremitive:D(200),emptyChar:D(178),emptyValue:D(177),boundryChar:D(179),objStart:D(198),arrStart:D(204),arrayEnd:D(185)},K=[S.nilChar,S.nilPremitive,S.missingChar,S.missingPremitive,S.boundryChar,S.emptyChar,S.emptyValue,S.arrayEnd,S.objStart,S.arrStart],w=function(z,X,p){if(typeof X=="string")return z&&z[0]&&z[0].val!==void 0?y(z[0].val):y(z);{const C=(m=z)===void 0?S.missingChar:m===null?S.nilChar:!(m.child&&Object.keys(m.child).length===0&&(!m.attrsMap||Object.keys(m.attrsMap).length===0))||S.emptyChar;if(C===!0){let v="";if(Array.isArray(X)){v+=S.arrStart;const H=X[0],Y=z.length;if(typeof H=="string")for(let I=0;I<Y;I++){const k=y(z[I].val);v=P(v,k)}else for(let I=0;I<Y;I++){const k=w(z[I],H,p);v=P(v,k)}v+=S.arrayEnd}else{v+=S.objStart;const H=Object.keys(X);Array.isArray(z)&&(z=z[0]);for(let Y in H){const I=H[Y];let k;k=!p.ignoreAttributes&&z.attrsMap&&z.attrsMap[I]?w(z.attrsMap[I],X[I],p):I===p.textNodeName?w(z.val,X[I],p):w(z.child[I],X[I],p),v=P(v,k)}}return v}return C}var m},y=function(z){switch(z){case void 0:return S.missingPremitive;case null:return S.nilPremitive;case"":return S.emptyValue;default:return z}},P=function(z,X){return V(X[0])||V(z[z.length-1])||(z+=S.boundryChar),z+X},V=function(z){return K.indexOf(z)!==-1},R=T("./node_modules/fast-xml-parser/src/xmlstr2xmlnode.js"),O=T("./node_modules/fast-xml-parser/src/util.js").buildOptions;E.convert2nimn=function(z,X,p){return p=O(p,R.defaultOptions,R.props),w(z,X,p)}},"./node_modules/fast-xml-parser/src/node2json.js":(q,E,T)=>{const D=T("./node_modules/fast-xml-parser/src/util.js"),S=function(K,w,y){const P={};if(!w.alwaysCreateTextNode&&(!K.child||D.isEmptyObject(K.child))&&(!K.attrsMap||D.isEmptyObject(K.attrsMap)))return D.isExist(K.val)?K.val:"";if(D.isExist(K.val)&&(typeof K.val!="string"||K.val!==""&&K.val!==w.cdataPositionChar)){const R=D.isTagNameInArrayMode(K.tagname,w.arrayMode,y);P[w.textNodeName]=R?[K.val]:K.val}D.merge(P,K.attrsMap,w.arrayMode);const V=Object.keys(K.child);for(let R=0;R<V.length;R++){const O=V[R];if(K.child[O]&&K.child[O].length>1){P[O]=[];for(let z in K.child[O])K.child[O].hasOwnProperty(z)&&P[O].push(S(K.child[O][z],w,O))}else{const z=S(K.child[O][0],w,O),X=w.arrayMode===!0&&typeof z=="object"||D.isTagNameInArrayMode(O,w.arrayMode,y);P[O]=X?[z]:z}}return P};E.convertToJson=S},"./node_modules/fast-xml-parser/src/node2json_str.js":(q,E,T)=>{const D=T("./node_modules/fast-xml-parser/src/util.js"),S=T("./node_modules/fast-xml-parser/src/util.js").buildOptions,K=T("./node_modules/fast-xml-parser/src/xmlstr2xmlnode.js"),w=function(y,P,V){let R="{";const O=Object.keys(y.child);for(let X=0;X<O.length;X++){const p=O[X];if(y.child[p]&&y.child[p].length>1){R+='"'+p+'" : [ ';for(let m in y.child[p])R+=w(y.child[p][m],P)+" , ";R=R.substr(0,R.length-1)+" ] "}else R+='"'+p+'" : '+w(y.child[p][0],P)+" ,"}return D.merge(R,y.attrsMap),D.isEmptyObject(R)?D.isExist(y.val)?y.val:"":(D.isExist(y.val)&&(typeof y.val!="string"||y.val!==""&&y.val!==P.cdataPositionChar)&&(R+='"'+P.textNodeName+'" : '+((z=y.val)!==!0&&z!==!1&&isNaN(z)?'"'+z+'"':z)),R[R.length-1]===","&&(R=R.substr(0,R.length-2)),R+"}");var z};E.convertToJsonString=function(y,P){return(P=S(P,K.defaultOptions,K.props)).indentBy=P.indentBy||"",w(y,P)}},"./node_modules/fast-xml-parser/src/parser.js":(q,E,T)=>{const D=T("./node_modules/fast-xml-parser/src/node2json.js"),S=T("./node_modules/fast-xml-parser/src/xmlstr2xmlnode.js"),K=T("./node_modules/fast-xml-parser/src/xmlstr2xmlnode.js"),w=T("./node_modules/fast-xml-parser/src/util.js").buildOptions,y=T("./node_modules/fast-xml-parser/src/validator.js");E.parse=function(P,V={},R){if(R){R===!0&&(R={});const X=y.validate(P,R);if(X!==!0)throw Error(X.err.msg)}V.parseTrueNumberOnly&&V.parseNodeValue!==!1&&!V.numParseOptions&&(V.numParseOptions={leadingZeros:!1});let O=w(V,K.defaultOptions,K.props);const z=S.getTraversalObj(P,O);return D.convertToJson(z,O)},E.convertTonimn=T("./node_modules/fast-xml-parser/src/nimndata.js").convert2nimn,E.getTraversalObj=S.getTraversalObj,E.convertToJson=D.convertToJson,E.convertToJsonString=T("./node_modules/fast-xml-parser/src/node2json_str.js").convertToJsonString,E.validate=y.validate,E.j2xParser=T("./node_modules/fast-xml-parser/src/json2xml.js"),E.parseToNimn=function(P,V,R){return E.convertTonimn(E.getTraversalObj(P,R),V,R)}},"./node_modules/fast-xml-parser/src/util.js":(q,E)=>{const T="[:A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*",D=new RegExp("^"+T+"$");E.isExist=function(S){return S!==void 0},E.isEmptyObject=function(S){return Object.keys(S).length===0},E.merge=function(S,K,w){if(K){const y=Object.keys(K),P=y.length;for(let V=0;V<P;V++)S[y[V]]=w==="strict"?[K[y[V]]]:K[y[V]]}},E.getValue=function(S){return E.isExist(S)?S:""},E.buildOptions=function(S,K,w){let y={};if(!S)return K;for(let P=0;P<w.length;P++)S[w[P]]!==void 0?y[w[P]]=S[w[P]]:y[w[P]]=K[w[P]];return y},E.isTagNameInArrayMode=function(S,K,w){return K!==!1&&(K instanceof RegExp?K.test(S):typeof K=="function"?!!K(S,w):K==="strict")},E.isName=function(S){return D.exec(S)!=null},E.getAllMatches=function(S,K){const w=[];let y=K.exec(S);for(;y;){const P=[];P.startIndex=K.lastIndex-y[0].length;const V=y.length;for(let R=0;R<V;R++)P.push(y[R]);w.push(P),y=K.exec(S)}return w},E.nameRegexp=T},"./node_modules/fast-xml-parser/src/validator.js":(q,E,T)=>{const D=T("./node_modules/fast-xml-parser/src/util.js"),S={allowBooleanAttributes:!1},K=["allowBooleanAttributes"];function w(C,v){const H=v;for(;v<C.length;v++)if(!(C[v]!="?"&&C[v]!=" ")){const Y=C.substr(H,v-H);if(v>5&&Y==="xml")return z("InvalidXml","XML declaration allowed only at the start of the document.",p(C,v));if(C[v]=="?"&&C[v+1]==">"){v++;break}}return v}function y(C,v){if(C.length>v+5&&C[v+1]==="-"&&C[v+2]==="-"){for(v+=3;v<C.length;v++)if(C[v]==="-"&&C[v+1]==="-"&&C[v+2]===">"){v+=2;break}}else if(C.length>v+8&&C[v+1]==="D"&&C[v+2]==="O"&&C[v+3]==="C"&&C[v+4]==="T"&&C[v+5]==="Y"&&C[v+6]==="P"&&C[v+7]==="E"){let H=1;for(v+=8;v<C.length;v++)if(C[v]==="<")H++;else if(C[v]===">"&&(H--,H===0))break}else if(C.length>v+9&&C[v+1]==="["&&C[v+2]==="C"&&C[v+3]==="D"&&C[v+4]==="A"&&C[v+5]==="T"&&C[v+6]==="A"&&C[v+7]==="["){for(v+=8;v<C.length;v++)if(C[v]==="]"&&C[v+1]==="]"&&C[v+2]===">"){v+=2;break}}return v}function P(C,v){let H="",Y="",I=!1;for(;v<C.length;v++){if(C[v]==='"'||C[v]==="'")Y===""?Y=C[v]:Y!==C[v]||(Y="");else if(C[v]===">"&&Y===""){I=!0;break}H+=C[v]}return Y===""&&{value:H,index:v,tagClosed:I}}E.validate=function(C,v){v=D.buildOptions(v,S,K);const H=[];let Y=!1,I=!1;C[0]==="\uFEFF"&&(C=C.substr(1));for(let b=0;b<C.length;b++)if(C[b]==="<"&&C[b+1]==="?"){if(b+=2,b=w(C,b),b.err)return b}else{if(C[b]!=="<"){if(C[b]===" "||C[b]==="	"||C[b]===`
`||C[b]==="\r")continue;return z("InvalidChar","char '"+C[b]+"' is not expected.",p(C,b))}{let N=b;if(b++,C[b]==="!"){b=y(C,b);continue}{let _=!1;C[b]==="/"&&(_=!0,b++);let ct="";for(;b<C.length&&C[b]!==">"&&C[b]!==" "&&C[b]!=="	"&&C[b]!==`
`&&C[b]!=="\r";b++)ct+=C[b];if(ct=ct.trim(),ct[ct.length-1]==="/"&&(ct=ct.substring(0,ct.length-1),b--),k=ct,!D.isName(k)){let Et;return Et=ct.trim().length===0?"Invalid space after '<'.":"Tag '"+ct+"' is an invalid name.",z("InvalidTag",Et,p(C,b))}const gt=P(C,b);if(gt===!1)return z("InvalidAttr","Attributes for '"+ct+"' have open quote.",p(C,b));let ot=gt.value;if(b=gt.index,ot[ot.length-1]==="/"){const Et=b-ot.length;ot=ot.substring(0,ot.length-1);const at=R(ot,v);if(at!==!0)return z(at.err.code,at.err.msg,p(C,Et+at.err.line));Y=!0}else if(_){if(!gt.tagClosed)return z("InvalidTag","Closing tag '"+ct+"' doesn't have proper closing.",p(C,b));if(ot.trim().length>0)return z("InvalidTag","Closing tag '"+ct+"' can't have attributes or invalid starting.",p(C,N));{const Et=H.pop();if(ct!==Et.tagName){let at=p(C,Et.tagStartPos);return z("InvalidTag","Expected closing tag '"+Et.tagName+"' (opened in line "+at.line+", col "+at.col+") instead of closing tag '"+ct+"'.",p(C,N))}H.length==0&&(I=!0)}}else{const Et=R(ot,v);if(Et!==!0)return z(Et.err.code,Et.err.msg,p(C,b-ot.length+Et.err.line));if(I===!0)return z("InvalidXml","Multiple possible root nodes found.",p(C,b));H.push({tagName:ct,tagStartPos:N}),Y=!0}for(b++;b<C.length;b++)if(C[b]==="<"){if(C[b+1]==="!"){b++,b=y(C,b);continue}if(C[b+1]!=="?")break;if(b=w(C,++b),b.err)return b}else if(C[b]==="&"){const Et=O(C,b);if(Et==-1)return z("InvalidChar","char '&' is not expected.",p(C,b));b=Et}C[b]==="<"&&b--}}}var k;return Y?H.length==1?z("InvalidTag","Unclosed tag '"+H[0].tagName+"'.",p(C,H[0].tagStartPos)):!(H.length>0)||z("InvalidXml","Invalid '"+JSON.stringify(H.map(b=>b.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):z("InvalidXml","Start tag expected.",1)};const V=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function R(C,v){const H=D.getAllMatches(C,V),Y={};for(let I=0;I<H.length;I++){if(H[I][1].length===0)return z("InvalidAttr","Attribute '"+H[I][2]+"' has no space in starting.",m(H[I]));if(H[I][3]===void 0&&!v.allowBooleanAttributes)return z("InvalidAttr","boolean attribute '"+H[I][2]+"' is not allowed.",m(H[I]));const k=H[I][2];if(!X(k))return z("InvalidAttr","Attribute '"+k+"' is an invalid name.",m(H[I]));if(Y.hasOwnProperty(k))return z("InvalidAttr","Attribute '"+k+"' is repeated.",m(H[I]));Y[k]=1}return!0}function O(C,v){if(C[++v]===";")return-1;if(C[v]==="#")return function(Y,I){let k=/\d/;for(Y[I]==="x"&&(I++,k=/[\da-fA-F]/);I<Y.length;I++){if(Y[I]===";")return I;if(!Y[I].match(k))break}return-1}(C,++v);let H=0;for(;v<C.length;v++,H++)if(!(C[v].match(/\w/)&&H<20)){if(C[v]===";")break;return-1}return v}function z(C,v,H){return{err:{code:C,msg:v,line:H.line||H,col:H.col}}}function X(C){return D.isName(C)}function p(C,v){const H=C.substring(0,v).split(/\r?\n/);return{line:H.length,col:H[H.length-1].length+1}}function m(C){return C.startIndex+C[1].length}},"./node_modules/fast-xml-parser/src/xmlNode.js":q=>{q.exports=function(E,T,D){this.tagname=E,this.parent=T,this.child={},this.attrsMap={},this.val=D,this.addChild=function(S){Array.isArray(this.child[S.tagname])?this.child[S.tagname].push(S):this.child[S.tagname]=[S]}}},"./node_modules/fast-xml-parser/src/xmlstr2xmlnode.js":(q,E,T)=>{const D=T("./node_modules/fast-xml-parser/src/util.js"),S=T("./node_modules/fast-xml-parser/src/util.js").buildOptions,K=T("./node_modules/fast-xml-parser/src/xmlNode.js"),w=T("./node_modules/strnum/strnum.js");"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,D.nameRegexp),!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const y={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,ignoreNameSpace:!1,allowBooleanAttributes:!1,parseNodeValue:!0,parseAttributeValue:!1,arrayMode:!1,trimValues:!0,cdataTagName:!1,cdataPositionChar:"\\c",numParseOptions:{hex:!0,leadingZeros:!0},tagValueProcessor:function(C,v){return C},attrValueProcessor:function(C,v){return C},stopNodes:[],alwaysCreateTextNode:!1};E.defaultOptions=y;const P=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","ignoreNameSpace","allowBooleanAttributes","parseNodeValue","parseAttributeValue","arrayMode","trimValues","cdataTagName","cdataPositionChar","tagValueProcessor","attrValueProcessor","parseTrueNumberOnly","numParseOptions","stopNodes","alwaysCreateTextNode"];function V(C,v,H){return v&&(H.trimValues&&(v=v.trim()),v=O(v=H.tagValueProcessor(v,C),H.parseNodeValue,H.numParseOptions)),v}function R(C,v){if(v.ignoreNameSpace){const H=C.split(":"),Y=C.charAt(0)==="/"?"/":"";if(H[0]==="xmlns")return"";H.length===2&&(C=Y+H[1])}return C}function O(C,v,H){if(v&&typeof C=="string"){const Y=C.trim();return Y==="true"||Y!=="false"&&w(C,H)}return D.isExist(C)?C:""}E.props=P;const z=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])(.*?)\\3)?`,"g");function X(C,v){if(!v.ignoreAttributes&&typeof C=="string"){C=C.replace(/\r?\n/g," ");const H=D.getAllMatches(C,z),Y=H.length,I={};for(let k=0;k<Y;k++){const b=R(H[k][1],v);b.length&&(H[k][4]!==void 0?(v.trimValues&&(H[k][4]=H[k][4].trim()),H[k][4]=v.attrValueProcessor(H[k][4],b),I[v.attributeNamePrefix+b]=O(H[k][4],v.parseAttributeValue,v.numParseOptions)):v.allowBooleanAttributes&&(I[v.attributeNamePrefix+b]=!0))}if(!Object.keys(I).length)return;if(v.attrNodeName){const k={};return k[v.attrNodeName]=I,k}return I}}function p(C,v){let H,Y="";for(let I=v;I<C.length;I++){let k=C[I];if(H)k===H&&(H="");else if(k==='"'||k==="'")H=k;else{if(k===">")return{data:Y,index:I};k==="	"&&(k=" ")}Y+=k}}function m(C,v,H,Y){const I=C.indexOf(v,H);if(I===-1)throw new Error(Y);return I+v.length-1}E.getTraversalObj=function(C,v){C=C.replace(/\r\n?/g,`
`),v=S(v,y,P);const H=new K("!xml");let Y=H,I="";for(let k=0;k<C.length;k++)if(C[k]==="<")if(C[k+1]==="/"){const b=m(C,">",k,"Closing Tag is not closed.");let N=C.substring(k+2,b).trim();if(v.ignoreNameSpace){const _=N.indexOf(":");_!==-1&&(N=N.substr(_+1))}Y&&(Y.val?Y.val=D.getValue(Y.val)+""+V(N,I,v):Y.val=V(N,I,v)),v.stopNodes.length&&v.stopNodes.includes(Y.tagname)&&(Y.child=[],Y.attrsMap==null&&(Y.attrsMap={}),Y.val=C.substr(Y.startIndex+1,k-Y.startIndex-1)),Y=Y.parent,I="",k=b}else if(C[k+1]==="?")k=m(C,"?>",k,"Pi Tag is not closed.");else if(C.substr(k+1,3)==="!--")k=m(C,"-->",k,"Comment is not closed.");else if(C.substr(k+1,2)==="!D"){const b=m(C,">",k,"DOCTYPE is not closed.");k=C.substring(k,b).indexOf("[")>=0?C.indexOf("]>",k)+1:b}else if(C.substr(k+1,2)==="!["){const b=m(C,"]]>",k,"CDATA is not closed.")-2,N=C.substring(k+9,b);if(I&&(Y.val=D.getValue(Y.val)+""+V(Y.tagname,I,v),I=""),v.cdataTagName){const _=new K(v.cdataTagName,Y,N);Y.addChild(_),Y.val=D.getValue(Y.val)+v.cdataPositionChar,N&&(_.val=N)}else Y.val=(Y.val||"")+(N||"");k=b+2}else{const b=p(C,k+1);let N=b.data;const _=b.index,ct=N.indexOf(" ");let gt=N,ot=!0;if(ct!==-1&&(gt=N.substr(0,ct).replace(/\s\s*$/,""),N=N.substr(ct+1)),v.ignoreNameSpace){const Et=gt.indexOf(":");Et!==-1&&(gt=gt.substr(Et+1),ot=gt!==b.data.substr(Et+1))}if(Y&&I&&Y.tagname!=="!xml"&&(Y.val=D.getValue(Y.val)+""+V(Y.tagname,I,v)),N.length>0&&N.lastIndexOf("/")===N.length-1){gt[gt.length-1]==="/"?(gt=gt.substr(0,gt.length-1),N=gt):N=N.substr(0,N.length-1);const Et=new K(gt,Y,"");gt!==N&&(Et.attrsMap=X(N,v)),Y.addChild(Et)}else{const Et=new K(gt,Y);v.stopNodes.length&&v.stopNodes.includes(Et.tagname)&&(Et.startIndex=_),gt!==N&&ot&&(Et.attrsMap=X(N,v)),Y.addChild(Et),Y=Et}I="",k=_}else I+=C[k];return H}},"./node_modules/pako/index.js":(q,E,T)=>{var D={};(0,T("./node_modules/pako/lib/utils/common.js").assign)(D,T("./node_modules/pako/lib/deflate.js"),T("./node_modules/pako/lib/inflate.js"),T("./node_modules/pako/lib/zlib/constants.js")),q.exports=D},"./node_modules/pako/lib/deflate.js":(q,E,T)=>{var D=T("./node_modules/pako/lib/zlib/deflate.js"),S=T("./node_modules/pako/lib/utils/common.js"),K=T("./node_modules/pako/lib/utils/strings.js"),w=T("./node_modules/pako/lib/zlib/messages.js"),y=T("./node_modules/pako/lib/zlib/zstream.js"),P=Object.prototype.toString;function V(O){if(!(this instanceof V))return new V(O);this.options=S.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},O||{});var z=this.options;z.raw&&z.windowBits>0?z.windowBits=-z.windowBits:z.gzip&&z.windowBits>0&&z.windowBits<16&&(z.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var X=D.deflateInit2(this.strm,z.level,z.method,z.windowBits,z.memLevel,z.strategy);if(X!==0)throw new Error(w[X]);if(z.header&&D.deflateSetHeader(this.strm,z.header),z.dictionary){var p;if(p=typeof z.dictionary=="string"?K.string2buf(z.dictionary):P.call(z.dictionary)==="[object ArrayBuffer]"?new Uint8Array(z.dictionary):z.dictionary,(X=D.deflateSetDictionary(this.strm,p))!==0)throw new Error(w[X]);this._dict_set=!0}}function R(O,z){var X=new V(z);if(X.push(O,!0),X.err)throw X.msg||w[X.err];return X.result}V.prototype.push=function(O,z){var X,p,m=this.strm,C=this.options.chunkSize;if(this.ended)return!1;p=z===~~z?z:z===!0?4:0,typeof O=="string"?m.input=K.string2buf(O):P.call(O)==="[object ArrayBuffer]"?m.input=new Uint8Array(O):m.input=O,m.next_in=0,m.avail_in=m.input.length;do{if(m.avail_out===0&&(m.output=new S.Buf8(C),m.next_out=0,m.avail_out=C),(X=D.deflate(m,p))!==1&&X!==0)return this.onEnd(X),this.ended=!0,!1;m.avail_out!==0&&(m.avail_in!==0||p!==4&&p!==2)||(this.options.to==="string"?this.onData(K.buf2binstring(S.shrinkBuf(m.output,m.next_out))):this.onData(S.shrinkBuf(m.output,m.next_out)))}while((m.avail_in>0||m.avail_out===0)&&X!==1);return p===4?(X=D.deflateEnd(this.strm),this.onEnd(X),this.ended=!0,X===0):p!==2||(this.onEnd(0),m.avail_out=0,!0)},V.prototype.onData=function(O){this.chunks.push(O)},V.prototype.onEnd=function(O){O===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=S.flattenChunks(this.chunks)),this.chunks=[],this.err=O,this.msg=this.strm.msg},E.Deflate=V,E.deflate=R,E.deflateRaw=function(O,z){return(z=z||{}).raw=!0,R(O,z)},E.gzip=function(O,z){return(z=z||{}).gzip=!0,R(O,z)}},"./node_modules/pako/lib/inflate.js":(q,E,T)=>{var D=T("./node_modules/pako/lib/zlib/inflate.js"),S=T("./node_modules/pako/lib/utils/common.js"),K=T("./node_modules/pako/lib/utils/strings.js"),w=T("./node_modules/pako/lib/zlib/constants.js"),y=T("./node_modules/pako/lib/zlib/messages.js"),P=T("./node_modules/pako/lib/zlib/zstream.js"),V=T("./node_modules/pako/lib/zlib/gzheader.js"),R=Object.prototype.toString;function O(X){if(!(this instanceof O))return new O(X);this.options=S.assign({chunkSize:16384,windowBits:0,to:""},X||{});var p=this.options;p.raw&&p.windowBits>=0&&p.windowBits<16&&(p.windowBits=-p.windowBits,p.windowBits===0&&(p.windowBits=-15)),!(p.windowBits>=0&&p.windowBits<16)||X&&X.windowBits||(p.windowBits+=32),p.windowBits>15&&p.windowBits<48&&!(15&p.windowBits)&&(p.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new P,this.strm.avail_out=0;var m=D.inflateInit2(this.strm,p.windowBits);if(m!==w.Z_OK)throw new Error(y[m]);if(this.header=new V,D.inflateGetHeader(this.strm,this.header),p.dictionary&&(typeof p.dictionary=="string"?p.dictionary=K.string2buf(p.dictionary):R.call(p.dictionary)==="[object ArrayBuffer]"&&(p.dictionary=new Uint8Array(p.dictionary)),p.raw&&(m=D.inflateSetDictionary(this.strm,p.dictionary))!==w.Z_OK))throw new Error(y[m])}function z(X,p){var m=new O(p);if(m.push(X,!0),m.err)throw m.msg||y[m.err];return m.result}O.prototype.push=function(X,p){var m,C,v,H,Y,I=this.strm,k=this.options.chunkSize,b=this.options.dictionary,N=!1;if(this.ended)return!1;C=p===~~p?p:p===!0?w.Z_FINISH:w.Z_NO_FLUSH,typeof X=="string"?I.input=K.binstring2buf(X):R.call(X)==="[object ArrayBuffer]"?I.input=new Uint8Array(X):I.input=X,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new S.Buf8(k),I.next_out=0,I.avail_out=k),(m=D.inflate(I,w.Z_NO_FLUSH))===w.Z_NEED_DICT&&b&&(m=D.inflateSetDictionary(this.strm,b)),m===w.Z_BUF_ERROR&&N===!0&&(m=w.Z_OK,N=!1),m!==w.Z_STREAM_END&&m!==w.Z_OK)return this.onEnd(m),this.ended=!0,!1;I.next_out&&(I.avail_out!==0&&m!==w.Z_STREAM_END&&(I.avail_in!==0||C!==w.Z_FINISH&&C!==w.Z_SYNC_FLUSH)||(this.options.to==="string"?(v=K.utf8border(I.output,I.next_out),H=I.next_out-v,Y=K.buf2string(I.output,v),I.next_out=H,I.avail_out=k-H,H&&S.arraySet(I.output,I.output,v,H,0),this.onData(Y)):this.onData(S.shrinkBuf(I.output,I.next_out)))),I.avail_in===0&&I.avail_out===0&&(N=!0)}while((I.avail_in>0||I.avail_out===0)&&m!==w.Z_STREAM_END);return m===w.Z_STREAM_END&&(C=w.Z_FINISH),C===w.Z_FINISH?(m=D.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===w.Z_OK):C!==w.Z_SYNC_FLUSH||(this.onEnd(w.Z_OK),I.avail_out=0,!0)},O.prototype.onData=function(X){this.chunks.push(X)},O.prototype.onEnd=function(X){X===w.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=S.flattenChunks(this.chunks)),this.chunks=[],this.err=X,this.msg=this.strm.msg},E.Inflate=O,E.inflate=z,E.inflateRaw=function(X,p){return(p=p||{}).raw=!0,z(X,p)},E.ungzip=z},"./node_modules/pako/lib/utils/common.js":(q,E)=>{var T=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function D(w,y){return Object.prototype.hasOwnProperty.call(w,y)}E.assign=function(w){for(var y=Array.prototype.slice.call(arguments,1);y.length;){var P=y.shift();if(P){if(typeof P!="object")throw new TypeError(P+"must be non-object");for(var V in P)D(P,V)&&(w[V]=P[V])}}return w},E.shrinkBuf=function(w,y){return w.length===y?w:w.subarray?w.subarray(0,y):(w.length=y,w)};var S={arraySet:function(w,y,P,V,R){if(y.subarray&&w.subarray)w.set(y.subarray(P,P+V),R);else for(var O=0;O<V;O++)w[R+O]=y[P+O]},flattenChunks:function(w){var y,P,V,R,O,z;for(V=0,y=0,P=w.length;y<P;y++)V+=w[y].length;for(z=new Uint8Array(V),R=0,y=0,P=w.length;y<P;y++)O=w[y],z.set(O,R),R+=O.length;return z}},K={arraySet:function(w,y,P,V,R){for(var O=0;O<V;O++)w[R+O]=y[P+O]},flattenChunks:function(w){return[].concat.apply([],w)}};E.setTyped=function(w){w?(E.Buf8=Uint8Array,E.Buf16=Uint16Array,E.Buf32=Int32Array,E.assign(E,S)):(E.Buf8=Array,E.Buf16=Array,E.Buf32=Array,E.assign(E,K))},E.setTyped(T)},"./node_modules/pako/lib/utils/strings.js":(q,E,T)=>{var D=T("./node_modules/pako/lib/utils/common.js"),S=!0,K=!0;try{String.fromCharCode.apply(null,[0])}catch{S=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{K=!1}for(var w=new D.Buf8(256),y=0;y<256;y++)w[y]=y>=252?6:y>=248?5:y>=240?4:y>=224?3:y>=192?2:1;function P(V,R){if(R<65534&&(V.subarray&&K||!V.subarray&&S))return String.fromCharCode.apply(null,D.shrinkBuf(V,R));for(var O="",z=0;z<R;z++)O+=String.fromCharCode(V[z]);return O}w[254]=w[254]=1,E.string2buf=function(V){var R,O,z,X,p,m=V.length,C=0;for(X=0;X<m;X++)(64512&(O=V.charCodeAt(X)))==55296&&X+1<m&&(64512&(z=V.charCodeAt(X+1)))==56320&&(O=65536+(O-55296<<10)+(z-56320),X++),C+=O<128?1:O<2048?2:O<65536?3:4;for(R=new D.Buf8(C),p=0,X=0;p<C;X++)(64512&(O=V.charCodeAt(X)))==55296&&X+1<m&&(64512&(z=V.charCodeAt(X+1)))==56320&&(O=65536+(O-55296<<10)+(z-56320),X++),O<128?R[p++]=O:O<2048?(R[p++]=192|O>>>6,R[p++]=128|63&O):O<65536?(R[p++]=224|O>>>12,R[p++]=128|O>>>6&63,R[p++]=128|63&O):(R[p++]=240|O>>>18,R[p++]=128|O>>>12&63,R[p++]=128|O>>>6&63,R[p++]=128|63&O);return R},E.buf2binstring=function(V){return P(V,V.length)},E.binstring2buf=function(V){for(var R=new D.Buf8(V.length),O=0,z=R.length;O<z;O++)R[O]=V.charCodeAt(O);return R},E.buf2string=function(V,R){var O,z,X,p,m=R||V.length,C=new Array(2*m);for(z=0,O=0;O<m;)if((X=V[O++])<128)C[z++]=X;else if((p=w[X])>4)C[z++]=65533,O+=p-1;else{for(X&=p===2?31:p===3?15:7;p>1&&O<m;)X=X<<6|63&V[O++],p--;p>1?C[z++]=65533:X<65536?C[z++]=X:(X-=65536,C[z++]=55296|X>>10&1023,C[z++]=56320|1023&X)}return P(C,z)},E.utf8border=function(V,R){var O;for((R=R||V.length)>V.length&&(R=V.length),O=R-1;O>=0&&(192&V[O])==128;)O--;return O<0||O===0?R:O+w[V[O]]>R?O:R}},"./node_modules/pako/lib/zlib/adler32.js":q=>{q.exports=function(E,T,D,S){for(var K=65535&E|0,w=E>>>16&65535|0,y=0;D!==0;){D-=y=D>2e3?2e3:D;do w=w+(K=K+T[S++]|0)|0;while(--y);K%=65521,w%=65521}return K|w<<16|0}},"./node_modules/pako/lib/zlib/constants.js":q=>{q.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},"./node_modules/pako/lib/zlib/crc32.js":q=>{var E=function(){for(var T,D=[],S=0;S<256;S++){T=S;for(var K=0;K<8;K++)T=1&T?3988292384^T>>>1:T>>>1;D[S]=T}return D}();q.exports=function(T,D,S,K){var w=E,y=K+S;T^=-1;for(var P=K;P<y;P++)T=T>>>8^w[255&(T^D[P])];return-1^T}},"./node_modules/pako/lib/zlib/deflate.js":(q,E,T)=>{var D,S=T("./node_modules/pako/lib/utils/common.js"),K=T("./node_modules/pako/lib/zlib/trees.js"),w=T("./node_modules/pako/lib/zlib/adler32.js"),y=T("./node_modules/pako/lib/zlib/crc32.js"),P=T("./node_modules/pako/lib/zlib/messages.js"),V=-2,R=258,O=262,z=103,X=113,p=666;function m(A,L){return A.msg=P[L],L}function C(A){return(A<<1)-(A>4?9:0)}function v(A){for(var L=A.length;--L>=0;)A[L]=0}function H(A){var L=A.state,nt=L.pending;nt>A.avail_out&&(nt=A.avail_out),nt!==0&&(S.arraySet(A.output,L.pending_buf,L.pending_out,nt,A.next_out),A.next_out+=nt,L.pending_out+=nt,A.total_out+=nt,A.avail_out-=nt,L.pending-=nt,L.pending===0&&(L.pending_out=0))}function Y(A,L){K._tr_flush_block(A,A.block_start>=0?A.block_start:-1,A.strstart-A.block_start,L),A.block_start=A.strstart,H(A.strm)}function I(A,L){A.pending_buf[A.pending++]=L}function k(A,L){A.pending_buf[A.pending++]=L>>>8&255,A.pending_buf[A.pending++]=255&L}function b(A,L){var nt,B,st=A.max_chain_length,M=A.strstart,tt=A.prev_length,rt=A.nice_match,At=A.strstart>A.w_size-O?A.strstart-(A.w_size-O):0,lt=A.window,bt=A.w_mask,Bt=A.prev,yt=A.strstart+R,kt=lt[M+tt-1],Mt=lt[M+tt];A.prev_length>=A.good_match&&(st>>=2),rt>A.lookahead&&(rt=A.lookahead);do if(lt[(nt=L)+tt]===Mt&&lt[nt+tt-1]===kt&&lt[nt]===lt[M]&&lt[++nt]===lt[M+1]){M+=2,nt++;do;while(lt[++M]===lt[++nt]&&lt[++M]===lt[++nt]&&lt[++M]===lt[++nt]&&lt[++M]===lt[++nt]&&lt[++M]===lt[++nt]&&lt[++M]===lt[++nt]&&lt[++M]===lt[++nt]&&lt[++M]===lt[++nt]&&M<yt);if(B=R-(yt-M),M=yt-R,B>tt){if(A.match_start=L,tt=B,B>=rt)break;kt=lt[M+tt-1],Mt=lt[M+tt]}}while((L=Bt[L&bt])>At&&--st!=0);return tt<=A.lookahead?tt:A.lookahead}function N(A){var L,nt,B,st,M,tt,rt,At,lt,bt,Bt=A.w_size;do{if(st=A.window_size-A.lookahead-A.strstart,A.strstart>=Bt+(Bt-O)){S.arraySet(A.window,A.window,Bt,Bt,0),A.match_start-=Bt,A.strstart-=Bt,A.block_start-=Bt,L=nt=A.hash_size;do B=A.head[--L],A.head[L]=B>=Bt?B-Bt:0;while(--nt);L=nt=Bt;do B=A.prev[--L],A.prev[L]=B>=Bt?B-Bt:0;while(--nt);st+=Bt}if(A.strm.avail_in===0)break;if(tt=A.strm,rt=A.window,At=A.strstart+A.lookahead,lt=st,bt=void 0,(bt=tt.avail_in)>lt&&(bt=lt),nt=bt===0?0:(tt.avail_in-=bt,S.arraySet(rt,tt.input,tt.next_in,bt,At),tt.state.wrap===1?tt.adler=w(tt.adler,rt,bt,At):tt.state.wrap===2&&(tt.adler=y(tt.adler,rt,bt,At)),tt.next_in+=bt,tt.total_in+=bt,bt),A.lookahead+=nt,A.lookahead+A.insert>=3)for(M=A.strstart-A.insert,A.ins_h=A.window[M],A.ins_h=(A.ins_h<<A.hash_shift^A.window[M+1])&A.hash_mask;A.insert&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[M+3-1])&A.hash_mask,A.prev[M&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=M,M++,A.insert--,!(A.lookahead+A.insert<3)););}while(A.lookahead<O&&A.strm.avail_in!==0)}function _(A,L){for(var nt,B;;){if(A.lookahead<O){if(N(A),A.lookahead<O&&L===0)return 1;if(A.lookahead===0)break}if(nt=0,A.lookahead>=3&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+3-1])&A.hash_mask,nt=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),nt!==0&&A.strstart-nt<=A.w_size-O&&(A.match_length=b(A,nt)),A.match_length>=3)if(B=K._tr_tally(A,A.strstart-A.match_start,A.match_length-3),A.lookahead-=A.match_length,A.match_length<=A.max_lazy_match&&A.lookahead>=3){A.match_length--;do A.strstart++,A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+3-1])&A.hash_mask,nt=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart;while(--A.match_length!=0);A.strstart++}else A.strstart+=A.match_length,A.match_length=0,A.ins_h=A.window[A.strstart],A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+1])&A.hash_mask;else B=K._tr_tally(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++;if(B&&(Y(A,!1),A.strm.avail_out===0))return 1}return A.insert=A.strstart<2?A.strstart:2,L===4?(Y(A,!0),A.strm.avail_out===0?3:4):A.last_lit&&(Y(A,!1),A.strm.avail_out===0)?1:2}function ct(A,L){for(var nt,B,st;;){if(A.lookahead<O){if(N(A),A.lookahead<O&&L===0)return 1;if(A.lookahead===0)break}if(nt=0,A.lookahead>=3&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+3-1])&A.hash_mask,nt=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),A.prev_length=A.match_length,A.prev_match=A.match_start,A.match_length=2,nt!==0&&A.prev_length<A.max_lazy_match&&A.strstart-nt<=A.w_size-O&&(A.match_length=b(A,nt),A.match_length<=5&&(A.strategy===1||A.match_length===3&&A.strstart-A.match_start>4096)&&(A.match_length=2)),A.prev_length>=3&&A.match_length<=A.prev_length){st=A.strstart+A.lookahead-3,B=K._tr_tally(A,A.strstart-1-A.prev_match,A.prev_length-3),A.lookahead-=A.prev_length-1,A.prev_length-=2;do++A.strstart<=st&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+3-1])&A.hash_mask,nt=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart);while(--A.prev_length!=0);if(A.match_available=0,A.match_length=2,A.strstart++,B&&(Y(A,!1),A.strm.avail_out===0))return 1}else if(A.match_available){if((B=K._tr_tally(A,0,A.window[A.strstart-1]))&&Y(A,!1),A.strstart++,A.lookahead--,A.strm.avail_out===0)return 1}else A.match_available=1,A.strstart++,A.lookahead--}return A.match_available&&(B=K._tr_tally(A,0,A.window[A.strstart-1]),A.match_available=0),A.insert=A.strstart<2?A.strstart:2,L===4?(Y(A,!0),A.strm.avail_out===0?3:4):A.last_lit&&(Y(A,!1),A.strm.avail_out===0)?1:2}function gt(A,L,nt,B,st){this.good_length=A,this.max_lazy=L,this.nice_length=nt,this.max_chain=B,this.func=st}function ot(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new S.Buf16(1146),this.dyn_dtree=new S.Buf16(122),this.bl_tree=new S.Buf16(78),v(this.dyn_ltree),v(this.dyn_dtree),v(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new S.Buf16(16),this.heap=new S.Buf16(573),v(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new S.Buf16(573),v(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Et(A){var L;return A&&A.state?(A.total_in=A.total_out=0,A.data_type=2,(L=A.state).pending=0,L.pending_out=0,L.wrap<0&&(L.wrap=-L.wrap),L.status=L.wrap?42:X,A.adler=L.wrap===2?0:1,L.last_flush=0,K._tr_init(L),0):m(A,V)}function at(A){var L,nt=Et(A);return nt===0&&((L=A.state).window_size=2*L.w_size,v(L.head),L.max_lazy_match=D[L.level].max_lazy,L.good_match=D[L.level].good_length,L.nice_match=D[L.level].nice_length,L.max_chain_length=D[L.level].max_chain,L.strstart=0,L.block_start=0,L.lookahead=0,L.insert=0,L.match_length=L.prev_length=2,L.match_available=0,L.ins_h=0),nt}function mt(A,L,nt,B,st,M){if(!A)return V;var tt=1;if(L===-1&&(L=6),B<0?(tt=0,B=-B):B>15&&(tt=2,B-=16),st<1||st>9||nt!==8||B<8||B>15||L<0||L>9||M<0||M>4)return m(A,V);B===8&&(B=9);var rt=new ot;return A.state=rt,rt.strm=A,rt.wrap=tt,rt.gzhead=null,rt.w_bits=B,rt.w_size=1<<rt.w_bits,rt.w_mask=rt.w_size-1,rt.hash_bits=st+7,rt.hash_size=1<<rt.hash_bits,rt.hash_mask=rt.hash_size-1,rt.hash_shift=~~((rt.hash_bits+3-1)/3),rt.window=new S.Buf8(2*rt.w_size),rt.head=new S.Buf16(rt.hash_size),rt.prev=new S.Buf16(rt.w_size),rt.lit_bufsize=1<<st+6,rt.pending_buf_size=4*rt.lit_bufsize,rt.pending_buf=new S.Buf8(rt.pending_buf_size),rt.d_buf=1*rt.lit_bufsize,rt.l_buf=3*rt.lit_bufsize,rt.level=L,rt.strategy=M,rt.method=nt,at(A)}D=[new gt(0,0,0,0,function(A,L){var nt=65535;for(nt>A.pending_buf_size-5&&(nt=A.pending_buf_size-5);;){if(A.lookahead<=1){if(N(A),A.lookahead===0&&L===0)return 1;if(A.lookahead===0)break}A.strstart+=A.lookahead,A.lookahead=0;var B=A.block_start+nt;if((A.strstart===0||A.strstart>=B)&&(A.lookahead=A.strstart-B,A.strstart=B,Y(A,!1),A.strm.avail_out===0)||A.strstart-A.block_start>=A.w_size-O&&(Y(A,!1),A.strm.avail_out===0))return 1}return A.insert=0,L===4?(Y(A,!0),A.strm.avail_out===0?3:4):(A.strstart>A.block_start&&(Y(A,!1),A.strm.avail_out),1)}),new gt(4,4,8,4,_),new gt(4,5,16,8,_),new gt(4,6,32,32,_),new gt(4,4,16,16,ct),new gt(8,16,32,32,ct),new gt(8,16,128,128,ct),new gt(8,32,128,256,ct),new gt(32,128,258,1024,ct),new gt(32,258,258,4096,ct)],E.deflateInit=function(A,L){return mt(A,L,8,15,8,0)},E.deflateInit2=mt,E.deflateReset=at,E.deflateResetKeep=Et,E.deflateSetHeader=function(A,L){return A&&A.state?A.state.wrap!==2?V:(A.state.gzhead=L,0):V},E.deflate=function(A,L){var nt,B,st,M;if(!A||!A.state||L>5||L<0)return A?m(A,V):V;if(B=A.state,!A.output||!A.input&&A.avail_in!==0||B.status===p&&L!==4)return m(A,A.avail_out===0?-5:V);if(B.strm=A,nt=B.last_flush,B.last_flush=L,B.status===42)if(B.wrap===2)A.adler=0,I(B,31),I(B,139),I(B,8),B.gzhead?(I(B,(B.gzhead.text?1:0)+(B.gzhead.hcrc?2:0)+(B.gzhead.extra?4:0)+(B.gzhead.name?8:0)+(B.gzhead.comment?16:0)),I(B,255&B.gzhead.time),I(B,B.gzhead.time>>8&255),I(B,B.gzhead.time>>16&255),I(B,B.gzhead.time>>24&255),I(B,B.level===9?2:B.strategy>=2||B.level<2?4:0),I(B,255&B.gzhead.os),B.gzhead.extra&&B.gzhead.extra.length&&(I(B,255&B.gzhead.extra.length),I(B,B.gzhead.extra.length>>8&255)),B.gzhead.hcrc&&(A.adler=y(A.adler,B.pending_buf,B.pending,0)),B.gzindex=0,B.status=69):(I(B,0),I(B,0),I(B,0),I(B,0),I(B,0),I(B,B.level===9?2:B.strategy>=2||B.level<2?4:0),I(B,3),B.status=X);else{var tt=8+(B.w_bits-8<<4)<<8;tt|=(B.strategy>=2||B.level<2?0:B.level<6?1:B.level===6?2:3)<<6,B.strstart!==0&&(tt|=32),tt+=31-tt%31,B.status=X,k(B,tt),B.strstart!==0&&(k(B,A.adler>>>16),k(B,65535&A.adler)),A.adler=1}if(B.status===69)if(B.gzhead.extra){for(st=B.pending;B.gzindex<(65535&B.gzhead.extra.length)&&(B.pending!==B.pending_buf_size||(B.gzhead.hcrc&&B.pending>st&&(A.adler=y(A.adler,B.pending_buf,B.pending-st,st)),H(A),st=B.pending,B.pending!==B.pending_buf_size));)I(B,255&B.gzhead.extra[B.gzindex]),B.gzindex++;B.gzhead.hcrc&&B.pending>st&&(A.adler=y(A.adler,B.pending_buf,B.pending-st,st)),B.gzindex===B.gzhead.extra.length&&(B.gzindex=0,B.status=73)}else B.status=73;if(B.status===73)if(B.gzhead.name){st=B.pending;do{if(B.pending===B.pending_buf_size&&(B.gzhead.hcrc&&B.pending>st&&(A.adler=y(A.adler,B.pending_buf,B.pending-st,st)),H(A),st=B.pending,B.pending===B.pending_buf_size)){M=1;break}M=B.gzindex<B.gzhead.name.length?255&B.gzhead.name.charCodeAt(B.gzindex++):0,I(B,M)}while(M!==0);B.gzhead.hcrc&&B.pending>st&&(A.adler=y(A.adler,B.pending_buf,B.pending-st,st)),M===0&&(B.gzindex=0,B.status=91)}else B.status=91;if(B.status===91)if(B.gzhead.comment){st=B.pending;do{if(B.pending===B.pending_buf_size&&(B.gzhead.hcrc&&B.pending>st&&(A.adler=y(A.adler,B.pending_buf,B.pending-st,st)),H(A),st=B.pending,B.pending===B.pending_buf_size)){M=1;break}M=B.gzindex<B.gzhead.comment.length?255&B.gzhead.comment.charCodeAt(B.gzindex++):0,I(B,M)}while(M!==0);B.gzhead.hcrc&&B.pending>st&&(A.adler=y(A.adler,B.pending_buf,B.pending-st,st)),M===0&&(B.status=z)}else B.status=z;if(B.status===z&&(B.gzhead.hcrc?(B.pending+2>B.pending_buf_size&&H(A),B.pending+2<=B.pending_buf_size&&(I(B,255&A.adler),I(B,A.adler>>8&255),A.adler=0,B.status=X)):B.status=X),B.pending!==0){if(H(A),A.avail_out===0)return B.last_flush=-1,0}else if(A.avail_in===0&&C(L)<=C(nt)&&L!==4)return m(A,-5);if(B.status===p&&A.avail_in!==0)return m(A,-5);if(A.avail_in!==0||B.lookahead!==0||L!==0&&B.status!==p){var rt=B.strategy===2?function(At,lt){for(var bt;;){if(At.lookahead===0&&(N(At),At.lookahead===0)){if(lt===0)return 1;break}if(At.match_length=0,bt=K._tr_tally(At,0,At.window[At.strstart]),At.lookahead--,At.strstart++,bt&&(Y(At,!1),At.strm.avail_out===0))return 1}return At.insert=0,lt===4?(Y(At,!0),At.strm.avail_out===0?3:4):At.last_lit&&(Y(At,!1),At.strm.avail_out===0)?1:2}(B,L):B.strategy===3?function(At,lt){for(var bt,Bt,yt,kt,Mt=At.window;;){if(At.lookahead<=R){if(N(At),At.lookahead<=R&&lt===0)return 1;if(At.lookahead===0)break}if(At.match_length=0,At.lookahead>=3&&At.strstart>0&&(Bt=Mt[yt=At.strstart-1])===Mt[++yt]&&Bt===Mt[++yt]&&Bt===Mt[++yt]){kt=At.strstart+R;do;while(Bt===Mt[++yt]&&Bt===Mt[++yt]&&Bt===Mt[++yt]&&Bt===Mt[++yt]&&Bt===Mt[++yt]&&Bt===Mt[++yt]&&Bt===Mt[++yt]&&Bt===Mt[++yt]&&yt<kt);At.match_length=R-(kt-yt),At.match_length>At.lookahead&&(At.match_length=At.lookahead)}if(At.match_length>=3?(bt=K._tr_tally(At,1,At.match_length-3),At.lookahead-=At.match_length,At.strstart+=At.match_length,At.match_length=0):(bt=K._tr_tally(At,0,At.window[At.strstart]),At.lookahead--,At.strstart++),bt&&(Y(At,!1),At.strm.avail_out===0))return 1}return At.insert=0,lt===4?(Y(At,!0),At.strm.avail_out===0?3:4):At.last_lit&&(Y(At,!1),At.strm.avail_out===0)?1:2}(B,L):D[B.level].func(B,L);if(rt!==3&&rt!==4||(B.status=p),rt===1||rt===3)return A.avail_out===0&&(B.last_flush=-1),0;if(rt===2&&(L===1?K._tr_align(B):L!==5&&(K._tr_stored_block(B,0,0,!1),L===3&&(v(B.head),B.lookahead===0&&(B.strstart=0,B.block_start=0,B.insert=0))),H(A),A.avail_out===0))return B.last_flush=-1,0}return L!==4?0:B.wrap<=0?1:(B.wrap===2?(I(B,255&A.adler),I(B,A.adler>>8&255),I(B,A.adler>>16&255),I(B,A.adler>>24&255),I(B,255&A.total_in),I(B,A.total_in>>8&255),I(B,A.total_in>>16&255),I(B,A.total_in>>24&255)):(k(B,A.adler>>>16),k(B,65535&A.adler)),H(A),B.wrap>0&&(B.wrap=-B.wrap),B.pending!==0?0:1)},E.deflateEnd=function(A){var L;return A&&A.state?(L=A.state.status)!==42&&L!==69&&L!==73&&L!==91&&L!==z&&L!==X&&L!==p?m(A,V):(A.state=null,L===X?m(A,-3):0):V},E.deflateSetDictionary=function(A,L){var nt,B,st,M,tt,rt,At,lt,bt=L.length;if(!A||!A.state||(M=(nt=A.state).wrap)===2||M===1&&nt.status!==42||nt.lookahead)return V;for(M===1&&(A.adler=w(A.adler,L,bt,0)),nt.wrap=0,bt>=nt.w_size&&(M===0&&(v(nt.head),nt.strstart=0,nt.block_start=0,nt.insert=0),lt=new S.Buf8(nt.w_size),S.arraySet(lt,L,bt-nt.w_size,nt.w_size,0),L=lt,bt=nt.w_size),tt=A.avail_in,rt=A.next_in,At=A.input,A.avail_in=bt,A.next_in=0,A.input=L,N(nt);nt.lookahead>=3;){B=nt.strstart,st=nt.lookahead-2;do nt.ins_h=(nt.ins_h<<nt.hash_shift^nt.window[B+3-1])&nt.hash_mask,nt.prev[B&nt.w_mask]=nt.head[nt.ins_h],nt.head[nt.ins_h]=B,B++;while(--st);nt.strstart=B,nt.lookahead=2,N(nt)}return nt.strstart+=nt.lookahead,nt.block_start=nt.strstart,nt.insert=nt.lookahead,nt.lookahead=0,nt.match_length=nt.prev_length=2,nt.match_available=0,A.next_in=rt,A.input=At,A.avail_in=tt,nt.wrap=M,0},E.deflateInfo="pako deflate (from Nodeca project)"},"./node_modules/pako/lib/zlib/gzheader.js":q=>{q.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},"./node_modules/pako/lib/zlib/inffast.js":q=>{q.exports=function(E,T){var D,S,K,w,y,P,V,R,O,z,X,p,m,C,v,H,Y,I,k,b,N,_,ct,gt,ot;D=E.state,S=E.next_in,gt=E.input,K=S+(E.avail_in-5),w=E.next_out,ot=E.output,y=w-(T-E.avail_out),P=w+(E.avail_out-257),V=D.dmax,R=D.wsize,O=D.whave,z=D.wnext,X=D.window,p=D.hold,m=D.bits,C=D.lencode,v=D.distcode,H=(1<<D.lenbits)-1,Y=(1<<D.distbits)-1;t:do{m<15&&(p+=gt[S++]<<m,m+=8,p+=gt[S++]<<m,m+=8),I=C[p&H];e:for(;;){if(p>>>=k=I>>>24,m-=k,(k=I>>>16&255)==0)ot[w++]=65535&I;else{if(!(16&k)){if(!(64&k)){I=C[(65535&I)+(p&(1<<k)-1)];continue e}if(32&k){D.mode=12;break t}E.msg="invalid literal/length code",D.mode=30;break t}b=65535&I,(k&=15)&&(m<k&&(p+=gt[S++]<<m,m+=8),b+=p&(1<<k)-1,p>>>=k,m-=k),m<15&&(p+=gt[S++]<<m,m+=8,p+=gt[S++]<<m,m+=8),I=v[p&Y];i:for(;;){if(p>>>=k=I>>>24,m-=k,!(16&(k=I>>>16&255))){if(!(64&k)){I=v[(65535&I)+(p&(1<<k)-1)];continue i}E.msg="invalid distance code",D.mode=30;break t}if(N=65535&I,m<(k&=15)&&(p+=gt[S++]<<m,(m+=8)<k&&(p+=gt[S++]<<m,m+=8)),(N+=p&(1<<k)-1)>V){E.msg="invalid distance too far back",D.mode=30;break t}if(p>>>=k,m-=k,N>(k=w-y)){if((k=N-k)>O&&D.sane){E.msg="invalid distance too far back",D.mode=30;break t}if(_=0,ct=X,z===0){if(_+=R-k,k<b){b-=k;do ot[w++]=X[_++];while(--k);_=w-N,ct=ot}}else if(z<k){if(_+=R+z-k,(k-=z)<b){b-=k;do ot[w++]=X[_++];while(--k);if(_=0,z<b){b-=k=z;do ot[w++]=X[_++];while(--k);_=w-N,ct=ot}}}else if(_+=z-k,k<b){b-=k;do ot[w++]=X[_++];while(--k);_=w-N,ct=ot}for(;b>2;)ot[w++]=ct[_++],ot[w++]=ct[_++],ot[w++]=ct[_++],b-=3;b&&(ot[w++]=ct[_++],b>1&&(ot[w++]=ct[_++]))}else{_=w-N;do ot[w++]=ot[_++],ot[w++]=ot[_++],ot[w++]=ot[_++],b-=3;while(b>2);b&&(ot[w++]=ot[_++],b>1&&(ot[w++]=ot[_++]))}break}}break}}while(S<K&&w<P);S-=b=m>>3,p&=(1<<(m-=b<<3))-1,E.next_in=S,E.next_out=w,E.avail_in=S<K?K-S+5:5-(S-K),E.avail_out=w<P?P-w+257:257-(w-P),D.hold=p,D.bits=m}},"./node_modules/pako/lib/zlib/inflate.js":(q,E,T)=>{var D=T("./node_modules/pako/lib/utils/common.js"),S=T("./node_modules/pako/lib/zlib/adler32.js"),K=T("./node_modules/pako/lib/zlib/crc32.js"),w=T("./node_modules/pako/lib/zlib/inffast.js"),y=T("./node_modules/pako/lib/zlib/inftrees.js"),P=-2,V=12,R=30;function O(b){return(b>>>24&255)+(b>>>8&65280)+((65280&b)<<8)+((255&b)<<24)}function z(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new D.Buf16(320),this.work=new D.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function X(b){var N;return b&&b.state?(N=b.state,b.total_in=b.total_out=N.total=0,b.msg="",N.wrap&&(b.adler=1&N.wrap),N.mode=1,N.last=0,N.havedict=0,N.dmax=32768,N.head=null,N.hold=0,N.bits=0,N.lencode=N.lendyn=new D.Buf32(852),N.distcode=N.distdyn=new D.Buf32(592),N.sane=1,N.back=-1,0):P}function p(b){var N;return b&&b.state?((N=b.state).wsize=0,N.whave=0,N.wnext=0,X(b)):P}function m(b,N){var _,ct;return b&&b.state?(ct=b.state,N<0?(_=0,N=-N):(_=1+(N>>4),N<48&&(N&=15)),N&&(N<8||N>15)?P:(ct.window!==null&&ct.wbits!==N&&(ct.window=null),ct.wrap=_,ct.wbits=N,p(b))):P}function C(b,N){var _,ct;return b?(ct=new z,b.state=ct,ct.window=null,(_=m(b,N))!==0&&(b.state=null),_):P}var v,H,Y=!0;function I(b){if(Y){var N;for(v=new D.Buf32(512),H=new D.Buf32(32),N=0;N<144;)b.lens[N++]=8;for(;N<256;)b.lens[N++]=9;for(;N<280;)b.lens[N++]=7;for(;N<288;)b.lens[N++]=8;for(y(1,b.lens,0,288,v,0,b.work,{bits:9}),N=0;N<32;)b.lens[N++]=5;y(2,b.lens,0,32,H,0,b.work,{bits:5}),Y=!1}b.lencode=v,b.lenbits=9,b.distcode=H,b.distbits=5}function k(b,N,_,ct){var gt,ot=b.state;return ot.window===null&&(ot.wsize=1<<ot.wbits,ot.wnext=0,ot.whave=0,ot.window=new D.Buf8(ot.wsize)),ct>=ot.wsize?(D.arraySet(ot.window,N,_-ot.wsize,ot.wsize,0),ot.wnext=0,ot.whave=ot.wsize):((gt=ot.wsize-ot.wnext)>ct&&(gt=ct),D.arraySet(ot.window,N,_-ct,gt,ot.wnext),(ct-=gt)?(D.arraySet(ot.window,N,_-ct,ct,0),ot.wnext=ct,ot.whave=ot.wsize):(ot.wnext+=gt,ot.wnext===ot.wsize&&(ot.wnext=0),ot.whave<ot.wsize&&(ot.whave+=gt))),0}E.inflateReset=p,E.inflateReset2=m,E.inflateResetKeep=X,E.inflateInit=function(b){return C(b,15)},E.inflateInit2=C,E.inflate=function(b,N){var _,ct,gt,ot,Et,at,mt,A,L,nt,B,st,M,tt,rt,At,lt,bt,Bt,yt,kt,Mt,Wt,qt,Yt=0,Kt=new D.Buf8(4),Fe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!b||!b.state||!b.output||!b.input&&b.avail_in!==0)return P;(_=b.state).mode===V&&(_.mode=13),Et=b.next_out,gt=b.output,mt=b.avail_out,ot=b.next_in,ct=b.input,at=b.avail_in,A=_.hold,L=_.bits,nt=at,B=mt,Mt=0;t:for(;;)switch(_.mode){case 1:if(_.wrap===0){_.mode=13;break}for(;L<16;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}if(2&_.wrap&&A===35615){_.check=0,Kt[0]=255&A,Kt[1]=A>>>8&255,_.check=K(_.check,Kt,2,0),A=0,L=0,_.mode=2;break}if(_.flags=0,_.head&&(_.head.done=!1),!(1&_.wrap)||(((255&A)<<8)+(A>>8))%31){b.msg="incorrect header check",_.mode=R;break}if((15&A)!=8){b.msg="unknown compression method",_.mode=R;break}if(L-=4,kt=8+(15&(A>>>=4)),_.wbits===0)_.wbits=kt;else if(kt>_.wbits){b.msg="invalid window size",_.mode=R;break}_.dmax=1<<kt,b.adler=_.check=1,_.mode=512&A?10:V,A=0,L=0;break;case 2:for(;L<16;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}if(_.flags=A,(255&_.flags)!=8){b.msg="unknown compression method",_.mode=R;break}if(57344&_.flags){b.msg="unknown header flags set",_.mode=R;break}_.head&&(_.head.text=A>>8&1),512&_.flags&&(Kt[0]=255&A,Kt[1]=A>>>8&255,_.check=K(_.check,Kt,2,0)),A=0,L=0,_.mode=3;case 3:for(;L<32;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}_.head&&(_.head.time=A),512&_.flags&&(Kt[0]=255&A,Kt[1]=A>>>8&255,Kt[2]=A>>>16&255,Kt[3]=A>>>24&255,_.check=K(_.check,Kt,4,0)),A=0,L=0,_.mode=4;case 4:for(;L<16;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}_.head&&(_.head.xflags=255&A,_.head.os=A>>8),512&_.flags&&(Kt[0]=255&A,Kt[1]=A>>>8&255,_.check=K(_.check,Kt,2,0)),A=0,L=0,_.mode=5;case 5:if(1024&_.flags){for(;L<16;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}_.length=A,_.head&&(_.head.extra_len=A),512&_.flags&&(Kt[0]=255&A,Kt[1]=A>>>8&255,_.check=K(_.check,Kt,2,0)),A=0,L=0}else _.head&&(_.head.extra=null);_.mode=6;case 6:if(1024&_.flags&&((st=_.length)>at&&(st=at),st&&(_.head&&(kt=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),D.arraySet(_.head.extra,ct,ot,st,kt)),512&_.flags&&(_.check=K(_.check,ct,st,ot)),at-=st,ot+=st,_.length-=st),_.length))break t;_.length=0,_.mode=7;case 7:if(2048&_.flags){if(at===0)break t;st=0;do kt=ct[ot+st++],_.head&&kt&&_.length<65536&&(_.head.name+=String.fromCharCode(kt));while(kt&&st<at);if(512&_.flags&&(_.check=K(_.check,ct,st,ot)),at-=st,ot+=st,kt)break t}else _.head&&(_.head.name=null);_.length=0,_.mode=8;case 8:if(4096&_.flags){if(at===0)break t;st=0;do kt=ct[ot+st++],_.head&&kt&&_.length<65536&&(_.head.comment+=String.fromCharCode(kt));while(kt&&st<at);if(512&_.flags&&(_.check=K(_.check,ct,st,ot)),at-=st,ot+=st,kt)break t}else _.head&&(_.head.comment=null);_.mode=9;case 9:if(512&_.flags){for(;L<16;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}if(A!==(65535&_.check)){b.msg="header crc mismatch",_.mode=R;break}A=0,L=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),b.adler=_.check=0,_.mode=V;break;case 10:for(;L<32;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}b.adler=_.check=O(A),A=0,L=0,_.mode=11;case 11:if(_.havedict===0)return b.next_out=Et,b.avail_out=mt,b.next_in=ot,b.avail_in=at,_.hold=A,_.bits=L,2;b.adler=_.check=1,_.mode=V;case V:if(N===5||N===6)break t;case 13:if(_.last){A>>>=7&L,L-=7&L,_.mode=27;break}for(;L<3;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}switch(_.last=1&A,L-=1,3&(A>>>=1)){case 0:_.mode=14;break;case 1:if(I(_),_.mode=20,N===6){A>>>=2,L-=2;break t}break;case 2:_.mode=17;break;case 3:b.msg="invalid block type",_.mode=R}A>>>=2,L-=2;break;case 14:for(A>>>=7&L,L-=7&L;L<32;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}if((65535&A)!=(A>>>16^65535)){b.msg="invalid stored block lengths",_.mode=R;break}if(_.length=65535&A,A=0,L=0,_.mode=15,N===6)break t;case 15:_.mode=16;case 16:if(st=_.length){if(st>at&&(st=at),st>mt&&(st=mt),st===0)break t;D.arraySet(gt,ct,ot,st,Et),at-=st,ot+=st,mt-=st,Et+=st,_.length-=st;break}_.mode=V;break;case 17:for(;L<14;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}if(_.nlen=257+(31&A),A>>>=5,L-=5,_.ndist=1+(31&A),A>>>=5,L-=5,_.ncode=4+(15&A),A>>>=4,L-=4,_.nlen>286||_.ndist>30){b.msg="too many length or distance symbols",_.mode=R;break}_.have=0,_.mode=18;case 18:for(;_.have<_.ncode;){for(;L<3;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}_.lens[Fe[_.have++]]=7&A,A>>>=3,L-=3}for(;_.have<19;)_.lens[Fe[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,Wt={bits:_.lenbits},Mt=y(0,_.lens,0,19,_.lencode,0,_.work,Wt),_.lenbits=Wt.bits,Mt){b.msg="invalid code lengths set",_.mode=R;break}_.have=0,_.mode=19;case 19:for(;_.have<_.nlen+_.ndist;){for(;At=(Yt=_.lencode[A&(1<<_.lenbits)-1])>>>16&255,lt=65535&Yt,!((rt=Yt>>>24)<=L);){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}if(lt<16)A>>>=rt,L-=rt,_.lens[_.have++]=lt;else{if(lt===16){for(qt=rt+2;L<qt;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}if(A>>>=rt,L-=rt,_.have===0){b.msg="invalid bit length repeat",_.mode=R;break}kt=_.lens[_.have-1],st=3+(3&A),A>>>=2,L-=2}else if(lt===17){for(qt=rt+3;L<qt;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}L-=rt,kt=0,st=3+(7&(A>>>=rt)),A>>>=3,L-=3}else{for(qt=rt+7;L<qt;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}L-=rt,kt=0,st=11+(127&(A>>>=rt)),A>>>=7,L-=7}if(_.have+st>_.nlen+_.ndist){b.msg="invalid bit length repeat",_.mode=R;break}for(;st--;)_.lens[_.have++]=kt}}if(_.mode===R)break;if(_.lens[256]===0){b.msg="invalid code -- missing end-of-block",_.mode=R;break}if(_.lenbits=9,Wt={bits:_.lenbits},Mt=y(1,_.lens,0,_.nlen,_.lencode,0,_.work,Wt),_.lenbits=Wt.bits,Mt){b.msg="invalid literal/lengths set",_.mode=R;break}if(_.distbits=6,_.distcode=_.distdyn,Wt={bits:_.distbits},Mt=y(2,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,Wt),_.distbits=Wt.bits,Mt){b.msg="invalid distances set",_.mode=R;break}if(_.mode=20,N===6)break t;case 20:_.mode=21;case 21:if(at>=6&&mt>=258){b.next_out=Et,b.avail_out=mt,b.next_in=ot,b.avail_in=at,_.hold=A,_.bits=L,w(b,B),Et=b.next_out,gt=b.output,mt=b.avail_out,ot=b.next_in,ct=b.input,at=b.avail_in,A=_.hold,L=_.bits,_.mode===V&&(_.back=-1);break}for(_.back=0;At=(Yt=_.lencode[A&(1<<_.lenbits)-1])>>>16&255,lt=65535&Yt,!((rt=Yt>>>24)<=L);){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}if(At&&!(240&At)){for(bt=rt,Bt=At,yt=lt;At=(Yt=_.lencode[yt+((A&(1<<bt+Bt)-1)>>bt)])>>>16&255,lt=65535&Yt,!(bt+(rt=Yt>>>24)<=L);){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}A>>>=bt,L-=bt,_.back+=bt}if(A>>>=rt,L-=rt,_.back+=rt,_.length=lt,At===0){_.mode=26;break}if(32&At){_.back=-1,_.mode=V;break}if(64&At){b.msg="invalid literal/length code",_.mode=R;break}_.extra=15&At,_.mode=22;case 22:if(_.extra){for(qt=_.extra;L<qt;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}_.length+=A&(1<<_.extra)-1,A>>>=_.extra,L-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=23;case 23:for(;At=(Yt=_.distcode[A&(1<<_.distbits)-1])>>>16&255,lt=65535&Yt,!((rt=Yt>>>24)<=L);){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}if(!(240&At)){for(bt=rt,Bt=At,yt=lt;At=(Yt=_.distcode[yt+((A&(1<<bt+Bt)-1)>>bt)])>>>16&255,lt=65535&Yt,!(bt+(rt=Yt>>>24)<=L);){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}A>>>=bt,L-=bt,_.back+=bt}if(A>>>=rt,L-=rt,_.back+=rt,64&At){b.msg="invalid distance code",_.mode=R;break}_.offset=lt,_.extra=15&At,_.mode=24;case 24:if(_.extra){for(qt=_.extra;L<qt;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}_.offset+=A&(1<<_.extra)-1,A>>>=_.extra,L-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){b.msg="invalid distance too far back",_.mode=R;break}_.mode=25;case 25:if(mt===0)break t;if(st=B-mt,_.offset>st){if((st=_.offset-st)>_.whave&&_.sane){b.msg="invalid distance too far back",_.mode=R;break}st>_.wnext?(st-=_.wnext,M=_.wsize-st):M=_.wnext-st,st>_.length&&(st=_.length),tt=_.window}else tt=gt,M=Et-_.offset,st=_.length;st>mt&&(st=mt),mt-=st,_.length-=st;do gt[Et++]=tt[M++];while(--st);_.length===0&&(_.mode=21);break;case 26:if(mt===0)break t;gt[Et++]=_.length,mt--,_.mode=21;break;case 27:if(_.wrap){for(;L<32;){if(at===0)break t;at--,A|=ct[ot++]<<L,L+=8}if(B-=mt,b.total_out+=B,_.total+=B,B&&(b.adler=_.check=_.flags?K(_.check,gt,B,Et-B):S(_.check,gt,B,Et-B)),B=mt,(_.flags?A:O(A))!==_.check){b.msg="incorrect data check",_.mode=R;break}A=0,L=0}_.mode=28;case 28:if(_.wrap&&_.flags){for(;L<32;){if(at===0)break t;at--,A+=ct[ot++]<<L,L+=8}if(A!==(4294967295&_.total)){b.msg="incorrect length check",_.mode=R;break}A=0,L=0}_.mode=29;case 29:Mt=1;break t;case R:Mt=-3;break t;case 31:return-4;default:return P}return b.next_out=Et,b.avail_out=mt,b.next_in=ot,b.avail_in=at,_.hold=A,_.bits=L,(_.wsize||B!==b.avail_out&&_.mode<R&&(_.mode<27||N!==4))&&k(b,b.output,b.next_out,B-b.avail_out)?(_.mode=31,-4):(nt-=b.avail_in,B-=b.avail_out,b.total_in+=nt,b.total_out+=B,_.total+=B,_.wrap&&B&&(b.adler=_.check=_.flags?K(_.check,gt,B,b.next_out-B):S(_.check,gt,B,b.next_out-B)),b.data_type=_.bits+(_.last?64:0)+(_.mode===V?128:0)+(_.mode===20||_.mode===15?256:0),(nt===0&&B===0||N===4)&&Mt===0&&(Mt=-5),Mt)},E.inflateEnd=function(b){if(!b||!b.state)return P;var N=b.state;return N.window&&(N.window=null),b.state=null,0},E.inflateGetHeader=function(b,N){var _;return b&&b.state&&2&(_=b.state).wrap?(_.head=N,N.done=!1,0):P},E.inflateSetDictionary=function(b,N){var _,ct=N.length;return b&&b.state?(_=b.state).wrap!==0&&_.mode!==11?P:_.mode===11&&S(1,N,ct,0)!==_.check?-3:k(b,N,ct,ct)?(_.mode=31,-4):(_.havedict=1,0):P},E.inflateInfo="pako inflate (from Nodeca project)"},"./node_modules/pako/lib/zlib/inftrees.js":(q,E,T)=>{var D=T("./node_modules/pako/lib/utils/common.js"),S=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],K=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],w=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],y=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];q.exports=function(P,V,R,O,z,X,p,m){var C,v,H,Y,I,k,b,N,_,ct=m.bits,gt=0,ot=0,Et=0,at=0,mt=0,A=0,L=0,nt=0,B=0,st=0,M=null,tt=0,rt=new D.Buf16(16),At=new D.Buf16(16),lt=null,bt=0;for(gt=0;gt<=15;gt++)rt[gt]=0;for(ot=0;ot<O;ot++)rt[V[R+ot]]++;for(mt=ct,at=15;at>=1&&rt[at]===0;at--);if(mt>at&&(mt=at),at===0)return z[X++]=20971520,z[X++]=20971520,m.bits=1,0;for(Et=1;Et<at&&rt[Et]===0;Et++);for(mt<Et&&(mt=Et),nt=1,gt=1;gt<=15;gt++)if(nt<<=1,(nt-=rt[gt])<0)return-1;if(nt>0&&(P===0||at!==1))return-1;for(At[1]=0,gt=1;gt<15;gt++)At[gt+1]=At[gt]+rt[gt];for(ot=0;ot<O;ot++)V[R+ot]!==0&&(p[At[V[R+ot]]++]=ot);if(P===0?(M=lt=p,k=19):P===1?(M=S,tt-=257,lt=K,bt-=257,k=256):(M=w,lt=y,k=-1),st=0,ot=0,gt=Et,I=X,A=mt,L=0,H=-1,Y=(B=1<<mt)-1,P===1&&B>852||P===2&&B>592)return 1;for(;;){b=gt-L,p[ot]<k?(N=0,_=p[ot]):p[ot]>k?(N=lt[bt+p[ot]],_=M[tt+p[ot]]):(N=96,_=0),C=1<<gt-L,Et=v=1<<A;do z[I+(st>>L)+(v-=C)]=b<<24|N<<16|_|0;while(v!==0);for(C=1<<gt-1;st&C;)C>>=1;if(C!==0?(st&=C-1,st+=C):st=0,ot++,--rt[gt]==0){if(gt===at)break;gt=V[R+p[ot]]}if(gt>mt&&(st&Y)!==H){for(L===0&&(L=mt),I+=Et,nt=1<<(A=gt-L);A+L<at&&!((nt-=rt[A+L])<=0);)A++,nt<<=1;if(B+=1<<A,P===1&&B>852||P===2&&B>592)return 1;z[H=st&Y]=mt<<24|A<<16|I-X|0}}return st!==0&&(z[I+st]=gt-L<<24|4194304|0),m.bits=mt,0}},"./node_modules/pako/lib/zlib/messages.js":q=>{q.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},"./node_modules/pako/lib/zlib/trees.js":(q,E,T)=>{var D=T("./node_modules/pako/lib/utils/common.js");function S(M){for(var tt=M.length;--tt>=0;)M[tt]=0}var K=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],w=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=new Array(576);S(V);var R=new Array(60);S(R);var O=new Array(512);S(O);var z=new Array(256);S(z);var X=new Array(29);S(X);var p,m,C,v=new Array(30);function H(M,tt,rt,At,lt){this.static_tree=M,this.extra_bits=tt,this.extra_base=rt,this.elems=At,this.max_length=lt,this.has_stree=M&&M.length}function Y(M,tt){this.dyn_tree=M,this.max_code=0,this.stat_desc=tt}function I(M){return M<256?O[M]:O[256+(M>>>7)]}function k(M,tt){M.pending_buf[M.pending++]=255&tt,M.pending_buf[M.pending++]=tt>>>8&255}function b(M,tt,rt){M.bi_valid>16-rt?(M.bi_buf|=tt<<M.bi_valid&65535,k(M,M.bi_buf),M.bi_buf=tt>>16-M.bi_valid,M.bi_valid+=rt-16):(M.bi_buf|=tt<<M.bi_valid&65535,M.bi_valid+=rt)}function N(M,tt,rt){b(M,rt[2*tt],rt[2*tt+1])}function _(M,tt){var rt=0;do rt|=1&M,M>>>=1,rt<<=1;while(--tt>0);return rt>>>1}function ct(M,tt,rt){var At,lt,bt=new Array(16),Bt=0;for(At=1;At<=15;At++)bt[At]=Bt=Bt+rt[At-1]<<1;for(lt=0;lt<=tt;lt++){var yt=M[2*lt+1];yt!==0&&(M[2*lt]=_(bt[yt]++,yt))}}function gt(M){var tt;for(tt=0;tt<286;tt++)M.dyn_ltree[2*tt]=0;for(tt=0;tt<30;tt++)M.dyn_dtree[2*tt]=0;for(tt=0;tt<19;tt++)M.bl_tree[2*tt]=0;M.dyn_ltree[512]=1,M.opt_len=M.static_len=0,M.last_lit=M.matches=0}function ot(M){M.bi_valid>8?k(M,M.bi_buf):M.bi_valid>0&&(M.pending_buf[M.pending++]=M.bi_buf),M.bi_buf=0,M.bi_valid=0}function Et(M,tt,rt,At){var lt=2*tt,bt=2*rt;return M[lt]<M[bt]||M[lt]===M[bt]&&At[tt]<=At[rt]}function at(M,tt,rt){for(var At=M.heap[rt],lt=rt<<1;lt<=M.heap_len&&(lt<M.heap_len&&Et(tt,M.heap[lt+1],M.heap[lt],M.depth)&&lt++,!Et(tt,At,M.heap[lt],M.depth));)M.heap[rt]=M.heap[lt],rt=lt,lt<<=1;M.heap[rt]=At}function mt(M,tt,rt){var At,lt,bt,Bt,yt=0;if(M.last_lit!==0)do At=M.pending_buf[M.d_buf+2*yt]<<8|M.pending_buf[M.d_buf+2*yt+1],lt=M.pending_buf[M.l_buf+yt],yt++,At===0?N(M,lt,tt):(N(M,(bt=z[lt])+256+1,tt),(Bt=K[bt])!==0&&b(M,lt-=X[bt],Bt),N(M,bt=I(--At),rt),(Bt=w[bt])!==0&&b(M,At-=v[bt],Bt));while(yt<M.last_lit);N(M,256,tt)}function A(M,tt){var rt,At,lt,bt=tt.dyn_tree,Bt=tt.stat_desc.static_tree,yt=tt.stat_desc.has_stree,kt=tt.stat_desc.elems,Mt=-1;for(M.heap_len=0,M.heap_max=573,rt=0;rt<kt;rt++)bt[2*rt]!==0?(M.heap[++M.heap_len]=Mt=rt,M.depth[rt]=0):bt[2*rt+1]=0;for(;M.heap_len<2;)bt[2*(lt=M.heap[++M.heap_len]=Mt<2?++Mt:0)]=1,M.depth[lt]=0,M.opt_len--,yt&&(M.static_len-=Bt[2*lt+1]);for(tt.max_code=Mt,rt=M.heap_len>>1;rt>=1;rt--)at(M,bt,rt);lt=kt;do rt=M.heap[1],M.heap[1]=M.heap[M.heap_len--],at(M,bt,1),At=M.heap[1],M.heap[--M.heap_max]=rt,M.heap[--M.heap_max]=At,bt[2*lt]=bt[2*rt]+bt[2*At],M.depth[lt]=(M.depth[rt]>=M.depth[At]?M.depth[rt]:M.depth[At])+1,bt[2*rt+1]=bt[2*At+1]=lt,M.heap[1]=lt++,at(M,bt,1);while(M.heap_len>=2);M.heap[--M.heap_max]=M.heap[1],function(Wt,qt){var Yt,Kt,Fe,ee,Ue,Ze,ye=qt.dyn_tree,Ui=qt.max_code,ji=qt.stat_desc.static_tree,$e=qt.stat_desc.has_stree,ti=qt.stat_desc.extra_bits,pi=qt.stat_desc.extra_base,fe=qt.stat_desc.max_length,ei=0;for(ee=0;ee<=15;ee++)Wt.bl_count[ee]=0;for(ye[2*Wt.heap[Wt.heap_max]+1]=0,Yt=Wt.heap_max+1;Yt<573;Yt++)(ee=ye[2*ye[2*(Kt=Wt.heap[Yt])+1]+1]+1)>fe&&(ee=fe,ei++),ye[2*Kt+1]=ee,Kt>Ui||(Wt.bl_count[ee]++,Ue=0,Kt>=pi&&(Ue=ti[Kt-pi]),Ze=ye[2*Kt],Wt.opt_len+=Ze*(ee+Ue),$e&&(Wt.static_len+=Ze*(ji[2*Kt+1]+Ue)));if(ei!==0){do{for(ee=fe-1;Wt.bl_count[ee]===0;)ee--;Wt.bl_count[ee]--,Wt.bl_count[ee+1]+=2,Wt.bl_count[fe]--,ei-=2}while(ei>0);for(ee=fe;ee!==0;ee--)for(Kt=Wt.bl_count[ee];Kt!==0;)(Fe=Wt.heap[--Yt])>Ui||(ye[2*Fe+1]!==ee&&(Wt.opt_len+=(ee-ye[2*Fe+1])*ye[2*Fe],ye[2*Fe+1]=ee),Kt--)}}(M,tt),ct(bt,Mt,M.bl_count)}function L(M,tt,rt){var At,lt,bt=-1,Bt=tt[1],yt=0,kt=7,Mt=4;for(Bt===0&&(kt=138,Mt=3),tt[2*(rt+1)+1]=65535,At=0;At<=rt;At++)lt=Bt,Bt=tt[2*(At+1)+1],++yt<kt&&lt===Bt||(yt<Mt?M.bl_tree[2*lt]+=yt:lt!==0?(lt!==bt&&M.bl_tree[2*lt]++,M.bl_tree[32]++):yt<=10?M.bl_tree[34]++:M.bl_tree[36]++,yt=0,bt=lt,Bt===0?(kt=138,Mt=3):lt===Bt?(kt=6,Mt=3):(kt=7,Mt=4))}function nt(M,tt,rt){var At,lt,bt=-1,Bt=tt[1],yt=0,kt=7,Mt=4;for(Bt===0&&(kt=138,Mt=3),At=0;At<=rt;At++)if(lt=Bt,Bt=tt[2*(At+1)+1],!(++yt<kt&&lt===Bt)){if(yt<Mt)do N(M,lt,M.bl_tree);while(--yt!=0);else lt!==0?(lt!==bt&&(N(M,lt,M.bl_tree),yt--),N(M,16,M.bl_tree),b(M,yt-3,2)):yt<=10?(N(M,17,M.bl_tree),b(M,yt-3,3)):(N(M,18,M.bl_tree),b(M,yt-11,7));yt=0,bt=lt,Bt===0?(kt=138,Mt=3):lt===Bt?(kt=6,Mt=3):(kt=7,Mt=4)}}S(v);var B=!1;function st(M,tt,rt,At){b(M,0+(At?1:0),3),function(lt,bt,Bt,yt){ot(lt),k(lt,Bt),k(lt,~Bt),D.arraySet(lt.pending_buf,lt.window,bt,Bt,lt.pending),lt.pending+=Bt}(M,tt,rt)}E._tr_init=function(M){B||(function(){var tt,rt,At,lt,bt,Bt=new Array(16);for(At=0,lt=0;lt<28;lt++)for(X[lt]=At,tt=0;tt<1<<K[lt];tt++)z[At++]=lt;for(z[At-1]=lt,bt=0,lt=0;lt<16;lt++)for(v[lt]=bt,tt=0;tt<1<<w[lt];tt++)O[bt++]=lt;for(bt>>=7;lt<30;lt++)for(v[lt]=bt<<7,tt=0;tt<1<<w[lt]-7;tt++)O[256+bt++]=lt;for(rt=0;rt<=15;rt++)Bt[rt]=0;for(tt=0;tt<=143;)V[2*tt+1]=8,tt++,Bt[8]++;for(;tt<=255;)V[2*tt+1]=9,tt++,Bt[9]++;for(;tt<=279;)V[2*tt+1]=7,tt++,Bt[7]++;for(;tt<=287;)V[2*tt+1]=8,tt++,Bt[8]++;for(ct(V,287,Bt),tt=0;tt<30;tt++)R[2*tt+1]=5,R[2*tt]=_(tt,5);p=new H(V,K,257,286,15),m=new H(R,w,0,30,15),C=new H(new Array(0),y,0,19,7)}(),B=!0),M.l_desc=new Y(M.dyn_ltree,p),M.d_desc=new Y(M.dyn_dtree,m),M.bl_desc=new Y(M.bl_tree,C),M.bi_buf=0,M.bi_valid=0,gt(M)},E._tr_stored_block=st,E._tr_flush_block=function(M,tt,rt,At){var lt,bt,Bt=0;M.level>0?(M.strm.data_type===2&&(M.strm.data_type=function(yt){var kt,Mt=4093624447;for(kt=0;kt<=31;kt++,Mt>>>=1)if(1&Mt&&yt.dyn_ltree[2*kt]!==0)return 0;if(yt.dyn_ltree[18]!==0||yt.dyn_ltree[20]!==0||yt.dyn_ltree[26]!==0)return 1;for(kt=32;kt<256;kt++)if(yt.dyn_ltree[2*kt]!==0)return 1;return 0}(M)),A(M,M.l_desc),A(M,M.d_desc),Bt=function(yt){var kt;for(L(yt,yt.dyn_ltree,yt.l_desc.max_code),L(yt,yt.dyn_dtree,yt.d_desc.max_code),A(yt,yt.bl_desc),kt=18;kt>=3&&yt.bl_tree[2*P[kt]+1]===0;kt--);return yt.opt_len+=3*(kt+1)+5+5+4,kt}(M),lt=M.opt_len+3+7>>>3,(bt=M.static_len+3+7>>>3)<=lt&&(lt=bt)):lt=bt=rt+5,rt+4<=lt&&tt!==-1?st(M,tt,rt,At):M.strategy===4||bt===lt?(b(M,2+(At?1:0),3),mt(M,V,R)):(b(M,4+(At?1:0),3),function(yt,kt,Mt,Wt){var qt;for(b(yt,kt-257,5),b(yt,Mt-1,5),b(yt,Wt-4,4),qt=0;qt<Wt;qt++)b(yt,yt.bl_tree[2*P[qt]+1],3);nt(yt,yt.dyn_ltree,kt-1),nt(yt,yt.dyn_dtree,Mt-1)}(M,M.l_desc.max_code+1,M.d_desc.max_code+1,Bt+1),mt(M,M.dyn_ltree,M.dyn_dtree)),gt(M),At&&ot(M)},E._tr_tally=function(M,tt,rt){return M.pending_buf[M.d_buf+2*M.last_lit]=tt>>>8&255,M.pending_buf[M.d_buf+2*M.last_lit+1]=255&tt,M.pending_buf[M.l_buf+M.last_lit]=255&rt,M.last_lit++,tt===0?M.dyn_ltree[2*rt]++:(M.matches++,tt--,M.dyn_ltree[2*(z[rt]+256+1)]++,M.dyn_dtree[2*I(tt)]++),M.last_lit===M.lit_bufsize-1},E._tr_align=function(M){b(M,2,3),N(M,256,V),function(tt){tt.bi_valid===16?(k(tt,tt.bi_buf),tt.bi_buf=0,tt.bi_valid=0):tt.bi_valid>=8&&(tt.pending_buf[tt.pending++]=255&tt.bi_buf,tt.bi_buf>>=8,tt.bi_valid-=8)}(M)}},"./node_modules/pako/lib/zlib/zstream.js":q=>{q.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},"./node_modules/strnum/strnum.js":q=>{const E=/^[-+]?0x[a-fA-F0-9]+$/,T=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/,D={hex:!0,leadingZeros:!0,decimalPoint:"."};q.exports=function(S,K={}){if(K=Object.assign({},D,K),!S||typeof S!="string")return S;let w=S.trim();if(K.skipLike!==void 0&&K.skipLike.test(w))return S;if(K.hex&&E.test(w))return Number.parseInt(w,16);{const y=T.exec(w);if(y){y[1];const P=y[2],V=y[3];return y[4]||y[6],P.length===1&&V[0]==="."?Number(S):!K.leadingZeros&&P.length>0?S:Number(w)}return S}}},"./src/index.ts":(q,E,T)=>{T.r(E),T.d(E,{FLIPPED_DIAGONALLY_FLAG:()=>w.FLIPPED_DIAGONALLY_FLAG,FLIPPED_HORIZONTALLY_FLAG:()=>w.FLIPPED_HORIZONTALLY_FLAG,FLIPPED_VERTICALLY_FLAG:()=>w.FLIPPED_VERTICALLY_FLAG,TiledEntity:()=>K.TiledEntity,TiledLayer:()=>w.TiledLayer,TiledLayerComponent:()=>R.TiledLayerComponent,TiledMap:()=>S.TiledMap,TiledMapFormat:()=>D.TiledMapFormat,TiledMapResource:()=>D.TiledMapResource,TiledObject:()=>y.TiledObject,TiledObjectComponent:()=>V.TiledObjectComponent,TiledObjectGroup:()=>y.TiledObjectGroup,TiledTileset:()=>P.TiledTileset,TiledTilesetTile:()=>P.TiledTilesetTile,getCanonicalGid:()=>w.getCanonicalGid,getProperty:()=>K.getProperty,isFlippedDiagonally:()=>w.isFlippedDiagonally,isFlippedHorizontally:()=>w.isFlippedHorizontally,isFlippedVertically:()=>w.isFlippedVertically,parseExternalJson:()=>P.parseExternalJson,parseExternalTsx:()=>P.parseExternalTsx}),T("./src/tiled-types.ts");var D=T("./src/tiled-map-resource.ts"),S=T("./src/tiled-map-parser.ts"),K=T("./src/tiled-entity.ts"),w=T("./src/tiled-layer.ts"),y=T("./src/tiled-object.ts"),P=T("./src/tiled-tileset.ts"),V=T("./src/tiled-object-component.ts"),R=T("./src/tiled-layer-component.ts");T("./src/raw-tiled-layer.ts"),T("./src/raw-tiled-map.ts"),T("./src/raw-tiled-object.ts"),T("./src/raw-tiled-text.ts"),T("./src/raw-tiled-tileset.ts"),T("./src/raw-tileset-tile.ts")},"./src/raw-tiled-layer.ts":(q,E,T)=>{T.r(E)},"./src/raw-tiled-map.ts":(q,E,T)=>{T.r(E)},"./src/raw-tiled-object.ts":(q,E,T)=>{T.r(E)},"./src/raw-tiled-text.ts":(q,E,T)=>{T.r(E)},"./src/raw-tiled-tileset.ts":(q,E,T)=>{T.r(E)},"./src/raw-tileset-tile.ts":(q,E,T)=>{T.r(E)},"./src/tiled-entity.ts":(q,E,T)=>{T.r(E),T.d(E,{TiledEntity:()=>S,getProperty:()=>D});const D=(K,w)=>{if(Array.isArray(K))return K==null?void 0:K.filter(y=>{var P;return((P=y.name)===null||P===void 0?void 0:P.toLocaleLowerCase())===w.toLocaleLowerCase()})[0]};class S{constructor(){this.properties=[]}getProperty(w){return D(this.properties,w)}}},"./src/tiled-layer-component.ts":(q,E,T)=>{T.r(E),T.d(E,{TiledLayerComponent:()=>S});var D=T("excalibur");class S extends D.Component{constructor(w){super(),this.layer=w,this.type="ex.tiledlayer"}}},"./src/tiled-layer.ts":(q,E,T)=>{T.r(E),T.d(E,{FLIPPED_DIAGONALLY_FLAG:()=>y,FLIPPED_HORIZONTALLY_FLAG:()=>K,FLIPPED_VERTICALLY_FLAG:()=>w,TiledLayer:()=>z,getCanonicalGid:()=>O,isFlippedDiagonally:()=>R,isFlippedHorizontally:()=>P,isFlippedVertically:()=>V});var D=T("./src/tiled-entity.ts"),S=T("excalibur");const K=2147483648,w=1073741824,y=536870912,P=X=>!!(X&K),V=X=>!!(X&w),R=X=>!!(X&y),O=X=>X&~(K|w|y);class z extends D.TiledEntity{constructor(){super(...arguments),this.offset=S.Vector.Zero,this.parallaxFactor=null,this.encoding="csv"}static parse(p){var m,C,v,H,Y,I;if(p.type!=="tilelayer")throw Error("Cannot parse a non tilelayer type layer");const k=new z;return k.id=+p.id,k.name=p.name,k.data=p.data,k.offset=(0,S.vec)((m=p.offsetx)!==null&&m!==void 0?m:0,(C=p.offsety)!==null&&C!==void 0?C:0),k.parallaxFactor=p.parallaxx||p.parallaxy?(0,S.vec)((v=p.parallaxx)!==null&&v!==void 0?v:1,(H=p.parallaxy)!==null&&H!==void 0?H:1):null,k.width=p.width,k.height=p.height,k.encoding=(Y=p.encoding)!==null&&Y!==void 0?Y:"csv",k.compression=p.compression,k.order=p.order,k.properties=(I=p.properties)!==null&&I!==void 0?I:[],k.rawLayer=p,k}}},"./src/tiled-map-parser.ts":(q,E,T)=>{T.r(E),T.d(E,{TiledMap:()=>R});var D=T("./node_modules/fast-xml-parser/src/parser.js"),S=T("./node_modules/pako/index.js"),K=T("./node_modules/zstddec/dist/zstddec.modern.js"),w=T("./src/tiled-layer.ts"),y=T("./src/tiled-object.ts"),P=T("./src/tiled-tileset.ts"),V=function(X,p,m,C){return new(m||(m=Promise))(function(v,H){function Y(b){try{k(C.next(b))}catch(N){H(N)}}function I(b){try{k(C.throw(b))}catch(N){H(N)}}function k(b){var N;b.done?v(b.value):(N=b.value,N instanceof m?N:new m(function(_){_(N)})).then(Y,I)}k((C=C.apply(X,p||[])).next())})};class R{constructor(){this.layers=[],this.tileSets=[],this.objectGroups=[]}getExcaliburObjects(){return this.getObjectLayerByProperty("excalibur",!0)}getObjectLayerByName(p){return this.objectGroups.filter(m=>m.name===p)[0]}getObjectLayerByProperty(p,m){return this.objectGroups.filter(C=>{var v;return((v=C.getProperty(p))===null||v===void 0?void 0:v.value)===m})}getTileLayerByName(p){return this.layers.filter(m=>m.name===p)[0]}getTileLayersByProperty(p,m){return this.layers.filter(C=>{var v;return((v=C.getProperty(p))===null||v===void 0?void 0:v.value)===m})}static fromTmx(p){var m,C,v,H,Y,I,k,b,N,_,ct,gt,ot,Et,at,mt;return V(this,void 0,void 0,function*(){const A=(B,st,M=!1)=>{B[st]?(B[st+(M?"s":"")]=Array.isArray(B[st])?B[st]:[B[st]],M&&delete B[st]):B[st+(M?"s":"")]=[]},L=D.parse(p,{attributeNamePrefix:"",textNodeName:"#text",ignoreAttributes:!1,ignoreNameSpace:!1,allowBooleanAttributes:!0,parseNodeValue:!0,parseAttributeValue:!0,trimValues:!0,parseTrueNumberOnly:!1,arrayMode:!1,stopNodes:["parse-me-as-string"]}).map;A(L,"layer",!0);for(let B of L.layers)B.type=(m=B.type)!==null&&m!==void 0?m:"tilelayer",B.encoding=B.data.encoding,B.compression=B.data.compression,B.encoding==="csv"?B.data=B.data["#text"].split(",").map(st=>+st):B.data=B.data["#text"],B.properties=(v=(C=B.properties)===null||C===void 0?void 0:C.property)!==null&&v!==void 0?v:[],A(B,"properties");L.objectgroup=(H=L.objectgroup)!==null&&H!==void 0?H:[];let nt=Array.isArray(L.objectgroup)?L.objectgroup:[L.objectgroup];for(let B of nt){B.type=(Y=B.type)!==null&&Y!==void 0?Y:"objectgroup",B.objects=Array.isArray(B.object)?B.object:[B.object],B.objects.forEach(st=>{var M,tt;return st.properties=(tt=(M=st.properties)===null||M===void 0?void 0:M.property)!==null&&tt!==void 0?tt:[]}),B.objects.forEach(st=>A(st,"properties")),B.properties=(k=(I=B.properties)===null||I===void 0?void 0:I.property)!==null&&k!==void 0?k:[],A(B,"properties"),delete B.object;for(let st of B.objects)st.text&&(st.text.text=st.text["#text"],st.text.halign=(b=st.text.halign)!==null&&b!==void 0?b:"left",st.text.valign=(N=st.text.valign)!==null&&N!==void 0?N:"top",st.text.fontfamily=(_=st.text.fontfamily)!==null&&_!==void 0?_:"sans-serif",st.text.pixelsize=+((ct=st.text.pixelsize)!==null&&ct!==void 0?ct:16),st.text.kerning=!!st.text.kerning,st.text.italic=!!st.text.italic,st.text.bold=!!st.text.bold,st.text.underline=!!st.text.underline,st.text.strikeout=!!st.text.strikeout,st.text.color=(gt=st.text.color)!==null&&gt!==void 0?gt:"#000000"),st.point===""&&(st.point=!0),st.ellipse===""&&(st.ellipse=!0),st.polyline&&(st.polyline=st.polyline.points.split(" ").map(M=>{const tt=M.split(",");return{x:+tt[0],y:+tt[1]}})),st.polygon&&(st.polygon=st.polygon.points.split(" ").map(M=>{const tt=M.split(",");return{x:+tt[0],y:+tt[1]}}));L.layers.push(B)}delete L.objectgroup,A(L,"imagelayer",!0);for(let B of L.imagelayers)B.type=(ot=B.type)!==null&&ot!==void 0?ot:"imagelayer",B.image=B.image.source,B.properties=(at=(Et=B.properties)===null||Et===void 0?void 0:Et.property)!==null&&at!==void 0?at:[],A(B,"properties"),L.layers.push(B);delete L.imagelayer,A(L,"tileset",!0);for(let B of L.tilesets)B.source||(B.image&&(B.imagewidth=B.image.width,B.imageheight=B.image.height,B.image=B.image.source),B.objectalignment=(mt=B.objectalignment)!==null&&mt!==void 0?mt:"unspecified",A(B,"tile",!0),B.tiles.forEach(st=>{var M;!((M=st.image)===null||M===void 0)&&M.source&&(st.image=st.image.source),st.objectgroup&&(st.objectgroup.type="objectgroup",A(st.objectgroup,"object",!0))}));return yield R._fromRawTiledMap(L)})}static fromJson(p){return V(this,void 0,void 0,function*(){return yield R._fromRawTiledMap(p)})}static _fromRawTiledMap(p){return V(this,void 0,void 0,function*(){yield R._decompresslayers(p);const m=new R;m.orientation=p.orientation,m.rawMap=p,m.width=+p.width,m.height=+p.height,m.tileWidth=+p.tilewidth,m.tileHeight=+p.tileheight,O(p);for(let C of p.layers)C.type=="tilelayer"&&m.layers.push(w.TiledLayer.parse(C)),C.type=="objectgroup"&&m.objectGroups.push(y.TiledObjectGroup.parse(C));for(let C of p.tilesets)C.source||m.tileSets.push(P.TiledTileset.parse(C));return m})}static _decompresslayers(p){var m;return V(this,void 0,void 0,function*(){if(p.layers)for(var C of p.layers)typeof C.data=="string"?C.encoding==="base64"&&(C.data=yield z.decompressBase64(C.data,C.encoding,(m=C.compression)!==null&&m!==void 0?m:"")):C.data=z.decompressCsv(C.data);return p})}}const O=X=>{let p=0;for(let m of X.layers)m.order=p++},z={decompressCsv:X=>X,decompressBase64:(X,p,m)=>{var C,v,H,Y,I,k;if(X.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var b="+".charCodeAt(0),N="/".charCodeAt(0),_="0".charCodeAt(0),ct="a".charCodeAt(0),gt="A".charCodeAt(0),ot="-".charCodeAt(0),Et="_".charCodeAt(0);function at(nt){var B=nt.charCodeAt(0);if(B===b||B===ot)return 62;if(B===N||B===Et)return 63;if(B<_)return-1;if(B<_+10)return B-_+26+26;if(B<gt+26)return B-gt;if(B<ct+26)return B-ct+26;throw Error("Could not decode elt")}var mt=X.length;I=X.charAt(mt-2)==="="?2:X.charAt(mt-1)==="="?1:0,k=new Uint8Array(3*X.length/4-I),H=I>0?X.length-4:X.length;var A=0;function L(nt){k[A++]=nt}for(C=0,v=0;C<H;C+=4,v+=3)L((16711680&(Y=at(X.charAt(C))<<18|at(X.charAt(C+1))<<12|at(X.charAt(C+2))<<6|at(X.charAt(C+3))))>>16),L((65280&Y)>>8),L(255&Y);return I===2?L(255&(Y=at(X.charAt(C))<<2|at(X.charAt(C+1))>>4)):I===1&&(L((Y=at(X.charAt(C))<<10|at(X.charAt(C+1))<<4|at(X.charAt(C+2))>>2)>>8&255),L(255&Y)),new Promise(nt=>{const B=function(tt){for(var rt=0,At=tt.length-1;At>=0;At--)rt=256*rt+1*tt[At];return rt};if(m==="zlib"||m==="gzip"){var st=(k=(0,S.inflate)(k)).length/4,M=new Array(st);for(C=0;C<st;C++)M[C]=B(k.slice(4*C,4*C+4));nt(M)}if(m==="zstd"){const tt=new K.ZSTDDecoder;tt.init().then(()=>{var rt=(k=tt.decode(k)).length/4,At=new Array(rt);for(C=0;C<rt;C++)At[C]=B(k.slice(4*C,4*C+4));nt(At)})}if(!m){for(st=k.length/4,M=new Array(st),C=0;C<st;C++)M[C]=B(k.slice(4*C,4*C+4));nt(M)}})}}},"./src/tiled-map-resource.ts":(q,E,T)=>{T.r(E),T.d(E,{TiledMapFormat:()=>D,TiledMapResource:()=>z});var D,S=T("excalibur"),K=T("./src/tiled-map-parser.ts"),w=T("./src/tiled-tileset.ts"),y=T("./src/tiled-layer.ts"),P=T("./src/tiled-entity.ts"),V=T("./src/tiled-object-component.ts"),R=T("./src/tiled-layer-component.ts"),O=function(X,p,m,C){return new(m||(m=Promise))(function(v,H){function Y(b){try{k(C.next(b))}catch(N){H(N)}}function I(b){try{k(C.throw(b))}catch(N){H(N)}}function k(b){var N;b.done?v(b.value):(N=b.value,N instanceof m?N:new m(function(_){_(N)})).then(Y,I)}k((C=C.apply(X,p||[])).next())})};(function(X){X.TMX="TMX",X.JSON="JSON"})(D||(D={}));class z{constructor(p,m){this.path=p,this.layers=[],this.isoLayers=[],this._layerZIndexStart=-1,this._mapToRawLayer=new Map;const{mapFormatOverride:C,startingLayerZIndex:v}=Object.assign({},m);this._layerZIndexStart=v??this._layerZIndexStart;const H=C??(p.includes(".tmx")?D.TMX:D.JSON);switch(H){case D.TMX:this._resource=new S.Resource(p,"text");break;case D.JSON:this._resource=new S.Resource(p,"json");break;default:throw`The format ${H} is not currently supported. Please export Tiled map as JSON.`}this.mapFormat=H,this.ex={},this.imageMap={},this.sheetMap={},this.tileImageMap={},this.convertPath=(Y,I)=>{if(I.indexOf("/")===0)return I;const k=Y.split("/"),b=I.split("/");return k[k.length-1].includes(".")&&k.pop(),k.concat(b).join("/")}}_addTiledCamera(p){const m=this.ex.camera;m&&(p.camera.x=m.x,p.camera.y=m.y,p.camera.zoom=m.zoom)}_addTiledColliders(p){var m;const C=this.ex.colliders;if(C)for(let v of C){const H=new S.Actor({pos:(0,S.vec)(v.x,v.y),name:v.name,collisionType:(m=v.collisionType)!==null&&m!==void 0?m:S.CollisionType.Fixed});v.color&&(H.color=S.Color.fromHex(v.color.value)),v.type==="box"&&H.collider.useBoxCollider(v.width,v.height,S.Vector.Zero),v.type==="circle"&&H.collider.useCircleCollider(v.radius),H.addComponent(new V.TiledObjectComponent(v.tiled)),p.add(H),v.zIndex&&(H.z=v.zIndex)}}_addTiledText(p){var m,C,v,H,Y,I,k,b,N,_,ct,gt;const ot=(m=this.data)===null||m===void 0?void 0:m.getExcaliburObjects();if(ot.length>0)for(const Et of ot){const at=Et.getText();for(const mt of at){const A=new S.Label({x:mt.x,y:mt.y+(((C=mt.height)!==null&&C!==void 0?C:0)-((H=(v=mt.text)===null||v===void 0?void 0:v.pixelSize)!==null&&H!==void 0?H:0)),text:(I=(Y=mt.text)===null||Y===void 0?void 0:Y.text)!==null&&I!==void 0?I:"",name:this._getEntityName(mt),font:new S.Font({family:(k=mt.text)===null||k===void 0?void 0:k.fontFamily,size:(b=mt.text)===null||b===void 0?void 0:b.pixelSize,unit:S.FontUnit.Px})});A.font.textAlign=S.TextAlign.Left,A.font.baseAlign=S.BaseAlign.Top,A.rotation=mt.rotation,A.color=S.Color.fromHex((_=(N=mt.text)===null||N===void 0?void 0:N.color)!==null&&_!==void 0?_:"#000000"),A.collider.set(S.Shape.Box((ct=mt.width)!==null&&ct!==void 0?ct:0,(gt=mt.height)!==null&&gt!==void 0?gt:0)),A.addComponent(new V.TiledObjectComponent(mt)),p.add(A),A.z=this._calculateZIndex(mt,Et)}}}_addTiledInsertedTiles(p){var m;const C=(m=this.data)===null||m===void 0?void 0:m.getExcaliburObjects();if(C.length>0)for(const v of C){const H=v.getInsertedTiles();for(const Y of H){const I=Y.getProperty("collisionType");let k=S.CollisionType.PreventCollision;if(I&&(k=I.value),Y.gid){const b=this.getSpriteForGid(Y.gid),N=this.getCollidersForGid(Y.gid),_=new S.Actor({x:Y.x,y:Y.y,width:Y.width,height:Y.height,anchor:(0,S.vec)(0,1),rotation:Y.rotation,collisionType:k,name:this._getEntityName(Y)});N.length&&(_.collider.clear(),_.collider.set(new S.CompositeCollider(N))),_.addComponent(new V.TiledObjectComponent(Y)),_.graphics.anchor=(0,S.vec)(0,1),_.graphics.use(b),p.add(_),_.z=this._calculateZIndex(Y,v)}}}}useSolidLayers(){var p,m,C;let v=this.getTileMapLayers();v=v.concat(this.isoLayers);for(const H of v){const Y=this._mapToRawLayer.get(H);if(Y&&(m=(p=(0,P.getProperty)(Y.properties,"solid"))===null||p===void 0?void 0:p.value)!==null&&m!==void 0&&m)for(let I=0;I<Y.data.length;I++)(C=H.tiles[I]).solid||(C.solid=!!Y.data[I])}}addTiledMapToScene(p){const m=this.getTileMapLayers();for(const C of m)p.add(C);for(const C of this.isoLayers)p.add(C);this._addTiledCamera(p),this._addTiledColliders(p),this._addTiledText(p),this._addTiledInsertedTiles(p),this.useSolidLayers()}_parseExcaliburInfo(){var p,m,C,v,H,Y,I,k,b,N;const _=(p=this.data)===null||p===void 0?void 0:p.getExcaliburObjects(),ct={};if(_.length>0){ct.camera=(m=_.find(gt=>gt.getObjectByClass("camera")))===null||m===void 0?void 0:m.getCamera(),ct.colliders=[];for(let gt of _){const ot=gt.getObjectsByClass("boxcollider");for(let at of ot){const mt=at.getProperty("collisiontype"),A=at.getProperty("color"),L=this._calculateZIndex(at,gt);ct.colliders.push(Object.assign(Object.assign({},at),{width:+((C=at.width)!==null&&C!==void 0?C:0),height:+((v=at.height)!==null&&v!==void 0?v:0),collisionType:(H=mt==null?void 0:mt.value)!==null&&H!==void 0?H:S.CollisionType.Fixed,color:A,zIndex:L,radius:0,type:"box",tiled:at,name:this._getEntityName(at)}))}const Et=gt.getObjectsByClass("circlecollider");for(let at of Et){const mt=at.getProperty("collisiontype"),A=at.getProperty("color"),L=this._calculateZIndex(at,gt);ct.colliders.push({x:at.x,y:at.y,radius:Math.max((Y=at.width)!==null&&Y!==void 0?Y:0,(I=at.height)!==null&&I!==void 0?I:0),collisionType:(k=mt==null?void 0:mt.value)!==null&&k!==void 0?k:S.CollisionType.Fixed,color:A,zIndex:L,width:(b=at.width)!==null&&b!==void 0?b:0,height:(N=at.height)!==null&&N!==void 0?N:0,type:"circle",tiled:at,name:this._getEntityName(at)})}}}this.ex=ct}isLoaded(){return!!this.data}load(){return O(this,void 0,void 0,function*(){const p=yield this._resource.load(),m=yield this._importMapData(p);let C=[];return m.rawMap.tilesets.forEach(v=>{if(v.source){const Y=v.source.includes(".tsx")?"text":"json";var H=new S.Resource(this.convertPath(this.path,v.source),Y);C.push(H.load().then(I=>{I=Y==="text"?(0,w.parseExternalTsx)(I,v.firstgid,v.source):(0,w.parseExternalJson)(I,v.firstgid,v.source),Object.assign(v,I),m.tileSets.push(I)},()=>{S.Logger.getInstance().error(`[Tiled] Error loading external tileset file ${H.path}`)}))}}),yield Promise.all(C).then(()=>{let v=[];return m.rawMap.tilesets.forEach(H=>{let Y=[];if(H.image){Y=H.source?[this.convertPath(H.source,H.image)]:[this.convertPath(this.path,H.image)];for(let I of Y){const k=new S.ImageSource(I);this.imageMap[H.firstgid]=k,v.push(k.load()),S.Logger.getInstance().debug("[Tiled] Loading associated tileset image: "+H.image)}}else for(let I of H.tiles){let k;k=H.source?this.convertPath(H.source,I.image):this.convertPath(this.path,I.image);const b=new S.ImageSource(k);v.push(b.load()),this.tileImageMap[H.firstgid]||(this.tileImageMap[H.firstgid]=[]),this.tileImageMap[H.firstgid].push([I,b]),S.Logger.getInstance().debug("[Tiled] Loading associated tileset image: "+k)}}),Promise.all(v).then(()=>{this._createTileMap()},()=>{S.Logger.getInstance().error("[Tiled] Error loading tileset images")})}),this._parseExcaliburInfo(),m})}_importMapData(p){return O(this,void 0,void 0,function*(){if(p===void 0)throw`Tiled map resource ${this.path} is empty`;switch(this.mapFormat){case D.TMX:return this.data=yield K.TiledMap.fromTmx(p);case D.JSON:return this.data=yield K.TiledMap.fromJson(p);default:throw new Error("Unknown map format: "+this.mapFormat)}})}getTilesetForTile(p){if(this.data)for(var m=this.data.tileSets.length-1;m>=0;m--){var C=this.data.tileSets[m];if(p>=C.firstGid&&p<=C.firstGid+C.tileCount-1)return C}throw Error(`No tileset exists for tiled gid [${p}]!`)}getSpriteForGid(p){const m=(0,y.isFlippedHorizontally)(p),C=(0,y.isFlippedVertically)(p),v=(0,y.isFlippedDiagonally)(p),H=(0,y.getCanonicalGid)(p),Y=this.getTilesetForTile(H),I=H-Y.firstGid,k=this.sheetMap[Y.firstGid.toString()];if(k){let b=k.sprites[I];return(v||m||C)&&(b=b.clone()),v&&(b.rotation=-Math.PI/2,b.scale=(0,S.vec)(-1,1)),m&&(b.scale=(0,S.vec)((v?1:-1)*b.scale.x,(v?-1:1)*b.scale.y)),C&&(b.scale=(0,S.vec)((v?-1:1)*b.scale.x,(v?1:-1)*b.scale.y)),b}throw new Error(`Could not find sprite for gid: [${p}] normalized gid: [${H}]`)}_transformPoints(p,m,C){const v=(0,y.isFlippedHorizontally)(C),H=(0,y.isFlippedVertically)(C);return(0,y.isFlippedDiagonally)(C)&&(p=p.map(Y=>m.diagonalFlipTransform.multiply(Y))),v&&(p=p.map(Y=>m.horizontalFlipTransform.multiply(Y))),H&&(p=p.map(Y=>m.verticalFlipTransform.multiply(Y))),p}getCollidersForGid(p){const m=(0,y.getCanonicalGid)(p),C=this.getTilesetForTile(m),v=m-C.firstGid,H=C.tiles.find(Y=>Y.id===v);if(H&&H.objectgroup){const Y=[];for(const I of H.objectgroup.getPolygons()){const k=(0,S.vec)(I.x,I.y),b=I.polygon.points.split(" ").map(_=>{const ct=_.split(",");return(0,S.vec)(Number.parseFloat(ct[0]),Number.parseFloat(ct[1])).add(k)}),N=S.Shape.Polygon(b);N.points=this._transformPoints(N.points,C,p),Y.push(N)}for(const I of H.objectgroup.getBoxes()){const k=S.Shape.Box(I.width,I.height,S.Vector.Zero);k.points=k.points.map(b=>b.add((0,S.vec)(I.x,I.y))),k.points=this._transformPoints(k.points,C,p),Y.push(k)}for(const I of H.objectgroup.getEllipses()){const k=S.Shape.Circle(Math.min(I.width/2,I.height/2),(0,S.vec)(I.width/2,I.height/2).add((0,S.vec)(I.x,I.y)));Y.push(k)}return Y}return[]}getAnimationForGid(p){const m=(0,y.getCanonicalGid)(p),C=this.getTilesetForTile(m),v=m-C.firstGid,H=C.tiles.find(Y=>Y.id===v);return H&&H.hasAnimation()?H.getAnimation(this):null}_calculateZIndex(p,m){var C,v,H;let Y=(v=(C=p.getProperty("z"))===null||C===void 0?void 0:C.value)!==null&&v!==void 0?v:(H=p.getProperty("zindex"))===null||H===void 0?void 0:H.value;return Y!=null||(Y=m.order+this._layerZIndexStart),+Y}_getEntityName(p){return p.name}_createTileMap(){var p,m,C,v,H,Y,I;for(const b of this.data.rawMap.tilesets){const N=(p=b.spacing)!==null&&p!==void 0?p:0,_=Math.floor((b.imagewidth+N)/(b.tilewidth+N)),ct=Math.floor((b.imageheight+N)/(b.tileheight+N));if(this.imageMap[b.firstgid]){const gt=S.SpriteSheet.fromImageSource({image:this.imageMap[b.firstgid],grid:{columns:_,rows:ct,spriteWidth:b.tilewidth,spriteHeight:b.tileheight},spacing:{margin:{x:(m=b.spacing)!==null&&m!==void 0?m:0,y:(C=b.spacing)!==null&&C!==void 0?C:0}}});this.sheetMap[b.firstgid.toString()]=gt}else{const gt=this.tileImageMap[b.firstgid].map(([Et,at])=>at.toSprite()),ot=new S.SpriteSheet({sprites:gt});this.sheetMap[b.firstgid.toString()]=ot}}for(var k of this.data.layers)if(k.rawLayer.type==="tilelayer"){if(this.data.orientation==="orthogonal"){const b=k.rawLayer,N=new S.TileMap({name:k.rawLayer.name,pos:(0,S.vec)(k.offset.x,k.offset.y),tileWidth:this.data.rawMap.tilewidth,tileHeight:this.data.rawMap.tileheight,columns:this.data.width,rows:this.data.height});if(N.addComponent(new R.TiledLayerComponent(k)),k.rawLayer.parallaxx||k.rawLayer.parallaxy){const _=(0,S.vec)((v=k.rawLayer.parallaxx)!==null&&v!==void 0?v:1,(H=k.rawLayer.parallaxy)!==null&&H!==void 0?H:1);N.addComponent(new S.ParallaxComponent(_))}N.z=this._calculateZIndex(k,k);for(let _=0;_<b.data.length;_++){let ct=b.data[_];if(ct!==0){const gt=this.getSpriteForGid(ct);N.tiles[_].addGraphic(gt);const ot=this.getCollidersForGid(ct);for(let at of ot)N.tiles[_].addCollider(at);const Et=this.getAnimationForGid(ct);Et&&(N.tiles[_].clearGraphics(),N.tiles[_].addGraphic(Et))}}this._mapToRawLayer.set(N,b),(Y=this.layers)===null||Y===void 0||Y.push(N)}if(this.data.orientation==="isometric"){const b=k.rawLayer,N=new S.IsometricMap({name:k.rawLayer.name,pos:(0,S.vec)(k.offset.x,k.offset.y),columns:this.data.width,rows:this.data.height,tileWidth:this.data.tileWidth,tileHeight:this.data.tileHeight}),_=N.get(S.TransformComponent);_&&(_.z=this._calculateZIndex(k,k));for(let ct=0;ct<b.data.length;ct++){let gt=b.data[ct];if(gt!==0){const ot=this.getSpriteForGid(gt);N.tiles[ct].addGraphic(ot);const Et=this.getCollidersForGid(gt);for(let mt of Et)N.tiles[ct].addCollider(mt);const at=N.tiles[ct].get(S.IsometricEntityComponent);at&&(at.elevation=k.order)}}N.updateColliders(),this._mapToRawLayer.set(N,b),(I=this.isoLayers)===null||I===void 0||I.push(N)}}}getTileMapLayers(){var p;return!((p=this.layers)===null||p===void 0)&&p.length?this.layers:[]}getIsometricMapLayers(){var p;return!((p=this.isoLayers)===null||p===void 0)&&p.length?this.isoLayers:[]}}},"./src/tiled-object-component.ts":(q,E,T)=>{T.r(E),T.d(E,{TiledObjectComponent:()=>S});var D=T("excalibur");class S extends D.Component{constructor(w){super(),this.object=w,this.type="ex.tiledobject"}}},"./src/tiled-object.ts":(q,E,T)=>{T.r(E),T.d(E,{TiledObject:()=>w,TiledObjectGroup:()=>K});var D=T("./src/tiled-entity.ts"),S=T("excalibur");class K extends D.TiledEntity{constructor(){super(...arguments),this.objects=[]}getCamera(){var P;const V=this.getObjectByClass("camera");if(V){const R=V.getProperty("zoom");return{x:V.x,y:V.y,zoom:R?+((P=R==null?void 0:R.value)!==null&&P!==void 0?P:1):1}}}getObjectByType(P){return this.getObjectsByType(P)[0]}getObjectByClass(P){return this.getObjectsByClass(P)[0]}getObjectsByType(P){return this.objects.filter(V=>{var R;return((R=V.type)===null||R===void 0?void 0:R.toLocaleLowerCase())===P.toLocaleLowerCase()})}getObjectsByClass(P){return this.objects.filter(V=>{var R;return((R=V.class)===null||R===void 0?void 0:R.toLocaleLowerCase())===P.toLocaleLowerCase()})}getObjectByName(P){return this.getObjectsByName(P)[0]}getObjectsByName(P){return this.objects.filter(V=>{var R;return((R=V.name)===null||R===void 0?void 0:R.toLocaleLowerCase())===P.toLocaleLowerCase()})}getPoints(){return this.objects.filter(P=>!!P.point)}getEllipses(){return this.objects.filter(P=>!!P.ellipse)}getText(){return this.objects.filter(P=>!!P.text)}getPolyLines(){return this.objects.filter(P=>!!P.polyline)}getPolygons(){return this.objects.filter(P=>!!P.polygon)}getBoxes(){return this.objects.filter(P=>!!P.width&&!!P.height&&!P.ellipse)}getInsertedTiles(){return this.objects.filter(P=>!!P.gid)}static parse(P){var V;if(P.type!=="objectgroup")throw Error("Cannot parse non objectgroup type layer");const R=new K;R.id=+P.id,R.name=P.name,R.properties=(V=P.properties)!==null&&V!==void 0?V:[],R.rawObjectGroup=P,R.order=P.order;for(let O of P.objects)R.objects.push(w.parse(O));return R}}class w extends D.TiledEntity{static parse(P){var V,R,O,z;const X=new w;return X.id=+P.id,X.gid=P.gid,X.visible=(V=P.visible)===null||V===void 0||V,X.name=P.name,X.type=P.type,X.class=P.class,X.x=+P.x,X.y=+P.y,X.rotation=P.rotation?(0,S.toRadians)(P.rotation):0,X.width=(R=P.width)!==null&&R!==void 0?R:0,X.height=(O=P.height)!==null&&O!==void 0?O:0,X.point=P.point,X.ellipse=P.ellipse===!0||P.ellipse==="",X.polyline=P.polyline,X.polygon=P.polygon,X.rawObject=P,P.text&&(X.text=Object.assign(Object.assign({},P.text),{pixelSize:P.text.pixelsize,fontFamily:P.text.fontfamily})),X.properties=(z=P.properties)!==null&&z!==void 0?z:[],X}}},"./src/tiled-tileset.ts":(q,E,T)=>{T.r(E),T.d(E,{TiledTileset:()=>y,TiledTilesetTile:()=>P,parseExternalJson:()=>R,parseExternalTsx:()=>V});var D=T("excalibur"),S=T("./node_modules/fast-xml-parser/src/parser.js"),K=T("./src/index.ts"),w=T("./src/tiled-entity.ts");class y{constructor(){this.tiles=[]}static parse(z){var X,p;const m=new y;let C=[];if(Array.isArray(z.tiles))C=((X=z.tiles)!==null&&X!==void 0?X:[]).map(v=>P.parse(v,m));else for(let v in z.tiles)C.push(P.parse(Object.assign(Object.assign({},z.tiles[v]),{id:+v}),m));return m.tiles=C,m.firstGid=z.firstgid,m.tileWidth=z.tilewidth,m.tileHeight=z.tileheight,m.tileCount=z.tilecount,m.tileOffset=z.tileoffset,m.tiledVersion=z.tiledversion,m.backgroundColor=z.backgroundcolor,m.transparentColor=z.transparentcolor,m.wangSets=z.wangsets,m.imageWidth=z.imagewidth,m.imageHeight=z.imageheight,m.objectAlignment=(p=z.objectalignment)!==null&&p!==void 0?p:"unspecified",m.image=z.image,m.spacing=isNaN(z.spacing)?0:z.spacing,m.horizontalFlipTransform=D.Matrix.identity().translate(m.tileWidth,0).scale(-1,1),m.verticalFlipTransform=D.Matrix.identity().translate(0,m.tileHeight).scale(1,-1),m.diagonalFlipTransform=D.Matrix.identity().translate(0,0).rotate(-Math.PI/2).scale(-1,1),m}}class P{hasAnimation(){return!!this.animation}getAnimation(z){var X;if(this.animation){let p=[];for(let m of this.animation)p.push({graphic:z.getSpriteForGid(m.tileid+this.tileset.firstGid),duration:m.duration});return new D.Animation({frames:p,strategy:(X=this.animationStrategy)!==null&&X!==void 0?X:D.AnimationStrategy.Loop})}return null}static parse(z,X){var p,m,C;const v=new P;if(v.id=+z.id,v.image=z.image,v.tileset=X,v.properties=Array.isArray(z.properties)?z.properties:(m=(p=z.properties)===null||p===void 0?void 0:p.property)!==null&&m!==void 0?m:[],z.objectgroup&&(v.objectgroup=K.TiledObjectGroup.parse(z.objectgroup)),z.terrain&&(v.terrain=z.terrain),z.animation&&(v.animation=Array.isArray(z.animation)?z.animation:[...z.animation.frame],v.properties)){const H=(C=(0,w.getProperty)(v.properties,"animationstrategy"))===null||C===void 0?void 0:C.value;switch(H==null?void 0:H.toLowerCase()){case D.AnimationStrategy.End.toLowerCase():v.animationStrategy=D.AnimationStrategy.End;break;case D.AnimationStrategy.Freeze.toLowerCase():v.animationStrategy=D.AnimationStrategy.Freeze;break;case D.AnimationStrategy.Loop.toLowerCase():v.animationStrategy=D.AnimationStrategy.Loop;break;case D.AnimationStrategy.PingPong.toLowerCase():v.animationStrategy=D.AnimationStrategy.PingPong;break;default:v.animationStrategy=D.AnimationStrategy.Loop}}return v}}const V=(O,z,X)=>{var p,m,C,v,H;const Y=(N,_,ct=!1)=>{N[_]?(N[_+(ct?"s":"")]=Array.isArray(N[_])?N[_]:[N[_]],ct&&delete N[_]):N[_+(ct?"s":"")]=[]},I=S.parse(O,{attributeNamePrefix:"",textNodeName:"#text",ignoreAttributes:!1,ignoreNameSpace:!1,allowBooleanAttributes:!0,parseNodeValue:!0,parseAttributeValue:!0,trimValues:!0,parseTrueNumberOnly:!1,arrayMode:!1,stopNodes:["parse-me-as-string"]}).tileset,k=I;k.firstgid=z,k.source=X,k.imagewidth=(p=I.image)===null||p===void 0?void 0:p.width,k.imageheight=(m=I.image)===null||m===void 0?void 0:m.height,k.objectalignment=(C=I.objectalignment)!==null&&C!==void 0?C:"unspecified",k.image=(v=I.image)===null||v===void 0?void 0:v.source,k.spacing=isNaN(I.spacing)?0:I.spacing,Y(I,"tile",!0),I.tiles.forEach(N=>{var _;!((_=N.image)===null||_===void 0)&&_.source&&(N.image=N.image.source),N.objectgroup&&(N.objectgroup.type="objectgroup",Y(N.objectgroup,"object",!0))}),k.tiles=I.tiles;const b=Object.assign(Object.assign({},k),{tiles:[],firstGid:k.firstgid,tileWidth:k.tilewidth,tileHeight:k.tileheight,tileCount:k.tilecount,tileOffset:k.tileoffset,tiledVersion:k.tiledversion,backgroundColor:k.backgroundcolor,transparentColor:k.transparentcolor,wangSets:k.wangsets,imageWidth:k.imagewidth,imageHeight:k.imageheight,objectAlignment:(H=k.objectalignment)!==null&&H!==void 0?H:"unspecified",image:k.image,spacing:isNaN(k.spacing)?0:k.spacing,horizontalFlipTransform:D.Matrix.identity().translate(k.tilewidth,0).scale(-1,1),verticalFlipTransform:D.Matrix.identity().translate(0,k.tileheight).scale(1,-1),diagonalFlipTransform:D.Matrix.identity().translate(k.tilewidth,k.tileheight).rotate(-Math.PI/2).scale(-1,1)});return b.tiles=k.tiles.map(N=>P.parse(N,b)),b},R=(O,z,X)=>{var p,m;let C=[];O.tiles=(p=O.tiles)!==null&&p!==void 0?p:[],(0,D.vec)(O.tilewidth/2,O.tileheight/2);const v=Object.assign(Object.assign({},O),{source:X,tiles:C,firstGid:z,tileWidth:O.tilewidth,tileHeight:O.tileheight,tileCount:O.tilecount,tileOffset:O.tileoffset,tiledVersion:O.tiledversion,backgroundColor:O.backgroundcolor,transparentColor:O.transparentcolor,wangSets:O.wangsets,imageWidth:O.imagewidth,imageHeight:O.imageheight,spacing:isNaN(O.spacing)?0:O.spacing,objectAlignment:(m=O.objectalignment)!==null&&m!==void 0?m:"unspecified",image:O.image,horizontalFlipTransform:D.Matrix.identity().translate(O.tilewidth,0).scale(-1,1),verticalFlipTransform:D.Matrix.identity().translate(0,O.tileheight).scale(1,-1),diagonalFlipTransform:D.Matrix.identity().translate(O.tilewidth,O.tileheight).rotate(-Math.PI/2).scale(-1,1)});for(let H in O.tiles)C.push(P.parse(Object.assign(Object.assign({},O.tiles[H]),{id:+H}),v));return v}},"./src/tiled-types.ts":(q,E,T)=>{T.r(E)},"./node_modules/zstddec/dist/zstddec.modern.js":(q,E,T)=>{let D,S,K;T.r(E),T.d(E,{ZSTDDecoder:()=>y});const w={env:{emscripten_notify_memory_growth:function(V){K=new Uint8Array(S.exports.memory.buffer)}}};class y{init(){return D||(D=typeof fetch<"u"?fetch("data:application/wasm;base64,"+P).then(R=>R.arrayBuffer()).then(R=>WebAssembly.instantiate(R,w)).then(this._init):WebAssembly.instantiate(Buffer.from(P,"base64"),w).then(this._init),D)}_init(R){S=R.instance,w.env.emscripten_notify_memory_growth(0)}decode(R,O=0){if(!S)throw new Error("ZSTDDecoder: Await .init() before decoding.");const z=R.byteLength,X=S.exports.malloc(z);K.set(R,X),O=O||Number(S.exports.ZSTD_findDecompressedSize(X,z));const p=S.exports.malloc(O),m=S.exports.ZSTD_decompress(p,O,X,z),C=K.slice(p,p+m);return S.exports.free(X),S.exports.free(p),C}}const P="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IAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQh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ASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigC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C0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdB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IAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY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wOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEE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"},excalibur:q=>{q.exports=g}},W={};function Z(q){var E=W[q];if(E!==void 0)return E.exports;var T=W[q]={exports:{}};return F[q](T,T.exports,Z),T.exports}return Z.n=q=>{var E=q&&q.__esModule?()=>q.default:()=>q;return Z.d(E,{a:E}),E},Z.d=(q,E)=>{for(var T in E)Z.o(E,T)&&!Z.o(q,T)&&Object.defineProperty(q,T,{enumerable:!0,get:E[T]})},Z.o=(q,E)=>Object.prototype.hasOwnProperty.call(q,E),Z.r=q=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(q,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(q,"__esModule",{value:!0})},Z("./src/index.ts")})())})(Nd);const qo="data:image/png;base64,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",Gd=""+new URL("blackscreen-da2d03b6.png",import.meta.url).href,zd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAABQCAYAAADSm7GJAAABvElEQVR42u3az0kDQRTA4VTgxYOQozctIIgIXm3AIjzbgCjYhi3YRcpSJvDC87GzesvO+n0w+GfXy/4yO5ONmw0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwpu3Z+VcersjK4r6/Ph/G7c3uMEReYdz9/lPkNQeO4Va9ssAxY+tMFnklG6oWt0WNrxE4Irtig4V9u7v8MabCWocHX2tz4JjF+bi4A96O8wytszhHjrgCDxD34+X+OHLkPKNz5BgPW4GHijsVOM/o2D230eJagwdZb58er4+B2/d151wjx23ae+GBHly0sDFy4IgZofOTrHbO7uriGNiz6gUHrnFy4PqQI8eN0X7OL5J4objaJwo8NWN/C5yP5bhttOM1sMgL2FhNRY7fzQXOkeN4+5v4ncADBG4jb7Da9/Xc+iKox13xEwaOGPE1r7E5cB69W7oHHwtcf/Putz5fnrs194aru6DIOUgEnorbC5x31eIOErx+3ls/8+29bRJ4gLgx5gL33kYJPMDMnZud1t6B49ZnzHXNrbO8nuNKLjhwbwPVO3fqfFdygNtzXW/n1mn/rjPYDJ7aUP1ll/2f/mXnG6lTONKL7esKAAAAAElFTkSuQmCC",Vd="data:image/png;base64,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",Od="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAABQCAYAAADSm7GJAAAB1UlEQVR42u3aS0oDQRCA4ZzAjQshS3d6gCAiuPUCHsK1FxAFr+EVvEWOpXSgQtF0JgEXmRq/H4o8ZrKZf+rRnVmtAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAvrC8uf3K4IguT+/n+uov7u80uSF6g3O32m+QlC45QqhcmODK2z2SSFyS4SY3XEBySXaXiU/NIrD5cXOzHw/U+QnLuw+QuYKA6JDnkElywHOcynAWH5BxPa5JLyP16e9xHlpwzugmOQSt6chNMciG5I8E5o2OJFHINWkX67cvz7V5wez81PUcPtuFRaJgKyRFZcMgM0Xm7sp2zubnaC/aHxIwF93Ky4H4nK8uNaJ/zTRI3iqt9JsGjjD0mOB/Lclu0471gkmcwWI0kx3dTgrPkON5+E98RXEBwizxgtff9uf1N0B93xc8oOGTEa+6xWXCOQyXd7tYM+2+efvtl0FRpziJl60wlZyGjR3JOEUxqIeFRgo9NzwQXz+p+vTsSnM8huZDc0Z5zFjza9CC4kOD+Ccoo2f05WTbBhUrzVHbqwYUFH5qcyV2A3NH6t5enNC+g94bskbherCwulL2jafmUIUwmFxM89SjsaP37nx6d/QUPxXDolimbQwAAAABJRU5ErkJggg==",Hd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAABQCAYAAADBaaZUAAAFYUlEQVR42u3dy6kcRxQGYEXgjRcGLb2zAhBGGLx1Ag7CaycgbHAaTkFZKAHHoDRk+kKJQ92qfk31o2q+DwqDZCQ0/5z6e/ox980bAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAID7e/vd91/j8ooAwAnl++Hn91//+evPb0sJA8DJ5Tut6deUcH9ZOoshY2RM5wWshPvLMeYmOxkjYx5UKsZptS7gUgl//vzpZXkD9DO0U15Lw1t7Ty0tr3Q/GSNjGpRvKsF8tdoU4yfgFHb68xVwf4Mbr+GXTmFNv/fly3+7lnLuI2NkzAklvKeI8+sLv719fQo6/dmOvvoZ3PwsRnpv1Er4kSJeU85SuTZjZMxJJby2iGPAqXynVboOrHz7GdqUXzpoyt8TtQxLn2QV8lgZ00++Mu68hGNY+aaXTm+UCjgv4fT7Ar//0P79y48vqzSwew6iaqeYWxay9K7NmHvmK+NBSrhUxu9/+uFlxYKNBZxKOC1HXfce3JjtNLi1sxit8juijCW5LeO0QZcyNqdj5Hv0HNPwdMXaIk7lmwq4dB04rdKnH+HfM/u54U1DGzfolmXc6jS1VMv51jJek7NX8t65PpKvV/OGwa4t32nF68D55pzfBh9vAPBqXz+4/3789duKA5xyS8Ob32CXck75t8hTCbfPOOZby3hNzub1XtlOmeXZPpKvV7aTIp4CWyrgfMVHj/74/Z3Ab3CKas3wxqPpmH8a3lTA02qxUbe+YUvGrzNO85fmcUvG5vb6A+bS2cRH8/VYUidFnAq1VL61Eo7hTm+OtIR93+GNd06WbtxIBR3fB7XMryrgZynhszO2UZ+bbZyrlN9cxvJ9kjdDXrox9NKvxfJVwPcY3jyTfHjToOY34ZU+/aa1N+cjniMevYTPzLjVQRaP7bkpw1q28n2iN0P+xRq1VdughXvt8K7NLN5BWcp7roCXck6f2loX7zMWcG2DPjpjc9xWfso4/xKjNXvulnxbHURz4rDHG3CW3hAK+J7Du3Q6c+7afi3rmO1SAUzrqOIduYC3btCtMt57kMVjudZybj3D8u2khPMbM2qnQkrfPZoCdnrjmuGNa26DThmuGdza4M/dUX908Y5Yvi026D0Z5/nWDrJM4bG5rr1has8My7ejEo7P/85diygVsGsL1xfv0mCXbpqbVryGNP03Hkht+fvOKN+RCnhrxls36JhvnOnazC4deJnKY4p3yx69lG8+v/HPr2XNjUo4v56w5dqEQO9RvFcs5Xv8WY0ts1s7wKrdXb3m7Ib5vqZ41+zNSwfe0umogGvXFkqDGm8CELTiVb7HZDy3me49cM5/kk7LwjC77V7HpXxrGdubOyzg0q3upW+7Kv0/Qn6O4j2zdEf4PujWGZc227nNOW7Qj95LwOtsj34d1+Rbu7vd3txxCcejqPxZs9IzwkJuP7zPUrKj/iCGHs9qKN422bZ8HUtPq8x9f4NvwxrkE3DpWTPXf8fdmO9SuqNc6+2pcM3x/rMbpWvpZ3wwqj3fLdNOy3fLaQ4Btx3eHj8tPVri+b9/5IyvymPpqQXz2+/eXCt/+XYYcP5zJZcu8DvtPOaGfVQJP/vGcHS2pdmNf5f5HW9vlu8gIa/5dDv37VhexXM+Id+hnNc8juYofH+2S6t0MDx3kBxzM7/j7M3yHez0xtLP9S09P+hI6x4b+Jrvj517HrT2fKgvce93frfm69WULxcdYZUeNZp7M+SnRAQsX+SLfK/yP16wDcoCotwEAAAAAElFTkSuQmCC",Ud=""+new URL("button_UI-577ae78b.png",import.meta.url).href,jd=""+new URL("BaltKeys_light-b029cebf.png",import.meta.url).href,Wo="data:image/png;base64,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",Yo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAABQCAYAAAA0u++hAAADBklEQVR42u3dQWoUQRTH4ZzAjQshS3d6gCAiuPUCHiJrLyAKXsMreIscK9KBJ38eNYILp6sq3wdFYtz1j6Snu17P3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFd2++LlYy5HRF/0ZZK4P759eVrv3909LZH1RV8mivvw8EtkfdGXGQP30C6X9EVfTg5cZ9xjHXErcEV2lPRFX04MXGFdJu3d171KfVk0cF4mCawv+nJy3O8fXj9W5B5YXH3RlxPj1srIFVdgfVm376dbjbeIm5FrHXFHgf1i64u+/KewNZYzCpz3sY7ve+Tj6/3nt09LZH2Zr2811nfBuH0jocL2Gcqc5MhRnePr3ZtXIi/Ut9+brL61iaSvvkx09h3t9vZB99wFznnKCluRBZ6/7+hBBn311XeyuD+/fvwTpc9L9hnK/MN9xMzAx78F1pf5+vaf67tQ3FoZOS+FMnLe4qjLotyAqMgCr9M3L3/1fX59c3JH38kCH1FHkWvlo6J9jjID58/E3bOvETx9uWLcClaR+/vG9sC5sZBn2x7Y0V237+jVlL76cnLg3M3NTYN/CSzuPn2rrb76cnLgfFWccWv1GdnRH2hx9+3rnqS+nBg4XxXnWTkD5+r3m8XVl7n6ZmN9Fw1clzY5nP63ucl+T0vYfftqqy8nBx7t/vZPXshxnTxLi7xe336pq+9efUefnJJ984+0N+xfIHCO6NQvZn9m/9IGocD6oi9XiDx6CulS4Ios8Np9L7XVV18mi5wrNxPynlWenW0s7N3X7Y31+/Y5aH03jN13hjO+o6Uv+nJC5NGj2/3drxwpfdGXEwNnUON1+rLGK2h9n8ElUo7iiKsv+jJR4AorsL6s11bfZxA4H1oQeP++2urLYoFtLujLmm313TBw3/11BtYXfTk57qVPRTFDuWff+n999WWhy6PRmbY/feao6Yu+XMnoWX1HRV/0ZaLI/Q3AHRV90ZdJCKwv+u7oNyX7+C2XT/IAAAAAAElFTkSuQmCC",Ko="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAABQCAYAAADSm7GJAAACBUlEQVR42u3bTUoDQRBA4ZzAjQshS3d6gCAiuPUCHsK1FxAFr+EVvEWOpXSgQlnMRHGh053vQYGTMS76pbt+nKxWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIDfsT45/YiwGgPKfX1+3MX11YboEeVut+9fJIdoKzTQ7g3RWTbJncuN3doiy23XBA8kOO9ax/SAkgkesB3KEUdyraatWMcF1cvN+T6y5JB7t/76IbCCC5dbK+QWTWIVHdHutXBcd3Akvz3d7sUdkpzvtZ9DblTUdvPC5D7cX+7k5siScyVde+Eqd3Nxtg+SF5Rzq+R2HZKnCqypSjrE5r6Z5AUVVCE1Il/XIUcWnHdvlkvywgRXEbVFCpkhOk+0pn7XUb2QCdXcyHGqD665uMrNeb1FExwngVX/Y8E133439Jg7fucEh1yC/7lyPiQh5+MWPxUcRzPB/yg4JOeC6tAujve0qL1wLsjye+ThBUieG0zE67XSDsE58u7Of8vQYwETrLl7tSWqbVIWmmfUWqNO5GehsUuncnHOwZ7y6FRylpsr6rl/LVq9DnN1lTsl2BHdca6e6oXnHggguFPJh4YdBA8qWR4eWHDesQQPJjn3xuQOJrgOP8gdWLIvpB1BLo5rgglGr4J922EwyfV5LoIH3MXao4EF12elCR5UcH6yg+TBJR+j4E8bcM3ve8+w9AAAAABJRU5ErkJggg==",Xd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAABQCAYAAAA0u++hAAADOUlEQVR42u3dQWoUQRSA4ZzAjQshS3d6gCAiuPUCHsK1FwgKXsMreIscK1KRFx6P1yaLZFJV833Q4JiMi/6d7qnq6pmLCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgRC5fvb7Nmz2iL/oySdxfP77fbR8/XN1tIuuLvkwU9+bmj8j6oi8zBnYW1hd9mSxwBI3A5rL0Zb2+0VjfDQOP4VEEjqGSyPqiL5MEzlt+t2Uv6cucbfXdNGpsPz+9vY9sHuu8+nqHtXbf0VbfzeLmiBG4Ro64Xy7/bULri748c9w6/OkixxZx68UHe1JfXuZds74bx/19/fk2h+4C578ffx6BXflfu29urO+afUfbp+h79e6NvrPF/fb1/X3gHLouas9h44pwnscacWMTWV/05YnmrGrk8Tgidwvd60XCHNfFw3375vW0+s7RVt8zCRxRY4vHeYlODZyHRjmuyHP1jcb66qvvooFzjBw6YnXrKPMQKYc1VFqvbx7+dn3z7+qrL88ct7v9swvc/W4XN5+5xzYCx1ncHl+/bzxPX305QeA6X1V/fhS4u5+/Bo64Aq/Ztzv56rtv3/w8fSeImy8qdCG6d8RHgfNQKD8WWF9epm9u/FDf+v9C30kCR+R8QeF/gcdW11HWCxP5eeax9upbn6evvpwg8lGgeoU4Auetnpm7f8fe3qPv0QHA3p6rb/xc3w0id1G6T7w6Wj/ZfY6wPTt/39yztq59fTDWOn3rwfloeV3tmy8a2rOLnJm7IdHRHJa46/TNL9p4F9XNU+a+TsBr9a1t692D3etX34UP0nFH0tEVfsOhNQ/SubO+e/XNbfXd/CBdl+ocLeMRWV/mmf54TF93Di4euVtH2Q2PDJH0Zc7G+p5Z4HqLt8D6suZJWN/NAnefD2wOa5+DtL76smjgvHRHXH1Zp29deqevwGzS117SlwWmOXwr8Hm8iPXVl0WHwfVOJIH1RV8ERl/05bGB3cOvL2tNcei7ceT6FTsC64u+THQWtnpDX/RlwsB5obs7j/RFXybSfTuwyPqiL5NGFlhf9F3JX7xwFDAatKk2AAAAAElFTkSuQmCC",qd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAABQCAYAAAAnSfh8AAADNElEQVR42u3cT2oWQRCG8ZzAjQshS3d6gCAiuPUCHiJrLyAKXsMreIscKzKBgqKomXz+ga+75/dAM4Hky6KfvN1dU5O5uQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/CduX7x8zMOMcIuJBP/49uVpvH939zSI5haTCX54+EU0t5hVcgzHrXXdCvCCkkNqXq23IcTrubU4Lyp5C2xc47gVws3SGm7zUVqIF5Oc5TpqrRfgPCzOi8jdxvcPrx9ziHOACZ7T6SVu+Z1c9CY3jyw65H66dcyayWkO6SVu+Z10ha6Cs+gYBM/lNR+N90Jc3dqJJwtulVwDnGuk7SrEcx2bj/zm74XbrnVoRgcU/PPrx8f7z29bybU+ihB37QezOabbGOG3PrSx5zaH/+7NK7vx6IK7EHfN/k6+52nHrHk3pzXE4fg5txHcCK8j9cDh7UJce7+1jbRdQ/D2me2zMUge44ZV+MjhDT9dXz+7zTtvHfwOIHlvdc4j77Q1yHmV3r7erkI8VoBr/dq57frA1e02slt+B1qhI7zdjY8sOh+Zc40UkrfflUNM8HXcVl//4rbWwQI8YICriCPJ9QZHrpFCbD5Wm+3rlUZ/4/bofoYyaeAj1p7kkHVJgOvKbaavWxZ1QftTt0d/G2Z8gAB3NySq4Bi1V3gUYrN8vQDnsuhoFz5yG58T1sHrpL1VOu/QWXIee7WSGR4jxN0R+FK3dWfmddA6qauVjvqDtX7yEMeYfrtdt2sH7vV/PagzUa10FN786GS34wrxfDtzd2TuauDwy+0ER60a4Prc857g+HmS5wxx3MvYc8vrpEetvdWZ5LVC3LWSaouJ3wlD3a3OXY0kwPM6Purxq38XFtw9tWPW1guxAC8muNbGArymY2+nXEzu0f8DE7yG57pAC+8i4X1uhTZba7ju3vltdiZfkbs7knbdc5y0OF5w9xXgc9TBHE/OXsuI3PME2C68QIjzO7GE9zx1sGP0IoRETf1zlk5mZRGxduBzeK6vEOZ6oZ1Yi+E8ZVP+t0OuF4HUc4aYawDT8Bv3LCs/hRKTswAAAABJRU5ErkJggg==",Wd="data:image/png;base64,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",Yd="data:image/png;base64,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",Jo="data:image/png;base64,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",Kd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAyCAYAAAAjrenXAAAAAXNSR0IArs4c6QAAAuhJREFUaIHtmDFP20AUx3+uChLKVqmmQyVkBZEKmQXBitgq9kwZmPkA/SAd8wkydUdlQqxFGcCqCmqGSB1aI7FFSDCYwbpwPr9zHC4X2ir/JTn73fnn8/N7zw8Wmq8C9acZxtlzFhikSWA7p685SJPAHLvYF8B//rkEYH11a2ygH1P/lZSdDaIbtwA4Sq4A2Hn/DoDzX79L85phnL15GwJwe5MCYI51+1fmBetIAasbMZ+Wgm6192m19+nGLTpRxMbSSuEG1DwdWgGbY/M6ryUwc2dddPXlFIC9xjJno3s2lla4frhzXvdZOy65lCQF7UPijks+bjsPZR8fpElwlJB1ooi9xjIAZ6N7AK4f7ko+nv8W3UWX5OMi+DSyRZVBmgQ9yIii8TEJurhOGV6CdgavCoU6fFU0Ka9Xji6SvVMcnwQurV1nTh37wsFp4euCLzQvNcM405+iOXaxd44qVRBPKZ8MnjImkJluVsyeOaw+ttYqPqBb7X0gT0R6HIc8wigYM+VLur1J3WuVaaSnfGBcr7jKK7jPlO8tnDXDuDLlV/t4UaabgEdwBdMRUr4t/kvwEjR4BlcwesqflLTMD4oXTXKT4rer/UIL/Y/y2lexrVu3F1Nl762votbc/HxJ+OMrAKNhn2/HPescWxyX7MWUrwBtbYpJfRV17PDkgp3NjPTDRwAaa9vsHnTEObbMKfVUrOBV0HWkdhrg/Hu+UVXwk6pDCV4EVztq65vU7asoaB+y7ngV1PrqVuG85K/Kr83xaNifnlKQt74KlOFnKad6vKo/ctr9VNjd0bA/HpuRZZAmgYoekqTI4rWv0gzjTL2ISrMKh977Kr4S0ELz1ly+gPTxtLWNzd5bQ0hBmLUKx71Sc0e3L2fQcjMIPH/lH55cAHkGNQst1698L32VOrWK2SOcVKvULrJmoRepVVz119cqVfJZq3h9OXcPOjTWtoHiTs/i5fTegpNqlX+mBaePZ5WAFpq3HgHDayym90jxZwAAAABJRU5ErkJggg==",Jd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANwAAADwCAYAAABrNArMAAAEWUlEQVR4nO3dwY0eRRSF0QpgErAsISRLyCEgsWBFCkRgh8CeVEhjkoMEQNVmyvdO9ztHugH0++ub7awFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALf3528f/zZ7yto9bbUPZHZy7Z622gcyO7l2T1vtA5mdXLunrfaBzE6u3dNW+0BmJ9fuaat9ILOTa/e01T6Q2cm1e9pqH8js5No9bbUPZHZy7Z62rn7I65fPZrUJziw4wZkFJziz4ARnFpzgzIITnFlwgjMLTnBmwQnOLDjB/cf++PWD/ct+/uHl6FrfIbg3EpzgBBckOMEJLkhwghNckOAEJ7ggwQlOcEGCE5zgggQnOMEFCU5wggsSnOAEFyS4ewb33sM8HbDgBCc4wX07wQlOcEGCE5zgggQnOMEFCU5wggsSnOAEFyQ4wQkuSHCCE1yQ4AQnuKCrHzLtoU5bO7zdBCe4R60dlOAEN2rtoAQnuFFrByU4wY1aOyjBCW7U2kEJTnCj1g5KcIIbtXZQghPcqLWDEpzgRq0dlOAEZ+8oTMEJbuQE90aCM8EFCc4EFyQ4E1yQ4ExwQYIzwQUJzgQXJDgTXJDgTHBBgrNmSIIT3Mi1gxKc4EatHZTgBDdq7aAEJ7hRawclOMGNWjsowQlu1NpBCU5wo9YOSnCCG7V2UIIT3Ki1gxLcOwnuKROS4NZagktNcIJbawkuNcEJbq0luNQEJ7i1luBSE5zg1lqCS01wgltrCS41wQlurSW41AQnuLWW4FITnODWWoJLTXCCW2tdD+70DzztwTwlpNYfDsEJTnCC+3aCu+dDfcp3CE5wt3ioT/kOwQnuFg/1Kd8hOMHd4qE+5TsEJ7hbPNSnfIfgBHeLh/qU7xCc4G7xUJ/yHYIT3C0e6lO+Q3BvDM7se0xwZsEJziw4wZkFJziz4ARnFpzgzIITnFlwgjMLTnBmwY0LzuwOa/e01T6Q2cm1e9pqH8js5No9bbUPZHZy7Z622gcyO7l2T1vtA5mdXLunrfaBzE6u3dNW+0BmJ9fuaat9ILOTa/e01T6Q2cm1e+J/uvoD//Ljy9F5WIwkOAgSHAQJDoIEB0GCgyDBQZDgIEhwECQ4CBIcBAkOggQHQYKDIMFBkOAgSHAQJDgIEhwECQ6Crj78168/HZ3gGElwECQ4CBIcBAkOggQHQYKDIMFBkOAgSHAQdPXh//X7p6MTHCMJDoIEB0GCgyDBQZDgIEhwECQ4CBIcBAkOggQHQYKDIMFBkOAgSHAQJDgIEhwECQ6CBAdBgoMgwUGQ4CBIcBAkOAgSHAQJDoIEB0GCgyDBQZDgIOjqw/fvquAAwUGQ4CBIcBAkOAgSHAQJDoIEB0GCgyDBQZDgIEhwECQ4CBIcBAkOggQHQYKDIMFBkOAgSHAQdPXht9a+DxzVDkpwjNIOSnCM0g5KcIzSDkpwjNIOSnCM0g5KcIzSDkpwjNIOSnCM0g5KcAAAAAAAAAAAcCf/ANF6CcMo73gmAAAAAElFTkSuQmCC",Zo="data:image/png;base64,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",Zd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAACWCAYAAAACG/YxAAAKsElEQVR4nO3dTWgc9xkH4HdrHwqFplhUpY1tqCKDA9qE9pBDTFRkqMGFJrk16dUHgw4u5Jpj7oGGIqpDjk1yq+JLig1aIuMEcinOqm2KZbv4oxAVizgQkkDE9CDNana1HzO7O5a98zwgkHY38mjz433f+c/sTAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAONVO+gNmCRvvvlm0vnYa6+95j0GoBL0wT2V/KPL0C1UqaqGi/FQsCiDXDFu+mC77x30BgC99SpY/QoZDCJXUL7DB70Bk2Jj498HvQkAcGD0wXYGrDE6HLdb338Xx/c9BkUpWJRBriiLPrjHgDUmaYCa63dj48adiPg4fvvS7+Kv7398sBvGY0/Bogxyxbjpg+0MWGPSXL8bERH1uaO7wYr41/pHB7lJTAAFizLIFWXQB9tV7qz+rHfffad1Querr/5+5PdiYb6eROyEK2IvbI21ZqXfZ4aXzVTa/GafOhYbN+7EnXtfyBVDkStS+mB5KvcHpxYXz7d9WuaFF36VK1zZMEbsBXJhvp6kE/vsU8daz48aqpWVleTll1+u7P+nx5GCRRnkinHTB8vlEOGuK1c+jHfffSfpF6433ng92dj4x77H00I1+9SPY+PG/2Ljxp3W3iDVsrh4Prly5cPWz4MylX1d9uduBSurqgWrquSKh0EfHC/XwcrhwuLZ5MLi2WT18sVYvXyx9fh//vbnVqh2fL+1vN5Ya9ayE/wwVlZWXJPmMZcWrH6vSQtW9iuivWBFRKtQVblgsUOueNj0weIquYLVuSya6ja9X1g8m6RL56nVyxcjNm/HzNThiPgm6nOzEbGzxJ4G7c69L0baG0xDZW9wcl1YPJtERKtYnf71ixHRu2Ade/JHSWOtWVuYryd37n0x9L/7OBcsBpMr8tAHy2cFq49uoWqZ3vlY88z2VjTXN1oPp+czjOJxD1VVDSpY2cfSbGXztXr5Yqz+5U+7P30T9bmjrTwtzNeTdE+wygWriuSKg6QPDs+A1UM2VI21Zi0tPt2Ck07u9bmj0TOIOU1CqOhPwaIMcsW46YOjqeQhwkE6QxURbUvre5+6iZjZ/m80Vz+KmD7etmfYWGsW+jezy+uPe6jorVe2uhUlBYu85Ipx0wdHV7kVrF7L7akrVz7s+3Hl7PJ7fe5o3Lz/Xev77J5hEZMWKrrLU7Dqc0fj5qGfRUREc/WjtqwNs9qwsrKSaIKTTa4oSh98OCo3YOU16HyEzj2/5vpG1OdmC+8RTmKoqkjBogxyxUHSB0djwCog3dvrvDDfznOzI/3uSQoVvSlYlEGueFj0wfycg5XT7gl+HR9zjp2TRzdvx/r6eqyu3aktzNd7n2gaEafnjyUn534TZ86cbT02aaGimOwhms5PgClYDEuuGDd9sBgDVkTcu3srnjz684GvW5g/kQnVN9FYu15Lg7a6dqd1YbWF+XqSXovmraUPasvLy63/7vz587WTc5FcuvRBnDlzdiJDRX4KFmWQK4rSB8ev0ocI79291fO5fYUpIhpr12ud3zfWmrXGZw96nvvwxhuvt37PP6+9FxcWzybpnewvXfpgtD+AR1q/fGXtL1h7h3uyBSti72rKERHLy8tJ+pW+Ls3UpBYs5Irx0gfLU+kBKyJ/sYpoL1gL8/XklVPH277S5zrPh9jcvB2bm7fj0909xWFPLuXxoGBRBrmiLPpgORwijNi3LNrthNFXTh1PYvvbiPg2jjy7s1y+dW2n4Hx+/8G+35n+jvQ6IIuL55On505Hc301GmvXa4216+P9I3ikjFKwfrLdnqf3rt5uW3ZPH9/c3Gl8n67f3T1heSOenjs+4pbzKJMryqIPjl/lBqylpeVa+tHnbsebuxWw7FSelQZqZupw6+PPg2T3KplsChZlkCtGpQ8+HJUbsIpKQ5UtSp+vvhcRsXuTyz0v/eJI8v7ft7oGZ2lpuRKBqioFizLIFY+CPH0wT6aq1gcNWBn37t6K9y9eagvAe1dv1xZOPtFWsDoHq2yw+g1ZkCpSsBZOPpF0O28monoFi/40QkY1bB9kv8qf5J7XzNRhgWIovQpW56EaGaMIueJhk6ViDFi7ep08+txTO1N7utfXL1xffr0dX369XcLWMWnSXEXYE2R8OnMlWxQxUh+cnt75oqWSA1aR5e+f/vBQmZvChOtVsDpz1bdgKVp0yJurnmSq8vTB8lVywOqUFqvO5faIGLgi9fbV+3vXldlthu0X+KMqihQsK53kVTRX9dPP932NVS26GdQHB+WK/So7YC0tLdfu3b3VN1RFND57UPOJG7L6Zavx2YOagsUw8tQs2SKPvH0wzVOeXFlg2GMgyGHh5BNJTE/HzPbWvufevnq/7T3MhsvAVU0vvXimlYF+TTC9NclX1z7p+vzbV+/X0jzJEnlztTB/IqnPzfbMVUTEzUNHZIrc0kxF9K5XNw8daX0vWzsqu4JVSI/hqptssEzy1fT+xUu19GvQa/PeLkKWyJurtAb94Nnner4mbz2DvPS+/QxYJVuYP5EIG0V1roxCEYMG9+xqAwzSWLteq8K9A8fNgDWCXk3Q8iiDpIcHB5ElhtGvIRreGUW/ldEIq6NZPk6S0w+efS7eWvogd2FqrF13/gwDNdau12ZOTbUNWxog49KtbqV1aWH+RKI2MYxuNercqakkDFdtDFgD5F1p6HTu1FRyc9wbw8TIri70G6jkiHGb2d5yiJDCdofx1snu/cxsb0Wj/E165DlEmENzfSP3ycjddN7DiWo717FilZccUUR6mHDYnURgNAasAUY+sW9zczwbwkQpfJ6CHFECQzvDMLTn4xBhH9nDM0XOVUhXKGa2tyKmDue6ez3VkGZjJxP9hyY5YlQz21vRXN+IhfkTSXaon9nekicomRWsAUb9RMTN+99F61Y6VFrnocEiuZAjhjWzvbVvBTQdrmSKIma2t+Kra59Ec/Wjfc/5cM5+VrB6KLLSAHlpbDwqZBDKZQWri1FWGqCbYU9sB3jcOPy8wwpWD+NaaTCckRolU3JEUe2r8DAaeSrOClYHKw2M27lTU4lDgxykztzJIaPolh8D2H4GrC5GaYbZAU3QGJYcMU7Z5udkZMqSrVUuAWLAamOlgXHLXi9GpoBJ1e3uAFUfsgxYJbHqQMTOhWpvHjoSMT091MX55IhRZPMjS4yqUIamp+OZ07+MPywuVHbIske968Li2eSra5+M5XpDnVO7lYvqSm+sm0rv45XnxuFyxCiyK/KdZImiHOEpzpu0K9sI63OzuRpgz9/T5bYmAkkRcsSosjuN9dPP77s4pCxRRGeehu2RVeIN2jXKSsO+35NtjNPT8czc0YiI+ONSw/tNLnLEqHrVtOb6hixR2Lh6JAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQKX8H5Dr0i+jR7PxAAAAAElFTkSuQmCC",$d="data:image/png;base64,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",tA="data:image/png;base64,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",eA=""+new URL("front-2f388a09.png",import.meta.url).href,iA="data:image/png;base64,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",sA="data:image/png;base64,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",nA=""+new URL("02_1_titles_LOOP-9b2e8b54.mp3",import.meta.url).href,rA=""+new URL("titles_INITIAL-806c5a24.mp3",import.meta.url).href,oA=""+new URL("game_over_INITIAL-9db1d2ee.mp3",import.meta.url).href,aA=""+new URL("game_over_LOOP-1d1ade1b.mp3",import.meta.url).href,lA=""+new URL("28_swoosh_01-f0abaadc.wav",import.meta.url).href,hA=""+new URL("29_swoosh_02-536bb479.wav",import.meta.url).href,cA=""+new URL("30_swoosh_03-61dc530b.wav",import.meta.url).href,dA=""+new URL("31_swoosh_sword_1-8a2bc369.wav",import.meta.url).href,AA=""+new URL("32_swoosh_sword_2-0e7b0029.wav",import.meta.url).href,uA=""+new URL("33_swoosh_sword_3-93405a04.wav",import.meta.url).href,pA=""+new URL("28_jump_01-de10f727.wav",import.meta.url).href,gA=""+new URL("29_jump_02-289883b3.wav",import.meta.url).href,fA=""+new URL("30_jump_03-9400e160.wav",import.meta.url).href,_A=""+new URL("45_Landing_01-cc00a36e.wav",import.meta.url).href,mA=""+new URL("46_Landing_02-ea84b7ae.wav",import.meta.url).href,vA=""+new URL("47_Landing_03-310f2d6e.wav",import.meta.url).href,wA=""+new URL("16_Crouch_01-c86efec7.wav",import.meta.url).href,bA=""+new URL("17_Crouch_02-6c1b671a.wav",import.meta.url).href,CA=""+new URL("18_Crouch_03-c627c83e.wav",import.meta.url).href,yA=""+new URL("01_Claw_01-87784371.wav",import.meta.url).href,xA=""+new URL("02_Claw_02-3fa61061.wav",import.meta.url).href,IA=""+new URL("03_Claw_03-1158dda4.wav",import.meta.url).href,EA=""+new URL("04_Claw_04-466c7d19.wav",import.meta.url).href,BA=""+new URL("testingmap2-472e1fb4.tmx",import.meta.url).href,Ct={tiledMap:new Oo.TiledMapResource(BA),blackscreen:new Jt(Gd),playeridle:new Jt(qo),playerrun:new Jt(Wo),playerjump:new Jt(Yo),playerjumptofall:new Jt(qd),playerfall:new Jt(Xd),playerattack1:new Jt(Wd),playerattack2:new Jt(Yd),playerdeath:new Jt(Jo),uibuttons:new Jt(Ud),buttons:new Jt(jd),sign:new Jt(Jd),healthui:new Jt(Kd),trackoverworldinit:new ue(rA),trackoverworld1:new ue(nA),trackgameover:new ue(oA),trackgameoverloop:new ue(aA),enemyknight:[new Jt(qo),new Jt(Wo),new Jt(Yo),new Jt(Jo),[new Jt(Ko),!0]],enemyskeleton:[new Jt(Zo),new Jt(Zd),new Jt(Zo),new Jt($d),[new Jt(tA),!1]],background:[new Jt(eA),new Jt(iA),new Jt(sA)],attack1sounds:[new ue(lA),new ue(hA),new ue(cA)],attack2sounds:[new ue(dA),new ue(AA),new ue(uA)],jumpingsounds:[new ue(pA),new ue(gA),new ue(fA)],landingsounds:[new ue(_A),new ue(mA),new ue(vA)],crouchingsounds:[new ue(wA),new ue(bA),new ue(CA)],playerhitsounds:[new ue(yA),new ue(xA),new ue(IA),new ue(EA)],crouchinganims:[new Jt(zd),new Jt(Od),new Jt(Vd),new Jt(Hd)],playerhit:new Jt(Ko)},SA=new la([Ct.uibuttons,Ct.playerdeath,Ct.playeridle,Ct.playerrun,Ct.playerfall,Ct.playerjump,Ct.playerjumptofall,Ct.playerattack1,Ct.playerattack2,Ct.trackoverworld1,Ct.trackoverworldinit,Ct.trackgameover,Ct.trackgameoverloop,Ct.playerhit,Ct.sign,Ct.healthui,Ct.buttons,Ct.blackscreen,Ct.enemyknight[0],Ct.enemyknight[1],Ct.enemyknight[2],Ct.enemyknight[3],Ct.enemyknight[4][0],Ct.enemyskeleton[0],Ct.enemyskeleton[1],Ct.enemyskeleton[2],Ct.enemyskeleton[3],Ct.enemyskeleton[4][0],Ct.background[0],Ct.background[1],Ct.background[2],Ct.playerhitsounds[0],Ct.playerhitsounds[1],Ct.playerhitsounds[2],Ct.playerhitsounds[3],Ct.attack1sounds[0],Ct.attack1sounds[1],Ct.attack1sounds[2],Ct.attack2sounds[0],Ct.attack2sounds[1],Ct.attack2sounds[2],Ct.jumpingsounds[0],Ct.jumpingsounds[1],Ct.jumpingsounds[2],Ct.crouchinganims[0],Ct.crouchinganims[1],Ct.crouchinganims[2],Ct.crouchinganims[3],Ct.landingsounds[0],Ct.landingsounds[1],Ct.landingsounds[2],Ct.crouchingsounds[0],Ct.crouchingsounds[1],Ct.crouchingsounds[2],Ct.tiledMap]);class No extends Ei{constructor(g,F,W,Z,q,E){super({x:g,y:F,name:"player",collisionType:ls.Active,collisionGroup:E,collider:Ce.Box(20,40,St.Half,Rt(0,20))});_t(this,"onGround",!0);_t(this,"jumped",!1);_t(this,"crouching",!1);_t(this,"hit",!1);_t(this,"health",3);_t(this,"animPlaying",0);_t(this,"attacking",0);_t(this,"attacked",!1);_t(this,"SFXVolume",localStorage.getItem("SFXvolume"));_t(this,"facing","R");_t(this,"playerAnimations",[]);_t(this,"transition");_t(this,"attackTransition");_t(this,"DataClass");_t(this,"attackHitbox");_t(this,"multiplayer",!1);_t(this,"player");this.DataClass=W,this.multiplayer=Z,this.player=q}onInitialize(g){this.DataClass.setPlayerHealth(this.player,this.health);let F=ge.fromImageSource({image:Ct.playeridle,grid:{rows:1,columns:10,spriteWidth:120,spriteHeight:80}}),W=ge.fromImageSource({image:Ct.playerrun,grid:{rows:1,columns:10,spriteWidth:120,spriteHeight:80}}),Z=ge.fromImageSource({image:Ct.playerjump,grid:{rows:1,columns:3,spriteWidth:120,spriteHeight:80}}),q=ge.fromImageSource({image:Ct.playerfall,grid:{rows:1,columns:3,spriteWidth:120,spriteHeight:80}}),E=ge.fromImageSource({image:Ct.playerjumptofall,grid:{rows:1,columns:2,spriteWidth:120,spriteHeight:80}}),T=ge.fromImageSource({image:Ct.playerattack1,grid:{rows:1,columns:4,spriteWidth:120,spriteHeight:80}}),D=ge.fromImageSource({image:Ct.playerattack2,grid:{rows:1,columns:6,spriteWidth:120,spriteHeight:80}}),S=Ct.crouchinganims[0].toSprite(),K=Ct.crouchinganims[1].toSprite(),w=ge.fromImageSource({image:Ct.crouchinganims[2],grid:{rows:1,columns:8,spriteWidth:120,spriteHeight:80}}),y=ge.fromImageSource({image:Ct.crouchinganims[3],grid:{rows:1,columns:4,spriteWidth:120,spriteHeight:80}}),P=ge.fromImageSource({image:Ct.playerdeath,grid:{rows:1,columns:10,spriteWidth:120,spriteHeight:80}}),V=Ct.playerhit.toSprite();this.playerAnimations.idleAnim=Oe.fromSpriteSheet(F,He(0,9),100),this.playerAnimations.runAnim=Oe.fromSpriteSheet(W,He(0,9),50),this.playerAnimations.jumpAnim=Oe.fromSpriteSheet(Z,He(0,2),50),this.playerAnimations.fallAnim=Oe.fromSpriteSheet(q,He(0,2),50),this.playerAnimations.jumpToFallAnim=Oe.fromSpriteSheet(E,He(0,1),50),this.playerAnimations.attackAnim1=Oe.fromSpriteSheet(T,He(0,3),100),this.playerAnimations.attackAnim2=Oe.fromSpriteSheet(D,He(0,5),100),this.playerAnimations.crouching=S,this.playerAnimations.crouchTarnsition=K,this.playerAnimations.crouchWalking=Oe.fromSpriteSheet(w,He(0,5),50),this.playerAnimations.crouchAttack=Oe.fromSpriteSheet(y,He(0,3),100),this.playerAnimations.deathAnim=Oe.fromSpriteSheet(P,He(0,9),100,po.Freeze),this.playerAnimations.playerHit=V,this.attackHitbox=new Ei({x:0,y:0,name:"attackbox",collisionType:ls.Passive,collider:Ce.Box(20,40,St.Half,Rt(0,20))}),this.addChild(this.attackHitbox),this.on("collisionstart",R=>{R.other._name=="enemy"&&!this.hit&&this.attacking==0&&R.other._tagsMemo[0]!="dead"&&(this.takeDamage(1,R.contact.info.sideId),this.hit=!0)})}update(g){switch(this.DataClass.setPlayerXpos(this.pos.x),this.SFXVolume=localStorage.getItem("SFXvolume"),this.vel.y==0?(this.onGround==!1&&Ct.landingsounds[Ss(0,2)].play(this.SFXVolume),this.onGround=!0,this.jumped=!1):this.onGround=!1,(this.onGround&&!g.input.keyboard.isHeld(Ot.Keys.D)&&!g.input.keyboard.isHeld(Ot.Keys.Right)&&!g.input.gamepads.at(0).getButton(Ot.Buttons.DpadRight)&&!g.input.keyboard.isHeld(Ot.Keys.A)&&!g.input.keyboard.isHeld(Ot.Keys.Left)&&!g.input.gamepads.at(0).getButton(Ot.Buttons.DpadLeft)&&this.player==1&&!this.multiplayer||!g.input.gamepads.at(0).getButton(Ot.Buttons.DpadLeft)&&!g.input.gamepads.at(0).getButton(Ot.Buttons.DpadRight)&&this.player==2&&this.multiplayer||!g.input.keyboard.isHeld(Ot.Keys.D)&&!g.input.keyboard.isHeld(Ot.Keys.Right)&&!g.input.keyboard.isHeld(Ot.Keys.A)&&!g.input.keyboard.isHeld(Ot.Keys.Left)&&this.player==1&&this.multiplayer)&&(this.vel.x=0),(this.crouching&&!g.input.keyboard.isHeld(Ot.Keys.S)&&!g.input.keyboard.isHeld(Ot.Keys.ArrowDown)&&!g.input.gamepads.at(0).getButton(Ot.Buttons.DpadDown)&&this.player==1&&!this.multiplayer||!g.input.gamepads.at(0).getButton(Ot.Buttons.DpadDown)&&this.player==2&&this.multiplayer||this.player==1&&this.multiplayer&&!g.input.keyboard.isHeld(Ot.Keys.S)&&!g.input.keyboard.isHeld(Ot.Keys.ArrowDown))&&(this.crouching=!1),!0){case(this.facing=="R"&&!this.crouching):this.attacking?this.attackHitbox.collider.set(Ce.Box(50,40,St.Half,Rt(25,20))):this.attackHitbox.collider.set(Ce.Box(1,40,St.Half,Rt(0,20))),this.collider.set(Ce.Box(20,40,St.Half,Rt(-5,20)));break;case(this.facing=="L"&&!this.crouching):this.attacking?this.attackHitbox.collider.set(Ce.Box(50,40,St.Half,Rt(-25,20))):this.attackHitbox.collider.set(Ce.Box(1,40,St.Half,Rt(0,20))),this.collider.set(Ce.Box(20,40,St.Half,Rt(5,20)));break;case(this.facing=="R"&&this.crouching):this.attacking?this.attackHitbox.collider.set(Ce.Box(50,20,St.Half,Rt(10,30))):this.attackHitbox.collider.set(Ce.Box(1,20,St.Half,Rt(10,30))),this.collider.set(Ce.Box(20,20,St.Half,Rt(-5,30)));break;case(this.facing=="L"&&this.crouching):this.attacking?this.attackHitbox.collider.set(Ce.Box(50,20,St.Half,Rt(-10,30))):this.attackHitbox.collider.set(Ce.Box(1,20,St.Half,Rt(-10,30))),this.collider.set(Ce.Box(20,20,St.Half,Rt(5,30)));break}switch(!0){case(!this.hit&&this.attacking==0&&!this.crouching&&this.vel.x>0&&this.vel.y==0):this.vel.x=this.vel.x-1,this.animPlaying!=1&&(this.animPlaying=1,this.facing="R",this.playerAnimations.runAnim.flipHorizontal=!1,this.graphics.use(this.playerAnimations.runAnim));break;case(!this.hit&&this.attacking==0&&!this.crouching&&this.vel.x<0&&this.vel.y==0):this.vel.x=this.vel.x+1,this.animPlaying!=2&&(this.animPlaying=2,this.facing="L",this.playerAnimations.runAnim.flipHorizontal=!0,this.graphics.use(this.playerAnimations.runAnim));break;case(!this.hit&&this.attacking==0&&this.vel.y<0&&this.vel.x<0):this.animPlaying!=3&&(this.animPlaying=3,this.facing="L",this.playerAnimations.jumpAnim.flipHorizontal=!0,this.graphics.use(this.playerAnimations.jumpAnim));break;case(!this.hit&&this.attacking==0&&this.vel.y<0&&this.vel.x>0):this.animPlaying!=4&&(this.animPlaying=4,this.facing="R",this.playerAnimations.jumpAnim.flipHorizontal=!1,this.graphics.use(this.playerAnimations.jumpAnim));break;case(!this.hit&&this.attacking==0&&this.vel.y>0&&this.vel.x>0):this.animPlaying!=5&&(this.facing="R",this.playerAnimations.fallAnim.flipHorizontal=!1,this.playerAnimations.jumpToFallAnim.flipHorizontal=!1,this.animPlaying!=9&&(this.transition=this.graphics.use(this.playerAnimations.jumpToFallAnim),this.animPlaying=9),this.transition.currentFrameIndex==1&&(this.graphics.use(this.playerAnimations.fallAnim),this.animPlaying=5,this.transition.reset()));break;case(!this.hit&&this.attacking==0&&this.vel.y>0&&this.vel.x<0):this.animPlaying!=6&&(this.facing="L",this.playerAnimations.fallAnim.flipHorizontal=!0,this.playerAnimations.jumpToFallAnim.flipHorizontal=!0,this.animPlaying!=9&&(this.transition=this.graphics.use(this.playerAnimations.jumpToFallAnim),this.animPlaying=9),this.transition.currentFrameIndex==1&&(this.graphics.use(this.playerAnimations.fallAnim),this.animPlaying=6,this.transition.reset()));break;case(!this.hit&&this.attacking==0&&this.vel.y>0&&this.vel.x==0):if(this.animPlaying!=7){switch(this.facing){case"R":this.playerAnimations.fallAnim.flipHorizontal=!1,this.playerAnimations.jumpToFallAnim.flipHorizontal=!1;break;case"L":this.playerAnimations.fallAnim.flipHorizontal=!0,this.playerAnimations.jumpToFallAnim.flipHorizontal=!0;break}this.animPlaying!=9&&(this.transition=this.graphics.use(this.playerAnimations.jumpToFallAnim),this.animPlaying=9),this.transition.currentFrameIndex==1&&(this.animPlaying=7,this.graphics.use(this.playerAnimations.fallAnim),this.transition.reset())}break;case(!this.hit&&this.attacking==0&&this.vel.y<0&&this.vel.x==0):if(this.animPlaying!=8){switch(this.facing){case"R":this.playerAnimations.jumpAnim.flipHorizontal=!1;break;case"L":this.playerAnimations.jumpAnim.flipHorizontal=!0;break}this.animPlaying=8,this.graphics.use(this.playerAnimations.jumpAnim)}break;case(!this.hit&&this.attacking==0&&this.crouching&&this.vel.y==0&&this.vel.x==0):if(this.animPlaying!=12){switch(this.facing){case"R":this.playerAnimations.crouching.flipHorizontal=!1;break;case"L":this.playerAnimations.crouching.flipHorizontal=!0;break}this.graphics.use(this.playerAnimations.crouching),this.animPlaying=12}break;case(!this.hit&&this.attacking==0&&this.crouching&&this.vel.x<0&&this.vel.y==0):this.animPlaying!=13&&(this.animPlaying=13,this.facing="L",this.playerAnimations.crouchWalking.flipHorizontal=!0,this.graphics.use(this.playerAnimations.crouchWalking));break;case(!this.hit&&this.attacking==0&&this.crouching&&this.vel.x>0&&this.vel.y==0):this.animPlaying!=14&&(this.animPlaying=14,this.facing="R",this.playerAnimations.crouchWalking.flipHorizontal=!1,this.graphics.use(this.playerAnimations.crouchWalking));break;case(!this.hit&&!this.crouching&&this.animPlaying!=0&&this.attacking==0&&this.health>0):switch(this.animPlaying=0,this.facing){case"R":this.playerAnimations.idleAnim.flipHorizontal=!1;break;case"L":this.playerAnimations.idleAnim.flipHorizontal=!0;break}this.graphics.use(this.playerAnimations.idleAnim);break;case this.health==0:switch(this.facing){case"R":this.playerAnimations.deathAnim.flipHorizontal=!1;break;case"L":this.playerAnimations.deathAnim.flipHorizontal=!0;break}this.graphics.use(this.playerAnimations.deathAnim);break}this.attacking>2?this.attacking=0:this.attacking!=0&&(this.vel.x=0,this.attackTransition.currentFrameIndex==3&&this.attacking==1&&!this.crouching&&(this.attackHitbox.removeTag("attacking1"),this.attacking=0),this.attackTransition.currentFrameIndex==5&&this.attacking>=2&&!this.crouching&&(this.attackHitbox.removeTag("attacking1"),this.attackHitbox.removeTag("attacking2"),this.attacking=0),this.crouching&&this.attackTransition.currentFrameIndex==3&&(this.attackHitbox.removeTag("attacking1"),this.attacking=0)),(g.input.keyboard.isHeld(Ot.Keys.D)&&!this.hit&&this.attacking==0&&this.health>0&&this.player==1||g.input.keyboard.isHeld(Ot.Keys.Right)&&this.player==1&&!this.hit&&this.attacking==0&&this.health>0||this.player==1&&!this.multiplayer&&g.input.gamepads.at(0).getButton(Ot.Buttons.DpadRight)&&!this.hit&&this.attacking==0&&this.health>0||this.player==2&&this.multiplayer&&g.input.gamepads.at(0).getButton(Ot.Buttons.DpadRight)&&!this.hit&&this.attacking==0&&this.health>0)&&this.movePlayer("D"),(g.input.keyboard.isHeld(Ot.Keys.A)&&!this.hit&&this.attacking==0&&this.health>0&&this.player==1||g.input.keyboard.isHeld(Ot.Keys.Left)&&this.player==1&&!this.hit&&this.attacking==0&&this.health>0||this.player==1&&!this.multiplayer&&g.input.gamepads.at(0).getButton(Ot.Buttons.DpadLeft)&&!this.hit&&this.attacking==0&&this.health>0||this.player==2&&this.multiplayer&&g.input.gamepads.at(0).getButton(Ot.Buttons.DpadLeft)&&!this.hit&&this.attacking==0&&this.health>0)&&this.movePlayer("A"),(g.input.keyboard.wasPressed(Ot.Keys.Space)&&!this.hit&&this.attacking==0&&this.health>0&&this.player==1||g.input.keyboard.wasPressed(Ot.Keys.ArrowUp)&&this.player==1&&!this.hit&&this.attacking==0&&this.health>0)&&this.onGround&&!this.jumped&&(this.jump(),this.jumped=!0),(g.input.keyboard.isHeld(Ot.Keys.S)&&!this.hit&&this.attacking==0&&this.health>0&&this.player==1||g.input.keyboard.isHeld(Ot.Keys.ArrowDown)&&this.player==1&&!this.hit&&this.attacking==0&&this.health>0||this.player==1&&!this.multiplayer&&g.input.gamepads.at(0).getButton(Ot.Buttons.DpadDown)&&!this.hit&&this.attacking==0&&this.health>0||this.player==2&&this.multiplayer&&g.input.gamepads.at(0).getButton(Ot.Buttons.DpadDown)&&!this.hit&&this.attacking==0&&this.health>0)&&this.onGround&&(this.crouch(),this.crouching=!0),g.input.keyboard.wasPressed(Ot.Keys.F)&&!this.hit&&this.health>0&&this.player==1&&(this.attacking+=1,this.attack(this.attacking)),g.input.keyboard.wasPressed(Ot.Keys.Escape)&&this.player==1&&g.goToScene("pausescreen"),g.input.gamepads.at(0).on("button",F=>{(F.button===Ot.Buttons.Face1&&this.player==1&&!this.multiplayer&&!this.hit&&this.attacking==0&&this.health>0||F.button===Ot.Buttons.Face1&&this.player==2&&this.multiplayer&&!this.hit&&this.attacking==0&&this.health>0||F.button===Ot.Buttons.DpadUp&&this.player==1&&!this.multiplayer&&!this.hit&&this.attacking==0&&this.health>0||F.button===Ot.Buttons.DpadUp&&this.player==2&&this.multiplayer&&!this.hit&&this.attacking==0&&this.health>0)&&this.onGround&&!this.jumped&&(this.jump(),this.jumped=!0),(F.button===Ot.Buttons.Face2&&!this.hit&&this.health>0&&this.player==1&&!this.multiplayer||F.button===Ot.Buttons.Face2&&!this.hit&&this.health>0&&this.player==2&&this.multiplayer)&&(this.attacked||(this.attacked=!0,this.attacking+=1,this.attack(this.attacking),setTimeout(()=>{this.attacked=!1},10))),F.button===Ot.Buttons.Select&&g.goToScene("pausescreen")})}movePlayer(g){if(this.attacking==0)switch(g){case"D":switch(this.crouching){case!0:this.vel.x=75;break;default:this.vel.x=150;break}break;case"A":switch(this.crouching){case!0:this.vel.x=-75;break;default:this.vel.x=-150;break}break}}jump(){this.transition.reset(),this.vel.y=-300,Ct.jumpingsounds[Ss(0,2)].play(this.SFXVolume)}crouch(){this.crouching||Ct.crouchingsounds[Ss(0,2)].play(this.SFXVolume)}attack(g){if(g==1){if(this.animPlaying!=10){switch(this.animPlaying=10,this.facing){case"R":this.playerAnimations.attackAnim1.flipHorizontal=!1,this.playerAnimations.crouchAttack.flipHorizontal=!1;break;case"L":this.playerAnimations.crouchAttack.flipHorizontal=!0,this.playerAnimations.attackAnim1.flipHorizontal=!0;break}this.crouching?(this.attackTransition=this.playerAnimations.crouchAttack,this.attackTransition.reset()):(this.attackTransition=this.playerAnimations.attackAnim1,this.attackTransition.reset()),this.attackHitbox.addTag("attacking1"),this.graphics.use(this.attackTransition),Ct.attack1sounds[Ss(0,2)].play(this.SFXVolume)}}else if(g==2&&this.animPlaying!=11){switch(this.animPlaying=11,this.facing){case"R":this.playerAnimations.attackAnim2.flipHorizontal=!1;break;case"L":this.playerAnimations.attackAnim2.flipHorizontal=!0;break}this.crouching||(this.attackHitbox.removeTag("attacking1"),this.attackHitbox.addTag("attacking2"),this.attackTransition=this.playerAnimations.attackAnim2,this.attackTransition.reset(),this.graphics.use(this.attackTransition),Ct.attack2sounds[Ss(0,2)].play(this.SFXVolume))}}getHealth(){return this.health}setPlayer(g,F){this.player=g,this.multiplayer=F}takeDamage(g,F){if(this.health>0){switch(this.facing){case"R":this.playerAnimations.playerHit.flipHorizontal=!1;break;case"L":this.playerAnimations.playerHit.flipHorizontal=!0;break}switch(F){case 3:this.vel.y=-200,setTimeout(()=>{this.vel.x=-200},50);break;case 1:this.vel.y=-200,setTimeout(()=>{this.vel.x=200},50);break}this.graphics.use(this.playerAnimations.playerHit),this.health-=g,Ct.playerhitsounds[Ss(0,3)].play(this.SFXVolume),setTimeout(()=>{this.hit=!1,this.graphics.use(this.playerAnimations.idleAnim)},800)}this.DataClass.setPlayerHealth(this.player,this.health)}}class $o extends Ei{constructor(g,F,W,Z,q,E,T,D,S,K,w,y){super({x:F,y:W,name:"enemy",collisionType:ls.Active,collider:D});_t(this,"enemyAnimations",[]);_t(this,"health",1);_t(this,"hit");_t(this,"dead",!1);_t(this,"onGround");_t(this,"Sprites");_t(this,"Speeds");_t(this,"SpriteRange");_t(this,"Grid",[]);_t(this,"hitAnim");_t(this,"Dimentions",[]);_t(this,"Collider");_t(this,"Offset");_t(this,"Dataclass");this.Dataclass=g,this.Sprites=q,this.Speeds=E,this.SpriteRange=T,this.Collider=D,this.Grid=K,this.health=Z,this.Offset=S,this.Dimentions=w,y!=null&&(this.scale=y)}onInitialize(g){const F=ge.fromImageSource({image:this.Sprites[0],grid:{rows:this.Grid[0].x,columns:this.Grid[0].y,spriteWidth:this.Dimentions[0].x,spriteHeight:this.Dimentions[0].y}}),W=ge.fromImageSource({image:this.Sprites[1],grid:{rows:this.Grid[1].x,columns:this.Grid[1].y,spriteWidth:this.Dimentions[1].x,spriteHeight:this.Dimentions[1].y}}),Z=ge.fromImageSource({image:this.Sprites[2],grid:{rows:this.Grid[2].x,columns:this.Grid[2].y,spriteWidth:this.Dimentions[2].x,spriteHeight:this.Dimentions[2].y}}),q=ge.fromImageSource({image:this.Sprites[3],grid:{rows:this.Grid[3].x,columns:this.Grid[3].y,spriteWidth:this.Dimentions[3].x,spriteHeight:this.Dimentions[3].y}});if(this.Sprites[4][1]){const E=this.Sprites[4][0].toSprite();this.enemyAnimations.Hit=E}else{const E=ge.fromImageSource({image:this.Sprites[4][0],grid:{rows:this.Grid[4].x,columns:this.Grid[4].y,spriteWidth:this.Dimentions[4].x,spriteHeight:this.Dimentions[4].y}});this.enemyAnimations.Hit=Oe.fromSpriteSheet(E,He(this.SpriteRange[4].x,this.SpriteRange[4].y),this.Speeds[4],po.Freeze)}this.enemyAnimations.Idle=Oe.fromSpriteSheet(F,He(this.SpriteRange[0].x,this.SpriteRange[0].y),this.Speeds[0]),this.enemyAnimations.Walk=Oe.fromSpriteSheet(W,He(this.SpriteRange[1].x,this.SpriteRange[1].y),this.Speeds[1]),this.enemyAnimations.Jump=Oe.fromSpriteSheet(Z,He(this.SpriteRange[2].x,this.SpriteRange[2].y),this.Speeds[2]),this.enemyAnimations.Death=Oe.fromSpriteSheet(q,He(this.SpriteRange[3].x,this.SpriteRange[3].y),this.Speeds[3],po.Freeze),this.on("collisionstart",E=>{E.other._name=="attackbox"&&!this.hit&&this.health>0&&(E.other._tagsMemo[0]=="attacking1"?(this.hit=!0,this.takeDamage(1,E.contact.info.sideId)):E.other._tagsMemo[0]=="attacking2"&&(this.hit=!0,this.takeDamage(2,E.contact.info.sideId)))})}update(g){switch(this.vel.y!=0?this.onGround=!1:this.onGround=!0,this.onGround&&(this.vel.x=0),!0){case(this.animPlaying!=0&&this.health>0):if(!this.dead){switch(this.animPlaying=0,this.facing){case"R":this.enemyAnimations.Idle.flipHorizontal=!1;break;case"L":this.enemyAnimations.Idle.flipHorizontal=!0;break}this.graphics.use(this.enemyAnimations.Idle)}break;case this.health<=0:if(!this.dead){switch(this.facing){case"R":this.enemyAnimations.Death.flipHorizontal=!1;break;case"L":this.enemyAnimations.Death.flipHorizontal=!0;break}this.dead=!0,this.collider.set(Ce.Box(20,1,St.Half,this.Offset)),this.collisionType=ls.PreventCollision,this.graphics.use(this.enemyAnimations.Death),this.Dataclass.incrementScore(),this.addTag("dead")}break}}takeDamage(g,F){if(this.health>0){switch(this.facing){case"R":this.enemyAnimations.Hit.flipHorizontal=!1;break;case"L":this.enemyAnimations.Hit.flipHorizontal=!0;break}switch(F){case 3:this.vel.y=-150;break;case 1:this.vel.y=-150;break}this.Sprites[4][1]||this.enemyAnimations.Hit.reset(),this.graphics.use(this.enemyAnimations.Hit),this.health-=g,Ct.playerhitsounds[Ss(0,3)].play(this.SFXVolume),setTimeout(()=>{this.hit=!1,this.dead||this.graphics.use(this.enemyAnimations.Idle)},400)}}}class kA{constructor(){}enemyKnight(it,g,F){return new $o(it,g.x,g.y,5,Ct.enemyknight,[100,50,50,50],[Rt(0,9),Rt(0,9),Rt(0,2),Rt(0,9)],Ce.Box(20,40,St.Half,Rt(-5,20)),Rt(-5,40),[Rt(1,10),Rt(1,10),Rt(1,3),Rt(1,10)],[Rt(120,80),Rt(120,80),Rt(120,80),Rt(120,80)],F)}enemySkeleton(it,g,F=Rt(.9,.8)){return new $o(it,g.x,g.y,3,Ct.enemyskeleton,[200,200,200,200,100],[Rt(0,3),Rt(0,3),Rt(0,3),Rt(0,3),Rt(0,3)],Ce.Box(20,40,St.Half,Rt(0,6.5)),Rt(0,26),[Rt(1,4),Rt(1,4),Rt(1,4),Rt(1,4),Rt(1,4)],[Rt(150,150),Rt(150,150),Rt(150,150),Rt(150,150),Rt(150,150)],F)}}class Go extends Ei{constructor(g,F,W,Z,q,E,T){super({pos:new St(0,0)});_t(this,"offset");_t(this,"DataClass");this.DataClass=T,E=E.toSprite(),E.scale=new St(Z,Z),this.offset=E.width,this.z=g;const D=new aa({members:[{graphic:E,pos:new St(F,W)},{graphic:E,pos:new St(F+E.width,W)},{graphic:E,pos:new St(F+E.width*2,W)},{graphic:E,pos:new St(F+E.width*3,W)},{graphic:E,pos:new St(F+E.width*4,W)},{graphic:E,pos:new St(F+E.width*5,W)}]});this.graphics.anchor=new St(0,0),this.graphics.add(D),this.addComponent(new ha(new St(q,q)))}}class ta extends Ei{constructor(g,F,W){super({x:g,y:F,name:"sign",collisionType:ls.Passive,collider:Ce.Box(20,20,St.Half,Rt(0,0))});_t(this,"DataClass");this.DataClass=W}onInitialize(g){let F=Ct.sign.toSprite();F.scale=new St(.1,.1),this.graphics.use(F),this.on("collisionstart",W=>{if(W.other._name=="player"&&W.other._tagsMemo[0]!="dead"){this.DataClass.setRestart(!0);let Z=this.DataClass.getLevel(0);g.goToScene(Z)}})}}class PA extends Ei{constructor(g,F,W){super({x:g,y:F,collisionType:ls.PreventCollision});_t(this,"inputButtons");_t(this,"controllerInputButtons");this.z=W,this.inputButtons=ge.fromImageSource({image:Ct.buttons,grid:{rows:16,columns:16,spriteWidth:16,spriteHeight:16}}),this.controllerInputButtons=ge.fromImageSource({image:Ct.buttons,grid:{rows:2,columns:5,spriteWidth:32,spriteHeight:32},spacing:{originOffset:{x:91,y:160}}})}onInitialize(){this.graphics.add("arrowLeft",this.inputButtons.getSprite(0,7)),this.graphics.add("arrowRight",this.inputButtons.getSprite(2,7)),this.graphics.add("arrowUp",this.inputButtons.getSprite(1,6)),this.graphics.add("arrowDown",this.inputButtons.getSprite(1,7)),this.graphics.add("Fkey",this.inputButtons.getSprite(5,3)),this.graphics.add("DpadLeft",this.controllerInputButtons.getSprite(3,0)),this.graphics.add("DpadRight",this.controllerInputButtons.getSprite(2,0)),this.graphics.add("DpadUp",this.controllerInputButtons.getSprite(0,0)),this.graphics.add("DpadDown",this.controllerInputButtons.getSprite(1,0)),this.graphics.add("controlerBottomButton",this.controllerInputButtons.getSprite(1,1)),this.graphics.add("controlerRightButton",this.controllerInputButtons.getSprite(3,1))}switchInput(g){switch(g){case 0:this.graphics.hide(),this.graphics.show("arrowLeft",{offset:new St(0,0)}),this.graphics.show("arrowRight",{offset:new St(32,0)}),this.graphics.show("arrowUp",{offset:new St(16,-16)}),this.graphics.show("arrowDown",{offset:new St(16,0)}),this.graphics.show("Fkey",{offset:new St(420,50)});break;case 1:this.graphics.hide(),this.graphics.show("DpadRight",{offset:new St(10,-5)}),this.graphics.show("controlerBottomButton",{offset:new St(40,-5)}),this.graphics.show("controlerRightButton",{offset:new St(415,50)});break}}}class ea extends jn{constructor(g,F,W,Z){super({x:g,y:F,width:10,height:12});_t(this,"DataClass");_t(this,"player");_t(this,"pos");_t(this,"health");_t(this,"mp",!1);this.DataClass=W,this.player=Z,this.pos=new St(g,F)}onInitialize(){let g=ge.fromImageSource({image:Ct.healthui,grid:{rows:4,columns:4,spriteWidth:11,spriteHeight:12}}),F=new Ho({color:Ii.White,text:"",width:10,height:10,font:new ks({size:10})});switch(this.graphics.add("H",g.getSprite(0,0)),this.graphics.add("P",g.getSprite(1,0)),this.graphics.add("Heart",g.getSprite(2,0)),this.graphics.add("EmptyHeart",g.getSprite(3,0)),this.graphics.add("Player",F),this.player){case 1:F.text="P1";break;case 2:F.text="P2";break}}showHP(){this.graphics.show("H",{offset:new St(10,0)}),this.graphics.show("P",{offset:new St(21,0)})}onPreUpdate(){this.health!=this.DataClass.getPlayerHealth(this.player)&&(this.health=this.DataClass.getPlayerHealth(this.player),this.updateHearts()),this.DataClass.getMultiplayer()!=this.mp&&(this.mp=this.DataClass.getMultiplayer(),this.updateHearts())}checkMP(){this.DataClass.getMultiplayer()?this.graphics.show("Player",{offset:new St(-5,8)}):this.graphics.hide("Player")}updateHearts(){switch(!0){case(this.player==2&&this.DataClass.getPlayerHealth(this.player)==3&&this.DataClass.getMultiplayer()||this.player==1&&this.DataClass.getPlayerHealth(this.player)==3):this.graphics.hide(),this.showHP(),this.checkMP(),this.graphics.show("Heart",{offset:new St(31,0)}),this.graphics.show("Heart",{offset:new St(41,0)}),this.graphics.show("Heart",{offset:new St(51,0)});break;case(this.player==2&&this.DataClass.getMultiplayer()&&this.DataClass.getPlayerHealth(this.player)==2||this.player==1&&this.DataClass.getPlayerHealth(this.player)==2):this.graphics.hide(),this.showHP(),this.checkMP(),this.graphics.show("Heart",{offset:new St(31,0)}),this.graphics.show("Heart",{offset:new St(41,0)}),this.graphics.show("EmptyHeart",{offset:new St(51,0)});break;case(this.player==2&&this.DataClass.getPlayerHealth(this.player)==1&&this.DataClass.getMultiplayer()||this.player==1&&this.DataClass.getPlayerHealth(this.player)==1):this.graphics.hide(),this.showHP(),this.checkMP(),this.graphics.show("Heart",{offset:new St(31,0)}),this.graphics.show("EmptyHeart",{offset:new St(41,0)}),this.graphics.show("EmptyHeart",{offset:new St(51,0)});break;case(this.player==2&&this.DataClass.getPlayerHealth(this.player)<=0&&this.DataClass.getMultiplayer()||this.player==1&&this.DataClass.getPlayerHealth(this.player)<=0):this.graphics.hide(),this.showHP(),this.checkMP(),this.graphics.show("EmptyHeart",{offset:new St(31,0)}),this.graphics.show("EmptyHeart",{offset:new St(41,0)}),this.graphics.show("EmptyHeart",{offset:new St(51,0)});break;default:this.graphics.hide();break}}}class QA extends jn{constructor(it,g,F){super({x:it,y:g,width:10,height:12}),this.z=F}onInitialize(){let it=ge.fromImageSource({image:Ct.buttons,grid:{rows:16,columns:16,spriteWidth:16,spriteHeight:16}}),g=Ct.blackscreen.toSprite();g.opacity=.5,this.graphics.add("G",it.getSprite(6,3)),this.graphics.add("A",it.getSprite(2,3)),this.graphics.add("M",it.getSprite(8,4)),this.graphics.add("E",it.getSprite(4,2)),this.graphics.add("O",it.getSprite(10,2)),this.graphics.add("V",it.getSprite(5,4)),this.graphics.add("R",it.getSprite(5,2)),this.graphics.add("blackscreen",g),this.graphics.show("blackscreen",{offset:new St(-500,-500)}),setTimeout(()=>{this.graphics.show("G",{offset:new St(0,0)})},200),setTimeout(()=>{this.graphics.show("A",{offset:new St(16,0)})},500),setTimeout(()=>{this.graphics.show("M",{offset:new St(32,0)})},800),setTimeout(()=>{this.graphics.show("E",{offset:new St(48,0)})},1100),setTimeout(()=>{this.graphics.show("O",{offset:new St(80,0)})},1400),setTimeout(()=>{this.graphics.show("V",{offset:new St(96,0)})},1700),setTimeout(()=>{this.graphics.show("E",{offset:new St(112,0)})},2e3),setTimeout(()=>{this.graphics.show("R",{offset:new St(128,0)})},2300)}}class DA extends kr{constructor(g){super({});_t(this,"dead",!1);_t(this,"cameraSwitched",!1);_t(this,"trackplaying");_t(this,"looping",!1);_t(this,"player");_t(this,"player2");_t(this,"playerHP");_t(this,"player2HP");_t(this,"p1Label");_t(this,"scoreLabel");_t(this,"score");_t(this,"enemy");_t(this,"sign");_t(this,"enemyGroup",Vo.create("enemyGroup"));_t(this,"playerGroup",Vo.create("player"));_t(this,"playersCanCollideWith");_t(this,"multiplayer",!1);_t(this,"muisicVolume",.1);_t(this,"DataClass");_t(this,"leftWallCollider");_t(this,"rightWallCollider");_t(this,"movementTutorial");_t(this,"deathscreen");_t(this,"knight");this.DataClass=g}onInitialize(g){g.input.gamepads.setMinimumGamepadConfiguration({axis:4,buttons:8}),g.input.gamepads.enabled=!0,this.DataClass.setScene("testmap");let F=new ta(1500,230,this.DataClass);this.movementTutorial=new PA(50,100,2),this.movementTutorial.scale=new St(2,2),this.add(F);const W=class extends jn{constructor(){super({x:30,y:15,width:10,height:12});_t(this,"text");this.text=new Ho({pos:Rt(30,15),text:"Kills: 0",color:Ii.White,font:new ks({size:15})}),this.graphics.show(this.text)}updateText(E){this.text.text=E}};this.scoreLabel=new W,this.add(this.scoreLabel),Ct.tiledMap.addTiledMapToScene(this),this.add(this.movementTutorial),this.initializeBackground(g),this.initializeActors(g),this.muisicVolume!=0&&(this.trackplaying=Ct.trackoverworldinit,this.trackplaying.play(this.muisicVolume)),g.input.gamepads.at(0).on("button",Z=>{this.DataClass.getMultiplayer()?this.movementTutorial.switchInput(0):this.movementTutorial.switchInput(1)}),g.input.keyboard.on("press",Z=>{this.DataClass.getMultiplayer()||this.movementTutorial.switchInput(0)})}initializeActors(g){this.DataClass.getRestart()&&(this.DataClass.setScore(0),this.DataClass.setRestart(!1),this.player.kill(),this.enemy.kill(),this.leftWallCollider.kill(),this.rightWallCollider.kill(),this.sign.kill(),this.knight.kill(),(this.DataClass.getMultiplayer()&&this.player2!=null||this.player2!=null)&&this.player2.kill(),this.deathscreen.kill()),this.playersCanCollideWith=na.collidesWith([this.enemyGroup]),this.deathscreen=new QA(220,200,3),this.deathscreen.scale=new St(3,3),this.leftWallCollider=new Ei({pos:Rt(-1,200),width:10,height:300,collisionType:ls.Fixed}),this.rightWallCollider=new Ei({pos:Rt(1520,200),width:10,height:300,collisionType:ls.Fixed}),this.p1Label=new Un({pos:Rt(-6,-5),text:"P1",color:Ii.White,font:new ks({size:10})}),this.p2Label=new Un({pos:Rt(-6,-5),text:"P2",color:Ii.White,font:new ks({size:10})}),this.player2=new No(50,200,this.DataClass,!0,2,this.playersCanCollideWith),this.player2HP=new ea(10,40,this.DataClass,2),this.playerHP=new ea(10,20,this.DataClass,1),this.player2HP.scale=new St(2,2),this.playerHP.scale=new St(2,2),this.add(this.playerHP),this.add(this.player2HP),this.p1Label.z=2,this.p2Label.z=2,this.DataClass.getMultiplayer()?(this.player2.addChild(this.p2Label),this.player=new No(22,210,this.DataClass,!0,1,this.playersCanCollideWith),this.player.addChild(this.p1Label),this.add(this.player2)):(this.player=new No(22,210,this.DataClass,!1,1,this.playersCanCollideWith),this.player2.addChild(this.p2Label),this.player.addChild(this.p1Label),this.p1Label.text="",this.add(this.player2),this.player2.active=!1);let F=new kA;this.enemy=F.enemySkeleton(this.DataClass,new St(880,260)),this.knight=F.enemyKnight(this.DataClass,new St(1400,200)),this.sign=new ta(1500,230,this.DataClass),this.camera.strategy.lockToActor(this.player);let W=new zo(0,-2e3,1520,320);this.camera.strategy.limitCameraBounds(W),this.add(this.leftWallCollider),this.add(this.rightWallCollider),this.add(this.player),this.add(this.enemy),this.add(this.knight),this.add(this.sign)}initializeBackground(g){let F=new Go(-2,-400,-300,4,.8,Ct.background[0],this.DataClass),W=new Go(-3,-400,-300,4,.6,Ct.background[1],this.DataClass),Z=new Go(-4,-400,-300,4,.4,Ct.background[2],this.DataClass);this.add(F),this.add(W),this.add(Z)}onActivate(){this.movementTutorial.switchInput(0),this.muisicVolume=this.DataClass.getMuisicvolume(),this.DataClass.getRestart()&&this.initializeActors()}onPreUpdate(g){if(this.trackplaying.volume=this.muisicVolume,this.score!=this.DataClass.getScore()&&(this.score=this.DataClass.getScore(),this.scoreLabel.updateText(`Kills: ${this.score}`)),this.DataClass.getMultiplayer()&&this.player.getHealth()<=0&&!this.cameraSwitched){console.log("switched");let F=new zo(0,-2e3,1520,320);this.camera.strategy.lockToActor(this.player2),this.camera.strategy.limitCameraBounds(F)}(this.DataClass.getMultiplayer()&&this.player.getHealth()<=0&&this.player2.getHealth()<=0||!this.DataClass.getMultiplayer()&&this.player.getHealth()<=0)&&this.add(this.deathscreen),this.muisicVolume!=0&&((this.player.getHealth()<=0&&this.dead==!1&&!this.DataClass.getMultiplayer()||this.DataClass.getMultiplayer()&&this.player.getHealth()<=0&&this.player2.getHealth()<=0&&this.dead==!1)&&(this.trackplaying.stop(),Ct.trackgameover.play(this.muisicVolume).then(()=>{this.trackplaying=Ct.trackgameoverloop,this.looping=!0}),this.dead=!0),this.looping&&(this.looping=!1,this.trackplaying.play(this.muisicVolume).then(()=>{this.looping=!0}))),!this.DataClass.getMultiplayer()&&this.player2!=null&&this.player2.active&&(this.player2.active=!1,this.player.setPlayer(1,!1),this.p1Label.text=""),this.DataClass.getMultiplayer()&&this.player2!=null&&this.player2.active==!1&&(this.player2.active=!0,this.add(this.player2),this.player.setPlayer(1,!0),this.p1Label.text="P1")}}class An extends jn{constructor(g,F,W,Z){super({x:W,y:Z,width:g,height:F});_t(this,"buttonSprite");_t(this,"buttonSpriteHover");_t(this,"text");_t(this,"fontSize",30);_t(this,"clicked",!1);_t(this,"pos");this.pos=new St(W,Z)}onInitialize(g){this.graphics.add("idle",this.buttonSprite),this.graphics.add("hover",this.buttonSpriteHover);let F=new Un({pos:Rt(20,10),text:this.text,font:new ks({size:this.fontSize})});this.addChild(F),this.graphics.show("idle"),this.on("pointerup",()=>{this.clicked=!0}),this.on("pointerenter",()=>{this.graphics.show("hover")}),this.on("pointerleave",()=>{this.graphics.hide("hover"),this.graphics.show("idle")})}setImages(g,F){this.buttonSprite=g,this.buttonSpriteHover=F}setText(g,F){this.text=g,this.fontSize=F}isClicked(){return this.clicked}setClicked(){this.clicked=!1}}class TA extends kr{constructor(g){super({});_t(this,"startButton");_t(this,"settingsButton");_t(this,"DataClass");this.DataClass=g}onInitialize(g){this.DataClass.setScene("mainmenu");let F=ge.fromImageSource({image:Ct.uibuttons,grid:{rows:12,columns:12,spriteHeight:16,spriteWidth:16},spacing:{margin:{x:0,y:0}}});this.startButton=new An(16,16,50,50),this.startButton.setText("Start",12),this.startButton.setImages(F.sprites[115],F.sprites[1]),this.settingsButton=new An(16,16,50,75),this.settingsButton.setText("Settings",12),this.settingsButton.setImages(F.sprites[116],F.sprites[2]),this.add(this.startButton),this.add(this.settingsButton)}onPreUpdate(g){this.startButton.isClicked()&&(this.startButton.setClicked(),g.goToScene("testmap")),this.settingsButton.isClicked()&&(this.settingsButton.setClicked(),g.goToScene("settings"))}}class ia extends Ei{constructor(g,F,W){super({pos:new St(g,F),height:2,width:100,color:Ii.White,collider:Ce.Box(110,20,St.Half,Rt(0,0))});_t(this,"startingPosition");_t(this,"dragable");_t(this,"value",.5);_t(this,"text");this.startingPosition=new St(g,F),this.text=W}onInitialize(){let g=new Un({pos:Rt(-55,-12),text:this.text,font:new ks({size:10})});this.dragable=new Ei({pos:new Rt(0,0),height:15,width:20,color:Ii.White}),this.addChild(this.dragable),this.addChild(g),this.on(Sr.PointerDragStart,F=>{this.dragable.color=Ii.Gray,this.setSliderPosition(F.coordinates.screenPos.x)}),this.on(Sr.PointerDragEnd,F=>{this.dragable.color=Ii.White}),this.on(Sr.PointerDragMove,F=>{this.dragable.color=Ii.Gray,this.setSliderPosition(F.coordinates.screenPos.x)}),this.on(Sr.PointerLeave,F=>{this.dragable.color=Ii.White})}setSliderPosition(g){switch(!0){case(g>=50&&g<55):this.dragable.pos.setTo(-50,0),this.value=0;break;case(g>=55&&g<65):this.dragable.pos.setTo(-40,0),this.value=.1;break;case(g>=65&&g<75):this.dragable.pos.setTo(-30,0),this.value=.2;break;case(g>=75&&g<85):this.dragable.pos.setTo(-20,0),this.value=.3;break;case(g>=85&&g<95):this.dragable.pos.setTo(-10,0),this.value=.4;break;case(g>=95&&g<105):this.dragable.pos.setTo(0,0),this.value=.5;break;case(g>=105&&g<115):this.dragable.pos.setTo(10,0),this.value=.6;break;case(g>=115&&g<125):this.dragable.pos.setTo(20,0),this.value=.7;break;case(g>=125&&g<135):this.dragable.pos.setTo(30,0),this.value=.8;break;case(g>=135&&g<145):this.dragable.pos.setTo(40,0),this.value=.9;break;case(g>=145&&g<150):this.dragable.pos.setTo(50,0),this.value=1;break}}getValue(){return this.value}setValue(g){switch(g=parseFloat(g),g){case 0:this.setSliderPosition(50);break;case .1:this.setSliderPosition(55);break;case .2:this.setSliderPosition(65);break;case .3:this.setSliderPosition(75);break;case .4:this.setSliderPosition(85);break;case .5:this.setSliderPosition(95);break;case .6:this.setSliderPosition(105);break;case .7:this.setSliderPosition(115);break;case .8:this.setSliderPosition(125);break;case .9:this.setSliderPosition(135);break;case 1:this.setSliderPosition(145);break}}}class FA extends jn{constructor(g,F,W,Z){super({x:W,y:Z,width:g,height:F});_t(this,"buttonSprite");_t(this,"buttonSpriteChecked");_t(this,"text");_t(this,"fontSize",30);_t(this,"clicked",!1);_t(this,"isActive",!1);_t(this,"pos");this.pos=new St(W,Z)}onInitialize(g){let F=new Un({pos:Rt(20,10),text:this.text,font:new ks({size:this.fontSize})});this.addChild(F),this.on("pointerup",()=>{this.clicked=!0,this.isActive?this.isActive=!1:this.isActive=!0})}onPreUpdate(){this.isActive?this.graphics.use(this.buttonSpriteChecked):this.graphics.use(this.buttonSprite)}setImages(g,F){this.buttonSprite=g,this.buttonSpriteChecked=F}setText(g,F){this.text=g,this.fontSize=F}setActive(g){this.isActive=g}isClicked(){return this.clicked}setClicked(){this.clicked=!1}getActive(){return this.isActive}}class MA extends kr{constructor(g){super({});_t(this,"backButton");_t(this,"multiplayerButton");_t(this,"multiplayer");_t(this,"SFXVolumeSlider");_t(this,"SFXVolume",.5);_t(this,"MuisicVolumeSlider");_t(this,"MuisicVolume",.5);_t(this,"DataClass");this.DataClass=g}onInitialize(g){let F=ge.fromImageSource({image:Ct.uibuttons,grid:{rows:12,columns:12,spriteHeight:16,spriteWidth:16},spacing:{margin:{x:0,y:0}}});this.SFXVolumeSlider=new ia(100,115,"SFX volume"),this.MuisicVolumeSlider=new ia(100,145,"Muisic volume"),this.backButton=new An(16,16,50,50),this.backButton.setText("Back",12),this.backButton.setImages(F.sprites[117],F.sprites[3]),this.multiplayerButton=new FA(16,16,50,160),this.multiplayerButton.setText("Multiplayer",12),this.multiplayerButton.setImages(F.sprites[108],F.sprites[125]),this.add(this.backButton),this.add(this.multiplayerButton),this.add(this.SFXVolumeSlider),this.add(this.MuisicVolumeSlider)}onActivate(){localStorage.getItem("SFXvolume")!=null&&localStorage.getItem("Muisicvolume")!=null&&localStorage.getItem("Multiplayer")!=null&&(this.MuisicVolumeSlider.setValue(localStorage.getItem("Muisicvolume")),this.SFXVolumeSlider.setValue(localStorage.getItem("SFXvolume")),this.multiplayerButton.setActive(JSON.parse(localStorage.getItem("Multiplayer"))),this.DataClass.setSFXvolume(this.SFXVolume),this.DataClass.setMuisicvolume(this.MuisicVolume),this.DataClass.setMultiplayer(this.multiplayer))}onPreUpdate(g){g.input.keyboard.wasPressed(Ot.Keys.Esc)&&g.goToScene(this.DataClass.getScene()),this.backButton.isClicked()&&(this.backButton.setClicked(),g.goToScene(this.DataClass.getScene())),this.multiplayerButton.isClicked()&&this.multiplayerButton.setClicked(),this.MuisicVolume=this.MuisicVolumeSlider.getValue(),this.SFXVolume=this.SFXVolumeSlider.getValue(),this.multiplayer=this.multiplayerButton.getActive(),localStorage.setItem("SFXvolume",this.SFXVolume),localStorage.setItem("Muisicvolume",this.MuisicVolume),localStorage.setItem("Multiplayer",this.multiplayer),this.DataClass.setSFXvolume(this.SFXVolume),this.DataClass.setMuisicvolume(this.MuisicVolume),this.DataClass.setMultiplayer(this.multiplayer)}getSettings(){let g=[];return localStorage.getItem("SFXvolume")!=null&&localStorage.getItem("Muisicvolume")&&localStorage.getItem("Multiplayer")!=null?(this.MuisicVolume=localStorage.getItem("Muisicvolume"),this.SFXVolume=localStorage.getItem("SFXvolume"),this.multiplayer=JSON.parse(localStorage.getItem("Multiplayer")),this.DataClass.setSFXvolume(this.SFXVolume),this.DataClass.setMuisicvolume(this.MuisicVolume),this.DataClass.setMultiplayer(this.multiplayer)):(this.MuisicVolume=.5,this.SFXVolume=.5,this.multiplayer=!1,this.DataClass.setSFXvolume(this.SFXVolume),this.DataClass.setMuisicvolume(this.MuisicVolume),this.DataClass.setMultiplayer(this.multiplayer),localStorage.setItem("SFXvolume",this.SFXVolume),localStorage.setItem("Muisicvolume",this.MuisicVolume),localStorage.setItem("Multiplayer",this.multiplayer)),g.SFXVolume=this.SFXVolume,g.MuisicVolume=this.MuisicVolume,g.Multiplayer=this.Multiplayer,g}}var sa={},RA={get exports(){return sa},set exports($){sa=$}};/*! For license information please see dev-tools.js.LICENSE.txt */(function($,it){(function(g,F){$.exports=F(da)})(self,g=>(()=>{var F={"./picker-system.ts":(E,T,D)=>{D.r(T),D.d(T,{PickerSystem:()=>K});var S=D("excalibur");class K extends S.System{constructor(){super(...arguments),this.types=["ex.transform"],this.systemType=S.SystemType.Update,this.priority=99,this.lastFrameEntityToPointers=new Map,this.currentFrameEntityToPointers=new Map}initialize(y){this._engine=y.engine,this._receiver=this._engine.input.pointers}addPointerToEntity(y,P){if(!this.currentFrameEntityToPointers.has(y.id))return void this.currentFrameEntityToPointers.set(y.id,[P]);const V=this.currentFrameEntityToPointers.get(y.id);this.currentFrameEntityToPointers.set(y.id,V.concat(P))}_processPointerToEntity(y){var P;let V,R,O;for(const z of y)if(!(z instanceof S.Particle)){if(V=z.get(S.TransformComponent),R=z.get(S.ColliderComponent),R){const X=R.get();if(X)for(const[p,m]of this._receiver.currentFramePointerCoords.entries())X.contains(V.coordPlane===S.CoordPlane.World?m.worldPos:m.screenPos)&&this.addPointerToEntity(z,p)}if(O=z.get(S.GraphicsComponent),O){const X=O.localBounds.transform(V.get().matrix);for(const[p,m]of this._receiver.currentFramePointerCoords.entries())X.contains(V.coordPlane===S.CoordPlane.World?m.worldPos:m.screenPos)&&this.addPointerToEntity(z,p)}if(!(!((P=O==null?void 0:O.current)===null||P===void 0)&&P.length)&&!(R!=null&&R.get())||z instanceof S.ParticleEmitter){const X=S.BoundingBox.fromDimension(100,100).transform(V.get().matrix);for(const[p,m]of this._receiver.currentFramePointerCoords.entries())X.contains(V.coordPlane===S.CoordPlane.World?m.worldPos:m.screenPos)&&this.addPointerToEntity(z,p)}}}update(y,P){this._processPointerToEntity(y),this.lastFrameEntityToPointers.clear(),this.lastFrameEntityToPointers=new Map(this.currentFrameEntityToPointers),this.currentFrameEntityToPointers.clear()}}},"./node_modules/tweakpane/dist/tweakpane.js":function(E,T){(function(D){class S{constructor(s){this.controller_=s}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(s){this.controller_.viewProps.set("disabled",s)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(s){this.controller_.viewProps.set("hidden",s)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class K{constructor(s){this.target=s}}class w extends K{constructor(s,r,c,f){super(s),this.value=r,this.presetKey=c,this.last=f==null||f}}class y extends K{constructor(s,r,c){super(s),this.value=r,this.presetKey=c}}class P extends K{constructor(s,r){super(s),this.expanded=r}}class V extends K{constructor(s,r){super(s),this.index=r}}function R(l){return l==null}function O(l,s){if(l.length!==s.length)return!1;for(let r=0;r<l.length;r++)if(l[r]!==s[r])return!1;return!0}const z={alreadydisposed:()=>"View has been already disposed",invalidparams:l=>`Invalid parameters for '${l.name}'`,nomatchingcontroller:l=>`No matching controller for '${l.key}'`,nomatchingview:l=>`No matching view for '${JSON.stringify(l.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:l=>`Property '${l.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class X{constructor(s){var r;this.message=(r=z[s.type](s.context))!==null&&r!==void 0?r:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=s.type}static alreadyDisposed(){return new X({type:"alreadydisposed"})}static notBindable(){return new X({type:"notbindable"})}static propertyNotFound(s){return new X({type:"propertynotfound",context:{name:s}})}static shouldNeverHappen(){return new X({type:"shouldneverhappen"})}}class p{constructor(s,r,c){this.obj_=s,this.key_=r,this.presetKey_=c??r}static isBindable(s){return s!==null&&typeof s=="object"}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(s){this.obj_[this.key_]=s}writeProperty(s,r){const c=this.read();if(!p.isBindable(c))throw X.notBindable();if(!(s in c))throw X.propertyNotFound(s);c[s]=r}}class m extends S{get label(){return this.controller_.props.get("label")}set label(s){this.controller_.props.set("label",s)}get title(){var s;return(s=this.controller_.valueController.props.get("title"))!==null&&s!==void 0?s:""}set title(s){this.controller_.valueController.props.set("title",s)}on(s,r){const c=r.bind(this);return this.controller_.valueController.emitter.on(s,()=>{c(new K(this))}),this}}class C{constructor(){this.observers_={}}on(s,r){let c=this.observers_[s];return c||(c=this.observers_[s]=[]),c.push({handler:r}),this}off(s,r){const c=this.observers_[s];return c&&(this.observers_[s]=c.filter(f=>f.handler!==r)),this}emit(s,r){const c=this.observers_[s];c&&c.forEach(f=>{f.handler(r)})}}const v="tp";function H(l){return(s,r)=>[v,"-",l,"v",s?`_${s}`:"",r?`-${r}`:""].join("")}function Y(l){return l.rawValue}function I(l,s){var r,c;l.emitter.on("change",(r=Y,c=s,f=>c(r(f)))),s(l.rawValue)}function k(l,s,r){I(l.value(s),r)}function b(l,s){return r=>{(function(c,f,G){G?c.classList.add(f):c.classList.remove(f)})(l,s,r)}}function N(l,s){I(l,r=>{s.textContent=r??""})}const _=H("btn");class ct{constructor(s,r){this.element=s.createElement("div"),this.element.classList.add(_()),r.viewProps.bindClassModifiers(this.element);const c=s.createElement("button");c.classList.add(_("b")),r.viewProps.bindDisabled(c),this.element.appendChild(c),this.buttonElement=c;const f=s.createElement("div");f.classList.add(_("t")),N(r.props.value("title"),f),this.buttonElement.appendChild(f)}}class gt{constructor(s,r){this.emitter=new C,this.onClick_=this.onClick_.bind(this),this.props=r.props,this.viewProps=r.viewProps,this.view=new ct(s,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class ot{constructor(s,r){var c;this.constraint_=r==null?void 0:r.constraint,this.equals_=(c=r==null?void 0:r.equals)!==null&&c!==void 0?c:(f,G)=>f===G,this.emitter=new C,this.rawValue_=s}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(s){this.setRawValue(s,{forceEmit:!1,last:!0})}setRawValue(s,r){const c=r??{forceEmit:!1,last:!0},f=this.constraint_?this.constraint_.constrain(s):s;(!this.equals_(this.rawValue_,f)||c.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=f,this.emitter.emit("change",{options:c,rawValue:f,sender:this}))}}class Et{constructor(s){this.emitter=new C,this.value_=s}get rawValue(){return this.value_}set rawValue(s){this.setRawValue(s,{forceEmit:!1,last:!0})}setRawValue(s,r){const c=r??{forceEmit:!1,last:!0};(this.value_!==s||c.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=s,this.emitter.emit("change",{options:c,rawValue:this.value_,sender:this}))}}function at(l,s){const r=s==null?void 0:s.constraint,c=s==null?void 0:s.equals;return r||c?new ot(l,s):new Et(l)}class mt{constructor(s){this.emitter=new C,this.valMap_=s;for(const r in this.valMap_)this.valMap_[r].emitter.on("change",()=>{this.emitter.emit("change",{key:r,sender:this})})}static createCore(s){return Object.keys(s).reduce((r,c)=>Object.assign(r,{[c]:at(s[c])}),{})}static fromObject(s){const r=this.createCore(s);return new mt(r)}get(s){return this.valMap_[s].rawValue}set(s,r){this.valMap_[s].rawValue=r}value(s){return this.valMap_[s]}}function A(l){return s=>r=>{if(!s&&r===void 0)return{succeeded:!1,value:void 0};if(s&&r===void 0)return{succeeded:!0,value:void 0};const c=l(r);return c!==void 0?{succeeded:!0,value:c}:{succeeded:!1,value:void 0}}}function L(l){return{custom:s=>A(s)(l),boolean:A(s=>typeof s=="boolean"?s:void 0)(l),number:A(s=>typeof s=="number"?s:void 0)(l),string:A(s=>typeof s=="string"?s:void 0)(l),function:A(s=>typeof s=="function"?s:void 0)(l),constant:s=>A(r=>r===s?s:void 0)(l),raw:A(s=>s)(l),object:s=>A(r=>{if((c=r)!==null&&typeof c=="object")return function(f,G){return Object.keys(G).reduce((j,ht)=>{if(j===void 0)return;const wt=(0,G[ht])(f[ht]);return wt.succeeded?Object.assign(Object.assign({},j),{[ht]:wt.value}):void 0},{})}(r,s);var c})(l),array:s=>A(r=>{if(Array.isArray(r))return c=s,r.reduce((f,G)=>{if(f===void 0)return;const j=c(G);return j.succeeded&&j.value!==void 0?[...f,j.value]:void 0},[]);var c})(l)}}const nt={optional:L(!0),required:L(!1)};function B(l,s){const r=nt.required.object(s)(l);return r.succeeded?r.value:void 0}const st=H(""),M={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class tt{constructor(s){this.parent_=null,this.blade=s.blade,this.view=s.view,this.viewProps=s.viewProps;const r=this.view.element;this.blade.value("positions").emitter.on("change",()=>{["veryfirst","first","last","verylast"].forEach(c=>{r.classList.remove(st(void 0,M[c]))}),this.blade.get("positions").forEach(c=>{r.classList.add(st(void 0,M[c]))})}),this.viewProps.handleDispose(()=>{(function(c){c&&c.parentElement&&c.parentElement.removeChild(c)})(r)})}get parent(){return this.parent_}}const rt="http://www.w3.org/2000/svg";function At(l){l.offsetHeight}function lt(l){return l.ontouchstart!==void 0}function bt(){return new Function("return this")().document}const Bt={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function yt(l,s){const r=l.createElementNS(rt,"svg");return r.innerHTML=Bt[s],r}function kt(l,s,r){l.insertBefore(s,l.children[r])}function Mt(l){l.parentElement&&l.parentElement.removeChild(l)}function Wt(l){for(;l.children.length>0;)l.removeChild(l.children[0])}function qt(l){return l.relatedTarget?l.relatedTarget:"explicitOriginalTarget"in l?l.explicitOriginalTarget:null}const Yt=H("lbl");class Kt{constructor(s,r){this.element=s.createElement("div"),this.element.classList.add(Yt()),r.viewProps.bindClassModifiers(this.element);const c=s.createElement("div");c.classList.add(Yt("l")),k(r.props,"label",G=>{R(G)?this.element.classList.add(Yt(void 0,"nol")):(this.element.classList.remove(Yt(void 0,"nol")),function(j){for(;j.childNodes.length>0;)j.removeChild(j.childNodes[0])}(c),c.appendChild(function(j,ht){const wt=j.createDocumentFragment();return ht.split(`
`).map(Dt=>j.createTextNode(Dt)).forEach((Dt,jt)=>{jt>0&&wt.appendChild(j.createElement("br")),wt.appendChild(Dt)}),wt}(s,G)))}),this.element.appendChild(c),this.labelElement=c;const f=s.createElement("div");f.classList.add(Yt("v")),this.element.appendChild(f),this.valueElement=f}}class Fe extends tt{constructor(s,r){const c=r.valueController.viewProps;super(Object.assign(Object.assign({},r),{view:new Kt(s,{props:r.props,viewProps:c}),viewProps:c})),this.props=r.props,this.valueController=r.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const ee={id:"button",type:"blade",accept(l){const s=nt,r=B(l,{title:s.required.string,view:s.required.constant("button"),label:s.optional.string});return r?{params:r}:null},controller:l=>new Fe(l.document,{blade:l.blade,props:mt.fromObject({label:l.params.label}),valueController:new gt(l.document,{props:mt.fromObject({title:l.params.title}),viewProps:l.viewProps})}),api:l=>l.controller instanceof Fe&&l.controller.valueController instanceof gt?new m(l.controller):null};class Ue extends tt{constructor(s){super(s),this.value=s.value}}function Ze(){return new mt({positions:at([],{equals:O})})}class ye extends mt{constructor(s){super(s)}static create(s){const r={completed:!0,expanded:s,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},c=mt.createCore(r);return new ye(c)}get styleExpanded(){var s;return(s=this.get("temporaryExpanded"))!==null&&s!==void 0?s:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const s=this.get("expandedHeight");return this.get("shouldFixHeight")&&!R(s)?`${s}px`:"auto"}bindExpandedClass(s,r){const c=()=>{this.styleExpanded?s.classList.add(r):s.classList.remove(r)};k(this,"expanded",c),k(this,"temporaryExpanded",c)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function Ui(l,s){s.style.height=l.styleHeight}function ji(l,s){l.value("expanded").emitter.on("beforechange",()=>{l.set("completed",!1),R(l.get("expandedHeight"))&&l.set("expandedHeight",function(r,c){let f=0;return function(G,j){const ht=G.style.transition;G.style.transition="none",j(),G.style.transition=ht}(c,()=>{r.set("expandedHeight",null),r.set("temporaryExpanded",!0),At(c),f=c.clientHeight,r.set("temporaryExpanded",null),At(c)}),f}(l,s)),l.set("shouldFixHeight",!0),At(s)}),l.emitter.on("change",()=>{Ui(l,s)}),Ui(l,s),s.addEventListener("transitionend",r=>{r.propertyName==="height"&&l.cleanUpTransition()})}class $e extends S{constructor(s,r){super(s),this.rackApi_=r}}class ti{constructor(s){this.emitter=new C,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=s}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(s){for(const r of this.allItems())if(s(r))return r;return null}includes(s){return this.cache_.has(s)}add(s,r){if(this.includes(s))throw X.shouldNeverHappen();const c=r!==void 0?r:this.items_.length;this.items_.splice(c,0,s),this.cache_.add(s);const f=this.extract_(s);f&&(f.emitter.on("add",this.onSubListAdd_),f.emitter.on("remove",this.onSubListRemove_),f.allItems().forEach(G=>{this.cache_.add(G)})),this.emitter.emit("add",{index:c,item:s,root:this,target:this})}remove(s){const r=this.items_.indexOf(s);if(r<0)return;this.items_.splice(r,1),this.cache_.delete(s);const c=this.extract_(s);c&&(c.emitter.off("add",this.onSubListAdd_),c.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:r,item:s,root:this,target:this})}onSubListAdd_(s){this.cache_.add(s.item),this.emitter.emit("add",{index:s.index,item:s.item,root:this,target:s.target})}onSubListRemove_(s){this.cache_.delete(s.item),this.emitter.emit("remove",{index:s.index,item:s.item,root:this,target:s.target})}}class pi extends S{constructor(s){super(s),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new C,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(s){this.controller_.props.set("label",s)}on(s,r){const c=r.bind(this);return this.emitter_.on(s,f=>{c(f.event)}),this}refresh(){this.controller_.binding.read()}onBindingChange_(s){const r=s.sender.target.read();this.emitter_.emit("change",{event:new w(this,r,this.controller_.binding.target.presetKey,s.options.last)})}}class fe extends Fe{constructor(s,r){super(s,r),this.binding=r.binding}}class ei extends S{constructor(s){super(s),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new C,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(s){this.controller_.props.set("label",s)}on(s,r){const c=r.bind(this);return this.emitter_.on(s,f=>{c(f.event)}),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(s){const r=s.sender.target.read();this.emitter_.emit("update",{event:new y(this,r,this.controller_.binding.target.presetKey)})}}class ii extends Fe{constructor(s,r){super(s,r),this.binding=r.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose(()=>{this.binding.dispose()})}}function Ps(l){return l instanceof hs?l.apiSet_:l instanceof $e?l.rackApi_.apiSet_:null}function gi(l,s){const r=l.find(c=>c.controller_===s);if(!r)throw X.shouldNeverHappen();return r}function Xi(l,s,r){if(!p.isBindable(l))throw X.notBindable();return new p(l,s,r)}class hs extends S{constructor(s,r){super(s),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new C,this.apiSet_=new ti(Ps),this.pool_=r;const c=this.controller_.rack;c.emitter.on("add",this.onRackAdd_),c.emitter.on("remove",this.onRackRemove_),c.emitter.on("inputchange",this.onRackInputChange_),c.emitter.on("monitorupdate",this.onRackMonitorUpdate_),c.children.forEach(f=>{this.setUpApi_(f)})}get children(){return this.controller_.rack.children.map(s=>gi(this.apiSet_,s))}addInput(s,r,c){const f=c??{},G=this.controller_.view.element.ownerDocument,j=this.pool_.createInput(G,Xi(s,r,f.presetKey),f),ht=new pi(j);return this.add(ht,f.index)}addMonitor(s,r,c){const f=c??{},G=this.controller_.view.element.ownerDocument,j=this.pool_.createMonitor(G,Xi(s,r),f),ht=new ei(j);return this.add(ht,f.index)}addFolder(s){return function(r,c){return r.addBlade(Object.assign(Object.assign({},c),{view:"folder"}))}(this,s)}addButton(s){return function(r,c){return r.addBlade(Object.assign(Object.assign({},c),{view:"button"}))}(this,s)}addSeparator(s){return function(r,c){const f=c??{};return r.addBlade(Object.assign(Object.assign({},f),{view:"separator"}))}(this,s)}addTab(s){return function(r,c){return r.addBlade(Object.assign(Object.assign({},c),{view:"tab"}))}(this,s)}add(s,r){this.controller_.rack.add(s.controller_,r);const c=this.apiSet_.find(f=>f.controller_===s.controller_);return c&&this.apiSet_.remove(c),this.apiSet_.add(s),s}remove(s){this.controller_.rack.remove(s.controller_)}addBlade(s){const r=this.controller_.view.element.ownerDocument,c=this.pool_.createBlade(r,s),f=this.pool_.createBladeApi(c);return this.add(f,s.index)}on(s,r){const c=r.bind(this);return this.emitter_.on(s,f=>{c(f.event)}),this}setUpApi_(s){this.apiSet_.find(r=>r.controller_===s)||this.apiSet_.add(this.pool_.createBladeApi(s))}onRackAdd_(s){this.setUpApi_(s.bladeController)}onRackRemove_(s){if(s.isRoot){const r=gi(this.apiSet_,s.bladeController);this.apiSet_.remove(r)}}onRackInputChange_(s){const r=s.bladeController;if(r instanceof fe){const c=gi(this.apiSet_,r),f=r.binding;this.emitter_.emit("change",{event:new w(c,f.target.read(),f.target.presetKey,s.options.last)})}else if(r instanceof Ue){const c=gi(this.apiSet_,r);this.emitter_.emit("change",{event:new w(c,r.value.rawValue,void 0,s.options.last)})}}onRackMonitorUpdate_(s){if(!(s.bladeController instanceof ii))throw X.shouldNeverHappen();const r=gi(this.apiSet_,s.bladeController),c=s.bladeController.binding;this.emitter_.emit("update",{event:new y(r,c.target.read(),c.target.presetKey)})}}class Qs extends $e{constructor(s,r){super(s,new hs(s.rackController,r)),this.emitter_=new C,this.controller_.foldable.value("expanded").emitter.on("change",c=>{this.emitter_.emit("fold",{event:new P(this,c.sender.rawValue)})}),this.rackApi_.on("change",c=>{this.emitter_.emit("change",{event:c})}),this.rackApi_.on("update",c=>{this.emitter_.emit("update",{event:c})})}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(s){this.controller_.foldable.set("expanded",s)}get title(){return this.controller_.props.get("title")}set title(s){this.controller_.props.set("title",s)}get children(){return this.rackApi_.children}addInput(s,r,c){return this.rackApi_.addInput(s,r,c)}addMonitor(s,r,c){return this.rackApi_.addMonitor(s,r,c)}addFolder(s){return this.rackApi_.addFolder(s)}addButton(s){return this.rackApi_.addButton(s)}addSeparator(s){return this.rackApi_.addSeparator(s)}addTab(s){return this.rackApi_.addTab(s)}add(s,r){return this.rackApi_.add(s,r)}remove(s){this.rackApi_.remove(s)}addBlade(s){return this.rackApi_.addBlade(s)}on(s,r){const c=r.bind(this);return this.emitter_.on(s,f=>{c(f.event)}),this}}class Ds extends tt{constructor(s){super({blade:s.blade,view:s.view,viewProps:s.rackController.viewProps}),this.rackController=s.rackController}}class Xn{constructor(s,r){const c=H(r.viewName);this.element=s.createElement("div"),this.element.classList.add(c()),r.viewProps.bindClassModifiers(this.element)}}function Ts(l){return l instanceof Si?l.rack:l instanceof Ds?l.rackController.rack:null}function qn(l){const s=Ts(l);return s?s.bcSet_:null}class Bi{constructor(s){var r;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new C,this.blade_=s??null,(r=this.blade_)===null||r===void 0||r.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new ti(qn),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(s,r){s.parent&&s.parent.remove(s),s.parent_=this,this.bcSet_.add(s,r)}remove(s){s.parent_=null,this.bcSet_.remove(s)}find(s){return this.bcSet_.allItems().filter(r=>r instanceof s)}onSetAdd_(s){this.updatePositions_();const r=s.target===s.root;if(this.emitter.emit("add",{bladeController:s.item,index:s.index,isRoot:r,sender:this}),!r)return;const c=s.item;if(c.viewProps.emitter.on("change",this.onChildViewPropsChange_),c.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),c.viewProps.handleDispose(this.onChildDispose_),c instanceof fe)c.binding.emitter.on("change",this.onChildInputChange_);else if(c instanceof ii)c.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(c instanceof Ue)c.value.emitter.on("change",this.onChildValueChange_);else{const f=Ts(c);if(f){const G=f.emitter;G.on("layout",this.onDescendantLayout_),G.on("inputchange",this.onDescendantInputChange_),G.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(s){this.updatePositions_();const r=s.target===s.root;if(this.emitter.emit("remove",{bladeController:s.item,isRoot:r,sender:this}),!r)return;const c=s.item;if(c instanceof fe)c.binding.emitter.off("change",this.onChildInputChange_);else if(c instanceof ii)c.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(c instanceof Ue)c.value.emitter.off("change",this.onChildValueChange_);else{const f=Ts(c);if(f){const G=f.emitter;G.off("layout",this.onDescendantLayout_),G.off("inputchange",this.onDescendantInputChange_),G.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const s=this.bcSet_.items.filter(f=>!f.viewProps.get("hidden")),r=s[0],c=s[s.length-1];this.bcSet_.items.forEach(f=>{const G=[];f===r&&(G.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||G.push("veryfirst")),f===c&&(G.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||G.push("verylast")),f.blade.set("positions",G)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(s){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(s=>s.viewProps.get("disposed")).forEach(s=>{this.bcSet_.remove(s)})}onChildInputChange_(s){const r=function(c,f){for(let G=0;G<c.length;G++){const j=c[G];if(j instanceof fe&&j.binding===f)return j}return null}(this.find(fe),s.sender);if(!r)throw X.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:r,options:s.options,sender:this})}onChildMonitorUpdate_(s){const r=function(c,f){for(let G=0;G<c.length;G++){const j=c[G];if(j instanceof ii&&j.binding===f)return j}return null}(this.find(ii),s.sender);if(!r)throw X.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:r,sender:this})}onChildValueChange_(s){const r=function(c,f){for(let G=0;G<c.length;G++){const j=c[G];if(j instanceof Ue&&j.value===f)return j}return null}(this.find(Ue),s.sender);if(!r)throw X.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:r,options:s.options,sender:this})}onDescendantLayout_(s){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(s){this.emitter.emit("inputchange",{bladeController:s.bladeController,options:s.options,sender:this})}onDescendantMonitorUpdate_(s){this.emitter.emit("monitorupdate",{bladeController:s.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Si extends tt{constructor(s,r){super(Object.assign(Object.assign({},r),{view:new Xn(s,{viewName:"brk",viewProps:r.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const c=new Bi(r.root?void 0:r.blade);c.emitter.on("add",this.onRackAdd_),c.emitter.on("remove",this.onRackRemove_),this.rack=c,this.viewProps.handleDispose(()=>{for(let f=this.rack.children.length-1;f>=0;f--)this.rack.children[f].viewProps.set("disposed",!0)})}onRackAdd_(s){s.isRoot&&kt(this.view.element,s.bladeController.view.element,s.index)}onRackRemove_(s){s.isRoot&&Mt(s.bladeController.view.element)}}const ki=H("cnt");class Pr{constructor(s,r){var c;this.className_=H((c=r.viewName)!==null&&c!==void 0?c:"fld"),this.element=s.createElement("div"),this.element.classList.add(this.className_(),ki()),r.viewProps.bindClassModifiers(this.element),this.foldable_=r.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),k(this.foldable_,"completed",b(this.element,this.className_(void 0,"cpl")));const f=s.createElement("button");f.classList.add(this.className_("b")),k(r.props,"title",wt=>{R(wt)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),r.viewProps.bindDisabled(f),this.element.appendChild(f),this.buttonElement=f;const G=s.createElement("div");G.classList.add(this.className_("t")),N(r.props.value("title"),G),this.buttonElement.appendChild(G),this.titleElement=G;const j=s.createElement("div");j.classList.add(this.className_("m")),this.buttonElement.appendChild(j);const ht=r.containerElement;ht.classList.add(this.className_("c")),this.element.appendChild(ht),this.containerElement=ht}}class Be extends Ds{constructor(s,r){var c;const f=ye.create((c=r.expanded)===null||c===void 0||c),G=new Si(s,{blade:r.blade,root:r.root,viewProps:r.viewProps});super(Object.assign(Object.assign({},r),{rackController:G,view:new Pr(s,{containerElement:G.view.element,foldable:f,props:r.props,viewName:r.root?"rot":void 0,viewProps:r.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=r.props,this.foldable=f,ji(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const qi={id:"folder",type:"blade",accept(l){const s=nt,r=B(l,{title:s.required.string,view:s.required.constant("folder"),expanded:s.optional.boolean});return r?{params:r}:null},controller:l=>new Be(l.document,{blade:l.blade,expanded:l.params.expanded,props:mt.fromObject({title:l.params.title}),viewProps:l.viewProps}),api:l=>l.controller instanceof Be?new Qs(l.controller,l.pool):null};class xe extends Ue{constructor(s,r){const c=r.valueController.viewProps;super(Object.assign(Object.assign({},r),{value:r.valueController.value,view:new Kt(s,{props:r.props,viewProps:c}),viewProps:c})),this.props=r.props,this.valueController=r.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Xt extends S{}const un=H("spr");class cs{constructor(s,r){this.element=s.createElement("div"),this.element.classList.add(un()),r.viewProps.bindClassModifiers(this.element);const c=s.createElement("hr");c.classList.add(un("r")),this.element.appendChild(c)}}class Fs extends tt{constructor(s,r){super(Object.assign(Object.assign({},r),{view:new cs(s,{viewProps:r.viewProps})}))}}const go={id:"separator",type:"blade",accept(l){const s=B(l,{view:nt.required.constant("separator")});return s?{params:s}:null},controller:l=>new Fs(l.document,{blade:l.blade,viewProps:l.viewProps}),api:l=>l.controller instanceof Fs?new Xt(l.controller):null},Wn=H("");function Qr(l,s){return b(l,Wn(void 0,s))}class hi extends mt{constructor(s){super(s)}static create(s){var r,c;const f=s??{},G={disabled:(r=f.disabled)!==null&&r!==void 0&&r,disposed:!1,hidden:(c=f.hidden)!==null&&c!==void 0&&c},j=mt.createCore(G);return new hi(j)}bindClassModifiers(s){k(this,"disabled",Qr(s,"disabled")),k(this,"hidden",Qr(s,"hidden"))}bindDisabled(s){k(this,"disabled",r=>{s.disabled=r})}bindTabIndex(s){k(this,"disabled",r=>{s.tabIndex=r?-1:0})}handleDispose(s){this.value("disposed").emitter.on("change",r=>{r&&s()})}}const Me=H("tbi");class fo{constructor(s,r){this.element=s.createElement("div"),this.element.classList.add(Me()),r.viewProps.bindClassModifiers(this.element),k(r.props,"selected",G=>{G?this.element.classList.add(Me(void 0,"sel")):this.element.classList.remove(Me(void 0,"sel"))});const c=s.createElement("button");c.classList.add(Me("b")),r.viewProps.bindDisabled(c),this.element.appendChild(c),this.buttonElement=c;const f=s.createElement("div");f.classList.add(Me("t")),N(r.props.value("title"),f),this.buttonElement.appendChild(f),this.titleElement=f}}class _o{constructor(s,r){this.emitter=new C,this.onClick_=this.onClick_.bind(this),this.props=r.props,this.viewProps=r.viewProps,this.view=new fo(s,{props:r.props,viewProps:r.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class pn{constructor(s,r){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new _o(s,{props:r.itemProps,viewProps:hi.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new Si(s,{blade:Ze(),viewProps:hi.create()}),this.props=r.props,k(this.props,"selected",c=>{this.itemController.props.set("selected",c),this.contentController.viewProps.set("hidden",!c)})}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class Yn{constructor(s,r){this.controller_=s,this.rackApi_=r}get title(){var s;return(s=this.controller_.itemController.props.get("title"))!==null&&s!==void 0?s:""}set title(s){this.controller_.itemController.props.set("title",s)}get selected(){return this.controller_.props.get("selected")}set selected(s){this.controller_.props.set("selected",s)}get children(){return this.rackApi_.children}addButton(s){return this.rackApi_.addButton(s)}addFolder(s){return this.rackApi_.addFolder(s)}addSeparator(s){return this.rackApi_.addSeparator(s)}addTab(s){return this.rackApi_.addTab(s)}add(s,r){this.rackApi_.add(s,r)}remove(s){this.rackApi_.remove(s)}addInput(s,r,c){return this.rackApi_.addInput(s,r,c)}addMonitor(s,r,c){return this.rackApi_.addMonitor(s,r,c)}addBlade(s){return this.rackApi_.addBlade(s)}}class Kn extends $e{constructor(s,r){super(s,new hs(s.rackController,r)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new C,this.pageApiMap_=new Map,this.rackApi_.on("change",c=>{this.emitter_.emit("change",{event:c})}),this.rackApi_.on("update",c=>{this.emitter_.emit("update",{event:c})}),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach(c=>{this.setUpPageApi_(c)})}get pages(){return this.controller_.pageSet.items.map(s=>{const r=this.pageApiMap_.get(s);if(!r)throw X.shouldNeverHappen();return r})}addPage(s){const r=this.controller_.view.element.ownerDocument,c=new pn(r,{itemProps:mt.fromObject({selected:!1,title:s.title}),props:mt.fromObject({selected:!1})});this.controller_.add(c,s.index);const f=this.pageApiMap_.get(c);if(!f)throw X.shouldNeverHappen();return f}removePage(s){this.controller_.remove(s)}on(s,r){const c=r.bind(this);return this.emitter_.on(s,f=>{c(f.event)}),this}setUpPageApi_(s){const r=this.rackApi_.apiSet_.find(f=>f.controller_===s.contentController);if(!r)throw X.shouldNeverHappen();const c=new Yn(s,r);this.pageApiMap_.set(s,c)}onPageAdd_(s){this.setUpPageApi_(s.item)}onPageRemove_(s){if(!this.pageApiMap_.get(s.item))throw X.shouldNeverHappen();this.pageApiMap_.delete(s.item)}onSelect_(s){this.emitter_.emit("select",{event:new V(this,s.rawValue)})}}class qe{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=at(!0),this.selectedIndex=at(-1),this.items_=[]}add(s,r){const c=r??this.items_.length;this.items_.splice(c,0,s),s.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(s){const r=this.items_.indexOf(s);r<0||(this.items_.splice(r,1),s.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0)return this.selectedIndex.rawValue=-1,void(this.empty.rawValue=!0);const s=this.items_.findIndex(r=>r.rawValue);s<0?(this.items_.forEach((r,c)=>{r.rawValue=c===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((r,c)=>{r.rawValue=c===s}),this.selectedIndex.rawValue=s),this.empty.rawValue=!1}onItemSelectedChange_(s){if(s.rawValue){const r=this.items_.findIndex(c=>c===s.sender);this.items_.forEach((c,f)=>{c.rawValue=f===r}),this.selectedIndex.rawValue=r}else this.keepSelection_()}}const si=H("tab");class Pi{constructor(s,r){this.element=s.createElement("div"),this.element.classList.add(si(),ki()),r.viewProps.bindClassModifiers(this.element),I(r.empty,b(this.element,si(void 0,"nop")));const c=s.createElement("div");c.classList.add(si("i")),this.element.appendChild(c),this.itemsElement=c;const f=r.contentsElement;f.classList.add(si("c")),this.element.appendChild(f),this.contentsElement=f}}class le extends Ds{constructor(s,r){const c=new Si(s,{blade:r.blade,viewProps:r.viewProps}),f=new qe;super({blade:r.blade,rackController:c,view:new Pi(s,{contentsElement:c.view.element,empty:f.empty,viewProps:r.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new ti(()=>null),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=f}get pageSet(){return this.pageSet_}add(s,r){this.pageSet_.add(s,r)}remove(s){this.pageSet_.remove(this.pageSet_.items[s])}onPageAdd_(s){const r=s.item;kt(this.view.itemsElement,r.itemController.view.element,s.index),this.rackController.rack.add(r.contentController,s.index),this.tab.add(r.props.value("selected"))}onPageRemove_(s){const r=s.item;Mt(r.itemController.view.element),this.rackController.rack.remove(r.contentController),this.tab.remove(r.props.value("selected"))}}const Dr={id:"tab",type:"blade",accept(l){const s=nt,r=B(l,{pages:s.required.array(s.required.object({title:s.required.string})),view:s.required.constant("tab")});return r&&r.pages.length!==0?{params:r}:null},controller(l){const s=new le(l.document,{blade:l.blade,viewProps:l.viewProps});return l.params.pages.forEach(r=>{const c=new pn(l.document,{itemProps:mt.fromObject({selected:!1,title:r.title}),props:mt.fromObject({selected:!1})});s.add(c)}),s},api:l=>l.controller instanceof le?new Kn(l.controller,l.pool):null};class mo{constructor(){this.disabled=!1,this.emitter=new C}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class vo{constructor(s,r){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=s,this.emitter=new C,this.interval_=r,this.setTimer_()}get disabled(){return this.disabled_}set disabled(s){this.disabled_=s,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const s=this.doc_.defaultView;s&&s.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const s=this.doc_.defaultView;s&&(this.timerId_=s.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class Ms{constructor(s){this.constraints=s}constrain(s){return this.constraints.reduce((r,c)=>c.constrain(r),s)}}function ci(l,s){if(l instanceof s)return l;if(l instanceof Ms){const r=l.constraints.reduce((c,f)=>c||(f instanceof s?f:null),null);if(r)return r}return null}class Rs{constructor(s){this.options=s}constrain(s){const r=this.options;return r.length===0||r.filter(c=>c.value===s).length>0?s:r[0].value}}class ds{constructor(s){this.maxValue=s.max,this.minValue=s.min}constrain(s){let r=s;return R(this.minValue)||(r=Math.max(r,this.minValue)),R(this.maxValue)||(r=Math.min(r,this.maxValue)),r}}class Wi{constructor(s,r=0){this.step=s,this.origin=r}constrain(s){const r=this.origin%this.step;return r+Math.round((s-r)/this.step)*this.step}}const Jn=H("lst");class wo{constructor(s,r){this.onValueChange_=this.onValueChange_.bind(this),this.props_=r.props,this.element=s.createElement("div"),this.element.classList.add(Jn()),r.viewProps.bindClassModifiers(this.element);const c=s.createElement("select");c.classList.add(Jn("s")),k(this.props_,"options",G=>{Wt(c),G.forEach((j,ht)=>{const wt=s.createElement("option");wt.dataset.index=String(ht),wt.textContent=j.text,wt.value=String(j.value),c.appendChild(wt)})}),r.viewProps.bindDisabled(c),this.element.appendChild(c),this.selectElement=c;const f=s.createElement("div");f.classList.add(Jn("m")),f.appendChild(yt(s,"dropdown")),this.element.appendChild(f),r.value.emitter.on("change",this.onValueChange_),this.value_=r.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class Ls{constructor(s,r){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=r.props,this.value=r.value,this.viewProps=r.viewProps,this.view=new wo(s,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(s){const r=s.currentTarget.selectedOptions.item(0);if(!r)return;const c=Number(r.dataset.index);this.value.rawValue=this.props.get("options")[c].value}}const Tr=H("pop");class bo{constructor(s,r){this.element=s.createElement("div"),this.element.classList.add(Tr()),r.viewProps.bindClassModifiers(this.element),I(r.shows,b(this.element,Tr(void 0,"v")))}}class Fr{constructor(s,r){this.shows=at(!1),this.viewProps=r.viewProps,this.view=new bo(s,{shows:this.shows,viewProps:this.viewProps})}}const Mr=H("txt");class Co{constructor(s,r){this.onChange_=this.onChange_.bind(this),this.element=s.createElement("div"),this.element.classList.add(Mr()),r.viewProps.bindClassModifiers(this.element),this.props_=r.props,this.props_.emitter.on("change",this.onChange_);const c=s.createElement("input");c.classList.add(Mr("i")),c.type="text",r.viewProps.bindDisabled(c),this.element.appendChild(c),this.inputElement=c,r.value.emitter.on("change",this.onChange_),this.value_=r.value,this.refresh()}refresh(){const s=this.props_.get("formatter");this.inputElement.value=s(this.value_.rawValue)}onChange_(){this.refresh()}}class gn{constructor(s,r){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=r.parser,this.props=r.props,this.value=r.value,this.viewProps=r.viewProps,this.view=new Co(s,{props:r.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(s){const r=s.currentTarget.value,c=this.parser_(r);R(c)||(this.value.rawValue=c),this.view.refresh()}}function Zn(l){return l!=="false"&&!!l}function Rr(l){return function(s){return String(s)}(l)}class Ut{constructor(s){this.text=s}evaluate(){return Number(this.text)}toString(){return this.text}}const yo={"**":(l,s)=>Math.pow(l,s),"*":(l,s)=>l*s,"/":(l,s)=>l/s,"%":(l,s)=>l%s,"+":(l,s)=>l+s,"-":(l,s)=>l-s,"<<":(l,s)=>l<<s,">>":(l,s)=>l>>s,">>>":(l,s)=>l>>>s,"&":(l,s)=>l&s,"^":(l,s)=>l^s,"|":(l,s)=>l|s};class Ns{constructor(s,r,c){this.left=r,this.operator=s,this.right=c}evaluate(){const s=yo[this.operator];if(!s)throw new Error(`unexpected binary operator: '${this.operator}`);return s(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const he={"+":l=>l,"-":l=>-l,"~":l=>~l};class xo{constructor(s,r){this.operator=s,this.expression=r}evaluate(){const s=he[this.operator];if(!s)throw new Error(`unexpected unary operator: '${this.operator}`);return s(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function As(l){return(s,r)=>{for(let c=0;c<l.length;c++){const f=l[c](s,r);if(f!=="")return f}return""}}function re(l,s){var r;const c=l.substr(s).match(/^\s+/);return(r=c&&c[0])!==null&&r!==void 0?r:""}function Yi(l,s){var r;const c=l.substr(s).match(/^[0-9]+/);return(r=c&&c[0])!==null&&r!==void 0?r:""}function Gs(l,s){const r=l.substr(s,1);if(s+=1,r.toLowerCase()!=="e")return"";const c=function(f,G){const j=Yi(f,G);if(j!=="")return j;const ht=f.substr(G,1);if(ht!=="-"&&ht!=="+")return"";const wt=Yi(f,G+=1);return wt===""?"":ht+wt}(l,s);return c===""?"":r+c}function Ki(l,s){const r=l.substr(s,1);if(r==="0")return r;const c=function(f,G){const j=f.substr(G,1);return j.match(/^[1-9]$/)?j:""}(l,s);return s+=c.length,c===""?"":c+Yi(l,s)}const Io=As([function(l,s){const r=Ki(l,s);if(s+=r.length,r==="")return"";const c=l.substr(s,1);if(s+=c.length,c!==".")return"";const f=Yi(l,s);return r+c+f+Gs(l,s+=f.length)},function(l,s){const r=l.substr(s,1);if(s+=r.length,r!==".")return"";const c=Yi(l,s);return s+=c.length,c===""?"":r+c+Gs(l,s)},function(l,s){const r=Ki(l,s);return s+=r.length,r===""?"":r+Gs(l,s)}]),Ji=As([function(l,s){const r=l.substr(s,2);if(s+=r.length,r.toLowerCase()!=="0b")return"";const c=function(f,G){var j;const ht=f.substr(G).match(/^[01]+/);return(j=ht&&ht[0])!==null&&j!==void 0?j:""}(l,s);return c===""?"":r+c},function(l,s){const r=l.substr(s,2);if(s+=r.length,r.toLowerCase()!=="0o")return"";const c=function(f,G){var j;const ht=f.substr(G).match(/^[0-7]+/);return(j=ht&&ht[0])!==null&&j!==void 0?j:""}(l,s);return c===""?"":r+c},function(l,s){const r=l.substr(s,2);if(s+=r.length,r.toLowerCase()!=="0x")return"";const c=function(f,G){var j;const ht=f.substr(G).match(/^[0-9a-f]+/i);return(j=ht&&ht[0])!==null&&j!==void 0?j:""}(l,s);return c===""?"":r+c}]),We=As([Ji,Io]);function $n(l,s){var r;return(r=function(c,f){const G=We(c,f);return f+=G.length,G===""?null:{evaluable:new Ut(G),cursor:f}}(l,s))!==null&&r!==void 0?r:function(c,f){const G=c.substr(f,1);if(f+=G.length,G!=="(")return null;const j=fn(c,f);if(!j)return null;f=j.cursor,f+=re(c,f).length;const ht=c.substr(f,1);return f+=ht.length,ht!==")"?null:{evaluable:j.evaluable,cursor:f}}(l,s)}function Eo(l,s,r){r+=re(s,r).length;const c=l.filter(f=>s.startsWith(f,r))[0];return c?(r+=c.length,{cursor:r+=re(s,r).length,operator:c}):null}const Bo=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((l,s)=>function(r,c){return(f,G)=>{const j=r(f,G);if(!j)return null;G=j.cursor;let ht=j.evaluable;for(;;){const wt=Eo(c,f,G);if(!wt)break;G=wt.cursor;const Dt=r(f,G);if(!Dt)return null;G=Dt.cursor,ht=new Ns(wt.operator,ht,Dt.evaluable)}return ht?{cursor:G,evaluable:ht}:null}}(l,s),function l(s,r){const c=$n(s,r);if(c)return c;const f=s.substr(r,1);if(r+=f.length,f!=="+"&&f!=="-"&&f!=="~")return null;const G=l(s,r);return G?{cursor:r=G.cursor,evaluable:new xo(f,G.evaluable)}:null});function fn(l,s){return s+=re(l,s).length,Bo(l,s)}function fi(l){var s;const r=function(c){const f=fn(c,0);return f?f.cursor+re(c,f.cursor).length!==c.length?null:f.evaluable:null}(l);return(s=r==null?void 0:r.evaluate())!==null&&s!==void 0?s:null}function Lr(l){if(typeof l=="number")return l;if(typeof l=="string"){const s=fi(l);if(!R(s))return s}return 0}function So(l){return String(l)}function ce(l){return s=>s.toFixed(Math.max(Math.min(l,20),0))}const _n=ce(0);function us(l){return _n(l)+"%"}function zs(l){return String(l)}function mn(l){return l}function vn(l,s){for(;l.length<s;)l.push(void 0)}function Qi(l){const s=[];return vn(s,l),at(s)}function Nr(l){const s=l.indexOf(void 0);return s<0?l:l.slice(0,s)}function Vs({primary:l,secondary:s,forward:r,backward:c}){let f=!1;function G(j){f||(f=!0,j(),f=!1)}l.emitter.on("change",j=>{G(()=>{s.setRawValue(r(l,s),j.options)})}),s.emitter.on("change",j=>{G(()=>{l.setRawValue(c(l,s),j.options)}),G(()=>{s.setRawValue(r(l,s),j.options)})}),G(()=>{s.setRawValue(r(l,s),{forceEmit:!1,last:!0})})}function Re(l,s){const r=l*(s.altKey?.1:1)*(s.shiftKey?10:1);return s.upKey?+r:s.downKey?-r:0}function ps(l){return{altKey:l.altKey,downKey:l.key==="ArrowDown",shiftKey:l.shiftKey,upKey:l.key==="ArrowUp"}}function di(l){return{altKey:l.altKey,downKey:l.key==="ArrowLeft",shiftKey:l.shiftKey,upKey:l.key==="ArrowRight"}}function tr(l){return function(s){return s==="ArrowUp"||s==="ArrowDown"}(l)||l==="ArrowLeft"||l==="ArrowRight"}function Gt(l,s){var r,c;const f=s.ownerDocument.defaultView,G=s.getBoundingClientRect();return{x:l.pageX-(((r=f&&f.scrollX)!==null&&r!==void 0?r:0)+G.left),y:l.pageY-(((c=f&&f.scrollY)!==null&&c!==void 0?c:0)+G.top)}}class Di{constructor(s){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=s,this.emitter=new C,s.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),s.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),s.addEventListener("touchend",this.onTouchEnd_),s.addEventListener("mousedown",this.onMouseDown_)}computePosition_(s){const r=this.elem_.getBoundingClientRect();return{bounds:{width:r.width,height:r.height},point:s?{x:s.x,y:s.y}:null}}onMouseDown_(s){var r;s.preventDefault(),(r=s.currentTarget)===null||r===void 0||r.focus();const c=this.elem_.ownerDocument;c.addEventListener("mousemove",this.onDocumentMouseMove_),c.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:s.altKey,data:this.computePosition_(Gt(s,this.elem_)),sender:this,shiftKey:s.shiftKey})}onDocumentMouseMove_(s){this.emitter.emit("move",{altKey:s.altKey,data:this.computePosition_(Gt(s,this.elem_)),sender:this,shiftKey:s.shiftKey})}onDocumentMouseUp_(s){const r=this.elem_.ownerDocument;r.removeEventListener("mousemove",this.onDocumentMouseMove_),r.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:s.altKey,data:this.computePosition_(Gt(s,this.elem_)),sender:this,shiftKey:s.shiftKey})}onTouchStart_(s){s.preventDefault();const r=s.targetTouches.item(0),c=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:s.altKey,data:this.computePosition_(r?{x:r.clientX-c.left,y:r.clientY-c.top}:void 0),sender:this,shiftKey:s.shiftKey}),this.lastTouch_=r}onTouchMove_(s){const r=s.targetTouches.item(0),c=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:s.altKey,data:this.computePosition_(r?{x:r.clientX-c.left,y:r.clientY-c.top}:void 0),sender:this,shiftKey:s.shiftKey}),this.lastTouch_=r}onTouchEnd_(s){var r;const c=(r=s.targetTouches.item(0))!==null&&r!==void 0?r:this.lastTouch_,f=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:s.altKey,data:this.computePosition_(c?{x:c.clientX-f.left,y:c.clientY-f.top}:void 0),sender:this,shiftKey:s.shiftKey})}}function Zt(l,s,r,c,f){return c+(l-s)/(r-s)*(f-c)}function Gr(l){return String(l.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function de(l,s,r){return Math.min(Math.max(l,s),r)}function er(l,s){return(l%s+s)%s}const Ye=H("txt");class Zi{constructor(s,r){this.onChange_=this.onChange_.bind(this),this.props_=r.props,this.props_.emitter.on("change",this.onChange_),this.element=s.createElement("div"),this.element.classList.add(Ye(),Ye(void 0,"num")),r.arrayPosition&&this.element.classList.add(Ye(void 0,r.arrayPosition)),r.viewProps.bindClassModifiers(this.element);const c=s.createElement("input");c.classList.add(Ye("i")),c.type="text",r.viewProps.bindDisabled(c),this.element.appendChild(c),this.inputElement=c,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=r.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Ye()),this.inputElement.classList.add(Ye("i"));const f=s.createElement("div");f.classList.add(Ye("k")),this.element.appendChild(f),this.knobElement=f;const G=s.createElementNS(rt,"svg");G.classList.add(Ye("g")),this.knobElement.appendChild(G);const j=s.createElementNS(rt,"path");j.classList.add(Ye("gb")),G.appendChild(j),this.guideBodyElem_=j;const ht=s.createElementNS(rt,"path");ht.classList.add(Ye("gh")),G.appendChild(ht),this.guideHeadElem_=ht;const wt=s.createElement("div");wt.classList.add(H("tt")()),this.knobElement.appendChild(wt),this.tooltipElem_=wt,r.value.emitter.on("change",this.onChange_),this.value=r.value,this.refresh()}onDraggingChange_(s){if(s.rawValue===null)return void this.element.classList.remove(Ye(void 0,"drg"));this.element.classList.add(Ye(void 0,"drg"));const r=s.rawValue/this.props_.get("draggingScale"),c=r+(r>0?-1:r<0?1:0),f=de(-c,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${c+f},0 L${c},4 L${c+f},8`,`M ${r},-1 L${r},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${r},4`);const G=this.props_.get("formatter");this.tooltipElem_.textContent=G(this.value.rawValue),this.tooltipElem_.style.left=`${r}px`}refresh(){const s=this.props_.get("formatter");this.inputElement.value=s(this.value.rawValue)}onChange_(){this.refresh()}}class Ti{constructor(s,r){var c;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=r.baseStep,this.parser_=r.parser,this.props=r.props,this.sliderProps_=(c=r.sliderProps)!==null&&c!==void 0?c:null,this.value=r.value,this.viewProps=r.viewProps,this.dragging_=at(null),this.view=new Zi(s,{arrayPosition:r.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const f=new Di(this.view.knobElement);f.emitter.on("down",this.onPointerDown_),f.emitter.on("move",this.onPointerMove_),f.emitter.on("up",this.onPointerUp_)}constrainValue_(s){var r,c;const f=(r=this.sliderProps_)===null||r===void 0?void 0:r.get("minValue"),G=(c=this.sliderProps_)===null||c===void 0?void 0:c.get("maxValue");let j=s;return f!==void 0&&(j=Math.max(j,f)),G!==void 0&&(j=Math.min(j,G)),j}onInputChange_(s){const r=s.currentTarget.value,c=this.parser_(r);R(c)||(this.value.rawValue=this.constrainValue_(c)),this.view.refresh()}onInputKeyDown_(s){const r=Re(this.baseStep_,ps(s));r!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+r),{forceEmit:!1,last:!1})}onInputKeyUp_(s){Re(this.baseStep_,ps(s))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(s){if(!s.point)return null;const r=s.point.x-s.bounds.width/2;return this.constrainValue_(this.originRawValue_+r*this.props.get("draggingScale"))}onPointerMove_(s){const r=this.computeDraggingValue_(s.data);r!==null&&(this.value.setRawValue(r,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(s){const r=this.computeDraggingValue_(s.data);r!==null&&(this.value.setRawValue(r,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const gs=H("sld");class Ft{constructor(s,r){this.onChange_=this.onChange_.bind(this),this.props_=r.props,this.props_.emitter.on("change",this.onChange_),this.element=s.createElement("div"),this.element.classList.add(gs()),r.viewProps.bindClassModifiers(this.element);const c=s.createElement("div");c.classList.add(gs("t")),r.viewProps.bindTabIndex(c),this.element.appendChild(c),this.trackElement=c;const f=s.createElement("div");f.classList.add(gs("k")),this.trackElement.appendChild(f),this.knobElement=f,r.value.emitter.on("change",this.onChange_),this.value=r.value,this.update_()}update_(){const s=de(Zt(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${s}%`}onChange_(){this.update_()}}class je{constructor(s,r){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=r.baseStep,this.value=r.value,this.viewProps=r.viewProps,this.props=r.props,this.view=new Ft(s,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Di(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(s,r){s.point&&this.value.setRawValue(Zt(de(s.point.x,0,s.bounds.width),0,s.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),r)}onPointerDownOrMove_(s){this.handlePointerEvent_(s.data,{forceEmit:!1,last:!1})}onPointerUp_(s){this.handlePointerEvent_(s.data,{forceEmit:!0,last:!0})}onKeyDown_(s){const r=Re(this.baseStep_,di(s));r!==0&&this.value.setRawValue(this.value.rawValue+r,{forceEmit:!1,last:!1})}onKeyUp_(s){Re(this.baseStep_,di(s))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Os=H("sldtxt");class zr{constructor(s,r){this.element=s.createElement("div"),this.element.classList.add(Os());const c=s.createElement("div");c.classList.add(Os("s")),this.sliderView_=r.sliderView,c.appendChild(this.sliderView_.element),this.element.appendChild(c);const f=s.createElement("div");f.classList.add(Os("t")),this.textView_=r.textView,f.appendChild(this.textView_.element),this.element.appendChild(f)}}class $i{constructor(s,r){this.value=r.value,this.viewProps=r.viewProps,this.sliderC_=new je(s,{baseStep:r.baseStep,props:r.sliderProps,value:r.value,viewProps:this.viewProps}),this.textC_=new Ti(s,{baseStep:r.baseStep,parser:r.parser,props:r.textProps,sliderProps:r.sliderProps,value:r.value,viewProps:r.viewProps}),this.view=new zr(s,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function Hs(l,s){l.write(s)}function Se(l){const s=nt;return Array.isArray(l)?s.required.array(s.required.object({text:s.required.string,value:s.required.raw}))(l).value:typeof l=="object"?s.required.raw(l).value:void 0}function wn(l){if(l==="inline"||l==="popup")return l}function Ie(l){const s=nt;return s.required.object({max:s.optional.number,min:s.optional.number,step:s.optional.number})(l).value}function Pt(l){if(Array.isArray(l))return l;const s=[];return Object.keys(l).forEach(r=>{s.push({text:r,value:l[r]})}),s}function ie(l){return R(l)?null:new Rs(Pt(l))}function ni(l){const s=l?ci(l,Rs):null;return s?s.options:null}function ke(l,s){const r=l&&ci(l,Wi);return r?Gr(r.step):Math.max(Gr(s),2)}function Ai(l){const s=function(r){const c=r?ci(r,Wi):null;return c?c.step:null}(l);return s??1}function Fi(l,s){var r;const c=l&&ci(l,Wi),f=Math.abs((r=c==null?void 0:c.step)!==null&&r!==void 0?r:s);return f===0?.1:Math.pow(10,Math.floor(Math.log10(f))-1)}const fs=H("ckb");class _i{constructor(s,r){this.onValueChange_=this.onValueChange_.bind(this),this.element=s.createElement("div"),this.element.classList.add(fs()),r.viewProps.bindClassModifiers(this.element);const c=s.createElement("label");c.classList.add(fs("l")),this.element.appendChild(c);const f=s.createElement("input");f.classList.add(fs("i")),f.type="checkbox",c.appendChild(f),this.inputElement=f,r.viewProps.bindDisabled(this.inputElement);const G=s.createElement("div");G.classList.add(fs("w")),c.appendChild(G);const j=yt(s,"check");G.appendChild(j),r.value.emitter.on("change",this.onValueChange_),this.value=r.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class ir{constructor(s,r){this.onInputChange_=this.onInputChange_.bind(this),this.value=r.value,this.viewProps=r.viewProps,this.view=new _i(s,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(s){const r=s.currentTarget;this.value.rawValue=r.checked}}const Mi={id:"input-bool",type:"input",accept:(l,s)=>{if(typeof l!="boolean")return null;const r=B(s,{options:nt.optional.custom(Se)});return r?{initialValue:l,params:r}:null},binding:{reader:l=>Zn,constraint:l=>function(s){const r=[],c=ie(s.options);return c&&r.push(c),new Ms(r)}(l.params),writer:l=>Hs},controller:l=>{var s;const r=l.document,c=l.value,f=l.constraint;return f&&ci(f,Rs)?new Ls(r,{props:mt.fromObject({options:(s=ni(f))!==null&&s!==void 0?s:[]}),value:c,viewProps:l.viewProps}):new ir(r,{value:c,viewProps:l.viewProps})}},Ae=H("col");class Le{constructor(s,r){this.element=s.createElement("div"),this.element.classList.add(Ae()),r.foldable.bindExpandedClass(this.element,Ae(void 0,"expanded")),k(r.foldable,"completed",b(this.element,Ae(void 0,"cpl")));const c=s.createElement("div");c.classList.add(Ae("h")),this.element.appendChild(c);const f=s.createElement("div");f.classList.add(Ae("s")),c.appendChild(f),this.swatchElement=f;const G=s.createElement("div");if(G.classList.add(Ae("t")),c.appendChild(G),this.textElement=G,r.pickerLayout==="inline"){const j=s.createElement("div");j.classList.add(Ae("p")),this.element.appendChild(j),this.pickerElement=j}else this.pickerElement=null}}function Us(l,s,r){const c=er(l,360),f=de(s/100,0,1),G=de(r/100,0,1),j=G*f,ht=j*(1-Math.abs(c/60%2-1)),wt=G-j;let Dt,jt,me;return[Dt,jt,me]=c>=0&&c<60?[j,ht,0]:c>=60&&c<120?[ht,j,0]:c>=120&&c<180?[0,j,ht]:c>=180&&c<240?[0,ht,j]:c>=240&&c<300?[ht,0,j]:[j,0,ht],[255*(Dt+wt),255*(jt+wt),255*(me+wt)]}function Pe(l){return[l[0],l[1],l[2]]}function ve(l,s){return[l[0],l[1],l[2],s]}const ts={hsl:{hsl:(l,s,r)=>[l,s,r],hsv:function(l,s,r){const c=r+s*(100-Math.abs(2*r-100))/200;return[l,c!==0?s*(100-Math.abs(2*r-100))/c:0,r+s*(100-Math.abs(2*r-100))/200]},rgb:function(l,s,r){const c=(l%360+360)%360,f=de(s/100,0,1),G=de(r/100,0,1),j=(1-Math.abs(2*G-1))*f,ht=j*(1-Math.abs(c/60%2-1)),wt=G-j/2;let Dt,jt,me;return[Dt,jt,me]=c>=0&&c<60?[j,ht,0]:c>=60&&c<120?[ht,j,0]:c>=120&&c<180?[0,j,ht]:c>=180&&c<240?[0,ht,j]:c>=240&&c<300?[ht,0,j]:[j,0,ht],[255*(Dt+wt),255*(jt+wt),255*(me+wt)]}},hsv:{hsl:function(l,s,r){const c=100-Math.abs(r*(200-s)/100-100);return[l,c!==0?s*r/c:0,r*(200-s)/200]},hsv:(l,s,r)=>[l,s,r],rgb:Us},rgb:{hsl:function(l,s,r){const c=de(l/255,0,1),f=de(s/255,0,1),G=de(r/255,0,1),j=Math.max(c,f,G),ht=Math.min(c,f,G),wt=j-ht;let Dt=0,jt=0;const me=(ht+j)/2;return wt!==0&&(jt=wt/(1-Math.abs(j+ht-1)),Dt=c===j?(f-G)/wt:f===j?2+(G-c)/wt:4+(c-f)/wt,Dt=Dt/6+(Dt<0?1:0)),[360*Dt,100*jt,100*me]},hsv:function(l,s,r){const c=de(l/255,0,1),f=de(s/255,0,1),G=de(r/255,0,1),j=Math.max(c,f,G),ht=j-Math.min(c,f,G);let wt;return wt=ht===0?0:j===c?((f-G)/ht%6+6)%6*60:j===f?60*((G-c)/ht+2):60*((c-f)/ht+4),[wt,100*(j===0?0:ht/j),100*j]},rgb:(l,s,r)=>[l,s,r]}};function _s(l,s){return[s==="float"?1:l==="rgb"?255:360,s==="float"?1:l==="rgb"?255:100,s==="float"?1:l==="rgb"?255:100]}function Ke(l,s,r,c){const f=_s(s,r),G=_s(s,c);return l.map((j,ht)=>j/f[ht]*G[ht])}function Ee(l,s){return typeof l=="object"&&!R(l)&&s in l&&typeof l[s]=="number"}class Nt{constructor(s,r,c="int"){this.mode=r,this.type=c,this.comps_=function(f,G,j){var ht;const wt=_s(G,j);return[G==="rgb"?de(f[0],0,wt[0]):er(f[0],wt[0]),de(f[1],0,wt[1]),de(f[2],0,wt[2]),de((ht=f[3])!==null&&ht!==void 0?ht:1,0,1)]}(s,r,c)}static black(s="int"){return new Nt([0,0,0],"rgb",s)}static fromObject(s,r="int"){const c="a"in s?[s.r,s.g,s.b,s.a]:[s.r,s.g,s.b];return new Nt(c,"rgb",r)}static toRgbaObject(s,r="int"){return s.toRgbaObject(r)}static isRgbColorObject(s){return Ee(s,"r")&&Ee(s,"g")&&Ee(s,"b")}static isRgbaColorObject(s){return this.isRgbColorObject(s)&&Ee(s,"a")}static isColorObject(s){return this.isRgbColorObject(s)}static equals(s,r){if(s.mode!==r.mode)return!1;const c=s.comps_,f=r.comps_;for(let G=0;G<c.length;G++)if(c[G]!==f[G])return!1;return!0}getComponents(s,r="int"){return ve(function(c,f,G){const j=Ke(c,f.mode,f.type,"int");return Ke(ts[f.mode][G.mode](...j),G.mode,"int",G.type)}(Pe(this.comps_),{mode:this.mode,type:this.type},{mode:s??this.mode,type:r}),this.comps_[3])}toRgbaObject(s="int"){const r=this.getComponents("rgb",s);return{r:r[0],g:r[1],b:r[2],a:r[3]}}}const se=H("colp");class _e{constructor(s,r){this.alphaViews_=null,this.element=s.createElement("div"),this.element.classList.add(se());const c=s.createElement("div");c.classList.add(se("hsv"));const f=s.createElement("div");f.classList.add(se("sv")),this.svPaletteView_=r.svPaletteView,f.appendChild(this.svPaletteView_.element),c.appendChild(f);const G=s.createElement("div");G.classList.add(se("h")),this.hPaletteView_=r.hPaletteView,G.appendChild(this.hPaletteView_.element),c.appendChild(G),this.element.appendChild(c);const j=s.createElement("div");if(j.classList.add(se("rgb")),this.textView_=r.textView,j.appendChild(this.textView_.element),this.element.appendChild(j),r.alphaViews){this.alphaViews_={palette:r.alphaViews.palette,text:r.alphaViews.text};const ht=s.createElement("div");ht.classList.add(se("a"));const wt=s.createElement("div");wt.classList.add(se("ap")),wt.appendChild(this.alphaViews_.palette.element),ht.appendChild(wt);const Dt=s.createElement("div");Dt.classList.add(se("at")),Dt.appendChild(this.alphaViews_.text.element),ht.appendChild(Dt),this.element.appendChild(ht)}}get allFocusableElements(){const s=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map(r=>r.inputElement)];return this.alphaViews_&&s.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),s}}function Ne(l){return l==="int"?"int":l==="float"?"float":void 0}function Ht(l){const s=nt;return B(l,{alpha:s.optional.boolean,color:s.optional.object({alpha:s.optional.boolean,type:s.optional.custom(Ne)}),expanded:s.optional.boolean,picker:s.optional.custom(wn)})}function Ri(l){return l?.1:1}function Li(l){var s;return(s=l.color)===null||s===void 0?void 0:s.type}function Xe(l,s){const r=l.match(/^(.+)%$/);return Math.min(r?.01*parseFloat(r[1])*s:parseFloat(l),s)}const Vr={deg:l=>l,grad:l=>360*l/400,rad:l=>360*l/(2*Math.PI),turn:l=>360*l};function we(l){const s=l.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!s)return parseFloat(l);const r=parseFloat(s[1]),c=s[2];return Vr[c](r)}function bn(l){const s=l.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!s)return null;const r=[Xe(s[1],255),Xe(s[2],255),Xe(s[3],255)];return isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function Cn(l){return s=>{const r=bn(s);return r?new Nt(r,"rgb",l):null}}function sr(l){const s=l.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!s)return null;const r=[Xe(s[1],255),Xe(s[2],255),Xe(s[3],255),Xe(s[4],1)];return isNaN(r[0])||isNaN(r[1])||isNaN(r[2])||isNaN(r[3])?null:r}function Qe(l){return s=>{const r=sr(s);return r?new Nt(r,"rgb",l):null}}function js(l){const s=l.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!s)return null;const r=[we(s[1]),Xe(s[2],100),Xe(s[3],100)];return isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function Xs(l){return s=>{const r=js(s);return r?new Nt(r,"hsl",l):null}}function es(l){const s=l.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!s)return null;const r=[we(s[1]),Xe(s[2],100),Xe(s[3],100),Xe(s[4],1)];return isNaN(r[0])||isNaN(r[1])||isNaN(r[2])||isNaN(r[3])?null:r}function ne(l){return s=>{const r=es(s);return r?new Nt(r,"hsl",l):null}}function nr(l){const s=l.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(s)return[parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16),parseInt(s[3]+s[3],16)];const r=l.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return r?[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)]:null}function rr(l){const s=l.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(s)return[parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16),parseInt(s[3]+s[3],16),Zt(parseInt(s[4]+s[4],16),0,255,0,1)];const r=l.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return r?[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16),Zt(parseInt(r[4],16),0,255,0,1)]:null}function or(l){const s=l.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!s)return null;const r=[parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3])];return isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function ar(l){return s=>{const r=or(s);return r?new Nt(r,"rgb",l):null}}function lr(l){const s=l.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!s)return null;const r=[parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]),parseFloat(s[4])];return isNaN(r[0])||isNaN(r[1])||isNaN(r[2])||isNaN(r[3])?null:r}function ze(l){return s=>{const r=lr(s);return r?new Nt(r,"rgb",l):null}}const Or=[{parser:nr,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:rr,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:bn,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:sr,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:js,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:es,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:or,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:lr,result:{alpha:!0,mode:"rgb",notation:"object"}}];function yn(l,s="int"){const r=function(c){return Or.reduce((f,{parser:G,result:j})=>f||(G(c)?j:null),null)}(l);return r?r.notation==="hex"&&s!=="float"?Object.assign(Object.assign({},r),{type:"int"}):r.notation==="func"?Object.assign(Object.assign({},r),{type:s}):null:null}const hr={int:[function(l){const s=nr(l);return s?new Nt(s,"rgb","int"):null},function(l){const s=rr(l);return s?new Nt(s,"rgb","int"):null},Cn("int"),Qe("int"),Xs("int"),ne("int"),ar("int"),ze("int")],float:[Cn("float"),Qe("float"),Xs("float"),ne("float"),ar("float"),ze("float")]};function xn(l){const s=hr[l];return r=>s.reduce((c,f)=>c||f(r),null)}function cr(l){const s=de(Math.floor(l),0,255).toString(16);return s.length===1?`0${s}`:s}function dr(l,s="#"){return`${s}${Pe(l.getComponents("rgb")).map(cr).join("")}`}function In(l,s="#"){const r=l.getComponents("rgb");return`${s}${[r[0],r[1],r[2],255*r[3]].map(cr).join("")}`}function Ar(l,s){const r=ce(s==="float"?2:0);return`rgb(${Pe(l.getComponents("rgb",s)).map(c=>r(c)).join(", ")})`}function Hr(l){return s=>Ar(s,l)}function qs(l,s){const r=ce(2),c=ce(s==="float"?2:0);return`rgba(${l.getComponents("rgb",s).map((f,G)=>(G===3?r:c)(f)).join(", ")})`}function Ur(l){return s=>qs(s,l)}function En(l,s){const r=ce(s==="float"?2:0),c=["r","g","b"];return`{${Pe(l.getComponents("rgb",s)).map((f,G)=>`${c[G]}: ${r(f)}`).join(", ")}}`}function ur(l){return s=>En(s,l)}function ms(l,s){const r=ce(2),c=ce(s==="float"?2:0),f=["r","g","b","a"];return`{${l.getComponents("rgb",s).map((G,j)=>`${f[j]}: ${(j===3?r:c)(G)}`).join(", ")}}`}function vs(l){return s=>ms(s,l)}const Bn=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:dr},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:In},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:function(l){const s=[ce(0),us,us];return`hsl(${Pe(l.getComponents("hsl")).map((r,c)=>s[c](r)).join(", ")})`}},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:function(l){const s=[ce(0),us,us,ce(2)];return`hsla(${l.getComponents("hsl").map((r,c)=>s[c](r)).join(", ")})`}},...["int","float"].reduce((l,s)=>[...l,{format:{alpha:!1,mode:"rgb",notation:"func",type:s},stringifier:Hr(s)},{format:{alpha:!0,mode:"rgb",notation:"func",type:s},stringifier:Ur(s)},{format:{alpha:!1,mode:"rgb",notation:"object",type:s},stringifier:ur(s)},{format:{alpha:!0,mode:"rgb",notation:"object",type:s},stringifier:vs(s)}],[])];function ws(l){return Bn.reduce((s,r)=>{return s||(c=r.format,f=l,c.alpha===f.alpha&&c.mode===f.mode&&c.notation===f.notation&&c.type===f.type?r.stringifier:null);var c,f},null)}const Ni=H("apl");class Sn{constructor(s,r){this.onValueChange_=this.onValueChange_.bind(this),this.value=r.value,this.value.emitter.on("change",this.onValueChange_),this.element=s.createElement("div"),this.element.classList.add(Ni()),r.viewProps.bindTabIndex(this.element);const c=s.createElement("div");c.classList.add(Ni("b")),this.element.appendChild(c);const f=s.createElement("div");f.classList.add(Ni("c")),c.appendChild(f),this.colorElem_=f;const G=s.createElement("div");G.classList.add(Ni("m")),this.element.appendChild(G),this.markerElem_=G;const j=s.createElement("div");j.classList.add(Ni("p")),this.markerElem_.appendChild(j),this.previewElem_=j,this.update_()}update_(){const s=this.value.rawValue,r=s.getComponents("rgb"),c=new Nt([r[0],r[1],r[2],0],"rgb"),f=new Nt([r[0],r[1],r[2],255],"rgb"),G=["to right",qs(c),qs(f)];this.colorElem_.style.background=`linear-gradient(${G.join(",")})`,this.previewElem_.style.backgroundColor=qs(s);const j=Zt(r[3],0,1,0,100);this.markerElem_.style.left=`${j}%`}onValueChange_(){this.update_()}}class kn{constructor(s,r){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=r.value,this.viewProps=r.viewProps,this.view=new Sn(s,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Di(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(s,r){if(!s.point)return;const c=s.point.x/s.bounds.width,f=this.value.rawValue,[G,j,ht]=f.getComponents("hsv");this.value.setRawValue(new Nt([G,j,ht,c],"hsv"),r)}onPointerDown_(s){this.handlePointerEvent_(s.data,{forceEmit:!1,last:!1})}onPointerMove_(s){this.handlePointerEvent_(s.data,{forceEmit:!1,last:!1})}onPointerUp_(s){this.handlePointerEvent_(s.data,{forceEmit:!0,last:!0})}onKeyDown_(s){const r=Re(Ri(!0),di(s));if(r===0)return;const c=this.value.rawValue,[f,G,j,ht]=c.getComponents("hsv");this.value.setRawValue(new Nt([f,G,j,ht+r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(s){Re(Ri(!0),di(s))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const ri=H("coltxt");class Ws{constructor(s,r){this.element=s.createElement("div"),this.element.classList.add(ri());const c=s.createElement("div");c.classList.add(ri("m")),this.modeElem_=function(j){const ht=j.createElement("select");return ht.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}].reduce((wt,Dt)=>{const jt=j.createElement("option");return jt.textContent=Dt.text,jt.value=Dt.value,wt.appendChild(jt),wt},j.createDocumentFragment())),ht}(s),this.modeElem_.classList.add(ri("ms")),c.appendChild(this.modeSelectElement);const f=s.createElement("div");f.classList.add(ri("mm")),f.appendChild(yt(s,"dropdown")),c.appendChild(f),this.element.appendChild(c);const G=s.createElement("div");G.classList.add(ri("w")),this.element.appendChild(G),this.textsElem_=G,this.textViews_=r.textViews,this.applyTextViews_(),I(r.colorMode,j=>{this.modeElem_.value=j})}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(s){this.textViews_=s,this.applyTextViews_()}applyTextViews_(){Wt(this.textsElem_);const s=this.element.ownerDocument;this.textViews_.forEach(r=>{const c=s.createElement("div");c.classList.add(ri("c")),c.appendChild(r.element),this.textsElem_.appendChild(c)})}}function mi(l,s,r){const c=_s(l,s)[r];return new ds({min:0,max:c})}function Pn(l,s,r){return new Ti(l,{arrayPosition:r===0?"fst":r===2?"lst":"mid",baseStep:Ri(!1),parser:s.parser,props:mt.fromObject({draggingScale:s.colorType==="float"?.01:1,formatter:(c=s.colorType,ce(c==="float"?2:0))}),value:at(0,{constraint:mi(s.colorMode,s.colorType,r)}),viewProps:s.viewProps});var c}class pr{constructor(s,r){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=r.colorType,this.parser_=r.parser,this.value=r.value,this.viewProps=r.viewProps,this.colorMode=at(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(s),this.view=new Ws(s,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(s){const r={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},c=[Pn(s,r,0),Pn(s,r,1),Pn(s,r,2)];return c.forEach((f,G)=>{Vs({primary:this.value,secondary:f.value,forward:j=>j.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[G],backward:(j,ht)=>{const wt=this.colorMode.rawValue,Dt=j.rawValue.getComponents(wt,this.colorType_);return Dt[G]=ht.rawValue,new Nt(ve(Pe(Dt),Dt[3]),wt,this.colorType_)}})}),c}onModeSelectChange_(s){const r=s.currentTarget;this.colorMode.rawValue=r.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const Gi=H("hpl");class Qn{constructor(s,r){this.onValueChange_=this.onValueChange_.bind(this),this.value=r.value,this.value.emitter.on("change",this.onValueChange_),this.element=s.createElement("div"),this.element.classList.add(Gi()),r.viewProps.bindTabIndex(this.element);const c=s.createElement("div");c.classList.add(Gi("c")),this.element.appendChild(c);const f=s.createElement("div");f.classList.add(Gi("m")),this.element.appendChild(f),this.markerElem_=f,this.update_()}update_(){const s=this.value.rawValue,[r]=s.getComponents("hsv");this.markerElem_.style.backgroundColor=Ar(new Nt([r,100,100],"hsv"));const c=Zt(r,0,360,0,100);this.markerElem_.style.left=`${c}%`}onValueChange_(){this.update_()}}class Dn{constructor(s,r){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=r.value,this.viewProps=r.viewProps,this.view=new Qn(s,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Di(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(s,r){if(!s.point)return;const c=Zt(de(s.point.x,0,s.bounds.width),0,s.bounds.width,0,359),f=this.value.rawValue,[,G,j,ht]=f.getComponents("hsv");this.value.setRawValue(new Nt([c,G,j,ht],"hsv"),r)}onPointerDown_(s){this.handlePointerEvent_(s.data,{forceEmit:!1,last:!1})}onPointerMove_(s){this.handlePointerEvent_(s.data,{forceEmit:!1,last:!1})}onPointerUp_(s){this.handlePointerEvent_(s.data,{forceEmit:!0,last:!0})}onKeyDown_(s){const r=Re(Ri(!1),di(s));if(r===0)return;const c=this.value.rawValue,[f,G,j,ht]=c.getComponents("hsv");this.value.setRawValue(new Nt([f+r,G,j,ht],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(s){Re(Ri(!1),di(s))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Tn=H("svp");class jr{constructor(s,r){this.onValueChange_=this.onValueChange_.bind(this),this.value=r.value,this.value.emitter.on("change",this.onValueChange_),this.element=s.createElement("div"),this.element.classList.add(Tn()),r.viewProps.bindTabIndex(this.element);const c=s.createElement("canvas");c.height=64,c.width=64,c.classList.add(Tn("c")),this.element.appendChild(c),this.canvasElement=c;const f=s.createElement("div");f.classList.add(Tn("m")),this.element.appendChild(f),this.markerElem_=f,this.update_()}update_(){const s=function(Dt){const jt=Dt.ownerDocument.defaultView;return jt&&"document"in jt?Dt.getContext("2d"):null}(this.canvasElement);if(!s)return;const r=this.value.rawValue.getComponents("hsv"),c=this.canvasElement.width,f=this.canvasElement.height,G=s.getImageData(0,0,c,f),j=G.data;for(let Dt=0;Dt<f;Dt++)for(let jt=0;jt<c;jt++){const me=Zt(jt,0,c,0,100),Je=Zt(Dt,0,f,100,0),Ve=Us(r[0],me,Je),li=4*(Dt*c+jt);j[li]=Ve[0],j[li+1]=Ve[1],j[li+2]=Ve[2],j[li+3]=255}s.putImageData(G,0,0);const ht=Zt(r[1],0,100,0,100);this.markerElem_.style.left=`${ht}%`;const wt=Zt(r[2],0,100,100,0);this.markerElem_.style.top=`${wt}%`}onValueChange_(){this.update_()}}class Xr{constructor(s,r){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=r.value,this.viewProps=r.viewProps,this.view=new jr(s,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Di(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(s,r){if(!s.point)return;const c=Zt(s.point.x,0,s.bounds.width,0,100),f=Zt(s.point.y,0,s.bounds.height,100,0),[G,,,j]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new Nt([G,c,f,j],"hsv"),r)}onPointerDown_(s){this.handlePointerEvent_(s.data,{forceEmit:!1,last:!1})}onPointerMove_(s){this.handlePointerEvent_(s.data,{forceEmit:!1,last:!1})}onPointerUp_(s){this.handlePointerEvent_(s.data,{forceEmit:!0,last:!0})}onKeyDown_(s){tr(s.key)&&s.preventDefault();const[r,c,f,G]=this.value.rawValue.getComponents("hsv"),j=Ri(!1),ht=Re(j,di(s)),wt=Re(j,ps(s));ht===0&&wt===0||this.value.setRawValue(new Nt([r,c+ht,f+wt,G],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(s){const r=Ri(!1),c=Re(r,di(s)),f=Re(r,ps(s));c===0&&f===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Fn{constructor(s,r){this.value=r.value,this.viewProps=r.viewProps,this.hPaletteC_=new Dn(s,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Xr(s,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=r.supportsAlpha?{palette:new kn(s,{value:this.value,viewProps:this.viewProps}),text:new Ti(s,{parser:fi,baseStep:.1,props:mt.fromObject({draggingScale:.01,formatter:ce(2)}),value:at(0,{constraint:new ds({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Vs({primary:this.value,secondary:this.alphaIcs_.text.value,forward:c=>c.rawValue.getComponents()[3],backward:(c,f)=>{const G=c.rawValue.getComponents();return G[3]=f.rawValue,new Nt(G,c.rawValue.mode)}}),this.textC_=new pr(s,{colorType:r.colorType,parser:fi,value:this.value,viewProps:this.viewProps}),this.view=new _e(s,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:r.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}get textController(){return this.textC_}}const Mn=H("colsw");class qr{constructor(s,r){this.onValueChange_=this.onValueChange_.bind(this),r.value.emitter.on("change",this.onValueChange_),this.value=r.value,this.element=s.createElement("div"),this.element.classList.add(Mn()),r.viewProps.bindClassModifiers(this.element);const c=s.createElement("div");c.classList.add(Mn("sw")),this.element.appendChild(c),this.swatchElem_=c;const f=s.createElement("button");f.classList.add(Mn("b")),r.viewProps.bindDisabled(f),this.element.appendChild(f),this.buttonElement=f,this.update_()}update_(){const s=this.value.rawValue;this.swatchElem_.style.backgroundColor=In(s)}onValueChange_(){this.update_()}}class Wr{constructor(s,r){this.value=r.value,this.viewProps=r.viewProps,this.view=new qr(s,{value:this.value,viewProps:this.viewProps})}}class Rn{constructor(s,r){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=r.value,this.viewProps=r.viewProps,this.foldable_=ye.create(r.expanded),this.swatchC_=new Wr(s,{value:this.value,viewProps:this.viewProps});const c=this.swatchC_.view.buttonElement;c.addEventListener("blur",this.onButtonBlur_),c.addEventListener("click",this.onButtonClick_),this.textC_=new gn(s,{parser:r.parser,props:mt.fromObject({formatter:r.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new Le(s,{foldable:this.foldable_,pickerLayout:r.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=r.pickerLayout==="popup"?new Fr(s,{viewProps:this.viewProps}):null;const f=new Fn(s,{colorType:r.colorType,supportsAlpha:r.supportsAlpha,value:this.value,viewProps:this.viewProps});f.view.allFocusableElements.forEach(G=>{G.addEventListener("blur",this.onPopupChildBlur_),G.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=f,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(f.view.element),Vs({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:G=>G.rawValue,backward:(G,j)=>j.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ji(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(s){if(!this.popC_)return;const r=this.view.element,c=s.relatedTarget;c&&r.contains(c)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(s){if(!this.popC_)return;const r=this.popC_.view.element,c=qt(s);c&&r.contains(c)||c&&c===this.swatchC_.view.buttonElement&&!lt(r.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(s){this.popC_?s.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&s.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function Yr(l){return Pe(l.getComponents("rgb")).reduce((s,r)=>s<<8|255&Math.floor(r),0)}function Kr(l){return l.getComponents("rgb").reduce((s,r,c)=>s<<8|255&Math.floor(c===3?255*r:r),0)>>>0}function ko(l){return typeof l!="number"?Nt.black():new Nt([(s=l)>>16&255,s>>8&255,255&s],"rgb");var s}function Jr(l){return typeof l!="number"?Nt.black():new Nt([(s=l)>>24&255,s>>16&255,s>>8&255,Zt(255&s,0,255,0,1)],"rgb");var s}function De(l){var s;return!(!(l!=null&&l.alpha)&&!(!((s=l==null?void 0:l.color)===null||s===void 0)&&s.alpha))}function oi(l){return l?s=>In(s,"0x"):s=>dr(s,"0x")}const Zr={id:"input-color-number",type:"input",accept:(l,s)=>{if(typeof l!="number"||!function(c){return"color"in c||"view"in c&&c.view==="color"}(s))return null;const r=Ht(s);return r?{initialValue:l,params:r}:null},binding:{reader:l=>De(l.params)?Jr:ko,equals:Nt.equals,writer:l=>function(s){const r=s?Kr:Yr;return(c,f)=>{Hs(c,r(f))}}(De(l.params))},controller:l=>{const s=De(l.params),r="expanded"in l.params?l.params.expanded:void 0,c="picker"in l.params?l.params.picker:void 0;return new Rn(l.document,{colorType:"int",expanded:r!=null&&r,formatter:oi(s),parser:xn("int"),pickerLayout:c??"popup",supportsAlpha:s,value:l.value,viewProps:l.viewProps})}};function Ys(l){return s=>function(r,c){return Nt.isColorObject(r)?Nt.fromObject(r,c):Nt.black(c)}(s,l)}function $r(l,s){return r=>l?ms(r,s):En(r,s)}const Po={id:"input-color-object",type:"input",accept:(l,s)=>{if(!Nt.isColorObject(l))return null;const r=Ht(s);return r?{initialValue:l,params:r}:null},binding:{reader:l=>Ys(Li(l.params)),equals:Nt.equals,writer:l=>{return c=l.initialValue,s=Nt.isRgbaColorObject(c),r=Li(l.params),(f,G)=>{s?function(j,ht,wt){const Dt=ht.toRgbaObject(wt);j.writeProperty("r",Dt.r),j.writeProperty("g",Dt.g),j.writeProperty("b",Dt.b),j.writeProperty("a",Dt.a)}(f,G,r):function(j,ht,wt){const Dt=ht.toRgbaObject(wt);j.writeProperty("r",Dt.r),j.writeProperty("g",Dt.g),j.writeProperty("b",Dt.b)}(f,G,r)};var s,r,c}},controller:l=>{var s;const r=Nt.isRgbaColorObject(l.initialValue),c="expanded"in l.params?l.params.expanded:void 0,f="picker"in l.params?l.params.picker:void 0,G=(s=Li(l.params))!==null&&s!==void 0?s:"int";return new Rn(l.document,{colorType:G,expanded:c!=null&&c,formatter:$r(r,G),parser:xn(G),pickerLayout:f??"popup",supportsAlpha:r,value:l.value,viewProps:l.viewProps})}},to={id:"input-color-string",type:"input",accept:(l,s)=>{if(typeof l!="string"||"view"in s&&s.view==="text")return null;const r=yn(l,Li(s));if(!r||!ws(r))return null;const c=Ht(s);return c?{initialValue:l,params:c}:null},binding:{reader:l=>{var s;return function(r){const c=hr[r];return f=>{if(typeof f!="string")return Nt.black(r);const G=c.reduce((j,ht)=>j||ht(f),null);return G??Nt.black(r)}}((s=Li(l.params))!==null&&s!==void 0?s:"int")},equals:Nt.equals,writer:l=>{const s=yn(l.initialValue,Li(l.params));if(!s)throw X.shouldNeverHappen();const r=function(c){const f=ws(c);return f?(G,j)=>{Hs(G,f(j))}:null}(s);if(!r)throw X.notBindable();return r}},controller:l=>{const s=yn(l.initialValue,Li(l.params));if(!s)throw X.shouldNeverHappen();const r=ws(s);if(!r)throw X.shouldNeverHappen();const c="expanded"in l.params?l.params.expanded:void 0,f="picker"in l.params?l.params.picker:void 0;return new Rn(l.document,{colorType:s.type,expanded:c!=null&&c,formatter:r,parser:xn(s.type),pickerLayout:f??"popup",supportsAlpha:s.alpha,value:l.value,viewProps:l.viewProps})}};class ai{constructor(s){this.components=s.components,this.asm_=s.assembly}constrain(s){const r=this.asm_.toComponents(s).map((c,f)=>{var G,j;return(j=(G=this.components[f])===null||G===void 0?void 0:G.constrain(c))!==null&&j!==void 0?j:c});return this.asm_.fromComponents(r)}}const gr=H("pndtxt");class eo{constructor(s,r){this.textViews=r.textViews,this.element=s.createElement("div"),this.element.classList.add(gr()),this.textViews.forEach(c=>{const f=s.createElement("div");f.classList.add(gr("a")),f.appendChild(c.element),this.element.appendChild(f)})}}class Ln{constructor(s,r){this.value=r.value,this.viewProps=r.viewProps,this.acs_=r.axes.map((c,f)=>function(G,j,ht){return new Ti(G,{arrayPosition:ht===0?"fst":ht===j.axes.length-1?"lst":"mid",baseStep:j.axes[ht].baseStep,parser:j.parser,props:j.axes[ht].textProps,value:at(0,{constraint:j.axes[ht].constraint}),viewProps:j.viewProps})}(s,r,f)),this.acs_.forEach((c,f)=>{Vs({primary:this.value,secondary:c.value,forward:G=>r.assembly.toComponents(G.rawValue)[f],backward:(G,j)=>{const ht=r.assembly.toComponents(G.rawValue);return ht[f]=j.rawValue,r.assembly.fromComponents(ht)}})}),this.view=new eo(s,{textViews:this.acs_.map(c=>c.view)})}}function fr(l,s){return"step"in l&&!R(l.step)?new Wi(l.step,s):null}function Te(l){return"max"in l&&!R(l.max)||"min"in l&&!R(l.min)?new ds({max:l.max,min:l.min}):null}function io(l){const[s,r]=function(c){const f=c?ci(c,ds):null;return f?[f.minValue,f.maxValue]:[void 0,void 0]}(l);return[s??0,r??100]}const so={id:"input-number",type:"input",accept:(l,s)=>{if(typeof l!="number")return null;const r=nt,c=B(s,{format:r.optional.function,max:r.optional.number,min:r.optional.number,options:r.optional.custom(Se),step:r.optional.number});return c?{initialValue:l,params:c}:null},binding:{reader:l=>Lr,constraint:l=>function(s,r){const c=[],f=fr(s,r);f&&c.push(f);const G=Te(s);G&&c.push(G);const j=ie(s.options);return j&&c.push(j),new Ms(c)}(l.params,l.initialValue),writer:l=>Hs},controller:l=>{var s,r;const c=l.value,f=l.constraint;if(f&&ci(f,Rs))return new Ls(l.document,{props:mt.fromObject({options:(s=ni(f))!==null&&s!==void 0?s:[]}),value:c,viewProps:l.viewProps});const G=(r="format"in l.params?l.params.format:void 0)!==null&&r!==void 0?r:ce(ke(f,c.rawValue));if(f&&ci(f,ds)){const[j,ht]=io(f);return new $i(l.document,{baseStep:Ai(f),parser:fi,sliderProps:mt.fromObject({maxValue:ht,minValue:j}),textProps:mt.fromObject({draggingScale:Fi(f,c.rawValue),formatter:G}),value:c,viewProps:l.viewProps})}return new Ti(l.document,{baseStep:Ai(f),parser:fi,props:mt.fromObject({draggingScale:Fi(f,c.rawValue),formatter:G}),value:c,viewProps:l.viewProps})}};class vi{constructor(s=0,r=0){this.x=s,this.y=r}getComponents(){return[this.x,this.y]}static isObject(s){if(R(s))return!1;const r=s.x,c=s.y;return typeof r=="number"&&typeof c=="number"}static equals(s,r){return s.x===r.x&&s.y===r.y}toObject(){return{x:this.x,y:this.y}}}const _r={toComponents:l=>l.getComponents(),fromComponents:l=>new vi(...l)},zi=H("p2d");class Ks{constructor(s,r){this.element=s.createElement("div"),this.element.classList.add(zi()),r.viewProps.bindClassModifiers(this.element),I(r.expanded,b(this.element,zi(void 0,"expanded")));const c=s.createElement("div");c.classList.add(zi("h")),this.element.appendChild(c);const f=s.createElement("button");f.classList.add(zi("b")),f.appendChild(yt(s,"p2dpad")),r.viewProps.bindDisabled(f),c.appendChild(f),this.buttonElement=f;const G=s.createElement("div");if(G.classList.add(zi("t")),c.appendChild(G),this.textElement=G,r.pickerLayout==="inline"){const j=s.createElement("div");j.classList.add(zi("p")),this.element.appendChild(j),this.pickerElement=j}else this.pickerElement=null}}const be=H("p2dp");class Vi{constructor(s,r){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=r.invertsY,this.maxValue_=r.maxValue,this.element=s.createElement("div"),this.element.classList.add(be()),r.layout==="popup"&&this.element.classList.add(be(void 0,"p"));const c=s.createElement("div");c.classList.add(be("p")),r.viewProps.bindTabIndex(c),this.element.appendChild(c),this.padElement=c;const f=s.createElementNS(rt,"svg");f.classList.add(be("g")),this.padElement.appendChild(f),this.svgElem_=f;const G=s.createElementNS(rt,"line");G.classList.add(be("ax")),G.setAttributeNS(null,"x1","0"),G.setAttributeNS(null,"y1","50%"),G.setAttributeNS(null,"x2","100%"),G.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(G);const j=s.createElementNS(rt,"line");j.classList.add(be("ax")),j.setAttributeNS(null,"x1","50%"),j.setAttributeNS(null,"y1","0"),j.setAttributeNS(null,"x2","50%"),j.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(j);const ht=s.createElementNS(rt,"line");ht.classList.add(be("l")),ht.setAttributeNS(null,"x1","50%"),ht.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(ht),this.lineElem_=ht;const wt=s.createElement("div");wt.classList.add(be("m")),this.padElement.appendChild(wt),this.markerElem_=wt,r.value.emitter.on("change",this.onValueChange_),this.value=r.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[s,r]=this.value.rawValue.getComponents(),c=this.maxValue_,f=Zt(s,-c,+c,0,100),G=Zt(r,-c,+c,0,100),j=this.invertsY_?100-G:G;this.lineElem_.setAttributeNS(null,"x2",`${f}%`),this.lineElem_.setAttributeNS(null,"y2",`${j}%`),this.markerElem_.style.left=`${f}%`,this.markerElem_.style.top=`${j}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function bs(l,s,r){return[Re(s[0],di(l)),Re(s[1],ps(l))*(r?1:-1)]}class no{constructor(s,r){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=r.value,this.viewProps=r.viewProps,this.baseSteps_=r.baseSteps,this.maxValue_=r.maxValue,this.invertsY_=r.invertsY,this.view=new Vi(s,{invertsY:this.invertsY_,layout:r.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Di(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(s,r){if(!s.point)return;const c=this.maxValue_,f=Zt(s.point.x,0,s.bounds.width,-c,+c),G=Zt(this.invertsY_?s.bounds.height-s.point.y:s.point.y,0,s.bounds.height,-c,+c);this.value.setRawValue(new vi(f,G),r)}onPointerDown_(s){this.handlePointerEvent_(s.data,{forceEmit:!1,last:!1})}onPointerMove_(s){this.handlePointerEvent_(s.data,{forceEmit:!1,last:!1})}onPointerUp_(s){this.handlePointerEvent_(s.data,{forceEmit:!0,last:!0})}onPadKeyDown_(s){tr(s.key)&&s.preventDefault();const[r,c]=bs(s,this.baseSteps_,this.invertsY_);r===0&&c===0||this.value.setRawValue(new vi(this.value.rawValue.x+r,this.value.rawValue.y+c),{forceEmit:!1,last:!1})}onPadKeyUp_(s){const[r,c]=bs(s,this.baseSteps_,this.invertsY_);r===0&&c===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Cs{constructor(s,r){var c,f;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=r.value,this.viewProps=r.viewProps,this.foldable_=ye.create(r.expanded),this.popC_=r.pickerLayout==="popup"?new Fr(s,{viewProps:this.viewProps}):null;const G=new no(s,{baseSteps:[r.axes[0].baseStep,r.axes[1].baseStep],invertsY:r.invertsY,layout:r.pickerLayout,maxValue:r.maxValue,value:this.value,viewProps:this.viewProps});G.view.allFocusableElements.forEach(j=>{j.addEventListener("blur",this.onPopupChildBlur_),j.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=G,this.textC_=new Ln(s,{assembly:_r,axes:r.axes,parser:r.parser,value:this.value,viewProps:this.viewProps}),this.view=new Ks(s,{expanded:this.foldable_.value("expanded"),pickerLayout:r.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(c=this.view.buttonElement)===null||c===void 0||c.addEventListener("blur",this.onPadButtonBlur_),(f=this.view.buttonElement)===null||f===void 0||f.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Vs({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:j=>j.rawValue,backward:(j,ht)=>ht.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ji(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(s){if(!this.popC_)return;const r=this.view.element,c=s.relatedTarget;c&&r.contains(c)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(s){if(!this.popC_)return;const r=this.popC_.view.element,c=qt(s);c&&r.contains(c)||c&&c===this.view.buttonElement&&!lt(r.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(s){this.popC_?s.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&s.key==="Escape"&&this.view.buttonElement.focus()}}function Qo(l){return vi.isObject(l)?new vi(l.x,l.y):new vi}function Nn(l,s){l.writeProperty("x",s.x),l.writeProperty("y",s.y)}function ui(l,s){if(!l)return;const r=[],c=fr(l,s);c&&r.push(c);const f=Te(l);return f&&r.push(f),new Ms(r)}function mr(l,s){var r,c;const f=l&&ci(l,ds);if(f)return Math.max(Math.abs((r=f.minValue)!==null&&r!==void 0?r:0),Math.abs((c=f.maxValue)!==null&&c!==void 0?c:0));const G=Ai(l);return Math.max(10*Math.abs(G),10*Math.abs(s))}function ro(l,s){const r=s instanceof ai?s.components[0]:void 0,c=s instanceof ai?s.components[1]:void 0,f=mr(r,l.x),G=mr(c,l.y);return Math.max(f,G)}function Js(l,s){return{baseStep:Ai(s),constraint:s,textProps:mt.fromObject({draggingScale:Fi(s,l),formatter:ce(ke(s,l))})}}function oo(l){if(!("y"in l))return!1;const s=l.y;return!!s&&"inverted"in s&&!!s.inverted}const Gn={id:"input-point2d",type:"input",accept:(l,s)=>{if(!vi.isObject(l))return null;const r=nt,c=B(s,{expanded:r.optional.boolean,picker:r.optional.custom(wn),x:r.optional.custom(Ie),y:r.optional.object({inverted:r.optional.boolean,max:r.optional.number,min:r.optional.number,step:r.optional.number})});return c?{initialValue:l,params:c}:null},binding:{reader:l=>Qo,constraint:l=>{return s=l.params,r=l.initialValue,new ai({assembly:_r,components:[ui("x"in s?s.x:void 0,r.x),ui("y"in s?s.y:void 0,r.y)]});var s,r},equals:vi.equals,writer:l=>Nn},controller:l=>{const s=l.document,r=l.value,c=l.constraint;if(!(c instanceof ai))throw X.shouldNeverHappen();const f="expanded"in l.params?l.params.expanded:void 0,G="picker"in l.params?l.params.picker:void 0;return new Cs(s,{axes:[Js(r.rawValue.x,c.components[0]),Js(r.rawValue.y,c.components[1])],expanded:f!=null&&f,invertsY:oo(l.params),maxValue:ro(r.rawValue,c),parser:fi,pickerLayout:G??"popup",value:r,viewProps:l.viewProps})}};class is{constructor(s=0,r=0,c=0){this.x=s,this.y=r,this.z=c}getComponents(){return[this.x,this.y,this.z]}static isObject(s){if(R(s))return!1;const r=s.x,c=s.y,f=s.z;return typeof r=="number"&&typeof c=="number"&&typeof f=="number"}static equals(s,r){return s.x===r.x&&s.y===r.y&&s.z===r.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const vr={toComponents:l=>l.getComponents(),fromComponents:l=>new is(...l)};function Zs(l){return is.isObject(l)?new is(l.x,l.y,l.z):new is}function ss(l,s){l.writeProperty("x",s.x),l.writeProperty("y",s.y),l.writeProperty("z",s.z)}function wr(l,s){return{baseStep:Ai(s),constraint:s,textProps:mt.fromObject({draggingScale:Fi(s,l),formatter:ce(ke(s,l))})}}const ao={id:"input-point3d",type:"input",accept:(l,s)=>{if(!is.isObject(l))return null;const r=nt,c=B(s,{x:r.optional.custom(Ie),y:r.optional.custom(Ie),z:r.optional.custom(Ie)});return c?{initialValue:l,params:c}:null},binding:{reader:l=>Zs,constraint:l=>{return s=l.params,r=l.initialValue,new ai({assembly:vr,components:[ui("x"in s?s.x:void 0,r.x),ui("y"in s?s.y:void 0,r.y),ui("z"in s?s.z:void 0,r.z)]});var s,r},equals:is.equals,writer:l=>ss},controller:l=>{const s=l.value,r=l.constraint;if(!(r instanceof ai))throw X.shouldNeverHappen();return new Ln(l.document,{assembly:vr,axes:[wr(s.rawValue.x,r.components[0]),wr(s.rawValue.y,r.components[1]),wr(s.rawValue.z,r.components[2])],parser:fi,value:s,viewProps:l.viewProps})}};class ns{constructor(s=0,r=0,c=0,f=0){this.x=s,this.y=r,this.z=c,this.w=f}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(s){if(R(s))return!1;const r=s.x,c=s.y,f=s.z,G=s.w;return typeof r=="number"&&typeof c=="number"&&typeof f=="number"&&typeof G=="number"}static equals(s,r){return s.x===r.x&&s.y===r.y&&s.z===r.z&&s.w===r.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const br={toComponents:l=>l.getComponents(),fromComponents:l=>new ns(...l)};function lo(l){return ns.isObject(l)?new ns(l.x,l.y,l.z,l.w):new ns}function $s(l,s){l.writeProperty("x",s.x),l.writeProperty("y",s.y),l.writeProperty("z",s.z),l.writeProperty("w",s.w)}const zn={id:"input-point4d",type:"input",accept:(l,s)=>{if(!ns.isObject(l))return null;const r=nt,c=B(s,{x:r.optional.custom(Ie),y:r.optional.custom(Ie),z:r.optional.custom(Ie),w:r.optional.custom(Ie)});return c?{initialValue:l,params:c}:null},binding:{reader:l=>lo,constraint:l=>{return s=l.params,r=l.initialValue,new ai({assembly:br,components:[ui("x"in s?s.x:void 0,r.x),ui("y"in s?s.y:void 0,r.y),ui("z"in s?s.z:void 0,r.z),ui("w"in s?s.w:void 0,r.w)]});var s,r},equals:ns.equals,writer:l=>$s},controller:l=>{const s=l.value,r=l.constraint;if(!(r instanceof ai))throw X.shouldNeverHappen();return new Ln(l.document,{assembly:br,axes:s.rawValue.getComponents().map((c,f)=>{return G=c,{baseStep:Ai(j=r.components[f]),constraint:j,textProps:mt.fromObject({draggingScale:Fi(j,G),formatter:ce(ke(j,G))})};var G,j}),parser:fi,value:s,viewProps:l.viewProps})}},ys={id:"input-string",type:"input",accept:(l,s)=>{if(typeof l!="string")return null;const r=B(s,{options:nt.optional.custom(Se)});return r?{initialValue:l,params:r}:null},binding:{reader:l=>zs,constraint:l=>function(s){const r=[],c=ie(s.options);return c&&r.push(c),new Ms(r)}(l.params),writer:l=>Hs},controller:l=>{var s;const r=l.document,c=l.value,f=l.constraint;return f&&ci(f,Rs)?new Ls(r,{props:mt.fromObject({options:(s=ni(f))!==null&&s!==void 0?s:[]}),value:c,viewProps:l.viewProps}):new gn(r,{parser:G=>G,props:mt.fromObject({formatter:mn}),value:c,viewProps:l.viewProps})}},rs={defaultInterval:200,defaultLineCount:3},tn=H("mll");class ho{constructor(s,r){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=r.formatter,this.element=s.createElement("div"),this.element.classList.add(tn()),r.viewProps.bindClassModifiers(this.element);const c=s.createElement("textarea");c.classList.add(tn("i")),c.style.height=`calc(var(--bld-us) * ${r.lineCount})`,c.readOnly=!0,r.viewProps.bindDisabled(c),this.element.appendChild(c),this.textareaElem_=c,r.value.emitter.on("change",this.onValueUpdate_),this.value=r.value,this.update_()}update_(){const s=this.textareaElem_,r=s.scrollTop===s.scrollHeight-s.clientHeight,c=[];this.value.rawValue.forEach(f=>{f!==void 0&&c.push(this.formatter_(f))}),s.textContent=c.join(`
`),r&&(s.scrollTop=s.scrollHeight)}onValueUpdate_(){this.update_()}}class xs{constructor(s,r){this.value=r.value,this.viewProps=r.viewProps,this.view=new ho(s,{formatter:r.formatter,lineCount:r.lineCount,value:this.value,viewProps:this.viewProps})}}const en=H("sgl");class sn{constructor(s,r){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=r.formatter,this.element=s.createElement("div"),this.element.classList.add(en()),r.viewProps.bindClassModifiers(this.element);const c=s.createElement("input");c.classList.add(en("i")),c.readOnly=!0,c.type="text",r.viewProps.bindDisabled(c),this.element.appendChild(c),this.inputElement=c,r.value.emitter.on("change",this.onValueUpdate_),this.value=r.value,this.update_()}update_(){const s=this.value.rawValue,r=s[s.length-1];this.inputElement.value=r!==void 0?this.formatter_(r):""}onValueUpdate_(){this.update_()}}class os{constructor(s,r){this.value=r.value,this.viewProps=r.viewProps,this.view=new sn(s,{formatter:r.formatter,value:this.value,viewProps:this.viewProps})}}const Cr={id:"monitor-bool",type:"monitor",accept:(l,s)=>{if(typeof l!="boolean")return null;const r=B(s,{lineCount:nt.optional.number});return r?{initialValue:l,params:r}:null},binding:{reader:l=>Zn},controller:l=>{var s;return l.value.rawValue.length===1?new os(l.document,{formatter:Rr,value:l.value,viewProps:l.viewProps}):new xs(l.document,{formatter:Rr,lineCount:(s=l.params.lineCount)!==null&&s!==void 0?s:rs.defaultLineCount,value:l.value,viewProps:l.viewProps})}},wi=H("grl");class nn{constructor(s,r){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=s.createElement("div"),this.element.classList.add(wi()),r.viewProps.bindClassModifiers(this.element),this.formatter_=r.formatter,this.props_=r.props,this.cursor_=r.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const c=s.createElementNS(rt,"svg");c.classList.add(wi("g")),c.style.height=`calc(var(--bld-us) * ${r.lineCount})`,this.element.appendChild(c),this.svgElem_=c;const f=s.createElementNS(rt,"polyline");this.svgElem_.appendChild(f),this.lineElem_=f;const G=s.createElement("div");G.classList.add(wi("t"),H("tt")()),this.element.appendChild(G),this.tooltipElem_=G,r.value.emitter.on("change",this.onValueUpdate_),this.value=r.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const s=this.svgElem_.getBoundingClientRect(),r=this.value.rawValue.length-1,c=this.props_.get("minValue"),f=this.props_.get("maxValue"),G=[];this.value.rawValue.forEach((jt,me)=>{if(jt===void 0)return;const Je=Zt(me,0,r,0,s.width),Ve=Zt(jt,c,f,s.height,0);G.push([Je,Ve].join(","))}),this.lineElem_.setAttributeNS(null,"points",G.join(" "));const j=this.tooltipElem_,ht=this.value.rawValue[this.cursor_.rawValue];if(ht===void 0)return void j.classList.remove(wi("t","a"));const wt=Zt(this.cursor_.rawValue,0,r,0,s.width),Dt=Zt(ht,c,f,s.height,0);j.style.left=`${wt}px`,j.style.top=`${Dt}px`,j.textContent=`${this.formatter_(ht)}`,j.classList.contains(wi("t","a"))||(j.classList.add(wi("t","a"),wi("t","in")),At(j),j.classList.remove(wi("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class rn{constructor(s,r){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=r.props,this.value=r.value,this.viewProps=r.viewProps,this.cursor_=at(-1),this.view=new nn(s,{cursor:this.cursor_,formatter:r.formatter,lineCount:r.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),lt(s)){const c=new Di(this.view.element);c.emitter.on("down",this.onGraphPointerDown_),c.emitter.on("move",this.onGraphPointerMove_),c.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(s){const r=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(Zt(s.offsetX,0,r.width,0,this.value.rawValue.length))}onGraphPointerDown_(s){this.onGraphPointerMove_(s)}onGraphPointerMove_(s){s.data.point?this.cursor_.rawValue=Math.floor(Zt(s.data.point.x,0,s.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function Vn(l){return"format"in l&&!R(l.format)?l.format:ce(2)}function yr(l){return"view"in l&&l.view==="graph"}const Is={id:"monitor-number",type:"monitor",accept:(l,s)=>{if(typeof l!="number")return null;const r=nt,c=B(s,{format:r.optional.function,lineCount:r.optional.number,max:r.optional.number,min:r.optional.number,view:r.optional.string});return c?{initialValue:l,params:c}:null},binding:{defaultBufferSize:l=>yr(l)?64:1,reader:l=>Lr},controller:l=>yr(l.params)?function(s){var r,c,f;return new rn(s.document,{formatter:Vn(s.params),lineCount:(r=s.params.lineCount)!==null&&r!==void 0?r:rs.defaultLineCount,props:mt.fromObject({maxValue:(c="max"in s.params?s.params.max:null)!==null&&c!==void 0?c:100,minValue:(f="min"in s.params?s.params.min:null)!==null&&f!==void 0?f:0}),value:s.value,viewProps:s.viewProps})}(l):function(s){var r;return s.value.rawValue.length===1?new os(s.document,{formatter:Vn(s.params),value:s.value,viewProps:s.viewProps}):new xs(s.document,{formatter:Vn(s.params),lineCount:(r=s.params.lineCount)!==null&&r!==void 0?r:rs.defaultLineCount,value:s.value,viewProps:s.viewProps})}(l)},Oi={id:"monitor-string",type:"monitor",accept:(l,s)=>{if(typeof l!="string")return null;const r=nt,c=B(s,{lineCount:r.optional.number,multiline:r.optional.boolean});return c?{initialValue:l,params:c}:null},binding:{reader:l=>zs},controller:l=>{var s;const r=l.value;return r.rawValue.length>1||"multiline"in l.params&&l.params.multiline?new xs(l.document,{formatter:mn,lineCount:(s=l.params.lineCount)!==null&&s!==void 0?s:rs.defaultLineCount,value:r,viewProps:l.viewProps}):new os(l.document,{formatter:mn,value:r,viewProps:l.viewProps})}};class bi{constructor(s){this.onValueChange_=this.onValueChange_.bind(this),this.reader=s.reader,this.writer=s.writer,this.emitter=new C,this.value=s.value,this.value.emitter.on("change",this.onValueChange_),this.target=s.target,this.read()}read(){const s=this.target.read();s!==void 0&&(this.value.rawValue=this.reader(s))}write_(s){this.writer(this.target,s)}onValueChange_(s){this.write_(s.rawValue),this.emitter.emit("change",{options:s.options,rawValue:s.rawValue,sender:this})}}class Ci{constructor(s){this.onTick_=this.onTick_.bind(this),this.reader_=s.reader,this.target=s.target,this.emitter=new C,this.value=s.value,this.ticker=s.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const s=this.target.read();if(s===void 0)return;const r=this.value.rawValue,c=this.reader_(s);this.value.rawValue=function(f,G){const j=[...Nr(f),G];return j.length>f.length?j.splice(0,j.length-f.length):vn(j,f.length),j}(r,c),this.emitter.emit("update",{rawValue:c,sender:this})}onTick_(s){this.read()}}function Do(l,s){return s===0?new mo:new vo(l,s??rs.defaultInterval)}class To{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(s){s.type==="blade"?this.pluginsMap_.blades.unshift(s):s.type==="input"?this.pluginsMap_.inputs.unshift(s):s.type==="monitor"&&this.pluginsMap_.monitors.unshift(s)}createInput(s,r,c){if(R(r.read()))throw new X({context:{key:r.key},type:"nomatchingcontroller"});const f=this.pluginsMap_.inputs.reduce((G,j)=>G??function(ht,wt){const Dt=ht.accept(wt.target.read(),wt.params);if(R(Dt))return null;const jt=nt,me={target:wt.target,initialValue:Dt.initialValue,params:Dt.params},Je=ht.binding.reader(me),Ve=ht.binding.constraint?ht.binding.constraint(me):void 0,li=at(Je(Dt.initialValue),{constraint:Ve,equals:ht.binding.equals}),Es=new bi({reader:Je,target:wt.target,value:li,writer:ht.binding.writer(me)}),Hn=jt.optional.boolean(wt.params.disabled).value,Er=jt.optional.boolean(wt.params.hidden).value,an=ht.controller({constraint:Ve,document:wt.document,initialValue:Dt.initialValue,params:Dt.params,value:Es.value,viewProps:hi.create({disabled:Hn,hidden:Er})}),Bs=jt.optional.string(wt.params.label).value;return new fe(wt.document,{binding:Es,blade:Ze(),props:mt.fromObject({label:Bs??wt.target.key}),valueController:an})}(j,{document:s,target:r,params:c}),null);if(f)return f;throw new X({context:{key:r.key},type:"nomatchingcontroller"})}createMonitor(s,r,c){const f=this.pluginsMap_.monitors.reduce((G,j)=>G??function(ht,wt){var Dt,jt,me;const Je=nt,Ve=ht.accept(wt.target.read(),wt.params);if(R(Ve))return null;const li={target:wt.target,initialValue:Ve.initialValue,params:Ve.params},Es=ht.binding.reader(li),Hn=(jt=(Dt=Je.optional.number(wt.params.bufferSize).value)!==null&&Dt!==void 0?Dt:ht.binding.defaultBufferSize&&ht.binding.defaultBufferSize(Ve.params))!==null&&jt!==void 0?jt:1,Er=Je.optional.number(wt.params.interval).value,an=new Ci({reader:Es,target:wt.target,ticker:Do(wt.document,Er),value:Qi(Hn)}),Bs=Je.optional.boolean(wt.params.disabled).value,Br=Je.optional.boolean(wt.params.hidden).value,Ro=ht.controller({document:wt.document,params:Ve.params,value:an.value,viewProps:hi.create({disabled:Bs,hidden:Br})}),Lo=(me=Je.optional.string(wt.params.label).value)!==null&&me!==void 0?me:wt.target.key;return new ii(wt.document,{binding:an,blade:Ze(),props:mt.fromObject({label:Lo}),valueController:Ro})}(j,{document:s,params:c,target:r}),null);if(f)return f;throw new X({context:{key:r.key},type:"nomatchingcontroller"})}createBlade(s,r){const c=this.pluginsMap_.blades.reduce((f,G)=>f??function(j,ht){const wt=j.accept(ht.params);if(!wt)return null;const Dt=nt.optional.boolean(ht.params.disabled).value,jt=nt.optional.boolean(ht.params.hidden).value;return j.controller({blade:Ze(),document:ht.document,params:Object.assign(Object.assign({},wt.params),{disabled:Dt,hidden:jt}),viewProps:hi.create({disabled:Dt,hidden:jt})})}(G,{document:s,params:r}),null);if(!c)throw new X({type:"nomatchingview",context:{params:r}});return c}createBladeApi(s){if(s instanceof fe)return new pi(s);if(s instanceof ii)return new ei(s);if(s instanceof Si)return new hs(s,this);const r=this.pluginsMap_.blades.reduce((c,f)=>c??f.api({controller:s,pool:this}),null);if(!r)throw X.shouldNeverHappen();return r}}class on extends S{constructor(s){super(s),this.emitter_=new C,this.controller_.valueController.value.emitter.on("change",r=>{this.emitter_.emit("change",{event:new w(this,r.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(s){this.controller_.props.set("label",s)}get options(){return this.controller_.valueController.props.get("options")}set options(s){this.controller_.valueController.props.set("options",s)}get value(){return this.controller_.valueController.value.rawValue}set value(s){this.controller_.valueController.value.rawValue=s}on(s,r){const c=r.bind(this);return this.emitter_.on(s,f=>{c(f.event)}),this}}class xr extends S{constructor(s){super(s),this.emitter_=new C,this.controller_.valueController.value.emitter.on("change",r=>{this.emitter_.emit("change",{event:new w(this,r.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(s){this.controller_.props.set("label",s)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(s){this.controller_.valueController.sliderController.props.set("maxValue",s)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(s){this.controller_.valueController.sliderController.props.set("minValue",s)}get value(){return this.controller_.valueController.value.rawValue}set value(s){this.controller_.valueController.value.rawValue=s}on(s,r){const c=r.bind(this);return this.emitter_.on(s,f=>{c(f.event)}),this}}class On extends S{constructor(s){super(s),this.emitter_=new C,this.controller_.valueController.value.emitter.on("change",r=>{this.emitter_.emit("change",{event:new w(this,r.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(s){this.controller_.props.set("label",s)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(s){this.controller_.valueController.props.set("formatter",s)}get value(){return this.controller_.valueController.value.rawValue}set value(s){this.controller_.valueController.value.rawValue=s}on(s,r){const c=r.bind(this);return this.emitter_.on(s,f=>{c(f.event)}),this}}const Ir={id:"list",type:"blade",accept(l){const s=nt,r=B(l,{options:s.required.custom(Se),value:s.required.raw,view:s.required.constant("list"),label:s.optional.string});return r?{params:r}:null},controller(l){const s=new Ls(l.document,{props:mt.fromObject({options:Pt(l.params.options)}),value:at(l.params.value),viewProps:l.viewProps});return new xe(l.document,{blade:l.blade,props:mt.fromObject({label:l.params.label}),valueController:s})},api:l=>l.controller instanceof xe&&l.controller.valueController instanceof Ls?new on(l.controller):null};class co extends Qs{constructor(s,r){super(s,r)}get element(){return this.controller_.view.element}importPreset(s){(function(r,c){r.forEach(f=>{const G=c[f.presetKey];G!==void 0&&f.write(G)})})(this.controller_.rackController.rack.find(fe).map(r=>r.binding.target),s),this.refresh()}exportPreset(){return this.controller_.rackController.rack.find(fe).map(s=>s.binding.target).reduce((s,r)=>Object.assign(s,{[r.presetKey]:r.read()}),{})}refresh(){this.controller_.rackController.rack.find(fe).forEach(s=>{s.binding.read()}),this.controller_.rackController.rack.find(ii).forEach(s=>{s.binding.read()})}}class Fo extends Be{constructor(s,r){super(s,{expanded:r.expanded,blade:r.blade,props:r.props,root:!0,viewProps:r.viewProps})}}const Ao={id:"slider",type:"blade",accept(l){const s=nt,r=B(l,{max:s.required.number,min:s.required.number,view:s.required.constant("slider"),format:s.optional.function,label:s.optional.string,value:s.optional.number});return r?{params:r}:null},controller(l){var s,r;const c=(s=l.params.value)!==null&&s!==void 0?s:0,f=new $i(l.document,{baseStep:1,parser:fi,sliderProps:mt.fromObject({maxValue:l.params.max,minValue:l.params.min}),textProps:mt.fromObject({draggingScale:Fi(void 0,c),formatter:(r=l.params.format)!==null&&r!==void 0?r:So}),value:at(c),viewProps:l.viewProps});return new xe(l.document,{blade:l.blade,props:mt.fromObject({label:l.params.label}),valueController:f})},api:l=>l.controller instanceof xe&&l.controller.valueController instanceof $i?new xr(l.controller):null},Hi={id:"text",type:"blade",accept(l){const s=nt,r=B(l,{parse:s.required.function,value:s.required.raw,view:s.required.constant("text"),format:s.optional.function,label:s.optional.string});return r?{params:r}:null},controller(l){var s;const r=new gn(l.document,{parser:l.params.parse,props:mt.fromObject({formatter:(s=l.params.format)!==null&&s!==void 0?s:c=>String(c)}),value:at(l.params.value),viewProps:l.viewProps});return new xe(l.document,{blade:l.blade,props:mt.fromObject({label:l.params.label}),valueController:r})},api:l=>l.controller instanceof xe&&l.controller.valueController instanceof gn?new On(l.controller):null};function as(l,s,r){if(l.querySelector(`style[data-tp-style=${s}]`))return;const c=l.createElement("style");c.dataset.tpStyle=s,c.textContent=r,l.head.appendChild(c)}const Mo=new class{constructor(l){const[s,r]=l.split("-"),c=s.split(".");this.major=parseInt(c[0],10),this.minor=parseInt(c[1],10),this.patch=parseInt(c[2],10),this.prerelease=r??null}toString(){const l=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[l,this.prerelease].join("-"):l}}("3.1.0");D.BladeApi=S,D.ButtonApi=m,D.FolderApi=Qs,D.InputBindingApi=pi,D.ListApi=on,D.MonitorBindingApi=ei,D.Pane=class extends co{constructor(l){var s,r;const c=l??{},f=(s=c.document)!==null&&s!==void 0?s:bt(),G=function(){const j=new To;return[Gn,ao,zn,ys,so,to,Po,Zr,Mi,Cr,Oi,Is,ee,qi,go,Dr].forEach(ht=>{j.register(ht)}),j}();super(new Fo(f,{expanded:c.expanded,blade:Ze(),props:mt.fromObject({title:c.title}),viewProps:hi.create()}),G),this.pool_=G,this.containerElem_=(r=c.container)!==null&&r!==void 0?r:function(j){const ht=j.createElement("div");return ht.classList.add(H("dfw")()),j.body&&j.body.appendChild(ht),ht}(f),this.containerElem_.appendChild(this.element),this.doc_=f,this.usesDefaultWrapper_=!c.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw X.alreadyDisposed();return this.doc_}dispose(){const l=this.containerElem_;if(!l)throw X.alreadyDisposed();if(this.usesDefaultWrapper_){const s=l.parentElement;s&&s.removeChild(l)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(l){("plugin"in l?[l.plugin]:"plugins"in l?l.plugins:[]).forEach(s=>{this.pool_.register(s),this.embedPluginStyle_(s)})}embedPluginStyle_(l){l.css&&as(this.document,`plugin-${l.id}`,l.css)}setUpDefaultPlugins_(){as(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor transparent;scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:transparent}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:transparent solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #28292e);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #28292e);--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i,.tp-fldv_c>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach(l=>{this.embedPluginStyle_(l)}),this.registerPlugin({plugins:[Ao,Ir,Dr,Hi]})}},D.SeparatorApi=Xt,D.SliderApi=xr,D.TabApi=Kn,D.TabPageApi=Yn,D.TextApi=On,D.TpChangeEvent=w,D.VERSION=Mo,Object.defineProperty(D,"__esModule",{value:!0})})(T)},excalibur:E=>{E.exports=g}},W={};function Z(E){var T=W[E];if(T!==void 0)return T.exports;var D=W[E]={exports:{}};return F[E].call(D.exports,D,D.exports,Z),D.exports}Z.n=E=>{var T=E&&E.__esModule?()=>E.default:()=>E;return Z.d(T,{a:T}),T},Z.d=(E,T)=>{for(var D in T)Z.o(T,D)&&!Z.o(E,D)&&Object.defineProperty(E,D,{enumerable:!0,get:T[D]})},Z.o=(E,T)=>Object.prototype.hasOwnProperty.call(E,T),Z.r=E=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(E,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(E,"__esModule",{value:!0})};var q={};return(()=>{Z.r(q),Z.d(q,{DevTool:()=>S});var E=Z("excalibur"),T=Z("./node_modules/tweakpane/dist/tweakpane.js"),D=Z("./picker-system.ts");class S{constructor(w){this.engine=w,this.pointerPos={x:0,y:0},this.highlightedEntities=[-1],this.selectedEntity=null,this.selectedEntityId=-1,this._previousScenes=[],this._previousScene=null,this.pane=new T.Pane({title:"Excalibur Dev Tools",expanded:!0});const y=document.createElement("style");y.innerText=".excalibur-tweakpane-custom { width: 405px; }",document.head.appendChild(y),this.pane.element.parentElement.classList.add("excalibur-tweakpane-custom"),this._buildMain(),this.tabs=this.pane.addTab({pages:[{title:"Entity"},{title:"Screen"},{title:"Camera"},{title:"Clock"},{title:"Timers"},{title:"Physics"},{title:"Settings"}]}),this.selectedEntityTab=this.tabs.pages[0],this.screenTab=this.tabs.pages[1],this.cameraTab=this.tabs.pages[2],this.clockTab=this.tabs.pages[3],this.timerTab=this.tabs.pages[4],this.physicsTab=this.tabs.pages[5],this.debugTab=this.tabs.pages[6],this._installPickerSystemIfNeeded(w.currentScene),w.debug.transform.showPosition=!0,w.debug.entity.showName=!0,this.selectedEntityFolder=this.selectedEntityTab.addFolder({title:"Selected"}),this._buildScreenTab(),this._buildCameraTab(),this._buildClockTab(),this._buildTimersTab(),this._buildPhysicsTab(),this._buildDebugSettingsTab(),setInterval(()=>{this.update(this)},30),this.addListeners()}addListeners(){this.engine.canvas.addEventListener("click",()=>{this.highlightedEntities[0]!==-1&&this.selectEntityById(this.highlightedEntities[0])})}selectEntityById(w){const y=this.engine;this.selectedEntityId=w,this.selectedEntity=y.currentScene.world.entityManager.getById(w),this._buildEntityUI(this.selectedEntity);const P=this.selectedEntity.get(E.TransformComponent);this._buildTransformUI(P);const V=this.selectedEntity.get(E.MotionComponent);if(this._buildMotionUI(V),this.selectedEntity instanceof E.ParticleEmitter)this._buildParticleEmitterUI(this.selectedEntity);else{const R=this.selectedEntity.get(E.GraphicsComponent);this._buildGraphicsUI(R);const O=this.selectedEntity.get(E.ColliderComponent),z=this.selectedEntity.get(E.BodyComponent);this._buildColliderUI(O,z)}}update(w){const y=w.engine,P=y.input.pointers.primary.lastWorldPos;this.pointerPos.x=P.x,this.pointerPos.y=P.y,this.pointerPosInput.refresh();const V=[...this.pickerSystem.lastFrameEntityToPointers.keys(),...this.pickerSystem.currentFrameEntityToPointers.keys()];V.length===0&&(V.push(-1),V.push(this.selectedEntityId)),this.highlightedEntities=V,y.debug.filter.useFilter=!0,y.debug.filter.ids=V,this.currentResolution.width===y.screen.resolution.width&&this.currentResolution.height===y.screen.resolution.height&&this.currentViewport.width===y.screen.viewport.width&&this.currentViewport.height===y.screen.viewport.height||(this.resolutionText.dispose(),this.viewportText.dispose(),this.resolutionText=this.screenFolder.addBlade({view:"text",label:"resolution",value:`(${y.screen.resolution.width}x${y.screen.resolution.height})`,parse:R=>String(R),index:0}),this.viewportText=this.screenFolder.addBlade({view:"text",label:"viewport",value:`(${y.screen.viewport.width.toFixed(0)}x${y.screen.viewport.height.toFixed(0)})`,parse:R=>String(R),index:1})),this._buildTimersTab(),this._buildSceneUI()}_installPickerSystemIfNeeded(w){this.pickerSystem=w.world.systemManager.get(D.PickerSystem),this.pickerSystem||(this.pickerSystem=new D.PickerSystem,w.world.systemManager.addSystem(this.pickerSystem))}_buildMain(){this.pane.addInput({debug:!1},"debug").on("change",()=>{this.engine.toggleDebug()}),this.pane.addMonitor(this.engine.clock.fpsSampler,"fps",{view:"graph",label:"fps (0 - 120)",min:0,max:120}),this._buildSceneUI(),this.pointerPos={x:10,y:10},this.pointerPosInput=this.pane.addInput(this,"pointerPos",{label:"pointer pos (world)"}),this.pane.addInput(this,"selectedEntityId",{label:"Select By Id"}).on("change",w=>this.selectEntityById(w.value))}_buildEntityUI(w){var y,P;this.selectedEntityFolder&&(this.selectedEntityFolder.dispose(),this.selectedEntityFolder=this.selectedEntityTab.addFolder({title:"Selected"})),this.selectedEntityFolder.addBlade({view:"text",label:"id",value:w.id.toString(),parse:V=>String(V)}),this.selectedEntityFolder.addInput(this.selectedEntity,"name"),this.selectedEntityFolder.addBlade({view:"text",label:"tags",value:w.tags.join(",")||"none",parse:V=>String(V)}),w instanceof E.Actor&&w.color&&this.selectedEntityFolder.addInput(this.selectedEntity,"color").on("change",V=>{w.color=new E.Color(V.value.r,V.value.g,V.value.b,V.value.a)}),this.selectedEntityFolder.addBlade({view:"text",label:"parent",value:w.parent?`(${(y=w.parent)===null||y===void 0?void 0:y.id}) ${(P=w.parent)===null||P===void 0?void 0:P.name}`:"none",parse:V=>String(V)}),this.selectedEntityFolder.addBlade({view:"list",label:"children",options:w.children.map(V=>({text:`(${V.id}) ${V.name}`,value:V.id})),value:w.children.length?w.children[0].id:"none"}),this.selectedEntityFolder.addButton({title:"Kill Entity"}).on("click",V=>{this.selectedEntity.kill(),this.selectedEntityFolder.dispose(),this.selectedEntityFolder=this.selectedEntityTab.addFolder({title:"Selected"})})}_buildColliderUI(w,y){var P,V;if(w){const R=this.selectedEntityFolder.addFolder({title:"Collider & Body"});R.addBlade({view:"text",label:"type",value:(V=(P=w.get())===null||P===void 0?void 0:P.constructor.name)!==null&&V!==void 0?V:"none",parse:O=>String(O)}),y&&(R.addBlade({view:"list",label:"collisionType",options:[E.CollisionType.Active,E.CollisionType.Fixed,E.CollisionType.Passive,E.CollisionType.PreventCollision].map(O=>({text:O,value:O})),value:y.collisionType}).on("change",O=>{y.collisionType=O.value}),R.addBlade({view:"list",label:"collisionGroup",options:[E.CollisionGroup.All,...E.CollisionGroupManager.groups].map(O=>({text:O.name,value:O})),value:y.group}).on("change",O=>{y.group=O.value}))}}_buildParticleEmitterUI(w){const y=this.selectedEntityFolder.addFolder({title:"Particles"});y.addInput(w,"isEmitting"),y.addInput(w,"emitRate"),y.addInput(w,"fadeFlag"),y.addInput(w,"particleLife",{min:100,max:1e4,step:100}),y.addInput(w,"width"),y.addInput(w,"height"),y.addInput(w,"minVel"),y.addInput(w,"maxVel"),y.addInput(w,"minAngle",{min:0,max:2*Math.PI,step:.1}),y.addInput(w,"maxAngle",{min:0,max:2*Math.PI,step:.1}),y.addInput(w,"minSize"),y.addInput(w,"maxSize"),y.addInput(w,"beginColor"),y.addInput(w,"endColor"),y.addInput(w,"opacity",{min:0,max:1,step:.01}),y.addInput(w,"randomRotation"),y.addInput(w,"particleRotationalVelocity")}_buildGraphicsUI(w){var y;if(w){const P=this.selectedEntityFolder.addFolder({title:"Graphics"});P.addInput(w,"anchor"),P.addInput(w,"opacity",{min:0,max:1,step:.05}),P.addInput(w,"visible");const V=[],R=[],O=w.current.map(m=>m.graphic),z=[];let X=0;for(let m in w.graphics)V.push({text:m,value:X++}),R.push(w.graphics[m]),z.push(w.graphics[m]);let p=0;for(let m of O)z.indexOf(m)===-1&&(V.push({text:"anonymous"+p++,value:X}),R.push(m));P.addBlade({view:"list",label:"graphics",options:V,value:R.indexOf((y=w.current[0])===null||y===void 0?void 0:y.graphic)}).on("change",m=>{w.use(R[m.value])})}}_buildMotionUI(w){if(w){const y=this.selectedEntityFolder.addFolder({title:"Motion"});y.addInput(w,"vel"),y.addInput(w,"acc"),y.addInput(w,"angularVelocity",{step:.1}),y.addInput(w,"scaleFactor"),y.addInput(w,"inertia")}}_buildTransformUI(w){if(w){const y=this.selectedEntityFolder.addFolder({title:"Transform"});y.addBlade({view:"list",label:"coord plane",options:[E.CoordPlane.World,E.CoordPlane.Screen].map(p=>({text:p,value:p})),value:w.coordPlane}).on("change",p=>w.coordPlane=p.value);const P=y.addInput(w,"pos"),V=y.addInput(w,"rotation",{min:0,max:2*Math.PI}),R=y.addInput(w,"scale");y.addSeparator();const O=y.addInput(w,"globalPos",{label:"global pos"}),z=y.addInput(w,"globalRotation",{label:"global rot",min:0,max:2*Math.PI}),X=y.addInput(w,"globalScale",{label:"global pos"});O.on("change",()=>P.refresh()),P.on("change",()=>O.refresh()),z.on("change",()=>V.refresh()),V.on("change",()=>z.refresh()),X.on("change",()=>R.refresh()),R.on("change",()=>X.refresh()),y.addInput(w,"z",{label:"z-index"})}}_buildScreenTab(){this.screenFolder=this.screenTab.addFolder({title:"Screen"}),this.currentResolution=this.engine.screen.resolution,this.currentViewport=this.engine.screen.viewport,this.resolutionText=this.screenFolder.addBlade({view:"text",label:"resolution",value:`(${this.engine.screen.resolution.width}x${this.engine.screen.resolution.height})`,parse:P=>String(P),index:0}),this.viewportText=this.screenFolder.addBlade({view:"text",label:"viewport",value:`(${this.engine.screen.viewport.width.toFixed(0)}x${this.engine.screen.viewport.height.toFixed(0)})`,parse:P=>String(P),index:1}),this.screenFolder.addButton({title:"Fullscreen"}).on("click",()=>{this.engine.screen.goFullScreen()}),this.screenFolder.addSeparator();const w=this.screenFolder.addBlade({view:"list",label:"Color Blindness Mode",options:[E.ColorBlindnessMode.Deuteranope,E.ColorBlindnessMode.Protanope,E.ColorBlindnessMode.Tritanope].map(P=>({text:P,value:P})),value:E.ColorBlindnessMode.Deuteranope}),y={simulate:!1};this.screenFolder.addInput(y,"simulate"),this.screenFolder.addButton({title:"Apply"}).on("click",()=>{y.simulate?this.engine.debug.colorBlindMode.simulate(w.value):this.engine.debug.colorBlindMode.correct(w.value)}),this.screenFolder.addButton({title:"Clear"}).on("click",()=>{this.engine.debug.colorBlindMode.clear()})}_buildCameraTab(){const w=this.cameraTab.addFolder({title:"Camera"});w.addInput(this.engine.currentScene.camera,"zoom",{min:.01,max:10,step:.1}),w.addInput(this.engine.currentScene.camera,"pos")}_buildClockTab(){const w=this.clockTab.addFolder({title:"Clock"});let y=this.engine.clock instanceof E.TestClock,P=16;const V=w.addButton({title:"step",disabled:!y,index:2}).on("click",()=>this.engine.clock.step(P));w.addBlade({view:"slider",label:"step (ms)",min:1,max:100,step:16,value:P}).on("change",z=>P=z.value),w.addButton({title:"Use Test Clock",index:0}).on("click",()=>{this.engine.debug.useTestClock(),y=!0,V.disabled=!1}),w.addButton({title:"Use Standard Clock",index:1}).on("click",()=>{this.engine.debug.useStandardClock(),y=!1,V.disabled=!0}),this.pane.addSeparator();const R=w.addButton({title:"Stop",disabled:!1}),O=w.addButton({title:"Start",disabled:!0});R.on("click",()=>{this.engine.clock.stop(),O.disabled=!1,R.disabled=!0}),O.on("click",()=>{this.engine.clock.start(),R.disabled=!1,O.disabled=!0})}_buildTimersTab(){this.timerTab,this._timersFolder&&this._timersFolder.dispose(),this._timersFolder=this.timerTab.addFolder({title:"Timers"});for(let w of this.engine.currentScene.timers){let y=w.repeats&&w.maxNumberOfRepeats===-1?"repeats":w._numberOfTicks+1+" of "+(w.maxNumberOfRepeats===-1?1:w.maxNumberOfRepeats);w.isRunning||(y="stopped"),w.complete&&(y="complete"),this._timersFolder.addBlade({view:"text",label:`timer(${w.id})`,value:`${y} next(${w.timeToNextAction.toFixed(0)}ms)`,parse:P=>String(P)})}}_buildPhysicsTab(){const w=this.physicsTab,y={};for(let V in E.Physics)y[V]=E.Physics[V];w.addInput(y,"enabled").on("change",V=>E.Physics.enabled=V.value),w.addInput(y,"acc");const P=w.addInput(y,"collisionResolutionStrategy");w.addButton({title:"Use Arcade"}).on("click",()=>{E.Physics.useArcadePhysics(),y.collisionResolutionStrategy=E.Physics.collisionResolutionStrategy,P.refresh()}),w.addButton({title:"Use Realistic"}).on("click",()=>{E.Physics.useRealisticPhysics(),y.collisionResolutionStrategy=E.Physics.collisionResolutionStrategy,P.refresh()}),w.addInput(y,"bodiesCanSleepByDefault").on("change",V=>E.Physics.bodiesCanSleepByDefault=V.value),w.addInput(y,"warmStart").on("change",V=>E.Physics.warmStart=V.value),w.addInput(y,"sleepEpsilon",{min:.01,max:2,step:.05}).on("change",V=>E.Physics.sleepEpsilon=V.value),w.addInput(y,"wakeThreshold",{min:.01,max:2,step:.05}).on("change",V=>E.Physics.wakeThreshold=V.value),w.addInput(y,"positionIterations",{min:1,max:30,step:1}).on("change",V=>E.Physics.positionIterations=V.value),w.addInput(y,"velocityIterations",{min:1,max:30,step:1}).on("change",V=>E.Physics.velocityIterations=V.value),w.addInput(y,"checkForFastBodies").on("change",V=>E.Physics.checkForFastBodies=V.value)}_buildDebugSettingsTab(){const w=this.debugTab;for(let y of["entity","transform","motion","body","collider","physics","graphics","camera"]){let P=w.addFolder({title:y});if(this.engine.debug[y]){for(let V in this.engine.debug[y])if(V)if(V.toLocaleLowerCase().includes("color"))P.addInput(this.engine.debug[y],V);else{if(Array.isArray(this.engine.debug[y][V]))continue;P.addInput(this.engine.debug[y],V)}}}}_areArraysEqual(w,y,P){return w.length===y.length&&w.every(P)}_areScenesEqual(w,y){return this._areArraysEqual(w,y,(P,V,R)=>P.value===R[V].value)}_buildSceneUI(){const w=[];let y="";for(let P in this.engine.scenes)this.engine.currentScene===this.engine.scenes[P]&&(y=P),w.push({text:P,value:P});this._previousScene===this.engine.currentScene&&this._areScenesEqual(this._previousScenes,w)||(this._scenePicker&&this._scenePicker.dispose(),this._numberEntitiesBlade&&this._numberEntitiesBlade.dispose(),this._scenePicker=this.pane.addBlade({view:"list",label:"current scene",options:w,value:y,index:2}),this._scenePicker.on("change",P=>{this.engine.goToScene(P.value)}),this._numberEntitiesBlade=this.pane.addBlade({view:"text",label:"number of entities",value:this.engine.currentScene.world.entityManager.entities.length,parse:P=>String(P),index:3}),this._installPickerSystemIfNeeded(this.engine.currentScene),this._previousScene=this.engine.currentScene,this._previousScenes=w)}}})(),q})())})(RA);class LA extends kr{constructor(g){super({});_t(this,"settingsButton");_t(this,"restartButton");_t(this,"menuButton");_t(this,"lastScene");_t(this,"DataClass");this.DataClass=g}onInitialize(g){this.lastScene=this.DataClass.getScene(),this.DataClass.setScene("pausescreen");let F=ge.fromImageSource({image:Ct.uibuttons,grid:{rows:12,columns:12,spriteHeight:16,spriteWidth:16},spacing:{margin:{x:0,y:0}}});this.settingsButton=new An(16,16,50,75),this.settingsButton.setText("Settings",12),this.settingsButton.setImages(F.sprites[116],F.sprites[2]),this.restartButton=new An(16,16,50,100),this.restartButton.setText("Restart",12),this.restartButton.setImages(F.sprites[117],F.sprites[3]),this.menuButton=new An(16,16,50,125),this.menuButton.setText("Main menu",12),this.menuButton.setImages(F.sprites[130],F.sprites[16]),this.backButton=new An(16,16,50,50),this.backButton.setText("Return to game",12),this.backButton.setImages(F.sprites[117],F.sprites[3]),this.add(this.settingsButton),this.add(this.backButton),this.add(this.restartButton),this.add(this.menuButton)}onPreUpdate(g){g.input.keyboard.wasPressed(Ot.Keys.Esc)&&g.goToScene(this.lastScene),g.input.gamepads.at(0).on("button",F=>{F.button===Ot.Buttons.Select&&g.goToScene(this.lastScene)}),this.settingsButton.isClicked()&&(this.settingsButton.setClicked(),g.goToScene("settings")),this.backButton.isClicked()&&(this.backButton.setClicked(),g.goToScene(this.lastScene)),this.restartButton.isClicked()&&(this.restartButton.setClicked(),this.DataClass.setRestart(!0),g.goToScene("testmap")),this.menuButton.isClicked()&&(this.menuButton.setClicked(),this.DataClass.setRestart(!0),g.goToScene("mainmenu"))}}class NA{constructor(){_t(this,"SFXvolume");_t(this,"Muisicvolume");_t(this,"Scene");_t(this,"restart",!1);_t(this,"playerXpos");_t(this,"levels",["testmap","level1","level2"]);_t(this,"currentLevel",0);_t(this,"multiplayer",!1);_t(this,"playerHealth",[]);_t(this,"score",0)}setSFXvolume(it){this.SFXvolume=parseFloat(it)}setMuisicvolume(it){this.Muisicvolume=parseFloat(it)}setScene(it){this.Scene=it}setRestart(it){this.restart=it}setPlayerXpos(it){this.playerXpos=it}setMultiplayer(it){this.multiplayer=it}setPlayerHealth(it,g){this.playerHealth[it]=g}setScore(it){this.score=it}incrementScore(){this.score=this.score+1}getSFXvolume(){return this.SFXvolume}getMuisicvolume(){return this.Muisicvolume}getScene(){return this.Scene}getRestart(){return this.restart}getPlayerXpos(){return this.playerXpos}getLevel(it){return this.levels[it]}getCurrentLevel(){return this.currentLevel}getMultiplayer(){return this.multiplayer}getPlayerHealth(it){return this.playerHealth[it]}getScore(){return this.score}}class GA extends oa{constructor(){super({width:854,height:480,displayMode:ra.FitScreenAndFill,maxFps:60});_t(this,"settings");_t(this,"testmap");_t(this,"mainmenu");_t(this,"pausescreen");_t(this,"DataClass");ca.acc=new Rt(0,800),this.start(SA).then(()=>this.startGame()),this.DataClass=new NA}startGame(){this.settings=new MA(this.DataClass),this.testmap=new DA(this.DataClass),this.mainmenu=new TA(this.DataClass),this.pausescreen=new LA(this.DataClass),this.add("testmap",this.testmap),this.add("mainmenu",this.mainmenu),this.add("settings",this.settings),this.add("pausescreen",this.pausescreen),this.goToScene("mainmenu")}onPreUpdate(g){this.settings.getSettings()}}new GA;
